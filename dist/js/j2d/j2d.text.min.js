/**
 * J2D (jQuery plugin of the fork j2ds)
 *
 * @authors Skaner, likerRr, DeVinterX
 * @license BSD, zlib
 * @version 0.1.5
 * @see https://github.com/SkanerSoft/J2ds/commit/501b8993fc41960794572dc481a5f2fe492da349
 */

if (global === undefined) var global = window;
if (typeof define !== 'function' || define.amd) global.J2D = {};

!function(t,i){"function"==typeof define&&define.amd?define("j2d.text",["jquery.j2d","j2d.base","j2d.scene"],i):i(t.J2D,BaseNode,Scene)}(global,function(t,i,o){"use strict";o.prototype.addTextNode||(o.prototype.addTextNode=function(t,i,o,n,e,h,p){return new s(this.parent,t,i,o,n,e,h,p)});var s=function(t,o,s,n,e,h,p,l){i.call(this,t,o,t.vector.vec2df(0,0)),this.nodeName="TextNode",this.mergeOptions({vAlign:"top",hAlign:"left",color:e?e:"black",family:h?h:"sans-serif",sizePx:n?n:20,box:{offset:{y:this.j2d.math.toInt(.26*this.sizePx)},size:{y:-this.j2d.math.toInt(.26*this.sizePx)}},lineWidth:p?p:0,colorL:l?l:"black",fullText:s,maxWidth:0,lines:s.split("\n")}),this.options.font=this.options.sizePx+"px "+this.options.family,this.j2d.scene.context.font=this.options.font;for(var x=0,a=this.options.lines.length;a>x;x+=1)this.options.maxWidth=this.options.maxWidth<this.j2d.scene.context.measureText(this.options.lines[x]).width?this.j2d.scene.context.measureText(this.options.lines[x]).width:this.options.maxWidth;this.options.size.x=this.options.maxWidth,this.options.size.y=this.options.lines.length*this.options.sizePx};return s.prototype=Object.create(i.prototype),s.prototype.constructor=s,s.prototype.setSize=function(t){this.options.sizePx=t,this.options.font=this.options.sizePx+"px "+this.options.family,this.j2d.scene.context.font=this.options.font,this.options.box.offset.y=this.j2d.math.toInt(.26*this.options.sizePx),this.options.box.size.y=-this.j2d.math.toInt(.26*this.options.sizePx);for(var i=0,o=this.options.lines.length;o>i;i+=1)this.options.maxWidth=this.options.maxWidth<this.j2d.scene.context.measureText(this.options.lines[i]).width?this.j2d.scene.context.measureText(this.options.lines[i]).width:this.options.maxWidth;this.options.size.x=this.options.maxWidth,this.options.size.y=this.options.lines.length*this.options.sizePx},s.prototype.getSize=function(){return this.options.sizePx},s.prototype.drawSimpleText=function(t,i,o,s){var n=this.layer.context;n.fillStyle=o?o:this.options.color,n.textAlign=this.options.hAlign,n.textBaseline=this.options.vAlign,n.font=this.options.font,n.lineWidth=this.options.lineWidth,n.strokeStyle=s?s:this.options.colorL;var e=t.split("\n");i=i?i:this.options.position;for(var h=0,p=e.length;p>h;h+=1)this.options.lineWidth&&n.strokeText(e[h],i.x,i.y+this.options.sizePx*h),n.fillText(e[h],i.x,i.y+this.options.sizePx*h);n.lineWidth=0,n.strokeStyle="black"},s.prototype.getText=function(){return this.options.fullText},s.prototype.setText=function(t){this.options.fullText=t,this.options.maxWidth=0,this.options.lines=t.split("\n"),this.j2d.scene.context.font=this.options.font,this.options.box.offset.y=this.j2d.math.toInt(.26*this.options.sizePx),this.options.box.size.y=-this.j2d.math.toInt(.26*this.options.sizePx);for(var i=0,o=this.options.lines.length;o>i;i+=1)this.options.maxWidth=this.options.maxWidth<this.j2d.scene.context.measureText(this.options.lines[i]).width?this.j2d.scene.context.measureText(this.options.lines[i]).width:this.options.maxWidth;this.options.size.x=this.options.maxWidth,this.options.size.y=this.options.lines.length*this.options.sizePx},s.prototype.draw=function(){var t=this.layer.context;if(this.options.visible&&this.isLookScene()){if(1!=this.options.alpha){var i=t.globalAlpha;t.globalAlpha=this.options.alpha}this.options.angle&&(t.save(),t.translate(this.getPosition().x-this.j2d.scene.viewport.x,this.getPosition().y-this.j2d.scene.viewport.y),t.rotate(this.j2d.math.rad(this.options.angle)),t.translate(-(this.getPosition().x-this.j2d.scene.viewport.x),-(this.getPosition().y-this.j2d.scene.viewport.y))),t.fillStyle=this.options.color,t.textAlign=this.options.hAlign,t.textBaseline=this.options.vAlign,t.font=this.options.font,t.lineWidth=this.options.lineWidth,t.strokeStyle=this.options.colorL;for(var o=0,s=this.options.lines.length;s>o;o+=1)this.options.lineWidth&&t.strokeText(this.options.lines[o],this.options.position.x,this.options.position.y+this.options.sizePx*o),t.fillText(this.options.lines[o],this.options.position.x,this.options.position.y+this.options.sizePx*o);t.lineWidth=0,t.strokeStyle="black",this.options.angle&&t.restore(),1!=this.options.alpha&&(t.globalAlpha=i)}},void 0!==window.J2D&&(window.TextNode=s),s});
//# sourceMappingURL=j2d.text.min.map
