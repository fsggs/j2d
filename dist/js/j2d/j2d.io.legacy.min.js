/**
 * J2D (jQuery plugin of the fork j2Ds)
 *
 * @authors Skaner, DeVinterX
 * @license BSD, zlib
 * @version 0.1.6
 */

if (global === undefined) var global = window;
if (typeof define !== 'function' || define.amd) global.J2D = {};

!function(e,t){"function"==typeof define&&define.amd?define("j2d.io.legacy",["jquery"],t):t(e.jQuery)}(global,function(e){"use strict";var t=function(e){this.j2d=e,this.data={pos:{x:0,y:0},x:0,y:0,abs:{x:0,y:0},keyDown:[],keyPress:[],keyPressed:[],keyUp:[],keyUpped:!1,mouseDown:[],mousePress:[],mousePressed:[],mouseUp:[],mouseUpped:!1,canceled:!1,body:!1,anyKey:!1,anyMouse:!1,writeMode:!1,displayCursor:"",visible:!0}};return t.prototype.init=function(){var e=this;t.activeElement=e.j2d.element,t.activeElement.focus(),e.j2d.options.window.oncontextmenu=function(){return!1},e.j2d.options.window.onselectstart=e.j2d.options.window.oncontextmenu,e.j2d.options.window.ondragstart=e.j2d.options.window.oncontextmenu,e.j2d.options.window.onmousedown=e.onMouseEvent,e.j2d.options.window.onmouseup=function(t){e.data.canceled=!1,e.onMouseEvent(t)},e.j2d.options.window.onmousemove=function(t){e.onMove(t)},e.j2d.options.window.onkeydown=function(t){e.keyEvent(t)},e.j2d.options.window.onkeyup=function(t){e.data.canceled=!1,e.keyEvent(t)},e.j2d.options.window.onkeypress=function(t){e.keyEvent(t)}},t.prototype.update=function(){var e=this.j2d.scene.canvas.offsetWidth/this.j2d.scene.width,t=this.j2d.scene.canvas.offsetHeight/this.j2d.scene.height;this.data.x=this.data.abs.x/e,this.data.y=this.data.abs.y/t,this.data.pos.x=this.j2d.scene.viewport.x+this.data.x,this.data.pos.y=this.j2d.scene.viewport.y+this.data.y},t.prototype.clear=function(){this.data.keyPress=[],this.data.keyUp=[],this.data.mousePress=[],this.data.mouseUp=[]},t.prototype.keyList=function(){var e=[];for(var s in t.keys)t.keys.hasOwnProperty(s)&&e.push(s);return e},t.prototype.isKeyDown=function(e){return this.data.keyDown[t.keys[e]]},t.prototype.isKeyPress=function(e){return this.data.keyPress[t.keys[e]]},t.prototype.isKeyUp=function(e){return this.data.keyUp[t.keys[e]]},t.prototype.getPosition=function(){return this.j2d.vector.vec2df(this.data.pos.x,this.data.pos.y)},t.prototype.setWriteMode=function(e){this.data.writeMode=e},t.prototype.isWriteMode=function(){return this.data.writeMode},t.prototype.keyEvent=function(t){if("keydown"==t.type)this.data.keyPressed[t.keyCode]||(this.data.keyPress[t.keyCode]=!0,this.data.keyPressed[t.keyCode]=!0),this.data.writeMode?e(this.j2d.element).trigger("keyPress"):t.preventDefault();else if("keyup"==t.type)this.data.keyPressed[t.keyCode]&&(this.data.keyPress[t.keyCode]=!1,this.data.keyPressed[t.keyCode]=!1,this.data.keyUp[t.keyCode]=!0,this.data.keyUpped=!0,t.preventDefault());else if("keypress"==t.type&&this.data.writeMode){var s="";0!=t.which&&0!=t.charCode&&t.which>=32&&(s=String.fromCharCode(t.which)),e(this.j2d.element).trigger("keyPress",[s])}return this.data.keyDown[t.keyCode]="keydown"==t.type&&!this.data.canceled,this.data.anyKey=t.keyCode,!1},t.prototype.cancel=function(e){e?this.data.keyDown[t.keys[e]]=!1:(this.data.canceled=!0,this.data.keyDown=[],this.data.mouseDown=[])},t.prototype.onNode=function(e){return e.layer.visible?this.data.pos.x>e.options.position.x&&this.data.pos.x<e.options.position.x+e.options.size.x&&this.data.pos.y>e.options.position.y&&this.data.pos.y<e.options.position.y+e.options.size.y:!1},t.prototype.onMove=function(e){this.data.abs.x=e.pageX,this.data.abs.y=e.pageY},t.prototype.isMouseDown=function(e){return this.data.mouseDown[t.mKeys[e]]},t.prototype.isMousePress=function(e){return this.data.mousePress[t.mKeys.mKeys[e]]},t.prototype.isMouseUp=function(e){return this.data.mouseUp[t.mKeys.mKeys[e]]},t.prototype.onMouseEvent=function(e){t.activeElement.j2d().options.io;return!e.which&&e.button&&(1&e.button?e.which=1:4&e.button?e.which=2:2&e.button&&(e.which=3)),"mousedown"==e.type?this.data.mousePressed[e.which]||(this.data.mousePress[e.which]=!0,this.data.mousePressed[e.which]=!0):"mouseup"==e.type&&this.data.mousePressed[e.which]&&(this.data.mousePress[e.which]=!1,this.data.mousePressed[e.which]=!1,this.data.mouseUp[e.which]=!0,this.data.mouseUped=!0),this.data.mouseDown[e.which]="mousedown"==e.type&&!this.data.canceled,t.activeElement.focus(),e.preventDefault(),!1},t.prototype.setCursorImage=function(t){e(this.j2d.element).css("cursor",'url("'+t+'"), auto')},t.prototype.setVisible=function(t){this.data.visible=t,t?e(this.j2d.element).css("cursor",this.data.displayCursor):(this.data.displayCursor=e(this.j2d.element).css("cursor"),e(this.j2d.element).css("cursor","none"))},t.prototype.isVisible=function(){return this.data.visible},t.mKeys={LEFT:1,MIDDLE:2,RIGHT:3},t.keys={LEFT:37,RIGHT:39,UP:38,DOWN:40,SPACE:32,CTRL:17,SHIFT:16,ALT:18,ESC:27,ENTER:13,MINUS:189,PLUS:187,CAPS_LOCK:20,BACKSPACE:8,TAB:9,Q:81,W:87,E:69,R:82,T:84,Y:89,U:85,I:73,O:79,P:80,A:65,S:83,D:68,F:70,G:71,H:72,J:74,K:75,L:76,Z:90,X:88,V:86,B:66,N:78,M:77,0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,C:67,9:57,NUM_0:45,NUM_1:35,NUM_2:40,NUM_3:34,NUM_4:37,NUM_5:12,NUM_6:39,NUM_7:36,NUM_8:38,NUM_9:33,NUM_MINUS:109,NUM_PLUS:107,NUM_LOCK:144,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123},t.activeElement=void 0,void 0!==global.J2D&&(global.IO=t),t});
//# sourceMappingURL=j2d.io.legacy.min.map
