/**
 * J2D (jQuery plugin of the fork j2ds)
 *
 * @authors Skaner, likerRr, DeVinterX
 * @license BSD, zlib
 * @version 0.1.5
 * @see https://github.com/SkanerSoft/J2ds/commit/501b8993fc41960794572dc481a5f2fe492da349
 */

if (global === undefined) var global = window;
if (typeof define !== 'function' || define.amd) global.J2D = {};

!function(e,t){"function"==typeof define&&define.amd?define("j2d.webGL2d",[],t):t()}(global,function(){"use strict";function e(e){return e>0&&0===(e-1&e)}function t(e){return this.clearStack(e)}var r={identity:[1,0,0,0,1,0,0,0,1],multiply:function(e,t){var r=e[0],i=e[1],a=e[2],o=e[3],n=e[4],f=e[5],s=e[6],l=e[7],u=e[8],c=t[0],h=t[1],d=t[2],g=t[3],p=t[4],m=t[5],v=t[6],b=t[7],y=t[8];t[0]=c*r+g*i+v*a,t[1]=h*r+p*i+b*a,t[2]=d*r+m*i+y*a,t[3]=c*o+g*n+v*f,t[4]=h*o+p*n+b*f,t[5]=d*o+m*n+y*f,t[6]=c*s+g*l+v*u,t[7]=h*s+p*l+b*u,t[8]=d*s+m*l+y*u},vec2_multiply:function(e,t){var r=[];return r[0]=t[0]*e[0]+t[3]*e[1]+t[6],r[1]=t[1]*e[0]+t[4]*e[1]+t[7],r},transpose:function(e){return[e[0],e[3],e[6],e[1],e[4],e[7],e[2],e[5],e[8]]}},i=16;t.prototype.clearStack=function(e){this.m_stack=[],this.m_cache=[],this.c_stack=0,this.valid=0,this.result=null;for(var t=0;i>t;t++)this.m_stack[t]=this.getIdentity();void 0!==e?this.m_stack[0]=e:this.setIdentity()},t.prototype.setIdentity=function(){this.m_stack[this.c_stack]=this.getIdentity(),this.valid===this.c_stack&&this.c_stack&&this.valid--},t.prototype.getIdentity=function(){return[1,0,0,0,1,0,0,0,1]},t.prototype.getResult=function(){if(!this.c_stack)return this.m_stack[0];var e=r.identity;this.valid>this.c_stack-1&&(this.valid=this.c_stack-1);for(var t=this.valid;t<this.c_stack+1;t++)e=r.multiply(this.m_stack[t],e),this.m_cache[t]=e;return this.valid=this.c_stack-1,this.result=this.m_cache[this.c_stack],this.result},t.prototype.pushMatrix=function(){this.c_stack++,this.m_stack[this.c_stack]=this.getIdentity()},t.prototype.popMatrix=function(){0!==this.c_stack&&this.c_stack--};var a=t.prototype.getIdentity();t.prototype.translate=function(e,t){a[6]=e,a[7]=t,r.multiply(a,this.m_stack[this.c_stack])};var o=t.prototype.getIdentity();t.prototype.tr=function(e,t,i,a,n,f){o[0]=e,o[1]=t,o[3]=i,o[4]=a,o[6]=n,o[7]=f,r.multiply(o,this.m_stack[this.c_stack])};var n=t.prototype.getIdentity();t.prototype.scale=function(e,t){n[0]=e,n[4]=t,r.multiply(n,this.m_stack[this.c_stack])};var f=t.prototype.getIdentity();t.prototype.rotate=function(e){var t,i;t=Math.sin(-e),i=Math.cos(-e),f[0]=i,f[3]=t,f[1]=-t,f[4]=i,r.multiply(f,this.m_stack[this.c_stack])};var s=global.WebGL2D=function(e,r){this.canvas=e,this.options=r||{},this.gl=void 0,this.fs=void 0,this.vs=void 0,this.shaderProgram=void 0,this.transform=new t,this.shaderPool=[],this.maxTextureSize=void 0,e.gl2d=this,e.$getContext=e.getContext,e.getContext=function(t){return function(r){if(!t.options.force&&"WebGL-2d"!==r||0===e.width||0===e.height)return t.canvas.$getContext(r);if(t.gl)return t.gl;var i=t.gl=t.canvas.$getContext("experimental-webgl");return"undefined"==typeof i||null===i?t.canvas.$getContext("2d"):(t.initShaders(),t.initBuffers(),t.initCanvas2DAPI(),i.enable(i.BLEND),i.blendFuncSeparate(i.SRC_ALPHA,i.ONE_MINUS_SRC_ALPHA,i.ONE,i.ONE_MINUS_SRC_ALPHA),t.maxTextureSize=i.getParameter(i.MAX_TEXTURE_SIZE),i)}}(this),this.postInit()};s.enable=function(e,t){return e.gl2d||new s(e,t)};var l={texture:1,crop:2,path:4};s.prototype.getFragmentShaderSource=function(e){var t=["#ifdef GL_ES","precision highp float;","#endif","#define hasTexture "+(e&l.texture?"1":"0"),"#define hasCrop "+(e&l.crop?"1":"0"),"varying vec4 vColor;","#if hasTexture","varying vec2 vTextureCoord;","uniform sampler2D uSampler;","#if hasCrop","uniform vec4 uCropSource;","#endif","#endif","void main(void) {","#if hasTexture","#if hasCrop","gl_FragColor = texture2D(uSampler, vec2(vTextureCoord.x * uCropSource.z, vTextureCoord.y * uCropSource.w) + uCropSource.xy);","#else","gl_FragColor = texture2D(uSampler, vTextureCoord);","#endif","#else","gl_FragColor = vColor;","#endif","}"].join("\n");return t},s.prototype.getVertexShaderSource=function(e,t){e=e||1;var r=["#define hasTexture "+(t&l.texture?"1":"0"),"attribute vec4 aVertexPosition;","#if hasTexture","varying vec2 vTextureCoord;","#endif","uniform vec4 uColor;","uniform mat3 uTransforms["+e+"];","varying vec4 vColor;","uniform mat4 pMatrix;","mat3 crunchStack(void) {","mat3 result = uTransforms[0];","for (int i = 1; i < "+e+"; ++i) {","result = uTransforms[i] * result;","}","return result;","}","void main(void) {","vec3 position = crunchStack() * vec3(aVertexPosition.x, aVertexPosition.y, 1.0);","gl_Position = pMatrix * vec4(position, 1.0);","vColor = uColor;","#if hasTexture","vTextureCoord = aVertexPosition.zw;","#endif","}"].join("\n");return r},s.prototype.initShaders=function(e,t){var r=this.gl;e=e||1,t=t||0;var i=this.shaderPool[e];if(i||(i=this.shaderPool[e]=[]),i=i[t])r.useProgram(i),this.shaderProgram=i;else{var a=this.fs=r.createShader(r.FRAGMENT_SHADER);if(r.shaderSource(this.fs,this.getFragmentShaderSource(t)),r.compileShader(this.fs),!r.getShaderParameter(this.fs,r.COMPILE_STATUS))throw"fragment shader error: "+r.getShaderInfoLog(this.fs);var o=this.vs=r.createShader(r.VERTEX_SHADER);if(r.shaderSource(this.vs,this.getVertexShaderSource(e,t)),r.compileShader(this.vs),!r.getShaderParameter(this.vs,r.COMPILE_STATUS))throw"vertex shader error: "+r.getShaderInfoLog(this.vs);var n=this.shaderProgram=r.createProgram();if(n.stackDepth=e,r.attachShader(n,a),r.attachShader(n,o),r.linkProgram(n),!r.getProgramParameter(n,r.LINK_STATUS))throw"Could not initialise shaders.";r.useProgram(n),n.vertexPositionAttribute=r.getAttribLocation(n,"aVertexPosition"),r.enableVertexAttribArray(n.vertexPositionAttribute),n.uColor=r.getUniformLocation(n,"uColor"),n.uSampler=r.getUniformLocation(n,"uSampler"),n.uCropSource=r.getUniformLocation(n,"uCropSource"),n.pMatrix=r.getUniformLocation(n,"pMatrix"),n.uTransforms=[];for(var f=0;e>f;++f)n.uTransforms[f]=r.getUniformLocation(n,"uTransforms["+f+"]");this.shaderPool[e][t]=n}return c[0]=2/this.canvas.width,c[5]=-2/this.canvas.height,r.uniformMatrix4fv(this.shaderProgram.pMatrix,!1,c),r.viewport(0,0,this.canvas.width,this.canvas.height),this.shaderProgram};var u=new Float32Array([0,0,0,0,0,1,0,1,1,1,1,1,1,0,1,0]),c=new Float32Array(16);return c[10]=1,c[11]=1,c[12]=-1,c[13]=1,s.prototype.initBuffers=function(){var e=this.gl;e.rectVertexPositionBuffer=e.createBuffer(),e.rectVertexColorBuffer=e.createBuffer(),e.pathVertexPositionBuffer=e.createBuffer(),e.pathVertexColorBuffer=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,e.rectVertexPositionBuffer),e.bufferData(e.ARRAY_BUFFER,u,e.STATIC_DRAW)},s.instances=[],s.prototype.postInit=function(){s.instances.push(this)},s.prototype.initCanvas2DAPI=function(){function t(e,t,r){return 0>r&&(r+=1),r>1&&(r-=1),1/6>r?e+6*(t-e)*r:.5>r?t:2/3>r?e+(t-e)*(2/3-r)*6:e}function r(e,r,i,a){var o,n,f,s,l;return e=(e%360+360)%360/360,r=r>100?1:r/100,r=0>r?0:r,i=i>100?1:i/100,i=0>i?0:i,0==r?o=n=f=i:(l=.5>i?i*(1+r):i+r-i*r,s=2*i-l,o=t(s,l,e+1/3),n=t(s,l,e),f=t(s,l,e-1/3)),[o,n,f,a]}function i(e){var t,a,o,n,f,s,l=[];if(t=v.exec(e)){if(n=t[1],f=parseFloat(t[8]),n&&isNaN(f)||!n&&!isNaN(f))return!1;s=t[3];for(var u=2;8>u;u+=2){if(a=t[u],o=t[u+1],o!==s)return!1;o?(a=a>100?1:a/100,a=0>a?0:a):(a=a>255?1:a/255,a=0>a?0:a),l.push(a)}l.push(n?f:1)}else if(t=b.exec(e))n=t[1],f=parseFloat(t[5]),l=r(t[2],t[3],t[4],parseFloat(n&&f?f:1));else if(t=S.exec(e)){var c=parseInt(t[1],16);l=[((16711680&c)>>16)/255,((65280&c)>>8)/255,(255&c)/255,1]}else if(t=T.exec(e)){var h="#"+[t[1],t[1],t[2],t[2],t[3],t[3]].join("");l=i(h)}else if(e.toLowerCase()in A)l=i(A[e.toLowerCase()]);else{if("transparent"!==e.toLowerCase())return!1;l=[0,0,0,0]}return l}function a(e){return"rgba("+255*e[0]+", "+255*e[1]+", "+255*e[2]+", "+parseFloat(e[3])+")"}function o(){var e={fillStyle:[_.fillStyle[0],_.fillStyle[1],_.fillStyle[2],_.fillStyle[3]],strokeStyle:[_.strokeStyle[0],_.strokeStyle[1],_.strokeStyle[2],_.strokeStyle[3]],globalAlpha:_.globalAlpha,globalCompositeOperation:_.globalCompositeOperation,lineCap:_.lineCap,lineJoin:_.lineJoin,lineWidth:_.lineWidth,miterLimit:_.miterLimit,shadowColor:_.shadowColor,shadowBlur:_.shadowBlur,shadowOffsetX:_.shadowOffsetX,shadowOffsetY:_.shadowOffsetY,textAlign:_.textAlign,font:_.font,textBaseline:_.textBaseline,imageSmoothingEnabled:_.imageSmoothingEnabled};P.push(e)}function n(){P.length&&(_=P.pop())}function f(e){for(var t=d.transform.m_stack,r=0,i=d.transform.c_stack+1;i>r;++r)g.uniformMatrix3fv(e.uTransforms[r],!1,t[i-1-r])}function s(e,t){this.closed=!1,this.verts=[e,t,0,0]}function u(e){var t=d.transform,r=d.initShaders(t.c_stack+2,0),i=E[e],a=i.verts;g.bindBuffer(g.ARRAY_BUFFER,g.pathVertexPositionBuffer),g.bufferData(g.ARRAY_BUFFER,new Float32Array(a),g.STATIC_DRAW),g.vertexAttribPointer(r.vertexPositionAttribute,4,g.FLOAT,!1,0,0),t.pushMatrix(),f(r),g.uniform4f(r.uColor,_.fillStyle[0],_.fillStyle[1],_.fillStyle[2],_.fillStyle[3]),g.drawArrays(g.TRIANGLE_FAN,0,a.length/4),t.popMatrix()}function c(e){var t=d.transform,r=d.initShaders(t.c_stack+2,0),i=E[e],a=i.verts;g.bindBuffer(g.ARRAY_BUFFER,g.pathVertexPositionBuffer),g.bufferData(g.ARRAY_BUFFER,new Float32Array(a),g.STATIC_DRAW),g.vertexAttribPointer(r.vertexPositionAttribute,4,g.FLOAT,!1,0,0),t.pushMatrix(),f(r),g.uniform4f(r.uColor,_.strokeStyle[0],_.strokeStyle[1],_.strokeStyle[2],_.strokeStyle[3]),i.closed?g.drawArrays(g.LINE_LOOP,0,a.length/4):g.drawArrays(g.LINE_STRIP,0,a.length/4),t.popMatrix()}function h(t){if(this.obj=g.createTexture(),this.index=R.push(this),C.push(t),t.width>d.maxTextureSize||t.height>d.maxTextureSize){var r=document.createElement("canvas");r.width=t.width>d.maxTextureSize?d.maxTextureSize:t.width,r.height=t.height>d.maxTextureSize?d.maxTextureSize:t.height;var i=r.getContext("2d");i.drawImage(t,0,0,t.width,t.height,0,0,r.width,r.height),t=r}var a=g.LINEAR,o=g.LINEAR_MIPMAP_LINEAR;_.imageSmoothingEnabled||(a=g.NEAREST,o=g.LINEAR_MIPMAP_NEAREST),g.bindTexture(g.TEXTURE_2D,this.obj),g.texImage2D(g.TEXTURE_2D,0,g.RGBA,g.RGBA,g.UNSIGNED_BYTE,t),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_S,g.CLAMP_TO_EDGE),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_T,g.CLAMP_TO_EDGE),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MAG_FILTER,a),e(t.width)&&e(t.height)?(g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MIN_FILTER,o),g.generateMipmap(g.TEXTURE_2D)):g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MIN_FILTER,a),g.bindTexture(g.TEXTURE_2D,null)}var d=this,g=this.gl,p=document.createElement("canvas");p.width=d.canvas.width,p.height=d.canvas.height;var m=p.getContext("2d"),v=/^rgb(a)?\(\s*(-?[\d]+)(%)?\s*,\s*(-?[\d]+)(%)?\s*,\s*(-?[\d]+)(%)?\s*,?\s*(-?[\d\.]+)?\s*\)$/,b=/^hsl(a)?\(\s*(-?[\d\.]+)\s*,\s*(-?[\d\.]+)%\s*,\s*(-?[\d\.]+)%\s*,?\s*(-?[\d\.]+)?\s*\)$/,S=/^#([0-9A-Fa-f]{6})$/,T=/^#([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/,A={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgrey:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"},_={},P=[];_.fillStyle=[0,0,0,1],Object.defineProperty(g,"fillStyle",{get:function(){return a(_.fillStyle)},set:function(e){_.fillStyle=i(e)||_.fillStyle}}),_.strokeStyle=[0,0,0,1],Object.defineProperty(g,"strokeStyle",{get:function(){return a(_.strokeStyle)},set:function(e){_.strokeStyle=i(e)||drawStyle.strokeStyle}}),g.$lineWidth=g.lineWidth,_.lineWidth=1,Object.defineProperty(g,"lineWidth",{get:function(){return _.lineWidth},set:function(e){e>0&&(g.$lineWidth(e),_.lineWidth=e)}}),_.lineCap="butt",Object.defineProperty(g,"lineCap",{get:function(){return _.lineCap},set:function(e){_.lineCap=e}}),_.lineJoin="miter",Object.defineProperty(g,"lineJoin",{get:function(){return _.lineJoin},set:function(e){_.lineJoin=e}}),_.miterLimit=10,Object.defineProperty(g,"miterLimit",{get:function(){return _.miterLimit},set:function(e){_.miterLimit=e}}),_.shadowOffsetX=0,Object.defineProperty(g,"shadowOffsetX",{get:function(){return _.shadowOffsetX},set:function(e){_.shadowOffsetX=e}}),_.shadowOffsetY=0,Object.defineProperty(g,"shadowOffsetY",{get:function(){return _.shadowOffsetY},set:function(e){_.shadowOffsetY=e}}),_.shadowBlur=0,Object.defineProperty(g,"shadowBlur",{get:function(){return _.shadowBlur},set:function(e){_.shadowBlur=e}}),_.shadowColor="rgba(0, 0, 0, 0.0)",Object.defineProperty(g,"shadowColor",{get:function(){return _.shadowColor},set:function(e){_.shadowColor=e}}),_.font="10px sans-serif",Object.defineProperty(g,"font",{get:function(){return _.font},set:function(e){m.font=e,_.font=e}}),_.textAlign="start",Object.defineProperty(g,"textAlign",{get:function(){return _.textAlign},set:function(e){_.textAlign=e}}),_.textBaseline="alphabetic",Object.defineProperty(g,"textBaseline",{get:function(){return _.textBaseline},set:function(e){_.textBaseline=e}}),_.globalAlpha=1,Object.defineProperty(g,"globalAlpha",{get:function(){return _.globalAlpha},set:function(e){_.globalAlpha=e}}),_.imageSmoothingEnabled=!0,Object.defineProperty(g,"imageSmoothingEnabled",{get:function(){return _.imageSmoothingEnabled},set:function(e){_.imageSmoothingEnabled=!!e}}),_.globalCompositeOperation="source-over",Object.defineProperty(g,"globalCompositeOperation",{get:function(){return _.globalCompositeOperation},set:function(e){_.globalCompositeOperation=e}}),g.fillText=function(e,t,r){m.clearRect(0,0,d.canvas.width,d.canvas.height),m.fillStyle=g.fillStyle,m.fillText(e,t,r),g.drawImage(p,0,0)},g.strokeText=function(){},g.measureText=function(){return 1};var w=document.createElement("canvas"),k=w.getContext("2d");g.save=function(){d.transform.pushMatrix(),o()},g.restore=function(){d.transform.popMatrix(),n()},g.translate=function(e,t){d.transform.translate(e,t)},g.rotate=function(e){d.transform.rotate(e)},g.scale=function(e,t){d.transform.scale(e,t)},g.createImageData=function(e,t){return k.createImageData(e,t)},g.getImageData=function(e,t,r,i){var a=k.createImageData(r,i),o=new Uint8Array(r*i*4);g.readPixels(e,t,r,i,g.RGBA,g.UNSIGNED_BYTE,o);for(var n=4*r,f=i,s=0,l=f/2;l>s;++s)for(var u=0,c=n;c>u;++u){var h=s*n+u,d=(f-s-1)*n+u;a.data[h]=o[d],a.data[d]=o[h]}return a},g.putImageData=function(e,t,r){g.drawImage(e,t,r)},g.transform=function(e,t,r,i,a,o){d.transform.tr(e,t,r,i,a,o)},g.setTransform=function(e,t,r,i,a,o){d.transform.setIdentity(),g.transform.apply(this,arguments)},g.fillRect=function(e,t,r,i){var a=d.transform,o=d.initShaders(a.c_stack+2,0);g.bindBuffer(g.ARRAY_BUFFER,g.rectVertexPositionBuffer),g.vertexAttribPointer(o.vertexPositionAttribute,4,g.FLOAT,!1,0,0),a.pushMatrix(),a.translate(e,t),a.scale(r,i),f(o),g.uniform4f(o.uColor,_.fillStyle[0],_.fillStyle[1],_.fillStyle[2],_.fillStyle[3]),g.drawArrays(g.TRIANGLE_FAN,0,4),a.popMatrix()},g.strokeRect=function(e,t,r,i){var a=d.transform,o=d.initShaders(a.c_stack+2,0);g.bindBuffer(g.ARRAY_BUFFER,g.rectVertexPositionBuffer),g.vertexAttribPointer(o.vertexPositionAttribute,4,g.FLOAT,!1,0,0),a.pushMatrix(),a.translate(e,t),a.scale(r,i),f(o),g.uniform4f(o.uColor,_.strokeStyle[0],_.strokeStyle[1],_.strokeStyle[2],_.strokeStyle[3]),g.drawArrays(g.LINE_LOOP,0,4),a.popMatrix()},g.clearRect=function(e,t,r,i){};var E=[];g.beginPath=function(){E.length=0},g.closePath=function(){if(E.length){var e=E[E.length-1],t=e.verts[0],r=e.verts[1];e.closed=!0;var i=new s(t,r);E.push(i)}},g.moveTo=function(e,t){E.push(new s(e,t))},g.lineTo=function(e,t){E.length?E[E.length-1].verts.push(e,t,0,0):g.moveTo(e,t)},g.quadraticApproximateCount=50,g.quadraticCurveTo=function(e,t,r,i){if(E.length)for(var a,o,n,f,s=E[E.length-1].verts,l=s[s.length-4],u=s[s.length-3],c=0;c<g.quadraticApproximateCount;c++)a=c/g.quadraticApproximateCount,o=1-a,n=o*o*l+2*o*a*e+a*a*r,f=o*o*u+2*o*a*t+a*a*i,s.push(n,f,0,0);else g.moveTo(r,i)},g.bezierApproximateCount=50,g.bezierCurveTo=function(e,t,r,i,a,o){if(E.length)for(var n,f,s,l,u=E[E.length-1].verts,c=u[u.length-4],h=u[u.length-3],d=0;d<g.bezierApproximateCount;d++)n=d/g.bezierApproximateCount,f=1-n,s=f*f*f*c+3*f*f*n*e+3*f*n*n*r+n*n*n*a,l=f*f*f*h+3*f*f*n*t+3*f*n*n*i+n*n*n*o,u.push(s,l,0,0);else g.moveTo(a,o)},g.arcTo=function(){E.length||g.moveTo(x,y)},g.rect=function(e,t,r,i){g.moveTo(e,t),g.lineTo(e+r,t),g.lineTo(e+r,t+i),g.lineTo(e,t+i),g.closePath()},g.arcApproximateCount=100,g.arc=function(e,t,r,i,a,o){if(E.length){var n=E[E.length-1].verts,f=e+r*Math.cos(i),s=t+r*Math.sin(i);for(n.push(f,s,0,0);i>2*Math.PI;)i-=2*Math.PI;for(;a>2*Math.PI;)a-=2*Math.PI;for(;i<2*-Math.PI;)i+=2*Math.PI;for(;a<2*-Math.PI;)a+=2*Math.PI;if(i==a)return;var l,u=1/g.arcApproximateCount,c=g.arcApproximateCount;o&&(a-=2*Math.PI,u=-u);for(var h=i;h>a&&o||a>h&&!o;h+=u)l!=(l=(h*c|0)/c)&&(f=e+r*Math.cos(l),s=t+r*Math.sin(l),n.push(f,s,0,0))}else g.moveTo(f,s)},g.fill=function(){for(var e=0;e<E.length;e++)u(e)},g.stroke=function(){for(var e=0;e<E.length;e++)c(e)},g.clip=function(){},g.isPointInPath=function(){},g.drawFocusRing=function(){};var C=[],R=[];g.drawImage=function(e,t,r,i,a,o,n,s,u){var c=d.transform;c.pushMatrix();var p=l.texture,m=!1;3===arguments.length?(c.translate(t,r),c.scale(e.width,e.height)):5===arguments.length?(c.translate(t,r),c.scale(i,a)):9===arguments.length&&(c.translate(o,n),c.scale(s,u),p|=l.crop,m=!0);var v,b=d.initShaders(c.c_stack+1,p),y=C.indexOf(e);v=-1!==y?R[y]:new h(e),m&&g.uniform4f(b.uCropSource,t/e.width,r/e.height,i/e.width,a/e.height),g.bindBuffer(g.ARRAY_BUFFER,g.rectVertexPositionBuffer),g.vertexAttribPointer(b.vertexPositionAttribute,4,g.FLOAT,!1,0,0),g.bindTexture(g.TEXTURE_2D,v.obj),g.activeTexture(g.TEXTURE0),g.uniform1i(b.uSampler,0),f(b),g.drawArrays(g.TRIANGLE_FAN,0,4),c.popMatrix()},Object.defineProperty(g,"isWebGL",{configurable:!1,enumerable:!0,writable:!1,value:!0})},s});
//# sourceMappingURL=j2d.webGL2d.min.map
