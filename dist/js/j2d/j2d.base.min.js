define("j2d.base",["jquery.j2d","j2d.scene"],function(t,i){"use strict";i.prototype.addBaseNode||(i.prototype.addBaseNode=function(t,i){return new e(this.parent,t,i)});var e=function(t,i,e){this.j2d=t,this.visible=!0,this.alpha=1,this.pos=i,this.size=e,this.parent=!1,this.angle=0,this.layer=t.scene,this.box={offset:{x:0,y:0},size:{x:0,y:0}}};return e.prototype.resizeBox=function(t,i){this.box.offset=t,this.box.size=i},e.prototype.setLayer=function(t){this.layer=t?this.j2d.layers.getLayer(t):this.j2d.scene},e.prototype.getLayer=function(){return this.layer},e.prototype.setVisible=function(t){this.visible=t},e.prototype.isVisible=function(){return this.visible},e.prototype.setAlpha=function(t){0>t&&(t=0),t>1&&(t=1),this.alpha=t},e.prototype.getAlpha=function(t){return this.alpha},e.prototype.moveTo=function(t,i){i=i?i:1,this.move(this.j2d.vector.vec2df((t.x-this.getPosition().x)/i,(t.y-this.getPosition().y)/i))},e.prototype.setPosition=function(t){this.pos=this.j2d.vector.vec2df(t.x-Math.ceil(this.size.x/2),t.y-Math.ceil(this.size.y/2))},e.prototype.move=function(t){this.pos.x+=t.x,this.pos.y+=t.y},e.prototype.getPosition=function(){return this.j2d.vector.vec2df(this.pos.x+Math.ceil(this.size.x/2),this.pos.y+Math.ceil(this.size.y/2))},e.prototype.setSize=function(t){this.size=t},e.prototype.getSize=function(){return this.size},e.prototype.setParent=function(t){this.parent=t},e.prototype.getDistance=function(t){return Math.ceil(Math.sqrt(Math.pow(t.getPosition().x-this.getPosition().x,2)+Math.pow(t.getPosition().y-this.getPosition().y,2)))},e.prototype.getDistanceXY=function(t){return this.j2d.vector.vec2df(Math.abs(t.getPosition().x-this.getPosition().x),Math.abs(t.getPosition().y-this.getPosition().y))},e.prototype.isIntersect=function(t){var i={x1:this.pos.x+this.box.offset.x,x2:t.pos.x+t.box.offset.x,y1:this.pos.y+this.box.offset.y,y2:t.pos.y+t.box.offset.y},e={x1:this.size.x+this.box.size.x,x2:t.size.x+t.box.size.x,y1:this.size.y+this.box.size.y,y2:t.size.y+t.box.size.y};return i.y1+e.y1>=i.y2&&i.x1+e.x1>=i.x2&&i.x1<i.x2+e.x2&&i.y1<i.y2+e.y2},e.prototype.isCollision=function(t){var i=!1;return this.getDistanceXY(t).x<this.size.x/2+t.size.x/2&&this.getDistanceXY(t).y<this.size.y/2+t.size.y/2&&(i=!0),i},e.prototype.isLookScene=function(){var t=!0;return(this.pos.x>this.j2d.scene.viewport.x+this.j2d.scene.width||this.pos.x+this.size.x<this.j2d.scene.viewport.x||this.pos.y>this.j2d.scene.viewport.y+this.j2d.scene.height||this.pos.y+this.size.y<this.j2d.scene.viewport.y)&&(t=!1),t},e.prototype.turn=function(t){this.angle=this.angle%360,this.angle+=t},e.prototype.setRotation=function(t){this.angle=t%360},e.prototype.getRotation=function(t){return this.angle},e.prototype.isOutScene=function(){var t={};return this.pos.x+this.size.x>=this.j2d.scene.viewport.x+this.j2d.scene.width?t.x=1:this.pos.x<=this.j2d.scene.viewport.x?t.x=-1:t.x=0,this.pos.y+this.size.y>=this.j2d.scene.viewport.y+this.j2d.scene.height?t.y=1:this.pos.y<=this.j2d.scene.viewport.y?t.y=-1:t.y=0,t.all=t.x||t.y,t},e.prototype.moveDir=function(t){this.pos.x+=t*Math.cos(this.j2d.math.rad(this.angle)),this.pos.y+=t*Math.sin(this.j2d.math.rad(this.angle))},e.prototype.drawBox=function(){var t=this.layer.context;this.angle&&(t.save(),t.translate(this.getPosition().x-this.j2d.scene.viewport.x,this.getPosition().y-this.j2d.scene.viewport.y),t.rotate(this.j2d.math.rad(this.angle)),t.translate(-(this.getPosition().x-this.j2d.scene.viewport.x),-(this.getPosition().y-this.j2d.scene.viewport.y))),t.lineWidth=2,t.strokeStyle="black",t.lineCap="round",t.beginPath(),t.rect(this.pos.x-this.j2d.scene.viewport.x,this.pos.y-this.j2d.scene.viewport.y,this.size.x,this.size.y),t.stroke(),t.strokeStyle="yellow",t.beginPath(),t.rect(this.box.offset.x+this.pos.x-this.j2d.scene.viewport.x,this.box.offset.y+this.pos.y-this.j2d.scene.viewport.y,this.box.size.x+this.size.x,this.box.size.y+this.size.y),t.stroke(),t.lineCap="butt",this.angle&&t.restore()},e});