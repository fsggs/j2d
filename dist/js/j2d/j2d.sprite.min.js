/**
 * J2D (jQuery plugin of the fork j2ds)
 *
 * @authors Skaner, likerRr, DeVinterX
 * @license BSD, zlib
 * @version 0.1.5
 * @see https://github.com/SkanerSoft/J2ds/commit/501b8993fc41960794572dc481a5f2fe492da349
 */

if (global === undefined) var global = window;
if (typeof define !== 'function' || define.amd) global.J2D = {};

!function(t,i){"function"==typeof define&&define.amd?define("j2d.sprite",["jquery.j2d","j2d.base","j2d.scene"],i):i(t.J2D,BaseNode,Scene)}(global,function(t,i,o){"use strict";o.prototype.addSpriteNode||(o.prototype.addSpriteNode=function(t,i,o){return new s(this.parent,t,i,o)});var s=function(t,o,s,e){i.call(this,t,o,s),this.nodeName="SpriteNode",this.mergeOptions({tmpSpeed:0,frame:0,animation:e,flip:{x:!1,y:!1}})};return s.prototype=Object.create(i.prototype),s.prototype.constructor=s,s.prototype.setFlip=function(t,i){this.options.flip={x:t,y:i}},s.prototype.draw=function(t){this.options.visible&&this.isLookScene()&&(t=t||1,this.options.frame>this.options.animation.frameCount&&(this.options.frame=0),this.drawFrame(this.options.frame+1),this.options.tmpSpeed>t?(this.options.frame+=1,this.options.tmpSpeed=0):this.options.tmpSpeed+=1)},s.prototype.drawFrame=function(t){var i=this.layer.context;if(this.options.visible&&this.isLookScene()){if(1!=this.options.alpha){var o=i.globalAlpha;i.globalAlpha=this.options.alpha}i.lineWidth=0,(this.options.angle||this.options.flip.x||this.options.flip.y)&&(i.save(),i.translate(this.getPosition().x-this.j2d.scene.viewport.x,this.getPosition().y-this.j2d.scene.viewport.y),i.rotate(this.j2d.math.rad(this.options.angle)),i.scale(this.options.flip.x?-1:1,this.options.flip.y?-1:1),i.translate(-(this.getPosition().x-this.j2d.scene.viewport.x),-(this.getPosition().y-this.j2d.scene.viewport.y))),t=t?t-1:0,i.drawImage(this.options.animation.imageMap.img,this.options.animation.sourceX+this.options.animation.sourceW*t,this.options.animation.sourceY,this.options.animation.sourceW,this.options.animation.sourceH,this.options.position.x-this.j2d.scene.viewport.x,this.options.position.y-this.j2d.scene.viewport.y,this.options.size.x,this.options.size.y),(this.options.angle||this.options.flip.x||this.options.flip.y)&&i.restore(),1!=this.options.alpha&&(i.globalAlpha=o)}},s.prototype.setAnimation=function(t){this.options.animation!=t&&(this.options.animation=t)},void 0!==global.J2D&&(global.SpriteNode=s),s});
//# sourceMappingURL=j2d.sprite.min.map
