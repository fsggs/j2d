{"version":3,"sources":["transitions/utils/Interpolation.es6","transitions/utils/Easing.es6","utils/MathUtil.es6","utils/ObjectUtil.es6","nodes/_deprecated/_deprecated_RectNode.es6","nodes/_deprecated/_deprecated_CameraNode.es6","utils/Vector2d.es6","utils/UUID.es6","nodes/_deprecated/_deprecated_BaseNode.es6","nodes/BaseNode.es6","nodes/_deprecated/_deprecated_AnimatedNode.es6","nodes/primitive2D/Sprite.es6","nodes/primitive2D/Rectangle.es6","io/devices/Touch.es6","io/devices/Pointer.es6","io/devices/Mouse.es6","io/devices/Keyboard.es6","io/devices/Joystick.es6","api/interfaces/IInputHandler.es6","api/interfaces/IHandler.es6","api/interfaces/IEngine.es6","transitions/_deprecated_Tween.es6","utils/_deprecated_Events.es6","utils/_deprecated_ArrayMap.es6","stores/BaseStore.es6","states/_deprecated_DefaultGameState.es6","states/_deprecated_BaseGameState.es6","objects/Immutable.es6","nodes/GroupNode.es6","nodes/CameraNode.es6","media/_deprecated_Video.es6","media/_deprecated_Sound.es6","media/_deprecated_Audio.es6","loaders/_deprecated_AssetsLoader.es6","layers/Layer.es6","io/_deprecated_MediaManager.es6","io/_deprecated_InputManager.es6","io/InputHandlerCodes.es6","exceptions/UnexpectedValueException.es6","exceptions/RuntimeException.es6","exceptions/RangeException.es6","exceptions/OutOfRangeException.es6","exceptions/OutOfBoundsException.es6","exceptions/LogicException.es6","exceptions/LengthException.es6","exceptions/Exception.es6","exceptions/BadMethodCallException.es6","exceptions/BadFunctionCallException.es6","core/_deprecated_ViewportManager.es6","core/_deprecated_SceneManager.es6","core/_deprecated_LayersManager.es6","core/_deprecated_GameStatesManager.es6","api/PrototypeObject.es6","api/PrototypeInterface.es6","api/Handler.es6","api/EngineComponent.es6","api/Device.es6","objects/Mutable.es6","core/ViewportHandler.es6","layers/LayersHandler.es6","utils/SystemConsole.es6","utils/Device.es6","core/SceneHandler.es6","core/FrameHandler.es6","io/InputHandler.es6","events/EventHandler.es6","exceptions/InvalidArgumentException.es6","api/interfaces/IEngineComponent.es6","api/Engine.es6","j2d.es6"],"names":["InterpolationEnum","Interpolation","Linear","v","k","m","length","f","i","Math","floor","fn","Utils","Bezier","b","n","pw","pow","bn","Bernstein","CatmullRom","p0","p1","t","fc","Factorial","a","s","p2","p3","v0","v1","t2","t3","get","interpolation","undefined","register","interpolationFunction","linear","bezier","catmull-rom","EasingEnum","Easing","None","Quadratic","In","Out","InOut","Cubic","Quartic","Quintic","Sinusoidal","cos","PI","sin","Exponential","Circular","sqrt","Elastic","p","asin","Back","Bounce","_Tween2","default","easing","easingFunction","quadratic-in","quadratic-out","quadratic-in-out","cubic-in","cubic-out","cubic-in-out","quartic-in","quartic-out","quartic-in-out","quintic-in","quintic-out","quintic-in-out","sinusoidal-in","sinusoidal-out","sinusoidal-in-out","exponential-in","exponential-out","exponential-in-out","circular-in","circular-out","circular-in-out","elastic-in","elastic-out","elastic-in-out","back-in","back-out","back-in-out","bounce-in","bounce-out","bounce-in-out","MathUtil","number","isFinite","min","max","opacity","random","vector4","parseInt","omitZero","degree","radian","ObjectUtil","args","Array","prototype","slice","call","arguments","deepness","splice","out","_typeof","Object","create","object","key","hasOwnProperty","extend","_deprecated_RectNode","data","_classCallCheck","this","_possibleConstructorReturn","__proto__","getPrototypeOf","_ObjectUtil2","RectNode","defaults","color","context","viewport","collection","visible","inViewport","tempOpacity","globalAlpha","angle","save","translate","getPosition","x","offset","y","rotate","_MathUtil2","degree2Radian","fillStyle","lineWidth","fillRect","position","size","scale","restore","draw","_deprecated_AnimatedNode","type","_deprecated_CameraNode","CameraNode","screen","calculate","Vector2d","array","vector1","vector2","getVector","atan2","UUID","replace","c","r","toString","_deprecated_BaseNode","BaseNode","id","_UUID2","generate","_Vector2d2","getSize","getOffset","value","enabledCache","cache","_this","_data","_Mutable2","device","toLowerCase","constructor","NodeName","name","isSpecial","AnimatedNode","duration","durationAsSpeed","tween","getDistance","to","start","getAngle","velocity","Sprite","gl","textureBuffer","createBuffer","bindBuffer","ARRAY_BUFFER","bufferData","Float32Array","STATIC_DRAW","_this2","texture","createTexture","bindTexture","TEXTURE_2D","texImage2D","RGBA","UNSIGNED_BYTE","Uint8Array","image","Image","src","addEventListener","texParameteri","TEXTURE_MAG_FILTER","LINEAR","TEXTURE_MIN_FILTER","LINEAR_MIPMAP_NEAREST","generateMipmap","scene","components","SceneHandler","_shaderProgram","render","startsWith","attributes","aPosition","getAttribLocation","aTexture","uTexture","getUniformLocation","uResolution","uPosition","uAngle","uScale","uCenter","positionBuffer","bindPositionBuffer","bindTextureBuffer","useProgram","enableVertexAttribArray","vertexAttribPointer","FLOAT","uniform2fv","canvas","clientWidth","clientHeight","uniform1f","center","uniform1i","drawArrays","TRIANGLES","_colorRGBA","_Rectangle3","VertexShader","Rectangle","width","height","defineProperty","enumerable","writable","vectorColorToRGBA","toCenter","cx","cy","uColor","uniform4fv","Touch","input","Error","IO","_Pointer3","Pointer","pointer","store","options","cursor","window","document","body","style","toggle","distance","Mouse","e","isEnabled","preventDefault","keyCode","KEYS_HELPER","getKeyById","__fixMouseButtonId","button","keys","keysDown","indexOf","push","recordMouseDragDistance","tracker","pageX","pageY","recordMouseClickTime","pressedTime","delta","startTime","timeStamp","events","trigger","keysUp","toFixed","wheelDelta","_get","setPointerImage","keyMouseDownEventHandler","keyMouseUpEventHandler","keyMouseMoveEventHandler","scrollMouseEventHandler","removeEventListener","Keyboard","recordKeyPressTime","keyDownEventHandler","keyUpEventHandler","Joystick","IInputHandler","IHandler","IEngine","tweens","Tween","tweenNode","node","_Events2","state","stateDefaults","properties","isStarted","stateData","_tweenStateData","tweenStateStack","time","nextState","currentStateAnimation","currentState","previousStatesTime","getStateTimeDuration","elapsed","import","util","animateTween","_Easing2","chainedTweensStack","result","forEach","withPrevious","tweenStateTimings","startState","index","parsedTweenStateStack","nextStateDelay","nextAllStateDelay","concat","reverseProperties","stateStack","stackLength","j","sIndex","delay","shift","calculateProperties","global","performance","now","isAnimated","cleanProperties","_calculateStackState","_calculateStackStateTimings","delayTime","add","stopChainedTweens","remove","stop","count","event","callback","on","off","once","flush","update","defaultDuration","property","temp","isNaN","Number","parseFloat","startProperties","endProperties","Events","eventName","onces","stack","ArrayMap","l","equals","contains","BaseStore","_Immutable2","_isEnabled","_RuntimeException2","oldState","toJS","newState","DefaultGameState","gsm","timestamp","setTimeout","setNextState","bind","BaseGameState","loader","STATE_NOT_LOADED","STATE_INIT","STATE_LOAD","STATE_UPDATE","STATE_RENDER","STATE_UNLOAD","FREEZE_NODE_METHODS","FREEZE_NODE_ARRAY_METHODS","Immutable","_InvalidArgumentException2","ImmutableArray","assign","unFreeze","JSON","stringify","freeze","__$ImmutableOptions","isFrozen","oldObject","newObject","console","log","getOwnPropertyNames","String","_get2","_len","_key","apply","_get3","_len2","_key2","fill","_get4","_len3","_key3","_get5","_len4","_key4","pop","reduce","reduceRight","reverse","sort","unshift","GroupNode","guid","_nodes","isSpecialNode","instanceOf","_BaseNode3","has","isLostContext","Video","createMasterGain","audioContext","masterGain","createGain","createGainNode","gain","connect","destination","Sound","manager","audioNode","getAudioContext","AudioContext","webkitAudioContext","getMasterGain","buffer","_setupAudioNode","iOSAutoEnable","iOSEnable","media","load","sound","loadBuffer","soundNode","disconnect","sprite","loaded","_inactiveNode","pos","timerId","loop","soundId","round","Date","_nodeById","paused","_clearEndTimer","rate","onEndTimer","timer","loopStart","loopEnd","refreshBuffer","playStart","currentTime","volume","bufferSource","noteGrainOn","play","activeNode","noteOff","vol","z","pos3d","panner","setPosition","panningModel","model","readyState","createPanner","_drainPool","newNode","inactive","format","autoPlay","muted","url","loadSound","test","atob","split","dataView","charCodeAt","decodeAudioData","xhr","XMLHttpRequest","open","responseType","onload","response","onerror","gainNode","send","arraybuffer","error","createBufferSource","playbackRate","AudioNode","Audio","audio","code","preload","listener","ceil","extension","isSupportAudio","warn","extractFormat","source","exec","isSupportCodec","_load","nodes","_unload","clearTimeout","audios","navigator","isCocoonJS","playSprite","pause","_activeNode","_pause","_stop","mute","_mute","unMute","_unMute","_volume","_position","zsaz","_pos3d","listenerEvent","AssetsLoader","progress","LAYER_PREFIX","Layer","_isGlobal","find","_registry","_BaseNode2","html5Audio","MediaManager","j2d","_ArrayMap2","iOSEnabled","codecs","mp3","canPlayType","opus","ogg","wav","aac","m4a","mp4","weba","fileExtension","sounds","webAudio","userAgent","unlock","noteOn","playbackState","PLAYING_STATE","FINISHED_STATE","getKey","filter","checkKeyMap","enableCallback","which","keyMap","$","isArray","eval","keysPressed","onMouseClick","enabled","isPlay","element","hasClass","DEPRECATED_InputManager","mouse","inArray","enableAdditionalData","startPosition","timePressed","preventAll","previousDistance","onMouseWheel","originalEvent","fixMouseWheel","mouseWheelCancel","onMouseMove","currentPosition","onKeyboardPress","writeMode","char","fromCharCode","focus","onTouchTap","touch","touches","changedTouches","onTouchMove","bindEvents","selector","unbindEvents","getPressData","keyList","FULLSCREEN","KEY_CTRL","KEY_F11","j2dPlugin","pluginInit","dX","offsetWidth","dY","offsetHeight","left","top","keyPressed","SCROLL_MOUSE_UP","SCROLL_MOUSE_DOWN","newKeyMap","oldKeyMap","parse","mapObject","current","previous","checkPressedKeyList","mode","css","enable","KEY_MOUSE_LEFT","KEY_MOUSE_MIDDLE","KEY_MOUSE_RIGHT","KEY_BACKSPACE","KEY_TAB","KEY_ENTER","KEY_SHIFT","KEY_ALT","KEY_PAUSE","KEY_BREAK","KEY_CAPS_LOCK","KEY_ESCAPE","KEY_SPACE_BAR","KEY_PAGE_UP","KEY_PAGE_DOWN","KEY_END","KEY_HOME","KEY_LEFT_ARROW","KEY_UP_ARROW","KEY_RIGHT_ARROW","KEY_DOWN_ARROW","KEY_INSERT","KEY_DELETE","KEY_0","KEY_1","KEY_2","KEY_3","KEY_4","KEY_5","KEY_6","KEY_7","KEY_8","KEY_9","KEY_A","KEY_B","KEY_C","KEY_D","KEY_E","KEY_F","KEY_G","KEY_H","KEY_I","KEY_J","KEY_K","KEY_L","KEY_M","KEY_N","KEY_O","KEY_P","KEY_Q","KEY_R","KEY_S","KEY_T","KEY_U","KEY_V","KEY_W","KEY_X","KEY_Y","KEY_Z","KEY_LEFT_WINDOW_KEY","KEY_RIGHT_WINDOW_KEY","KEY_SELECT_KEY","KEY_NUMPAD_0","KEY_NUMPAD_1","KEY_NUMPAD_2","KEY_NUMPAD_3","KEY_NUMPAD_4","KEY_NUMPAD_5","KEY_NUMPAD_6","KEY_NUMPAD_7","KEY_NUMPAD_8","KEY_NUMPAD_9","KEY_MULTIPLY","KEY_ADD","KEY_SUBTRACT","KEY_DECIMAL_POINT","KEY_DIVIDE","KEY_F1","KEY_F2","KEY_F3","KEY_F4","KEY_F5","KEY_F6","KEY_F7","KEY_F8","KEY_F9","KEY_F10","KEY_F12","KEY_NUM_LOCK","KEY_SCROLL_LOCK","KEY_SEMI_COLON","KEY_EQUAL_SIGN","KEY_COMMA","KEY_DASH","KEY_PERIOD","KEY_FORWARD_SLASH","KEY_GRAVE_ACCENT","KEY_OPEN_BRACKET","KEY_BACK_SLASH","KEY_CLOSE_BRACKET","KEY_SINGLE_QUOTE","KEY_LEFT_COMMAND","KEY_RIGHT_COMMAND","KEY_MOUSE_3","KEY_MOUSE_4","KEY_MOUSE_5","KEY_MOUSE_6","KEY_MOUSE_7","KEY_MOUSE_8","KEY_MOUSE_9","KEY_MOUSE_10","UnexpectedValueException","message","RuntimeException","RangeException","OutOfRangeException","OutOfBoundsException","LogicException","LengthException","Exception","BadMethodCallException","BadFunctionCallException","calculateScale","offsetX","offsetY","ViewportManager","cameras","camera","init","_CameraNode2","getCameraViewport","SceneManager","setGameCallback","frameManager","_FrameManager2","Init","layersManager","_LayersManager2","viewportManager","_ViewportManager2","gameStatesManager","_GameStatesManager2","initLayers","sceneManager","clear","fillBackground","originalWidth","originalHeight","originalMargin","getComputedStyle","initCanvas","setScreen","setDefaultViewport","getLayer","addLayer","querySelectorAll","createElement","zIndex","webGL","getContext","smoothing","disableSmoothing","shadowColor","backgroundColor","appendChild","clearRect","gameState","gameConstructor","patchGameStateRender","getState","newGameState","frameLimit","FrameHandler","getPreviousState","unload","io","getCurrent","fullscreen","getElementById","attr","requestFullscreen","webkitRequestFullscreen","webkitRequestFullScreen","mozRequestFullScreen","msRequestFullscreen","exitFullscreen","webkitExitFullscreen","webkitCancelFullScreen","mozCancelFullScreen","msExitFullscreen","resize","enableFullscreen","margin","setOffset","fullScreen","layers","getViewport","globalCollection","addCamera","setViewport","_updateNoCamerasViewport","updateViewport","display","enableFullScreen","LayersManager","_CollectionNode2","GameStatesManager","sceneCallback","_DefaultGameState2","states","previousState","PrototypeObject","interfaces","scope","_Device2","browser","version","implement","_PrototypeInterface2","PrototypeInterface","Handler","eventHandler","status","disable","_IHandler2","EngineComponent","_IEngineComponent2","Device","DeviceName","Mutable","__$MutableOptions","ViewportHandler","LayersHandler","_Layer2","_layers","SystemConsole","link","level","documentWidth","documentElement","documentHeight","_browser","getVersion","_version","innerWidth","innerHeight","match","appName","appVersion","vertex","fragment","onWebGLInit","engine","_engine","querySelector","nodeName","removeChild","right","bottom","_context","bindWebGLListeners","_element","toUpperCase","CULL_FACE","cullFace","FRONT","DEPTH_TEST","depthFunc","LEQUAL","BLEND","blendFunc","SRC_ALPHA","ONE_MINUS_SRC_ALPHA","onWebGLContextLost","onWebGLContextRestored","isContextLost","getExtension","loseContext","nodePrototype","FragmentShader","createProgram","_vertextShader","compileShader","createShader","VERTEX_SHADER","_fragmentShader","FRAGMENT_SHADER","attachShader","linkProgram","getProgramParameter","LINK_STATUS","info","clearColor","COLOR_BUFFER_BIT","DEPTH_BUFFER_BIT","handler","shader","shaderSource","getShaderParameter","COMPILE_STATUS","getShaderInfoLog","chrome","imageSmoothingEnabled","lastTime","deltaTime","interval","_frameLimit","_loop","_engineStack","_breakAnimationFrame","CancelAnimationFrame","RequestAnimationFrame","engineHandler","_timestamp","instance","requestAnimationFrame","webkitRequestAnimationFrame","mozRequestAnimationFrame","oRequestAnimationFrame","msRequestAnimationFrame","MAX_SAFE_INTEGER","cancelAnimationFrame","webkitCancelAnimationFrame","mozCancelAnimationFrame","oCancelAnimationFrame","msCancelAnimationFrame","InputHandler","KEYBOARD","MOUSE","KEY","keyCodeMap","DEBUG_INFO","newKeyCodeMap","oldKeyCodeMap","_getPressData","defaultIO","bindListeners","unBindListeners","getKeyByCode","EventHandler","_events","_onces","InvalidArgumentException","IEngineComponent","Engine","_$classPreInitialize","_IEngine2","EngineJ2D","_SystemConsole2","_initialized","tryLoadComponents","frame","classList","resume","logger","COMPONENT","_EventHandler2","_InputHandler2","_SceneHandler2","_LayersHandler2","_ViewportHandler2","_FrameHandler2","MediaHandler","TweenHandler","selected","resumeEventListener","getAttribute","resumeBind","jQuery","inactiveNodes","hasAttribute","setAttribute","tabIndex","_Engine3","click","activeNodes","PluginInit","_jQuery","ready","check","alert","CustomEvent","params","bubbles","cancelable","detail","customEvent","createEvent","initCustomEvent","Event","initPlugin","fullScreenEventListener","isFullScreen","resizeToFullPage","CompatibilityCheck","logSystem","VERSION","webkitFullscreenElement","webkitCurrentFullScreenElement","mozFullScreenElement","fullscreenElement","msFullscreenElement","html","onResize","dispatchEvent"],"mappings":";;;;;;;kVAAA,IAAIA,GAAAA,OAQAC,GAIAC,OAAQ,SAAUC,EAAGC,GACjB,GAAIC,GAAIF,EAAEG,OAAS,EACfC,EAAIF,EAAID,EACRI,EAAIC,KAAKC,MAAMH,GACfI,EAAKV,EAAcW,MAAMV,MAE7B,OAAIE,GAAI,EAAUO,EAAGR,EAAE,GAAIA,EAAE,GAAII,GAC7BH,EAAI,EAAUO,EAAGR,EAAEE,GAAIF,EAAEE,EAAI,GAAIA,EAAIE,GAElCI,EAAGR,EAAEK,GAAIL,EAAEK,EAAI,EAAIH,EAAIA,EAAIG,EAAI,GAAID,EAAIC,IAMlDK,OAAQ,SAAUV,EAAGC,GAMjB,IAAK,GALDU,GAAI,EACJC,EAAIZ,EAAEG,OAAS,EACfU,EAAKP,KAAKQ,IACVC,EAAKjB,EAAcW,MAAMO,UAEpBX,EAAI,EAAGA,GAAKO,EAAGP,IACpBM,GAAKE,EAAG,EAAIZ,EAAGW,EAAIP,GAAKQ,EAAGZ,EAAGI,GAAKL,EAAEK,GAAKU,EAAGH,EAAGP,EAGpD,OAAOM,IAMXM,WAAY,SAAUjB,EAAGC,GACrB,GAAIC,GAAIF,EAAEG,OAAS,EACfC,EAAIF,EAAID,EACRI,EAAIC,KAAKC,MAAMH,GACfI,EAAKV,EAAcW,MAAMQ,UAE7B,OAAIjB,GAAE,KAAOA,EAAEE,IACPD,EAAI,IAAGI,EAAIC,KAAKC,MAAMH,EAAIF,GAAK,EAAID,KAEhCO,EAAGR,GAAGK,EAAI,EAAIH,GAAKA,GAAIF,EAAEK,GAAIL,GAAGK,EAAI,GAAKH,GAAIF,GAAGK,EAAI,GAAKH,GAAIE,EAAIC,IAEpEJ,EAAI,EAAUD,EAAE,IAAMQ,EAAGR,EAAE,GAAIA,EAAE,GAAIA,EAAE,GAAIA,EAAE,IAAKI,GAAKJ,EAAE,IACzDC,EAAI,EAAUD,EAAEE,IAAMM,EAAGR,EAAEE,GAAIF,EAAEE,GAAIF,EAAEE,EAAI,GAAIF,EAAEE,EAAI,GAAIE,EAAIF,GAAKF,EAAEE,IAEjEM,EAAGR,EAAEK,EAAIA,EAAI,EAAI,GAAIL,EAAEK,GAAIL,EAAEE,EAAIG,EAAI,EAAIH,EAAIG,EAAI,GAAIL,EAAEE,EAAIG,EAAI,EAAIH,EAAIG,EAAI,GAAID,EAAIC,IAIlGI,OAIIV,OAAQ,SAAUmB,EAAIC,EAAIC,GACtB,OAAQD,EAAKD,GAAME,EAAIF,GAM3BF,UAAW,SAAUJ,EAAGP,GACpB,GAAIgB,GAAKvB,EAAcW,MAAMa,SAC7B,OAAOD,GAAGT,GAAKS,EAAGhB,GAAKgB,EAAGT,EAAIP,IAGlCiB,UAAY,WACR,GAAIC,IAAK,EACT,OAAO,UAAUX,GACb,GAAIY,GAAI,CACR,IAAID,EAAEX,GAAI,MAAOW,GAAEX,EAEnB,KAAK,GAAIP,GAAIO,EAAGP,EAAI,EAAGA,IACnBmB,GAAKnB,CAIT,OAFAkB,GAAEX,GAAKY,EAEAA,MAOfP,WAAY,SAAUC,EAAIC,EAAIM,EAAIC,EAAIN,GAClC,GAAIO,GAAiB,IAAXF,EAAKP,GACXU,EAAiB,IAAXF,EAAKP,GACXU,EAAKT,EAAIA,EACTU,EAAKV,EAAIS,CAEb,QAAQ,EAAIV,EAAK,EAAIM,EAAKE,EAAKC,GAAME,IAAM,EAAKX,EAAK,EAAIM,EAAK,EAAIE,EAAKC,GAAMC,EAAKF,EAAKP,EAAID,IAInGY,IAAK,SAACC,GACF,GAAyCC,SAArCpC,EAAkBmC,GAClB,MAAOnC,GAAkBmC,IAOjCE,SAAU,SAACF,EAAeG,GACtBtC,EAAkBmC,GAAiBG,GAI3CtC,IACIuC,OAAUtC,EAAcC,OACxBsC,OAAUvC,EAAcY,OACxB4B,cAAexC,EAAcmB,sBAGlBnB,geC3HXyC,EAAAA,OAQAC,GACAzC,QAII0C,KAAM,SAAUxC,GACZ,MAAOA,KAGfyC,WAIIC,GAAI,SAAU1C,GACV,MAAOA,GAAIA,GAMf2C,IAAK,SAAU3C,GACX,MAAOA,IAAK,EAAIA,IAMpB4C,MAAO,SAAU5C,GACb,OAAKA,GAAK,GAAK,EAAU,GAAMA,EAAIA,GAC5B,MAAUA,GAAKA,EAAI,GAAK,KAIvC6C,OAIIH,GAAI,SAAU1C,GACV,MAAOA,GAAIA,EAAIA,GAMnB2C,IAAK,SAAU3C,GACX,QAASA,EAAIA,EAAIA,EAAI,GAMzB4C,MAAO,SAAU5C,GACb,OAAKA,GAAK,GAAK,EAAU,GAAMA,EAAIA,EAAIA,EAChC,KAAQA,GAAK,GAAKA,EAAIA,EAAI,KAIzC8C,SAIIJ,GAAI,SAAU1C,GACV,MAAOA,GAAIA,EAAIA,EAAIA,GAMvB2C,IAAK,SAAU3C,GACX,MAAO,MAAOA,EAAIA,EAAIA,EAAIA,GAM9B4C,MAAO,SAAU5C,GACb,OAAKA,GAAK,GAAK,EAAW,GAAMA,EAAIA,EAAIA,EAAIA,GACrC,KAASA,GAAK,GAAKA,EAAIA,EAAIA,EAAI,KAI9C+C,SAIIL,GAAI,SAAU1C,GACV,MAAOA,GAAIA,EAAIA,EAAIA,EAAIA,GAM3B2C,IAAK,SAAU3C,GACX,QAASA,EAAIA,EAAIA,EAAIA,EAAIA,EAAI,GAMjC4C,MAAO,SAAU5C,GACb,OAAKA,GAAK,GAAK,EAAU,GAAMA,EAAIA,EAAIA,EAAIA,EAAIA,EACxC,KAAQA,GAAK,GAAKA,EAAIA,EAAIA,EAAIA,EAAI,KAKjDgD,YAIIN,GAAI,SAAU1C,GACV,MAAO,GAAIK,KAAK4C,IAAIjD,EAAIK,KAAK6C,GAAK,IAMtCP,IAAK,SAAU3C,GACX,MAAOK,MAAK8C,IAAInD,EAAIK,KAAK6C,GAAK,IAMlCN,MAAO,SAAU5C,GACb,MAAO,IAAO,EAAIK,KAAK4C,IAAI5C,KAAK6C,GAAKlD,MAI7CoD,aAIIV,GAAI,SAAU1C,GACV,MAAa,KAANA,EAAU,EAAIK,KAAKQ,IAAI,KAAMb,EAAI,IAM5C2C,IAAK,SAAU3C,GACX,MAAa,KAANA,EAAU,EAAI,EAAIK,KAAKQ,IAAI,GAAG,GAAMb,IAM/C4C,MAAO,SAAU5C,GACb,MAAU,KAANA,EAAgB,EACV,IAANA,EAAgB,GACfA,GAAK,GAAK,EAAU,GAAMK,KAAKQ,IAAI,KAAMb,EAAI,GAE3C,KAAQK,KAAKQ,IAAI,GAAG,IAAOb,EAAI,IAAM,KAIpDqD,UAIIX,GAAI,SAAU1C,GACV,MAAO,GAAIK,KAAKiD,KAAK,EAAItD,EAAIA,IAMjC2C,IAAK,SAAU3C,GACX,MAAOK,MAAKiD,KAAK,KAAOtD,EAAIA,IAMhC4C,MAAO,SAAU5C,GACb,OAAKA,GAAK,GAAK,GAAU,IAAQK,KAAKiD,KAAK,EAAItD,EAAIA,GAAK,GACjD,IAAOK,KAAKiD,KAAK,GAAKtD,GAAK,GAAKA,GAAK,KAIpDuD,SAIIb,GAAI,SAAU1C,GACV,GAAIuB,GACAD,EAAI,GACJkC,EAAI,EAER,OAAU,KAANxD,EAAgB,EACV,IAANA,EAAgB,IAEfsB,GAAKA,EAAI,GACVA,EAAI,EACJC,EAAIiC,EAAI,GAERjC,EAAIiC,EAAInD,KAAKoD,KAAK,EAAInC,IAAM,EAAIjB,KAAK6C,MAGhC5B,EAAIjB,KAAKQ,IAAI,EAAG,IAAMb,GAAK,IAAMK,KAAK8C,KAAKnD,EAAIuB,IAAM,EAAIlB,KAAK6C,IAAMM,MAMjFb,IAAK,SAAU3C,GACX,GAAIuB,GACAD,EAAI,GACJkC,EAAI,EAER,OAAU,KAANxD,EAAgB,EACV,IAANA,EAAgB,IAEfsB,GAAKA,EAAI,GACVA,EAAI,EACJC,EAAIiC,EAAI,GAERjC,EAAIiC,EAAInD,KAAKoD,KAAK,EAAInC,IAAM,EAAIjB,KAAK6C,IAGjC5B,EAAIjB,KAAKQ,IAAI,GAAG,GAAMb,GAAKK,KAAK8C,KAAKnD,EAAIuB,IAAM,EAAIlB,KAAK6C,IAAMM,GAAK,IAM/EZ,MAAO,SAAU5C,GAEb,GAAIuB,GACAD,EAAI,GACJkC,EAAI,EAER,OAAU,KAANxD,EAAgB,EACV,IAANA,EAAgB,IAEfsB,GAAKA,EAAI,GACVA,EAAI,EACJC,EAAIiC,EAAI,GAERjC,EAAIiC,EAAInD,KAAKoD,KAAK,EAAInC,IAAM,EAAIjB,KAAK6C,KAGpClD,GAAK,GAAK,GACJ,IAAQsB,EAAIjB,KAAKQ,IAAI,EAAG,IAAMb,GAAK,IAAMK,KAAK8C,KAAKnD,EAAIuB,IAAM,EAAIlB,KAAK6C,IAAMM,IAGhFlC,EAAIjB,KAAKQ,IAAI,GAAG,IAAOb,GAAK,IAAMK,KAAK8C,KAAKnD,EAAIuB,IAAM,EAAIlB,KAAK6C,IAAMM,GAAK,GAAM,KAM/FE,MAIIhB,GAAI,SAAU1C,GACV,GAAIuB,GAAI,OAER,OAAOvB,GAAIA,IAAMuB,EAAI,GAAKvB,EAAIuB,IAMlCoB,IAAK,SAAU3C,GACX,GAAIuB,GAAI,OAER,SAASvB,EAAIA,IAAMuB,EAAI,GAAKvB,EAAIuB,GAAK,GAMzCqB,MAAO,SAAU5C,GACb,GAAIuB,GAAI,SACR,QAAKvB,GAAK,GAAK,EAAU,IAAOA,EAAIA,IAAMuB,EAAI,GAAKvB,EAAIuB,IAEhD,KAAQvB,GAAK,GAAKA,IAAMuB,EAAI,GAAKvB,EAAIuB,GAAK,KAIzDoC,QAIIjB,GAAI,SAAU1C,GACV,MAAO,GAAI4D,EAAAC,QAAMtB,OAAOoB,OAAOhB,IAAI,EAAI3C,IAM3C2C,IAAK,SAAU3C,GACX,MAAIA,GAAK,EAAI,KACF,OAASA,EAAIA,EACbA,EAAK,EAAI,KACT,QAAUA,GAAM,IAAM,MAASA,EAAI,IACnCA,EAAK,IAAM,KACX,QAAUA,GAAM,KAAO,MAASA,EAAI,MAEpC,QAAUA,GAAM,MAAQ,MAASA,EAAI,SAOpD4C,MAAO,SAAU5C,GACb,MAAIA,GAAI,GAA4C,GAAhC4D,EAAAC,QAAMtB,OAAOoB,OAAOjB,GAAO,EAAJ1C,GACC,GAArC4D,EAAAC,QAAMtB,OAAOoB,OAAOhB,IAAQ,EAAJ3C,EAAQ,GAAW,KAI1D8B,IAAK,SAACgC,GACF,GAA2B9B,SAAvBM,EAAWwB,GACX,MAAOxB,GAAWwB,IAM1B7B,SAAU,SAAC6B,EAAQC,GACfzB,EAAWwB,GAAUC,GAI7BzB,IACIH,OAAUI,EAAOzC,OAAO0C,KAExBwB,eAAgBzB,EAAOE,UAAUC,GACjCuB,gBAAiB1B,EAAOE,UAAUE,IAClCuB,mBAAoB3B,EAAOE,UAAUG,MAErCuB,WAAY5B,EAAOM,MAAMH,GACzB0B,YAAa7B,EAAOM,MAAMF,IAC1B0B,eAAgB9B,EAAOM,MAAMD,MAE7B0B,aAAc/B,EAAOO,QAAQJ,GAC7B6B,cAAehC,EAAOO,QAAQH,IAC9B6B,iBAAkBjC,EAAOO,QAAQF,MAEjC6B,aAAclC,EAAOQ,QAAQL,GAC7BgC,cAAenC,EAAOQ,QAAQJ,IAC9BgC,iBAAkBpC,EAAOQ,QAAQH,MAEjCgC,gBAAiBrC,EAAOS,WAAWN,GACnCmC,iBAAkBtC,EAAOS,WAAWL,IACpCmC,oBAAqBvC,EAAOS,WAAWJ,MAEvCmC,iBAAkBxC,EAAOa,YAAYV,GACrCsC,kBAAmBzC,EAAOa,YAAYT,IACtCsC,qBAAsB1C,EAAOa,YAAYR,MAEzCsC,cAAe3C,EAAOc,SAASX,GAC/ByC,eAAgB5C,EAAOc,SAASV,IAChCyC,kBAAmB7C,EAAOc,SAAST,MAEnCyC,aAAc9C,EAAOgB,QAAQb,GAC7B4C,cAAe/C,EAAOgB,QAAQZ,IAC9B4C,iBAAkBhD,EAAOgB,QAAQX,MAEjC4C,UAAWjD,EAAOmB,KAAKhB,GACvB+C,WAAYlD,EAAOmB,KAAKf,IACxB+C,cAAenD,EAAOmB,KAAKd,MAE3B+C,YAAapD,EAAOoB,OAAOjB,GAC3BkD,aAAcrD,EAAOoB,OAAOhB,IAC5BkD,gBAAiBtD,EAAOoB,OAAOf,iBAGpBL,itBCvXMuD,EAAAA,wFAKKC,GAClB,MAAOA,IAAU,oCAOJA,GACb,MAAyB,gBAAXA,IAAuBC,SAASD,IACvCA,GAAS,kBAAqBA,EAAS,kBACvC1F,KAAKC,MAAMyF,KAAYA,sCASfE,EAAKC,EAAKC,GACzB,MAAO,QACDL,EAASM,OAAOH,EAAKC,GAAO,KAC5BJ,EAASM,OAAOH,EAAKC,GAAO,KAC5BJ,EAASM,OAAOH,EAAKC,GAAO,KAC5BC,EAAU,8CAGKE,GACrB,MAAO,QACDC,SAASD,EAAQ,IAAM,EAAI,MAAQ,KACnCC,SAASD,EAAQ,IAAM,EAAI,MAAQ,KACnCC,SAASD,EAAQ,IAAM,EAAI,MAAQ,KACnCA,EAAQ,GAAK,qCASTJ,EAAKC,EAAKK,GACpB,GAAIH,GAAU/F,KAAKC,MAAMD,KAAK+F,UAAYF,EAAMD,EAAM,GAAKA,EAC3D,OAAQM,IAAuB,IAAXH,EACdN,EAASM,OAAOH,EAAKC,EAAKK,GAC1BH,wCAOWI,GACjB,MAAOA,IAAUnG,KAAK6C,GAAK,2CAOVuD,GACjB,MAAOA,IAAU,IAAMpG,KAAK6C,uBAnEf4C,i6BCAAY,EAAAA,kFAEb,GAAIC,GAAOC,MAAMC,UAAUC,MAAMC,KAAKC,WAClCC,GAAW,CACQ,kBAAZN,GAAK,KACZM,EAAWN,EAAK,GAChBA,EAAKO,OAAO,EAAG,GAUnB,KAAK,GAPDC,GAAMR,EAAK,IAAM,WACb,MAAgB3E,UAAZ2E,EAAK,IAAgC,OAAZA,EAAK,IAAkC,WAAnBS,EAAOT,EAAK,IAClDU,OAAOC,OAAOX,EAAK,UAK7BvG,EAAI,EAAGA,EAAIuG,EAAKzG,OAAQE,IAAK,CAClC,GAAImH,GAASZ,EAAKvG,EAElB,IAAKmH,EAEL,IAAK,GAAIC,KAAOD,GAERA,EAAOE,eAAeD,KACK,WAAvBJ,EAAOG,EAAOC,KAAqC,OAAhBD,EAAOC,GAC1CL,EAAIK,GAAOP,EAAWP,EAAWgB,OAAOT,EAAUE,EAAIK,GAAMD,EAAOC,IAAQD,EAAOC,GAElFL,EAAIK,GAAOD,EAAOC,IAMlC,MAAOL,sBAjCMT,s9CCOAiB,EAAAA,SAAAA,GAMjB,QAAAA,GAAYC,GAAM,MAAAC,GAAAC,KAAAH,GAAAI,EAAAD,MAAAH,EAAAK,WAAAX,OAAAY,eAAAN,IAAAZ,KAAAe,KACRI,EAAArE,QAAW6D,QAAO,KAAUS,SAASC,SAAUR,yDAOrD,MAAOE,MAAKF,KAAKS,uCAOZA,GAEL,MADAP,MAAKF,KAAKS,MAAQA,EACXP,kCAYNQ,EAASC,EAAUC,EAAYZ,GAChC,GAAIE,KAAKF,KAAKa,SAAWX,KAAKY,WAAWH,GAAW,CAEhD,GAA0B,IAAtBT,KAAKF,KAAKzB,QAAiB,CAC3B,GAAIwC,GAAcL,EAAQM,WAC1BN,GAAQM,YAAcd,KAAKF,KAAKzB,SAGhC2B,KAAKF,KAAKiB,OAA4B,IAAnBN,EAASM,SAC5BP,EAAQQ,OAERR,EAAQS,UACJjB,KAAKkB,cAAcC,EAAIV,EAASW,OAAOD,EACvCnB,KAAKkB,cAAcG,EAAIZ,EAASW,OAAOC,GAC3Cb,EAAQc,OAAOC,EAAAxF,QAASyF,cAAcxB,KAAKF,KAAKiB,MAAQN,EAASM,QACjEP,EAAQS,YACFjB,KAAKkB,cAAcC,EAAIV,EAASW,OAAOD,KACvCnB,KAAKkB,cAAcG,EAAIZ,EAASW,OAAOC,KAGjDb,EAAQiB,UAAYzB,KAAKF,KAAKS,MAC9BC,EAAQkB,UAAY,EAEpBlB,EAAQmB,SACJ3B,KAAKF,KAAK8B,SAAST,EAAIV,EAASW,OAAOD,EACvCnB,KAAKF,KAAK8B,SAASP,EAAIZ,EAASW,OAAOC,EACvCrB,KAAKF,KAAK+B,KAAKV,EAAInB,KAAKF,KAAKgC,MAAQrB,EAASqB,MAC9C9B,KAAKF,KAAK+B,KAAKR,EAAIrB,KAAKF,KAAKgC,MAAQrB,EAASqB,QAG9C9B,KAAKF,KAAKiB,OAA4B,IAAnBN,EAASM,QAC5BP,EAAQuB,UAGc,IAAtB/B,KAAKF,KAAKzB,UACVmC,EAAQM,YAAcD,GAG9B,MAAO,qCAcJL,EAASC,EAAUC,EAAYZ,GAElC,MADAE,MAAKgC,KAAKxB,EAASC,EAAUC,EAAYZ,GAClCE,YAzFmCiC,gDAA7BpC,EAAAA,6CAEbqC,KAAM,WACN3B,MAAO,uBAHMV,04CCDAsC,EAAAA,SAAAA,GAKjB,QAAAA,GAAYrC,GAAM,MAAAC,GAAAC,KAAAmC,GAAAlC,EAAAD,MAAAmC,EAAAjC,WAAAX,OAAAY,eAAAgC,IAAAlD,KAAAe,KACRI,EAAArE,QAAW6D,QAAO,KAAUwC,WAAW9B,SAAUR,gEAQzCuC,EAAQC,GACtB,MAAOA,GAAUD,GACbjB,OAAQpB,KAAKF,KAAK8B,SAClBC,KAAM7B,KAAKF,KAAK+B,KAChBd,MAAOf,KAAKF,KAAKiB,MACjBe,MAAO9B,KAAKF,KAAKgC,uCAelBtB,EAASC,EAAUC,EAAYZ,GAClC,MAAOE,aAnCqCiC,gDAA/BE,EAAAA,6CAEbD,KAAM,0BAFOC,itBCJAI,EAAAA,WACjB,QAAAA,GAAYpB,EAAGE,GAAGtB,EAAAC,KAAAuC,GACdvC,KAAKmB,EAAIA,EACTnB,KAAKqB,EAAIA,2CAOT,MAAOrB,MAAKmB,iCAOZ,MAAOnB,MAAKqB,sCAOZ,OAAQF,EAAGnB,KAAKmB,EAAGE,EAAGrB,KAAKqB,qCAO3B,OAAQrB,KAAKmB,EAAGnB,KAAKqB,qCAOfmB,GAIN,MAHAxC,MAAKmB,EAAIqB,EAAM,GACfxC,KAAKqB,EAAImB,EAAM,GAERxC,wCAOP,MAAO,IAAMA,KAAKmB,EAAI,IAAMnB,KAAKqB,EAAI,0CAQtBoB,EAASC,GACxB,MAAOnK,MAAKiD,KACRjD,KAAKQ,IAAI2J,EAAQC,YAAYxB,EAAIsB,EAAQE,YAAYxB,EAAG,GACxD5I,KAAKQ,IAAI2J,EAAQC,YAAYtB,EAAIoB,EAAQE,YAAYtB,EAAG,qCAShDoB,EAASC,GACrB,MAAOnK,MAAKqK,MACJF,EAAQC,YAAYtB,EAAIoB,EAAQE,YAAYtB,EAC5CqB,EAAQC,YAAYxB,EAAIsB,EAAQE,YAAYxB,IAC3C,IAAM5I,KAAK6C,uBAzEPmH,mdCAAM,GAAAA,QAAAA,sCAAAA,EAAAA,4CACC,WACd,MAAO,uCAAuCC,QAAQ,QAAS,SAAUC,GACrE,GAAIC,GAAoB,GAAhBzK,KAAK+F,SAAgB,EAAGrG,EAAS,KAAL8K,EAAWC,EAAS,EAAJA,EAAU,CAC9D,OAAO/K,GAAEgL,SAAS,mBAJTJ,4+BCMAK,EAAAA,WA4BjB,QAAAA,GAAYpD,GAAMC,EAAAC,KAAAkD,GACdlD,KAAKF,KAAOM,EAAArE,QAAW6D,QAAO,KAAUuD,SAAS7C,SAAUR,GAEtC,OAAjBE,KAAKF,KAAKsD,KACVpD,KAAKF,KAAKsD,GAAKC,EAAAtH,QAAKuH,mDA+CvBxD,GACDE,KAAKF,KAAOM,EAAArE,QAAW6D,QAAO,KAAUI,KAAKF,KAAMA,kCAOnD,MAAOE,MAAKF,2CAOZ,MAAO,IAAAyD,GAAAxH,QAAaiE,KAAKF,KAAK8B,SAAST,EAAGnB,KAAKF,KAAK8B,SAASP,uCAOrDO,GAQR,MAPiB1H,UAAb0H,IACIA,YAAAA,GAAAA,QACA5B,KAAKF,KAAK8B,SAAWA,EAASe,YACvBf,YAAoBuB,YAC3BnD,KAAKF,KAAK8B,SAAWA,EAASV,cAAcyB,cAG7C3C,uCAOP,MAAO,IAAAuD,GAAAxH,QAAaiE,KAAKF,KAAK+B,KAAKV,EAAGnB,KAAKF,KAAK+B,KAAKR,mCAOjDQ,GAQJ,MAPa3H,UAAT2H,IACIA,YAAAA,GAAAA,QACA7B,KAAKF,KAAK+B,KAAOA,EAAKc,YACfd,YAAgBsB,YACvBnD,KAAKF,KAAK+B,KAAOA,EAAK2B,UAAUb,cAGjC3C,yCAOP,MAAO,IAAAuD,GAAAxH,QAAaiE,KAAKF,KAAKsB,OAAOD,EAAGnB,KAAKF,KAAKsB,OAAOC,qCAOnDD,GAQN,MAPelH,UAAXkH,IACIA,YAAAA,GAAAA,QACApB,KAAKF,KAAKsB,OAASA,EAAOuB,YACnBvB,YAAkB+B,YACzBnD,KAAKF,KAAKsB,OAASA,EAAOqC,YAAYd,cAGvC3C,oCAiBJQ,EAASC,EAAUC,EAAYZ,GAElC,MAAOE,yCAQAS,GACP,QAAUT,KAAKF,KAAK8B,SAAST,EAAIV,EAASW,OAAOD,EAAIV,EAASoB,KAAKV,GAChEnB,KAAKF,KAAK8B,SAAST,EAAIV,EAASoB,KAAKV,EAAIV,EAASW,OAAOD,GACxDnB,KAAKF,KAAK8B,SAASP,EAAIZ,EAASW,OAAOC,EAAIZ,EAASoB,KAAKR,GAC1DrB,KAAKF,KAAK8B,SAASP,EAAIZ,EAASoB,KAAKR,EAAIZ,EAASW,OAAOC,mCAnJ5D,MAAOrB,MAAKF,KAAKzB,sBAGTqF,GACR1D,KAAKF,KAAKzB,QAAUqF,kCAIpB,MAAO1D,MAAKF,KAAKa,sBAGT+C,GACR1D,KAAKF,KAAKa,UAAY+C,gCAItB,MAAO1D,MAAKF,KAAKiB,oBAGX2C,GACN1D,KAAKF,KAAKiB,MAAQ2C,EAAQ,kCAI1B,MAAO1D,MAAKF,KAAKgC,oBAGX4B,GACN1D,KAAKF,KAAKgC,MAAQ4B,gCAIlB,MAAO1D,MAAKF,KAAK6D,2BAGXD,GACN1D,KAAKF,KAAK6D,eAAiBD,iCAzEdR,EAAAA,6CAGbE,GAAI,KACJlB,KAAM,WAENN,UACIT,EAAG,EACHE,EAAG,GAEPQ,MACIV,EAAG,EACHE,EAAG,GAEPD,QACID,EAAG,EACHE,EAAG,GAGPV,SAAS,EACTI,MAAO,EACPe,MAAO,EACPzD,QAAS,EAETuF,MAAO,KACPD,cAAc,eAzBDT,m8CCPAC,EAAAA,SAAAA,GAWjB,QAAAA,GAAYrD,GAAMC,EAAAC,KAAAmD,EAAA,IAAAU,GAAA5D,EAAAD,MAAAmD,EAAAjD,WAAAX,OAAAY,eAAAgD,IAAAlE,KAAAe,MAAA,OAEM,gBAATF,KAAmBA,GAAQsD,GAAItD,IAC1C+D,EAAKC,MAAQC,EAAAhI,QAAQ6D,QAAO,KAAUuD,EAAS7C,SAAUR,GACnC,OAAlB+D,EAAKC,MAAMV,KAAaS,EAAKC,MAAMV,GAAKC,EAAAtH,QAAKuH,YAJnCO,sDAgBd,MAAO,UAAUG,GACb,MAAQA,GAAO,GAAGC,cAAgBD,EAAOhF,MAAM,IACjDgB,KAAKkE,YAAYC,UAAYnE,KAAKkE,YAAYE,mCAVhD,MAAOpE,MAAK8D,MAAMV,yCAIlB,MAAOpD,MAAKkE,YAAYG,YAAa,0CAvBxBlB,EAAAA,4CACC,mCADDA,EAAAA,8CAEE,0BAFFA,EAAAA,6CAMbC,GAAI,kBANSD,guDCUAmB,EAAAA,SAAAA,GAKjB,QAAAA,GAAYxE,GAAM,MAAAC,GAAAC,KAAAsE,GAAArE,EAAAD,MAAAsE,EAAApE,WAAAX,OAAAY,eAAAmE,IAAArF,KAAAe,KACRI,EAAArE,QAAW6D,QAAO,KAAU0E,EAAahE,SAAUR,qDAQtD8B,EAAU2C,EAAUC,GAGvB,GAFiBtK,SAAbqK,GAA8C,gBAAbA,KAAuBA,EAAW,KAE/C,YAApB,mBAAO3C,GAAP,YAAAtC,EAAOsC,IAAuB,CAC9B,GAAI6C,GAAQ,GAAA3I,GAAAC,QAAUiE,KAElB4B,aAAAA,GAAAA,SACI4C,IAAiBD,EAAWhB,EAAAxH,QAAS2I,YAAY1E,KAAKkB,cAAeU,GAAY2C,GACrFE,EAAME,IACF/C,UACIT,EAAGS,EAASe,YAAYxB,EACxBE,EAAGO,EAASe,YAAYtB,IAE7BkD,IACI3C,YAAAA,GAAAA,UACH4C,IAAiBD,EAAWhB,EAAAxH,QAAS2I,YAAY1E,KAAKkB,cAAeU,EAASV,eAAiBqD,GACnGE,EAAME,IACF/C,UACIT,EAAGS,EAASV,cAAcyB,YAAYxB,EACtCE,EAAGO,EAASV,cAAcyB,YAAYtB,IAE3CkD,IAGPE,EAAMG,0CASL/C,EAAM0C,EAAUC,GAErB,GADiBtK,SAAbqK,GAA8C,gBAAbA,KAAuBA,EAAW,KAC/C,YAApB,mBAAO3C,UAAP,YAAAtC,EAAOsC,WAAuB,CAC9B,GAAI6C,GAAQ,GAAA3I,GAAAC,QAAUiE,KAElB6B,aAAAA,GAAAA,SACI2C,IAAiBD,EAAWhB,EAAAxH,QAAS2I,YAAY1E,KAAKwD,UAAW3B,GAAQ0C,GAC7EE,EAAME,IACF9C,MACIV,EAAGU,EAAKc,YAAYxB,EACpBE,EAAGQ,EAAKc,YAAYtB,IAEzBkD,IACI1C,YAAAA,GAAAA,UACH2C,IAAiBD,EAAWhB,EAAAxH,QAAS2I,YAAY1E,KAAKwD,UAAW3B,EAAK2B,WAAae,GACvFE,EAAME,IACF9C,MACIV,EAAGU,EAAK2B,UAAUb,YAAYxB,EAC9BE,EAAGQ,EAAK2B,UAAUb,YAAYtB,IAEnCkD,IAGPE,EAAMG,0CAQL7D,EAAOwD,GACKrK,SAAbqK,GAA8C,gBAAbA,KAAuBA,EAAW,IACvE,IAAIE,GAAQ,GAAA3I,GAAAC,QAAUiE,KAED,iBAAVe,GACP0D,EAAME,IAAI5D,MAAOA,EAAQ,KAAMwD,GACP,YAAjB,mBAAOxD,GAAP,YAAAzB,EAAOyB,KAAsBA,YAAAA,GAAAA,SACpC0D,EAAME,IACF5D,MAAOwC,EAAAxH,QAAS8I,SAAS9D,EAAMG,cAAelB,KAAKkB,gBACpDqD,GAGPE,EAAMG,qCAMLE,GACgB5K,SAAb4K,GAA8C,gBAAbA,KAAuBA,EAAW,GACvE9E,KAAKe,OAAS+D,0CAlGDR,EAAAA,6CAEbpC,KAAM,4BAFOoC,05CCTAS,EAAAA,SAAAA,+QACD,0EACN,6EAEQC,GACdhF,KAAKiF,cAAgBD,EAAGE,eACxBF,EAAGG,WAAWH,EAAGI,aAAcpF,KAAKiF,eAEpCD,EAAGK,WAAWL,EAAGI,aAAc,GAAIE,eAC/B,EAAK,EACL,EAAK,EACL,EAAK,EACL,EAAK,EACL,EAAK,EACL,EAAK,IACLN,EAAGO,iDAGCP,GAAI,GAAAQ,GAAAxF,IACZA,MAAKyF,QAAUT,EAAGU,gBAClBV,EAAGW,YAAYX,EAAGY,WAAY5F,KAAKyF,SACnCT,EAAGa,WAAWb,EAAGY,WAAY,EAAGZ,EAAGc,KAAM,EAAG,EAAG,EAAGd,EAAGc,KAAMd,EAAGe,cAAe,GAAIC,aAAY,EAAG,EAAG,EAAG,IAEtG,IAAIC,GAAQ,GAAIC,MAChBD,GAAME,IAAM,eACZF,EAAMG,iBAAiB,OAAQ,WAC3BpB,EAAGW,YAAYX,EAAGY,WAAYJ,EAAKC,SACnCT,EAAGa,WAAWb,EAAGY,WAAY,EAAGZ,EAAGc,KAAMd,EAAGc,KAAKd,EAAGe,cAAeE,GACnEjB,EAAGqB,cAAcrB,EAAGY,WAAYZ,EAAGsB,mBAAoBtB,EAAGuB,QAC1DvB,EAAGqB,cAAcrB,EAAGY,WAAYZ,EAAGwB,mBAAoBxB,EAAGyB,uBAC1DzB,EAAG0B,eAAe1B,EAAGY,YACrBZ,EAAGW,YAAYX,EAAGY,WAAY,qCAIjCpF,EAASC,EAAUX,GACpB,GAAIkF,GAAKxE,EAASmG,EAAQ7G,EAAK8G,WAAWC,YAE1C,IAAI9B,EAAO+B,gBAAkBH,EAAM7C,MAAMiD,OAAOC,WAAW,SAAU,CAGjE,GAAIC,IACAC,UAAWlC,EAAGmC,kBAAkBpC,EAAO+B,eAAgB,aACvDM,SAAUpC,EAAGmC,kBAAkBpC,EAAO+B,eAAgB,YACtDO,SAAUrC,EAAGsC,mBAAmBvC,EAAO+B,eAAgB,YACvDS,YAAavC,EAAGsC,mBAAmBvC,EAAO+B,eAAgB,eAC1DU,UAAWxC,EAAGsC,mBAAmBvC,EAAO+B,eAAgB,aACxDW,OAAQzC,EAAGsC,mBAAmBvC,EAAO+B,eAAgB,UACrDY,OAAQ1C,EAAGsC,mBAAmBvC,EAAO+B,eAAgB,UACrDa,QAAS3C,EAAGsC,mBAAmBvC,EAAO+B,eAAgB,WAG9B,QAAxB9G,KAAK4H,gBAAyB5H,KAAK6H,mBAAmB7C,GAC/B,OAAvBhF,KAAKiF,eAAwBjF,KAAK8H,kBAAkB9C,GACnC,OAAjBhF,KAAKyF,SAAkBzF,KAAK2F,YAAYX,GAE5CA,EAAG+C,WAAWhD,EAAO+B,gBAErB9B,EAAGW,YAAYX,EAAGY,WAAY5F,KAAKyF,SAEnCT,EAAGgD,wBAAwBf,EAAWC,WACtClC,EAAGG,WAAWH,EAAGI,aAAcpF,KAAK4H,gBACpC5C,EAAGiD,oBAAoBhB,EAAWC,UAAW,EAAGlC,EAAGkD,OAAO,EAAO,EAAG,GAEpElD,EAAGgD,wBAAwBf,EAAWG,UACtCpC,EAAGG,WAAWH,EAAGI,aAAcpF,KAAKiF,eACpCD,EAAGiD,oBAAoBhB,EAAWG,SAAU,EAAGpC,EAAGkD,OAAO,EAAO,EAAG,GAEnElD,EAAGmD,WAAWlB,EAAWM,YAAa,GAAIjC,eAAcN,EAAGoD,OAAOC,YAAarD,EAAGoD,OAAOE,gBACzFtD,EAAGmD,WAAWlB,EAAWO,UAAW,GAAIlC,cAAatF,KAAK8D,MAAMlC,WAChEoD,EAAGuD,UAAUtB,EAAWQ,OAAQzH,KAAK8D,MAAM/C,OAC3CiE,EAAGmD,WAAWlB,EAAWS,OAAQ,GAAIpC,cAAatF,KAAK8D,MAAMhC,QAC7DkD,EAAGmD,WAAWlB,EAAWU,QAAS,GAAIrC,cAAatF,KAAK8D,MAAM0E,SAE9DxD,EAAGyD,UAAUxB,EAAWI,SAAU,GAElCrC,EAAG0D,WAAW1D,EAAG2D,UAAW,EAAG,OAC5B,CAEH,GAAI9H,GAAc,CAES,KAAvBb,KAAK8D,MAAMzF,UACXwC,EAAcL,EAAQM,YACtBN,EAAQM,YAAcd,KAAK8D,MAAMzF,SAGjC2B,KAAK8D,MAAM/C,QACXP,EAAQQ,OAERR,EAAQS,UAAUjB,KAAK8D,MAAMlC,SAAS,GAAI5B,KAAK8D,MAAMlC,SAAS,IAC9DpB,EAAQc,OAAOtB,KAAK8D,MAAM/C,OAC1BP,EAAQS,WAAYjB,KAAK8D,MAAMlC,SAAS,IAAO5B,KAAK8D,MAAMlC,SAAS,KAGvEpB,EAAQiB,UAAYzB,KAAK4I,WACzBpI,EAAQkB,UAAY,EAEpBlB,EAAQmB,SACJ3B,KAAK8D,MAAMlC,SAAS,GAAK5B,KAAK8D,MAAMjC,KAAK,GAAK,EAC9C7B,KAAK8D,MAAMlC,SAAS,GAAK5B,KAAK8D,MAAMjC,KAAK,GAAK,EAC9C7B,KAAK8D,MAAMjC,KAAK,GAAK7B,KAAK8D,MAAMhC,MAAM,GACtC9B,KAAK8D,MAAMjC,KAAK,GAAK7B,KAAK8D,MAAMhC,MAAM,IAGtC9B,KAAK8D,MAAM/C,OACXP,EAAQuB,UAGe,IAAvB/B,KAAK8D,MAAMzF,UACXmC,EAAQM,YAAcD,4CA7GjBkE,EAAAA,kDAkHO,6BAlHPA,EAAAA,mDAmHQ,6BAnHRA,EAAAA,kDAoHO,6BApHPA,EAAAA,gDAsHK8D,EAAA9M,QAAU+M,qCAtHf/D,EAAAA,sRAAAA,k8CCCAgE,EAAAA,SAAAA,GAGjB,QAAAA,GAAY5H,EAAGE,EAAG2H,EAAOC,GAAQlJ,EAAAC,KAAA+I,EAAA,IAAAlF,GAAA5D,EAAAD,MAAA+I,EAAA7I,WAAAX,OAAAY,eAAA4I,IAAA9J,KAAAe,MAEzB4B,UAAWT,GAAK,EAAKE,GAAK,GAC1BQ,MAAOmH,GAAS,EAAKC,GAAU,GAC/BlI,MAAOQ,EAAAxF,QAASyF,cAAc,IAC9BM,OAAQ,EAAK,GACb0G,QAAS,EAAK,GACdjI,OAAQhI,KAAK+F,SAAU/F,KAAK+F,SAAU/F,KAAK+F,SAAU,GACrDD,QAAS,IARgB,OAAAkB,QAAA2J,eAAArF,EAAA,kBAAAsF,YAAA,EAAAC,UAAA,EAAA1F,MAFhB,OAabG,EAAK+E,WAAarH,EAAAxF,QAASsN,kBAAkBxF,EAAKC,MAAMvD,OAExDsD,EAAKyF,WAbwBzF,oDAgBxB0F,EAAIC,GACEtP,SAAPqP,IAAkBA,EAAKvJ,KAAK8D,MAAMjC,KAAK,GAAK,GACrC3H,SAAPsP,IAAkBA,EAAKxJ,KAAK8D,MAAMjC,KAAK,GAAK,GAEhD7B,KAAK8D,MAAM0E,SAAWe,GAAKC,8CAGZxE,GACfhF,KAAK4H,eAAiB5C,EAAGE,eACzBF,EAAGG,WAAWH,EAAGI,aAAcpF,KAAK4H,eAEpC,IAAIzG,IAAK,EAAGnB,KAAK8D,MAAMjC,KAAK,IACxBR,GAAK,EAAGrB,KAAK8D,MAAMjC,KAAK,GAE5BmD,GAAGK,WAAWL,EAAGI,aAAc,GAAIE,eAC/BnE,EAAE,GAAIE,EAAE,GACRF,EAAE,GAAIE,EAAE,GACRF,EAAE,GAAIE,EAAE,GACRF,EAAE,GAAIE,EAAE,GACRF,EAAE,GAAIE,EAAE,GACRF,EAAE,GAAIE,EAAE,KACR2D,EAAGO,0CAGN/E,EAASC,EAAUX,GACpB,GAAIkF,GAAKxE,EAASmG,EAAQ7G,EAAK8G,WAAWC,YAE1C,IAAIkC,EAAUjC,gBAAkBH,EAAM7C,MAAMiD,OAAOC,WAAW,SAAU,CAGpE,GAAIC,IACAC,UAAWlC,EAAGmC,kBAAkB4B,EAAUjC,eAAgB,aAC1D2C,OAAQzE,EAAGsC,mBAAmByB,EAAUjC,eAAgB,UACxDS,YAAavC,EAAGsC,mBAAmByB,EAAUjC,eAAgB,eAC7DU,UAAWxC,EAAGsC,mBAAmByB,EAAUjC,eAAgB,aAC3DW,OAAQzC,EAAGsC,mBAAmByB,EAAUjC,eAAgB,UACxDY,OAAQ1C,EAAGsC,mBAAmByB,EAAUjC,eAAgB,UACxDa,QAAS3C,EAAGsC,mBAAmByB,EAAUjC,eAAgB,WAGjC,QAAxB9G,KAAK4H,gBAAyB5H,KAAK6H,mBAAmB7C,GAE1DA,EAAG+C,WAAWgB,EAAUjC;AAExB9B,EAAGgD,wBAAwBf,EAAWC,WACtClC,EAAGG,WAAWH,EAAGI,aAAcpF,KAAK4H,gBACpC5C,EAAGiD,oBAAoBhB,EAAWC,UAAW,EAAGlC,EAAGkD,OAAO,EAAO,EAAG,GAEpElD,EAAGmD,WAAWlB,EAAWM,YAAa,GAAIjC,eAAcN,EAAGoD,OAAOC,YAAarD,EAAGoD,OAAOE,gBACzFtD,EAAGmD,WAAWlB,EAAWO,UAAW,GAAIlC,cAAatF,KAAK8D,MAAMlC,WAChEoD,EAAGuD,UAAUtB,EAAWQ,OAAQzH,KAAK8D,MAAM/C,OAC3CiE,EAAGmD,WAAWlB,EAAWS,OAAQ,GAAIpC,cAAatF,KAAK8D,MAAMhC,QAC7DkD,EAAGmD,WAAWlB,EAAWU,QAAS,GAAIrC,cAAatF,KAAK8D,MAAM0E,SAE9DxD,EAAG0E,WAAWzC,EAAWwC,OAAQ,GAAInE,cAAatF,KAAK8D,MAAMvD,QAE7DyE,EAAG0D,WAAW1D,EAAG2D,UAAW,EAAG,OAC5B,CAEH,GAAI9H,GAAc,CAES,KAAvBb,KAAK8D,MAAMzF,UACXwC,EAAcL,EAAQM,YACtBN,EAAQM,YAAcd,KAAK8D,MAAMzF,SAGjC2B,KAAK8D,MAAM/C,QACXP,EAAQQ,OAERR,EAAQS,UAAUjB,KAAK8D,MAAMlC,SAAS,GAAI5B,KAAK8D,MAAMlC,SAAS,IAC9DpB,EAAQc,OAAOtB,KAAK8D,MAAM/C,OAC1BP,EAAQS,WAAYjB,KAAK8D,MAAMlC,SAAS,IAAO5B,KAAK8D,MAAMlC,SAAS,KAGvEpB,EAAQiB,UAAYzB,KAAK4I,WACzBpI,EAAQkB,UAAY,EAEpBlB,EAAQmB,SACJ3B,KAAK8D,MAAMlC,SAAS,GAAK5B,KAAK8D,MAAMjC,KAAK,GAAK,EAC9C7B,KAAK8D,MAAMlC,SAAS,GAAK5B,KAAK8D,MAAMjC,KAAK,GAAK,EAC9C7B,KAAK8D,MAAMjC,KAAK,GAAK7B,KAAK8D,MAAMhC,MAAM,GACtC9B,KAAK8D,MAAMjC,KAAK,GAAK7B,KAAK8D,MAAMhC,MAAM,IAGtC9B,KAAK8D,MAAM/C,OACXP,EAAQuB,UAGe,IAAvB/B,KAAK8D,MAAMzF,UACXmC,EAAQM,YAAcD,mCAK3BL,EAASC,EAAUX,GACtBE,KAAKgC,KAAKxB,EAASC,EAAUX,2CAlHhBiJ,EAAAA,kDAqHO,6BArHPA,EAAAA,mDAsHQ,6BAtHRA,EAAAA,kDAuHO,6BAvHPA,EAAAA,mpDAAAA,EAAAA,iOAAAA,21CCPAY,EAAAA,SAAAA,GAGjB,QAAAA,GAAYC,GAAO,MAAA7J,GAAAC,KAAA2J,GAAA1J,EAAAD,MAAA2J,EAAAzJ,WAAAX,OAAAY,eAAAwJ,IAAA1K,KAAAe,KACT4J,kDAGLA,GAED,MADc1P,UAAV0P,GAAsC1P,SAAf8F,KAAK4J,QAAqB5J,KAAK4J,MAAQA,IAC3D,mCAIP,OAAO,kCAIP,OAAO,mCAIP,KAAM,IAAIC,OAAM,wBAA0BF,EAAMG,GAAK,qEAKrD,KAAM,IAAID,OAAM,wBAA0BF,EAAMG,GAAK,2EA1BxCH,EAAAA,8CACGI,EAAAhO,QAAQgD,UAAUmF,YAAYE,iBADjCuF,u0CCAAK,EAAAA,SAAAA,GACjB,QAAAA,GAAYJ,GAAO7J,EAAAC,KAAAgK,EAAA,IAAAnG,GAAA5D,EAAAD,MAAAgK,EAAA9J,WAAAX,OAAAY,eAAA6J,IAAA/K,KAAAe,KACT4J,GACN,IAA8B,YAA1B/F,EAAKK,YAAYE,KACjB,KAAM,IAAIyF,OAAM,oCAHL,OAAAhG,4DAOHoC,GACZ,GAAIA,EACA,OAAQA,GACJ,IAAK,OACL,IAAK,UACL,IAAK,OACL,IAAK,YACL,IAAK,WACL,IAAK,OACL,IAAK,OACL,IAAK,WACL,IAAK,YACL,IAAK,YACL,IAAK,UACL,IAAK,WACL,IAAK,WACL,IAAK,YACL,IAAK,YACL,IAAK,OACL,IAAK,WACL,IAAK,OACL,IAAK,UACD,KACJ,SACIA,EAAQ,QAAUA,EAAQ,WAKtC,MAFAjG,MAAK4J,MAAM9J,KAAKmK,QAAQhE,MAAQjG,KAAK4J,MAAMM,MAAMD,QAAQhE,MAAQjG,KAAK4J,MAAMO,QAAQC,OAASnE,EAC7FoE,OAAOC,SAASC,KAAKC,MAAMJ,OAASpK,KAAK4J,MAAM9J,KAAKmK,QAAQhE,MACrDjG,0CAGEyK,GAOT,MAN8B,SAA1BzK,KAAK4J,MAAM9J,KAAKmG,OAAgC/L,SAAXuQ,GAAwBA,KAAW,EAIxEJ,OAAOC,SAASC,KAAKC,MAAMJ,OAASpK,KAAK4J,MAAMM,MAAMD,QAAQhE,OAH7DjG,KAAK4J,MAAMM,MAAMD,QAAQhE,MAAQoE,OAAOC,SAASC,KAAKC,MAAMJ,OAC5DC,OAAOC,SAASC,KAAKC,MAAMJ,OAAS,QAIjCpK,gDAIP,MAAyC,SAAlCA,KAAK4J,MAAM9J,KAAKmK,QAAQhE,mDAI/B,MAA0B/L,UAAtB8F,KAAKF,KAAKmK,SAA+B,EAAG,IACxCjK,KAAKF,KAAKmK,QAAQ9I,EAAGnB,KAAKF,KAAKmK,QAAQ5I,oDAI/C,MAA0BnH,UAAtB8F,KAAKF,KAAKmK,QAA8B,EACrCjK,KAAKF,KAAKmK,QAAQS,qCA7DZV,mlDCAAW,EAAAA,SAAAA,oRAGI,SAACvH,GAClB,MAAIA,GAAK,EACEA,EACO,IAAPA,EACA,OACO,IAAPA,EACA,SACO,IAAPA,EACA,QADJ,8FAKgB,SAACwH,GACpB/G,EAAK+F,MAAMiB,WAAahH,EAAK+F,MAAMkB,gBAAgBF,EAAEE,gBAEzD,IAAIC,GAAUlH,EAAK+F,MAAMoB,YAAYC,WAAW,aAAepH,EAAKqH,mBAAmBN,EAAEO,QACnFtH,GAAK+F,MAAM9J,KAAKsL,KAAKC,SAASC,QAAQP,MAAa,GACrDlH,EAAK+F,MAAM9J,KAAKsL,KAAKC,SAASE,KAAKR,GAGvClH,EAAK+F,MAAMM,MAAMsB,yBAA0B,EAC3C3H,EAAK+F,MAAMM,MAAMD,SACbwB,SACItK,EAAGyJ,EAAEc,MACLrK,EAAGuJ,EAAEe,QAIb9H,EAAK+F,MAAMM,MAAM0B,sBAAuB,EACW1R,SAA/C2J,EAAK+F,MAAMM,MAAMkB,KAAKS,YAAYd,GAClClH,EAAK+F,MAAMM,MAAMkB,KAAKS,YAAYd,GAASe,MAAQjI,EAAK+F,MAAMM,MAAMkB,KAAKS,YAAYd,GAASgB,UAAYnB,EAAEoB,UAE5GnI,EAAK+F,MAAMM,MAAMkB,KAAKS,YAAYd,IAC9BgB,UAAWnB,EAAEoB,UACbF,MAAO,GAIfjI,EAAK+F,MAAMqC,OAAOC,QAAQ,kBAAmBtB,wFAGxB,SAACA,GAClB/G,EAAK+F,MAAMiB,WAAahH,EAAK+F,MAAMkB,gBAAgBF,EAAEE,gBAEzD,IAAIC,GAAUlH,EAAK+F,MAAMoB,YAAYC,WAAW,aAAepH,EAAKqH,mBAAmBN,EAAEO,QACnFtH,GAAK+F,MAAM9J,KAAKsL,KAAKe,OAAOb,QAAQP,MAAa,GACnDlH,EAAK+F,MAAM9J,KAAKsL,KAAKe,OAAOZ,KAAKR,GAGrClH,EAAK+F,MAAMM,MAAMsB,yBAA0B,EAC3C3H,EAAK+F,MAAM9J,KAAKmK,QAAQS,SAAW,EACnC7G,EAAK+F,MAAMM,MAAMD,SACbwB,SACItK,EAAG,EACHE,EAAG,IAIXwC,EAAK+F,MAAMM,MAAM0B,sBAAuB,EACW1R,SAA/C2J,EAAK+F,MAAMM,MAAMkB,KAAKS,YAAYd,IAClClH,EAAK+F,MAAMM,MAAMkB,KAAKS,YAAYzM,OAAO2L,EAAS,GAGtDlH,EAAK+F,MAAMqC,OAAOC,QAAQ,gBAAiBtB,0FAGpB,SAACA,GACpB/G,EAAK+F,MAAMiB,WAAahH,EAAK+F,MAAMkB,gBAAgBF,EAAEE,iBAEzDjH,EAAK+F,MAAM9J,KAAKmK,SACZ9I,EAAGyJ,EAAEc,MACLrK,EAAGuJ,EAAEe,MACLjB,SAAW7G,EAAK+F,MAAMM,MAAMsB,wBAA2BjT,KAAKiD,KACxDjD,KAAKQ,IAAK6R,EAAEc,MAAQ7H,EAAK+F,MAAMM,MAAMD,QAAQwB,QAAQtK,EAAI,GACvD5I,KAAKQ,IAAK6R,EAAEe,MAAQ9H,EAAK+F,MAAMM,MAAMD,QAAQwB,QAAQpK,EAAI,IAC7D+K,QAAQ,GAAK,EACfnG,MAAOpC,EAAK+F,MAAM9J,KAAKmK,QAAQhE,OAGnCpC,EAAK+F,MAAMqC,OAAOC,QAAQ,eAAgBtB,yFAGpB,SAACA,GACnB/G,EAAK+F,MAAMiB,WAAahH,EAAK+F,MAAMkB,gBAAgBF,EAAEE,gBAEzD,IAAIC,GAAWH,EAAEyB,WAAa,IAAM,EAC9BxI,EAAK+F,MAAMoB,YAAYC,WAAW,mBAClCpH,EAAK+F,MAAMoB,YAAYC,WAAW,oBAElCpH,GAAK+F,MAAM9J,KAAKsL,KAAKe,OAAOb,QAAQP,MAAa,IACnDlH,EAAK+F,MAAM9J,KAAKsL,KAAKe,OAAOZ,KAAKR,GACjClH,EAAK+F,MAAM9J,KAAKsL,KAAKC,SAASE,KAAKR,IAGvClH,EAAK+F,MAAMqC,OAAOC,QAAQ,iBAAkBtB,+DAG3ChB,GACD0C,EAAA3B,EAAA5L,UAAAmB,WAAAX,OAAAY,eAAAwK,EAAA5L,WAAA,OAAAiB,MAAAf,KAAAe,KAAW4J,GACX5J,KAAK4J,MAAM9J,KAAKsL,MACZe,UACAd,aAEJrL,KAAK4J,MAAMM,MAAMkB,MACbS,gBAEJ7L,KAAK4J,MAAM9J,KAAKmK,SACZhE,MAAOjG,KAAK4J,MAAMO,QAAQC,QAAU,OACpCjJ,EAAG,EACHE,EAAG,EACHqJ,SAAU,GAEd1K,KAAK4J,MAAMM,MAAMD,SACbwB,SACItK,EAAG,EACHE,EAAG,GAEP4E,MAAOjG,KAAK4J,MAAMO,QAAQC,QAAU,QAExCpK,KAAK4J,MAAMM,MAAMsB,yBAA0B,EAC3CxL,KAAK4J,MAAMM,MAAM0B,sBAAuB,EACxC5L,KAAKuM,gBAAgBvM,KAAK4J,MAAMO,QAAQC,QAAU,yCAKlD,OAAO,kCAkBP,MAd6BlQ,UAAzB8F,KAAK4J,MAAM9J,KAAKsL,OAChBpL,KAAK4J,MAAM9J,KAAKsL,MACZe,UACAd,cAGwBnR,SAA5B8F,KAAK4J,MAAM9J,KAAKmK,UAChBjK,KAAK4J,MAAM9J,KAAKmK,SACZhE,MAAOjG,KAAK4J,MAAMO,QAAQF,SAAW,OACrC9I,EAAG,EACHE,EAAG,EACHqJ,SAAU,KAGX,mCAQP,MAJAL,QAAOjE,iBAAiB,YAAapG,KAAKwM,0BAA0B,GACpEnC,OAAOjE,iBAAiB,UAAWpG,KAAKyM,wBAAwB,GAChEpC,OAAOjE,iBAAiB,YAAapG,KAAK0M,0BAA0B,GACpErC,OAAOjE,iBAAiB,QAASpG,KAAK2M,yBAAyB,IACxD,oCAQP,MAJAtC,QAAOuC,oBAAoB,YAAa5M,KAAKwM,0BAA0B,GACvEnC,OAAOuC,oBAAoB,UAAW5M,KAAKyM,wBAAwB,GACnEpC,OAAOuC,oBAAoB,YAAa5M,KAAK0M,0BAA0B,GACvErC,OAAOuC,oBAAoB,QAAS5M,KAAK2M,yBAAyB,IAC3D,0CAnKMhC,EAAAA,8CACGZ,EAAAhO,QAAQgD,UAAUmF,YAAYE,iBADjCuG,ikDCAAkC,EAAAA,SAAAA,qRACK,SAACjC,GACf/G,EAAK+F,MAAMiB,WAAahH,EAAK+F,MAAMkB,gBAAgBF,EAAEE,iBACnDjH,EAAK+F,MAAM9J,KAAKsL,KAAKC,SAASC,QAAQV,EAAEG,YAAa,GACvDlH,EAAK+F,MAAM9J,KAAKsL,KAAKC,SAASE,KAAKX,EAAEG,SAGzClH,EAAK+F,MAAMM,MAAM4C,oBAAqB,EACe5S,SAAjD2J,EAAK+F,MAAMM,MAAMkB,KAAKS,YAAYjB,EAAEG,SACpClH,EAAK+F,MAAMM,MAAMkB,KAAKS,YAAYjB,EAAEG,SAASe,MAAQjI,EAAK+F,MAAMM,MAAMkB,KAAKS,YAAYjB,EAAEG,SAASgB,UAAYnB,EAAEoB,UAEhHnI,EAAK+F,MAAMM,MAAMkB,KAAKS,YAAYjB,EAAEG,UAChCgB,UAAWnB,EAAEoB,UACbF,MAAO,GAIfjI,EAAK+F,MAAMqC,OAAOC,QAAQ,qBAAsBtB,mFAGhC,SAACA,GACb/G,EAAK+F,MAAMiB,WAAahH,EAAK+F,MAAMkB,gBAAgBF,EAAEE,iBACnDjH,EAAK+F,MAAM9J,KAAKsL,KAAKe,OAAOb,QAAQV,EAAEG,YAAa,GACrDlH,EAAK+F,MAAM9J,KAAKsL,KAAKe,OAAOZ,KAAKX,EAAEG,SAGvClH,EAAK+F,MAAMM,MAAM4C,oBAAqB,EACe5S,SAAjD2J,EAAK+F,MAAMM,MAAMkB,KAAKS,YAAYjB,EAAEG,UACpClH,EAAK+F,MAAMM,MAAMkB,KAAKS,YAAYzM,OAAOwL,EAAEG,QAAS,GAGxDlH,EAAK+F,MAAMqC,OAAOC,QAAQ,mBAAoBtB,+DAG7ChB,GACD0C,EAAAO,EAAA9N,UAAAmB,WAAAX,OAAAY,eAAA0M,EAAA9N,WAAA,OAAAiB,MAAAf,KAAAe,KAAW4J,GACX5J,KAAK4J,MAAM9J,KAAKsL,MACZe,UACAd,aAEJrL,KAAK4J,MAAMM,MAAMkB,MACbS,gBAEJ7L,KAAK4J,MAAMM,MAAM4C,oBAAqB,mCAItC,OAAO,kCAUP,MAN6B5S,UAAzB8F,KAAK4J,MAAM9J,KAAKsL,OAChBpL,KAAK4J,MAAM9J,KAAKsL,MACZe,UACAd,eAGD,mCAMP,MAFAhB,QAAOjE,iBAAiB,UAAWpG,KAAK+M,qBAAqB,GAC7D1C,OAAOjE,iBAAiB,QAASpG,KAAKgN,mBAAmB,IAClD,oCAMP,MAFA3C,QAAOuC,oBAAoB,UAAW5M,KAAK+M,qBAAqB,GAChE1C,OAAOuC,oBAAoB,QAAS5M,KAAKgN,mBAAmB,IACrD,8BArEMH,y0CCAAI,EAAAA,SAAAA,GACjB,QAAAA,GAAYrD,GAAO,MAAA7J,GAAAC,KAAAiN,GAAAhN,EAAAD,MAAAiN,EAAA/M,WAAAX,OAAAY,eAAA8M,IAAAhO,KAAAe,KACT4J,kDAGLA,GAED,MADc1P,UAAV0P,GAAsC1P,SAAf8F,KAAK4J,QAAqB5J,KAAK4J,MAAQA,IAC3D,mCAIP,OAAO,kCAIP,OAAO,mCAIP,KAAM,IAAIC,OAAM,wBAA0BoD,EAASnD,GAAK,qEAKxD,KAAM,IAAID,OAAM,wBAA0BoD,EAASnD,GAAK,+DAxB3CmD,opCCIAC,EAAAA,SAAAA,6IAAAA,0oCCAAC,EAAAA,SAAAA,6IAAAA,woCCAAC,EAAAA,SAAAA,6IAAAA,grCCHjBC,KAWiBC,EAAAA,WA0BjB,QAAAA,GAAYC,EAAWzN,GAAMC,EAAAC,KAAAsN,GACzBtN,KAAKF,KAAOM,EAAArE,QAAW6D,QAAO,KAAU0N,EAAMhN,SAAUR,GACxDE,KAAKwN,KAAOD,EACZvN,KAAKiM,OAAS,GAAAwB,GAAA1R,QAEdiE,KAAK0N,2DAaO5N,GACZ,MAAiB5F,UAAT4F,GAAsC,YAAhB,mBAAOA,GAAP,YAAAR,EAAOQ,IAC/BM,EAAArE,QAAW6D,QAAO,KAAU0N,EAAMK,cAAe7N,GACjDwN,EAAMK,yCAQbC,EAAY9N,GACX,GAAI2E,GAAQzE,IAEZ,KAAKyE,EAAM3E,KAAK+N,UAAW,CAEH,gBAAT/N,KAAmBA,GAAQA,KAAMA,GAC5C,IAAIgO,GAA6B,gBAAThO,GAAqBE,KAAK+N,gBAAgBjO,GAAQA,CAK1E,OAJa5F,UAAT4F,GAAsC,gBAATA,KAAmBgO,EAAUvJ,SAAWzE,GAEzE2E,EAAM3E,KAAKkO,gBAAgBzC,MAAMqC,EAAYE,IAEtCrJ,kCAWRwJ,GACH,GAAIxJ,GAAQzE,KAERkO,EAAYzJ,EAAM3E,KAAKkO,gBAAgBvJ,EAAM3E,KAAKqO,sBAAwB,EAE9E,IAAIF,EAAOxJ,EAAM3E,KAAKiM,WAA2B7R,SAAdgU,EAAyB,OAAO,CAE9DzJ,GAAM3E,KAAK+N,YACZpJ,EAAMwH,OAAOC,QAAQ,SAAUzH,EAAM+I,OACrC/I,EAAM3E,KAAK+N,WAAY,EAG3B,IAAIO,GAAe3J,EAAM3E,KAAKkO,gBAAgBvJ,EAAM3E,KAAKqO,uBAErDE,EAAqB5J,EAAM6J,qBAAqB7J,EAAM3E,KAAKqO,uBAAuB,GAElFI,GAAWN,GAAQxJ,EAAM3E,KAAKiM,UAAYsC,IAAuBH,EAAU,GAAG3J,QASlF,IARAgK,EAAUA,EAAU,EAAI,EAAIA,EAE5B9J,EAAM+I,KAAKgB,OACPlB,EAAMmB,KAAKC,aAAaN,EAAa,GAAIF,EAAU,GAAIS,EAAA5S,QAAO/B,IAAIkU,EAAU,GAAGlS,QAAQuS,KAG3F9J,EAAMwH,OAAOC,QAAQ,UAAWzH,EAAM+I,OAEtB,IAAZe,EAAe,CACf,KAAI9J,EAAM3E,KAAKqO,sBAAwB1J,EAAM3E,KAAKkO,gBAAgB5V,QAE3D,CACHqM,EAAMwH,OAAOC,QAAQ,YAAazH,EAAM+I,MAExC,KAAK,GAAIlV,GAAI,EAAGA,EAAImM,EAAM3E,KAAK8O,mBAAmBxW,OAAQE,IACtDmM,EAAM3E,KAAK8O,mBAAmBtW,GAAGsM,MAC7BH,EAAM3E,KAAKiM,UAAYtH,EAAM6J,qBAAqB7J,EAAM3E,KAAKqO,sBAAwB,GAAG,GAGhG,QAAO,EATP1J,EAAM3E,KAAKqO,wBAYnB,OAAO,sDAIiBH,GACxB,GAAIa,KAMJ,OAJAb,GAAgBc,QAAQ,SAAUpL,GAC9BmL,EAAOtD,KAAK7H,EAAM,GAAGa,YAGlBsK,+CASUjN,EAAUmN,GAI3B,GAHiB7U,SAAb0H,GAAuC,OAAbA,IAAmBA,EAAW5B,KAAKF,KAAKqO,uBACjDjU,SAAjB6U,IAA4BA,GAAe,GAED7U,SAA1C8F,KAAKF,KAAKkP,kBAAkBpN,GAAyB,MAAO,EAEhE,IAAImN,EAAc,CAEd,IAAK,GADDF,GAAS,EACJvW,EAAI,EAAGA,GAAKsJ,EAAUtJ,IAC3BuW,GAAU7O,KAAKF,KAAKkP,kBAAkB1W,EAE1C,OAAOuW,GAEP,MAAO7O,MAAKF,KAAKkP,kBAAkBpN,gDAQtBqN,EAAYjB,GAC7B,GAAIa,IAAUI,GACVC,EAAQ,EAERC,GAAyBF,GACzBG,EAAiB,EACjBC,EAAoB,CAgFxB,OA9EArB,GAAgBc,QAAQ,SAAUpL,GAC9B,GAAwB,WAApBpE,EAAOoE,EAAM,KAAqBA,EAAM,YAAc5E,QASnD,GAAwB,gBAAb4E,GAAM,GAAiB,CACrC,GAAIpL,GAAI,CACR,QAAQoL,EAAM,IACV,IAAK,QACD0L,EAAiB1L,EAAM,GAAG5D,IAC1B,MACJ,KAAK,WACDuP,EAAoB3L,EAAM,GAAG5D,IAC7B,MACJ,KAAK,SACD,IAAKxH,EAAI,EAAGA,EAAIoL,EAAM,GAAG5D,KAAMxH,IAC3B6W,EAAsB5D,KAAK4D,EAAsBD,IACjDA,GAEJ,MACJ,KAAK,YACD,IAAK5W,EAAI,EAAGA,EAAIoL,EAAM,GAAG5D,KAAMxH,IAC3B6W,EAAsBG,OAAOH,GAC7BD,GAEJ,MACJ,KAAK,OACL,IAAK,UACD,IAAK5W,EAAI,EAAGA,EAAIoL,EAAM,GAAG5D,KAAMxH,IACc4B,SAArCiV,EAAsBD,EAAQ,KAC9BC,EAAsB5D,MAClB+B,EAAMmB,KAAKc,kBAAkBJ,EAAsBD,EAAQ,GAAG,IAC9DC,EAAsBD,EAAQ,GAAG,KAErCA,IAGR,MACJ,KAAK,UACL,IAAK,aACD,IAAK5W,EAAI,EAAGA,EAAIoL,EAAM,GAAG5D,KAAMxH,IAI3B,IAAK,GAHDkX,GAAaL,EAAsBnQ,MAAM,GAEzCyQ,EAAcD,EAAWpX,OACpBsX,EAAI,EAAGA,EAAID,EAAaC,IAAK,CAClC,GAAIC,GAASF,EAAcC,EAAI,CACJxV,UAAvBsV,EAAWG,KACXR,EAAsB5D,MAClB+B,EAAMmB,KAAKc,kBAAkBC,EAAWG,GAAQ,IAChDH,EAAWG,GAAQ,KAEvBT,YAtDG,KAAnBE,GACA1L,EAAM,GAAGkM,MAAQR,EACjBA,EAAiB,GACY,IAAtBC,IACP3L,EAAM,GAAGkM,MAAQP,GAErBF,EAAsB5D,MAAM7H,EAAM,GAAIA,EAAM,KAC5CwL,MA4DRA,EAAQ,EACRC,EAAsBU,QACtBV,EAAsBL,QAAQ,SAAUpL,GACZ,WAApBpE,EAAOoE,EAAM,KAAqBA,EAAM,YAAc5E,SACtD+P,EAAOtD,MAAM+B,EAAMmB,KAAKqB,oBAAoBjB,EAAOK,GAAO,GAAI9O,EAAArE,QAAW6D,QAAO,KAAUiP,EAAOK,GAAO,GAAIxL,EAAM,KAAMA,EAAM,KAC9HwL,OAIDL,gCAOLZ,GACF,GAAIxJ,GAAQzE,IAaZ,OAZa9F,UAAT+T,IAAoBA,EAAO8B,OAAOC,YAAYC,OAClDxL,EAAM3E,KAAKoQ,YAAa,EAEnBzL,EAAM3E,KAAK+N,YACZpJ,EAAM3E,KAAK+N,WAAY,EACvBpJ,EAAMiJ,OAASJ,EAAMmB,KAAK0B,gBAAgB1L,EAAM+I,KAAK1N,MAAOwN,EAAMK,eAClElJ,EAAM3E,KAAKkO,gBAAkBhO,KAAKoQ,qBAAqB3L,EAAMiJ,MAAOjJ,EAAM3E,KAAKkO,iBAC/EvJ,EAAM3E,KAAKkP,kBAAoBhP,KAAKqQ,4BAA4B5L,EAAM3E,KAAKkO,kBAG/EvJ,EAAM3E,KAAKiM,UAAYkC,EAAOxJ,EAAM3E,KAAKwQ,UAElChD,EAAMiD,IAAI9L,kCAOjB,GAAIA,GAAQzE,IACZ,OAAKyE,GAAM3E,KAAKoQ,YAEhBzL,EAAM3E,KAAKoQ,YAAa,EACxBzL,EAAMwH,OAAOC,QAAQ,QAASzH,EAAM+I,OACpC/I,EAAM+L,oBAEClD,EAAMmD,OAAOhM,IANezE,iDAcnC,IAAK,GADDyE,GAAQzE,KACH1H,EAAI,EAAGA,EAAImM,EAAM3E,KAAK8O,mBAAmBxW,OAAQE,IACtDmM,EAAM3E,KAAK8O,mBAAmBtW,GAAGoY,MAGrC,OAAOjM,iCASLmL,GAGF,MAFc1V,UAAV0V,IAAqBA,EAAQ,KACjC5P,KAAK2E,GAAG,QAASiL,GACV5P,sCAOF4P,GAGL,MAFc1V,UAAV0V,IAAqBA,EAAQ,KACjC5P,KAAK2E,GAAG,WAAYiL,GACb5P,oCAOJ2Q,GAGH,MAFczW,UAAVyW,IAAqBA,EAAQ,GACjC3Q,KAAK2E,GAAG,SAAUgM,GACX3Q,uCAOD2Q,GAGN,MAFczW,UAAVyW,IAAqBA,EAAQ,GACjC3Q,KAAK2E,GAAG,YAAagM,GACd3Q,kCAON2Q,GAGD,MAFczW,UAAVyW,IAAqBA,EAAQ,GACjC3Q,KAAK2E,GAAG,OAAQgM,GACT3Q,qCAOH2Q,GAGJ,MAFczW,UAAVyW,IAAqBA,EAAQ,GACjC3Q,KAAK2E,GAAG,UAAWgM,GACZ3Q,qCAOH2Q,GAGJ,MAFczW,UAAVyW,IAAqBA,EAAQ,GACjC3Q,KAAK2E,GAAG,UAAWgM,GACZ3Q,wCAOA2Q,GAGP,MAFczW,UAAVyW,IAAqBA,EAAQ,GACjC3Q,KAAK2E,GAAG,aAAcgM,GACf3Q,gCAUR4Q,EAAOC,GACN,MAAO7Q,MAAKiM,OAAO6E,GAAGF,EAAOC,+BAQ7BD,EAAOC,GACP,MAAO7Q,MAAKiM,OAAO8E,IAAIH,EAAOC,gCAQ7BD,EAAOC,GACR,MAAO7Q,MAAKiM,OAAO+E,KAAKJ,EAAOC,iCAO7BD,GACF,MAAO5Q,MAAKiM,OAAOgF,MAAML,mCAQrBA,EAAO9Q,GACX,MAAOE,MAAKiM,OAAOC,QAAQ0E,EAAO9Q,iCAQ3BoP,GACP,MAAkBhV,UAAVgV,EAAuB7B,EAASA,EAAO6B,+BAOxCzK,GAEP,MADA4I,GAAO9B,KAAK9G,GACLA,iCAOGA,GACV,GAAInM,GAAI+U,EAAO/B,QAAQ7G,EAEvB,OADInM,MAAM,GAAI+U,EAAOjO,OAAO9G,EAAG,GACxBmM,kCAOP4I,oCAOUY,GACV,GAAsB,IAAlBZ,EAAOjV,OAAc,OAAO,CAIhC,KAFA,GAAIE,GAAI,EAEDA,EAAI+U,EAAOjV,QACViV,EAAO/U,GAAG4Y,OAAOjD,GACjB3V,IAEA+U,EAAOjO,OAAO9G,EAAG,EAGzB,QAAO,iCAxdMgV,EAAAA,6CAEba,sBAAuB,EACvBH,mBACAgB,qBACAJ,sBAEAsB,YAAY,EACZrC,WAAW,EACX9B,UAAW,KAEXuE,UAAW,EAEXa,gBAAiB,6BAbJ7D,EAAAA,kDAiBbxN,KAAM,KACNyE,SAAU,IACVqL,MAAO,EACP5T,OAAQ,SACR/B,cAAe,kCArBFqT,EAAAA,4EAAAA,EAAAA,yCA4dboB,aAAc,SAAUN,EAAcF,EAAWxK,GAC7C,GACI0N,GACAC,EAFAxC,IAIJ,KAAKuC,IAAYlD,GACTA,EAAUvO,eAAeyR,IAAahD,EAAazO,eAAeyR,KAClEC,EAAO,KAE4B,gBAAxBnD,GAAUkD,GAEbC,EADAjD,EAAagD,KAAclD,EAAUkD,GAC9BhD,EAAagD,GAEbhD,EAAagD,IAAalD,EAAUkD,GAAYhD,EAAagD,IAAa1N,EAE/C,WAA/BpE,EAAO4O,EAAUkD,MACxBC,EAAOrR,KAAK0O,aAAaN,EAAagD,GAAWlD,EAAUkD,GAAW1N,IAE7D,OAAT2N,IAAexC,EAAOuC,GAAYC,GAI9C,OAAO9R,QAAO6L,KAAKyD,GAAQzW,OAAS,EAAIyW,EAAS,MAGrDsB,gBAAiB,SAAUvC,GACvB,GACIwD,GACAC,EAFAxC,IAIJ,KAAKuC,IAAYxD,GACTA,EAAWjO,eAAeyR,IAA0B,OAAbA,IACvCC,EAAO,KAC8B,gBAAzBzD,GAAWwD,KAA2BE,MAAM1D,EAAWwD,KAC5B,gBAAzBxD,GAAWwD,GAErBC,EAAOzD,EAAWwD,GACqB,WAAhC9R,EAAOsO,EAAWwD,MACzBC,EAAOrR,KAAKmQ,gBAAgBvC,EAAWwD,KAE9B,OAATC,IAAexC,EAAOuC,GAAYC,GAI9C,OAAO9R,QAAO6L,KAAKyD,GAAQzW,OAAS,EAAIyW,EAAS,MAGrDU,kBAAmB,SAAU3B,GACzB,GACIwD,GACAC,EAFAxC,IAIJ,KAAKuC,IAAYxD,GACTA,EAAWjO,eAAeyR,IAA0B,OAAbA,IACvCC,EAAO,KAC6B,gBAAzBzD,GAAWwD,IAA2BE,MAAM1D,EAAWwD,IAEvB,gBAAzBxD,GAAWwD,GACzBC,EAAOzD,EAAWwD,GACqB,WAAhC9R,EAAOsO,EAAWwD,MACzBC,EAAOrR,KAAKuP,kBAAkB3B,EAAWwD,KAJzCC,EAAOE,OAAOC,WAAW5D,EAAWwD,KAAa,GAAInO,WAM5C,OAAToO,IAAexC,EAAOuC,GAAYC,GAI9C,OAAO9R,QAAO6L,KAAKyD,GAAQzW,OAAS,EAAIyW,EAAS,MAGrDiB,oBAAqB,SAAU2B,EAAiBC,GAC5C,GACIN,GACAC,EAFAxC,IAIJ,KAAKuC,IAAYM,GACTA,EAAc/R,eAAeyR,IAAaK,EAAgB9R,eAAeyR,IAA0B,OAAbA,IACtFC,EAAO,KAEgC,gBAA5BK,GAAcN,IAA2BE,MAAMI,EAAcN,KAAmD,gBAA9BK,GAAgBL,GAE/D,gBAA5BM,GAAcN,IAA+D,gBAA9BK,GAAgBL,IAA2BE,MAAMG,EAAgBL,IAEpF,gBAA5BM,GAAcN,IAA+D,gBAA9BK,GAAgBL,GAC7EC,EAAOK,EAAcN,GACqB,WAAnC9R,EAAOoS,EAAcN,MAC5BC,EAAOrR,KAAK8P,oBAAoB2B,EAAgBL,GAAWM,EAAcN,KAJzEC,EAAOK,EAAcN,GAAYI,WAAWC,EAAgBL,IAF5DC,EAAOI,EAAgBL,GAAYI,WAAWE,EAAcN,IASnD,OAATC,IAAexC,EAAOuC,GAAYC,GAG9C,OAAO9R,QAAO6L,KAAKyD,GAAQzW,OAAS,EAAIyW,EAAS,mBAvjBxCvB,orBCRAqE,EAAAA,WAIjB,QAAAA,KAAc5R,EAAAC,KAAA2R,GAAApS,OAAA2J,eAAAlJ,KAAA;AAAAmJ,YAAA,EAAAC,UAAA,EAAA1F,WAAAnE,OAAA2J,eAAAlJ,KAAA,SAAAmJ,YAAA,EAAAC,UAAA,EAAA1F,WACV1D,KAAKiR,gDAMHW,GACgB1X,SAAd0X,GAC+B1X,SAA3B8F,KAAKiM,OAAO2F,KACZ5R,KAAKiM,OAAO2F,OAEc1X,SAA1B8F,KAAK6R,MAAMD,KACX5R,KAAK6R,MAAMD,SAGf5R,KAAK6R,SACL7R,KAAKiM,sCASV2F,EAAWf,GACV,GAA+B3W,SAA3B8F,KAAKiM,OAAO2F,GAA0B,CACtC,GAAIE,GAAQ9R,KAAKiM,OAAO2F,EACpBE,GAAMxG,QAAQuF,MAAc,GAC5BiB,EAAMvG,KAAKsF,OAGf7Q,MAAKiM,OAAO2F,MACZ5R,KAAKiM,OAAO2F,GAAWrG,KAAKsF,gCAQ/Be,EAAWf,GACZ,GAA8B3W,SAA1B8F,KAAK6R,MAAMD,GAA0B,CACrC,GAAIE,GAAQ9R,KAAK6R,MAAMD,EACnBE,GAAMxG,QAAQuF,MAAc,GAC5BiB,EAAMvG,KAAKsF,OAGf7Q,MAAK6R,MAAMD,MACX5R,KAAK6R,MAAMD,GAAWrG,KAAKsF,+BAQ/Be,EAAWf,GACX,GAA8B3W,SAA1B8F,KAAK6R,MAAMD,GAA0B,CACrC,GAAIE,GAAQ9R,KAAKiM,OAAO2F,EACpBE,GAAMxG,QAAQuF,MAAc,GAC5BiB,EAAM1S,OAAO0S,EAAMxG,QAAQuF,qCAS/Be,EAAW9R,GACf,GAAIgS,GAAOxZ,CAEX,IAA+B4B,SAA3B8F,KAAKiM,OAAO2F,GAEZ,IADAE,EAAQ9R,KAAKiM,OAAO2F,GACftZ,EAAI,EAAGA,EAAIwZ,EAAM1Z,OAAQE,IAC1BwZ,EAAMxZ,GAAG2G,KAAK6S,EAAMxZ,GAAIwH,EAIhC,IAA8B5F,SAA1B8F,KAAK6R,MAAMD,GAA0B,CAErC,IADAE,EAAQ9R,KAAK6R,MAAMD,GACdtZ,EAAI,EAAGA,EAAIwZ,EAAM1Z,OAAQE,IAC1BwZ,EAAMxZ,GAAG2G,KAAK6S,EAAMxZ,GAAIwH,EAE5BE,MAAKiR,MAAMW,uBA1FFD,i9CCEAI,EAAAA,SAAAA,GAKjB,QAAAA,GAAYlT,GAAMkB,EAAAC,KAAA+R,EAAA,IAAAlO,GAAA5D,EAAAD,MAAA+R,EAAA7R,WAAAX,OAAAY,eAAA4R,IAAA9S,KAAAe,KACRnB,GADQ,OAAAU,QAAA2J,eAAArF,EAAA,QAAAsF,YAAA,EAAAC,UAAA,EAAA1F,MAJX,WACH,MAAOG,GAAKA,EAAKzL,OAAS,MAGZyL,kDAQXrB,GACH,IAAKA,EACD,OAAO,CAEX,IAAIxC,KAAK5H,QAAUoK,EAAMpK,OACrB,OAAO,CAEX,KAAK,GAAIE,GAAI,EAAG0Z,EAAIhS,KAAK5H,OAAQE,EAAI0Z,EAAG1Z,IACpC,GAAI0H,KAAK1H,YAAcwG,QAAS0D,EAAMlK,YAAcwG,QAChD,IAAKkB,KAAK1H,GAAG2Z,OAAOzP,EAAMlK,IACtB,OAAO,MAEV,IAAI0H,KAAK1H,IAAMkK,EAAMlK,GACtB,OAAO,CAGf,QAAO,mCAOFmH,GAEL,IADA,GAAInH,GAAI0H,KAAK5H,OACNE,KACH,GAAI0H,KAAK1H,KAAOmH,EACZ,OAAO,CAGf,QAAO,+BAONoR,GACD,IAAKA,EAAU,OAAO,CAEtB,KAAK,GADDhC,IAAS,EACJvW,EAAI,EAAGA,EAAI0H,KAAK5H,OAAQE,IAC7B,GAAuC,IAAlCuW,EAASgC,EAAS7Q,KAAK1H,GAAIA,IAC5B,MAAOuW,EAGf,OAAOA,+BAQPnP,EAAKgE,GAOL,MANI1D,MAAKkS,SAASxS,GACdM,KAAKN,GAAOgE,GAEZ1D,KAAKuL,KAAK7L,GACVM,KAAKN,GAAOgE,GAET1D,iCAOPN,GACA,MAAOM,MAAKkS,SAASxS,GAAOM,KAAKN,GAAO,oCAOrCA,GACH,IAAK,GAAIpH,GAAI,EAAGA,EAAI0H,KAAK5H,SAAUE,EAC/B,GAAI0H,KAAK1H,IAAMoH,EAGX,MAFAM,MAAKZ,OAAO9G,EAAG,SACR0H,MAAKN,GACLM,IAGf,OAAOA,eAhGuBlB,kBAAjBiT,ijDCHAI,EAAAA,SAAAA,GAIjB,QAAAA,GAAYzE,GAAO3N,EAAAC,KAAAmS,EAAA,IAAAtO,GAAA5D,EAAAD,MAAAmS,EAAAjS,WAAAX,OAAAY,eAAAgS,IAAAlT,KAAAe,MAAA,OAEf6D,GAAK6J,MAAQ,GAAA0E,GAAArW,QAAc2R,GAFZ7J,sDASf,MAAO7D,MAAK0N,uCAOPA,EAAOmD,GACZ,IAAK7Q,KAAKqS,WAAY,KAAM,IAAAC,GAAAvW,QAAqB,uCAEjD,IAAIwW,GAAWvS,KAAK0N,KACpB1N,MAAK0N,MAAQ,GAAA0E,GAAArW,QAAcgI,EAAAhI,QAAQ6D,QAAO,KAAU2S,EAASC,OAAQ9E,IAEjE1N,KAAKiM,QACLjM,KAAKiM,OAAOC,QAAQ,UAChBuG,SAAUzS,KAAK0N,MACf6E,SAAAA,IAIJ1B,GAAUA,EAAS7Q,KAAK0N,MAAO6E,+BAjCtBJ,izCCQAO,EAAAA,SAAAA,GACjB,QAAAA,GAAYC,EAAK7S,GAAM,MAAAC,GAAAC,KAAA0S,GACNxY,SAAT4F,IAAoBA,MACxBA,EAAKsD,GAAK,WAFSnD,EAAAD,MAAA0S,EAAAxS,WAAAX,OAAAY,eAAAuS,IAAAzT,KAAAe,KAGb2S,EAAK7S,oDAWR8S,EAAW9S,GAId,MAHA+S,YAAW,WACP7S,KAAK2S,IAAIG,gBACXC,KAAK/S,MAAO,MACP,8BAnBM0S,kpCCEAM,EAAAA,WAejB,QAAAA,GAAYL,EAAK7S,GAAMC,EAAAC,KAAAgT,GACN9Y,SAAT4F,IAAoBA,MACX5F,SAAT4F,IAAoBA,MACxBA,EAAKsO,aAAe,EACJlU,SAAZ4F,EAAKsD,IAAgC,OAAZtD,EAAKsD,KAC9BtD,EAAKsD,GAAKC,EAAAtH,QAAKuH,YAEnBtD,KAAKF,KAAOM,EAAArE,QAAW6D,QAAO,KAAUoT,EAAc1S,SAAUR,GAEhEE,KAAK2S,IAAMA,EACX3S,KAAKiT,OAAS,KACdjT,KAAKiM,OAAS,GAAAwB,GAAA1R,+CAWb+D,GAID,MAHoB,YAAhB,mBAAOA,GAAP,YAAAR,EAAOQ,KAAuC5F,SAAlB4F,EAAK+Q,UACjC/Q,EAAK+Q,YAEF,+BAGN/Q,GAED,MADoB,YAAhB,mBAAOA,GAAP,YAAAR,EAAOQ,KAAuC5F,SAAlB4F,EAAK+Q,UAAwB/Q,EAAK+Q,YAC3D,iCAGJ+B,EAAW9S,GACd,OAAO,iCAGJ8S,EAAW9S,GACd,OAAO,iCAGJA,GAEH,MADoB,YAAhB,mBAAOA,GAAP,YAAAR,EAAOQ,KAAuC5F,SAAlB4F,EAAK+Q,UAAwB/Q,EAAK+Q,YAC3D,6BASRD,EAAOC,GACN,MAAO7Q,MAAKiM,OAAO6E,GAAGF,EAAOC,+BAQ7BD,EAAOC,GACP,MAAO7Q,MAAKiM,OAAO8E,IAAIH,EAAOC,gCAQ7BD,EAAOC,GACR,MAAO7Q,MAAKiM,OAAO+E,KAAKJ,EAAOC,iCAO7BD,GACF,MAAO5Q,MAAKiM,OAAOgF,MAAML,mCAQrBA,EAAO9Q,GACX,MAAOE,MAAKiM,OAAOC,QAAQ0E,EAAO9Q,8BA1ElC,MAAOE,MAAKF,KAAKsD,iBAGdM,GACH1D,KAAKF,KAAKsD,GAAKM,iCAlCFsP,EAAAA,6CAEb5P,GAAI,YACJgL,aAAc,2BAHD4E,EAAAA,0CAObE,iBAAkB,EAClBC,WAAY,EACZC,WAAY,EACZC,aAAc,EACdC,aAAc,EACdC,aAAc,eAZDP,0rECZfQ,GAAuB,MAAO,MAAO,OAAQ,UAC7CC,GACF,SAAU,aAAc,OAAQ,SAAU,MAAO,MAAO,SACxD,cAAe,UAAW,QAAS,QAAS,OAAQ,SAAU,WAM7CC,EAAAA,SAAAA,GAGjB,QAAAA,GAAYjU,EAAQ0K,GAChB,GADyBpK,EAAAC,KAAA0T,GACVxZ,SAAXuF,GAA0C,YAAlB,mBAAOA,GAAP,YAAAH,EAAOG,IAC/B,KAAM,IAAAkU,GAAA5X,QAA6B,oDAGvB7B,UAAZiQ,IAAuBA,MACZjQ,SAAXuF,IAAsBA,KAND,IAAAoE,GAAA5D,EAAAD,MAAA0T,EAAAxT,WAAAX,OAAAY,eAAAuT,IAAAzU,KAAAe,KAQnBP,YAAkBX,OAAQ,GAAI8U,GAAenU,EAAQ0K,GAAW5K,OAAOsU,UAAWpU,IAR/D,OAAAF,QAAA2J,eAAArF,EAAA,QAAAsF,YAAA,EAAAC,UAAA,EAAA1F,MAetB,WAAA,MAAMgQ,GAAUI,SAASvU,OAAOsU,OAAOhQ,YAAgB/E,aAA9B+E,OAfHtE,OAAA2J,eAAArF,EAAA,UAAAsF,YAAA,EAAAC,UAAA,EAAA1F,MAiBpB,WAAA,MAAMqQ,MAAKC,UAChBN,EAAUI,SAASvU,OAAOsU,OAAOhQ,YAAgB/E,aAA9B+E,QAlBMtE,OAAA2J,eAAArF,EAAA,OAAAsF,YAAA,EAAAC,UAAA,EAAA1F,MAqBvB,WAAA,MAAMgQ,GAAUO,OAAO1U,OAAOsU,OAAOhQ,YAAgB/E,aAA9B+E,GAAsDA,EAAKqQ,wBArB3D3U,OAAA2J,eAAArF,EAAA,OAAAsF,YAAA,EAAAC,UAAA,EAAA1F,MAuBvB,SAAC5D,GACH,GAAa5F,SAAT4F,GAAsC,YAAhB,mBAAOA,GAAP,YAAAR,EAAOQ,IAC7B,KAAM,IAAA6T,GAAA5X,QAA6B,oDAGvC,IAAIwD,OAAO4U,SAAPtQ,GAAuB,CACvB,GAAIuQ,GAAYV,EAAUI,SAASvU,OAAOsU,OAAOhQ,YAAgB/E,aAA9B+E,IAC/BwQ,EAAYtQ,EAAAhI,QAAQ6D,QAAO,EAAMwU,YAAqBtV,aAAiBsV,EAAWtU,EAGtF,OAFAwU,SAAQC,IAAIH,EAAZvQ,EAA6BwQ,GAEtBX,EAAUO,OAAOI,EAAWxQ,EAAKqQ,qBAG5C,MAAO,SA1BPrQ,EAAKqQ,oBAAsB/J,EAEtB5K,OAAO4U,SAAPtQ,IAAuB6P,EAAUO,OAAVpQ,EAAuBsG,GAZ1BtG,uDA4CfpE,EAAQ0K,GAElB,IAAK,GADDyD,GAAarO,OAAOiV,oBAAoB/U,GACnCnH,EAAI,EAAGA,EAAIsV,EAAWxV,OAAQE,KAC/BmH,EAAOE,eAAeiO,EAAWtV,KACJ,OAA1BmH,EAAOmO,EAAWtV,KACgB,WAAjCgH,EAAOG,EAAOmO,EAAWtV,MAAqD,kBAA1BmH,GAAOmO,EAAWtV,KACtEiH,OAAO4U,SAAS1U,EAAOmO,EAAWtV,MACjCkb,EAAoBlI,QAAQsC,EAAWtV,OAAQ,GAC/Cmb,EAA0BnI,QAAQsC,EAAWtV,OAAQ,GACrC,wBAAlBsV,EAAWtV,KAEdmH,EAAOmO,EAAWtV,IAAM,GAAIob,GAAUjU,EAAOmO,EAAWtV,IAAK6R,GAKrE,OADA5K,QAAO0U,OAAOxU,GACPA,mCAOKA,GACZ,GAAIoP,GAASpP,YAAkBX,YAE/B,IAAIW,YAAkBX,OAClB,IAAK,GAAIxG,GAAI,EAAGA,EAAImH,EAAOrH,OAAQE,IAAKuW,EAAOtD,KAAK9L,EAAOnH,QACxD,IAAImH,YAAkBgV,QACzB5F,EAAS4F,OAAOhV,GAAQwD,eACrB,IAAsB,YAAlB,mBAAOxD,GAAP,YAAAH,EAAOG,IACd,IAAK,GAAI2R,KAAY3R,GACbA,EAAOE,eAAeyR,IACjBoC,EAAoBlI,QAAQ8F,MAAc,GAC1CqC,EAA0BnI,QAAQ8F,MAAc,GACrC,wBAAbA,IAEHvC,EAAOuC,GAAyC,WAA5B9R,EAAOG,EAAO2R,KAA0B7R,OAAO4U,SAAS1U,EAAO2R,IAC7EsC,EAAUI,SAASrU,EAAO2R,IAC1B3R,EAAO2R,GAKzB,OAAOvC,UA3FwBtP,kBAAlBmU,KA+FfE,GAAAA,SAAAA,GAGF,QAAAA,GAAYpR,EAAO2H,GAASpK,EAAAC,KAAA4T,GACR1Z,SAAZiQ,IAAuBA,KADH,IAAA3E,GAAAvF,EAAAD,MAAA4T,EAAA1T,WAAAX,OAAAY,eAAAyT,IAAA3U,KAAAe,SAOxB,IAFAwF,EAAK0O,oBAAsB/J,EAEL,YAAjB,mBAAO3H,GAAP,YAAAlD,EAAOkD,KAAsBA,YAAiB1D,OAC/C,IAAK,GAAIxG,GAAI,EAAGA,EAAIkK,EAAMpK,OAAQE,IAAKkN,EAAKlN,GAAKkK,EAAMlK,EARnC,OAAAkN,qDAiBZ,IAAA,GAAAkP,GAAAC,EAAAzV,UAAA9G,OAANyG,EAAMC,MAAA6V,GAAAC,EAAA,EAAAA,EAAAD,EAAAC,IAAN/V,EAAM+V,GAAA1V,UAAA0V,EACZ,OAAOlB,GAAUO,QAAVS,EAAApI,EAAAsH,EAAA7U,UAAAmB,WAAAX,OAAAY,eAAAyT,EAAA7U,WAAA,SAAAiB,OAAAf,KAAA4V,MAAAH,GAAA1U,MAAAsP,OAAiCzQ,IAAOmB,KAAKkU,0DAOpC,IAAA,GAAAY,GAAAC,EAAA7V,UAAA9G,OAANyG,EAAMC,MAAAiW,GAAAC,EAAA,EAAAA,EAAAD,EAAAC,IAANnW,EAAMmW,GAAA9V,UAAA8V,EAChB,OAAOtB,GAAUO,QAAVa,EAAAxI,EAAAsH,EAAA7U,UAAAmB,WAAAX,OAAAY,eAAAyT,EAAA7U,WAAA,aAAAiB,OAAAf,KAAA4V,MAAAC,GAAA9U,MAAAsP,OAAqCzQ,IAAOmB,KAAKkU,oDAQxD,GAAI1R,GAAQkR,EAAUI,SAASvU,OAAOsU,UAAW7T,MACjD,OAAO0T,GAAUO,OAAOzR,EAAMyS,KAANJ,MAAArS,EAAAtD,WAAqBc,KAAKkU,sDAOtC,IAAA,GAAAgB,GAAAC,EAAAjW,UAAA9G,OAANyG,EAAMC,MAAAqW,GAAAC,EAAA,EAAAA,EAAAD,EAAAC,IAANvW,EAAMuW,GAAAlW,UAAAkW,EACZ,OAAO1B,GAAUO,QAAViB,EAAA5I,EAAAsH,EAAA7U,UAAAmB,WAAAX,OAAAY,eAAAyT,EAAA7U,WAAA,SAAAiB,OAAAf,KAAA4V,MAAAK,GAAAlV,MAAAsP,OAAiCzQ,IAAOmB,KAAKkU,mDAO3C,IAAA,GAAAmB,GAAAC,EAAApW,UAAA9G,OAANyG,EAAMC,MAAAwW,GAAAC,EAAA,EAAAA,EAAAD,EAAAC,IAAN1W,EAAM0W,GAAArW,UAAAqW,EACT,OAAO7B,GAAUO,QAAVoB,EAAA/I,EAAAsH,EAAA7U,UAAAmB,WAAAX,OAAAY,eAAAyT,EAAA7U,WAAA,MAAAiB,OAAAf,KAAA4V,MAAAQ,GAAArV,MAAAsP,OAA8BzQ,IAAOmB,KAAKkU,mDAQjD,GAAI1R,GAAQkR,EAAUI,SAASvU,OAAOsU,UAAW7T,MAEjD,OADAwC,GAAMgT,IAANX,MAAArS,EAAAtD,WACOwU,EAAUO,OAAOzR,EAAOxC,KAAKkU,oDAQpC,GAAI1R,GAAQkR,EAAUI,SAASvU,OAAOsU,UAAW7T,MAEjD,OADAwC,GAAM+I,KAANsJ,MAAArS,EAAAtD,WACOwU,EAAUO,OAAOzR,EAAOxC,KAAKkU,sDAQpC,GAAI1R,GAAQkR,EAAUI,SAASvU,OAAOsU,UAAW7T,MACjD,OAAO0T,GAAUO,OAAOzR,EAAMiT,OAANZ,MAAArS,EAAAtD,WAAuBc,KAAKkU,2DAQpD,GAAI1R,GAAQkR,EAAUI,SAASvU,OAAOsU,UAAW7T,MACjD,OAAO0T,GAAUO,OAAOzR,EAAMkT,YAANb,MAAArS,EAAAtD,WAA4Bc,KAAKkU,uDAQzD,GAAI1R,GAAQkR,EAAUI,SAASvU,OAAOsU,UAAW7T,MACjD,OAAO0T,GAAUO,OAAOzR,EAAMmT,QAANd,MAAArS,EAAAtD,WAAwBc,KAAKkU,qDAQrD,GAAI1R,GAAQkR,EAAUI,SAASvU,OAAOsU,UAAW7T,MAEjD,OADAwC,GAAMqN,MAANgF,MAAArS,EAAAtD,WACOwU,EAAUO,OAAOzR,EAAOxC,KAAKkU,qDAQpC,GAAI1R,GAAQkR,EAAUI,SAASvU,OAAOsU,UAAW7T,MACjD,OAAO0T,GAAUO,OAAOzR,EAAMxD,MAAN6V,MAAArS,EAAAtD,WAAsBc,KAAKkU,oDAQnD,GAAI1R,GAAQkR,EAAUI,SAASvU,OAAOsU,UAAW7T,MACjD,OAAO0T,GAAUO,OAAOzR,EAAMoT,KAANf,MAAArS,EAAAtD,WAAqBc,KAAKkU,sDAQlD,GAAI1R,GAAQkR,EAAUI,SAASvU,OAAOsU,UAAW7T,MACjD,OAAO0T,GAAUO,OAAOzR,EAAMpD,OAANyV,MAAArS,EAAAtD,WAAuBc,KAAKkU,uDAQpD,GAAI1R,GAAQkR,EAAUI,SAASvU,OAAOsU,UAAW7T,MAEjD,OADAwC,GAAMqT,QAANhB,MAAArS,EAAAtD,WACOwU,EAAUO,OAAOzR,EAAOxC,KAAKkU,8BApJfpV,85CCxGRgX,EAAAA,SAAAA,qUAIbC,GACA,MAAO/V,MAAKgW,OAAOD,IAAS,iCAG5BA,GACA,MAA6B7b,UAAtB8F,KAAKgW,OAAOD,+BAGnBvI,GACA,GAAIA,EAAKyI,cACL,KAAM,IAAA3D,GAAAvW,QAAA,mBAAwCyR,EAAKtJ,YAAYE,KAAzD,oCAMV,OAJIoJ,GAAK0I,WAALC,EAAApa,WACAiE,KAAKgW,OAAOxI,EAAKuI,MAAQvI,EACzBxN,KAAKgW,OAAOzK,KAAKiC,IAEdxN,oCAGJwN,EAAM0B,GACT,GAAI1B,EAAKyI,cACL,KAAM,IAAA3D,GAAAvW,QAAA,mBAAwCyR,EAAKtJ,YAAYE,KAAzD,oCAMV,OAJIoJ,GAAK0I,WAALC,EAAApa,WACAiE,KAAKgW,OAAOxI,EAAKuI,MAAQvI,EACzBxN,KAAKgW,OAAO5W,OAAO8P,EAAO,EAAG1B,IAE1BxN,oCAGJwN,GAKH,MAJIA,GAAK0I,WAALC,EAAApa,UAA6BiE,KAAKoW,IAAI5I,EAAKuI,QAC3C/V,KAAKgW,OAAO5W,OAAOY,KAAKgW,OAAO1K,QAAQkC,GAAO,SACvCxN,MAAKgW,OAAOxI,EAAKuI,OAErB/V,qCAKP,MADAA,MAAKgW,UACEhW,oCAGJQ,EAASC,EAAUX,GACtB,IAAIA,EAAK8G,WAAWC,aAAa/C,MAAMuS,eAEZ,IAAvBrW,KAAKgW,OAAO5d,OACZ,IAAK,GAAIE,GAAI,EAAGA,EAAI0H,KAAKgW,OAAO5d,OAAQE,IACpC0H,KAAKgW,OAAO1d,GAAGyO,OAAOvG,EAASC,EAAUX,+BApDpCgW,0jCCDA1T,EAAAA,SAAAA,6IAAAA,4bCIAkU,GAAAA,QAAAA,0BAAAA,uoCCGrB,QAASC,KACL,MAAIC,IACAC,EAA0Cvc,SAA5Bsc,EAAaE,WACrBF,EAAaG,iBACbH,EAAaE,aACnBD,EAAWG,KAAKlT,MAAQ,EACxB+S,EAAWI,QAAQL,EAAaM,aACzBL,GAEJ,yDAZPD,GACAC,mRAFA7S,KAyBiBmT,EAAAA,SAAAA,GAqBjB,QAAAA,GAAYjX,EAAMkX,GAASjX,EAAAC,KAAA+W,EAAA,IAAAlT,GAAA5D,EAAAD,MAAA+W,EAAA7W,WAAAX,OAAAY,eAAA4W,IAAA9X,KAAAe,KACjBF,EAAMkX,GADW,OAGvBnT,GAAKmT,QAAUA,EACfnT,EAAKoI,OAAWpI,EAAKmT,QAAUnT,EAAKmT,QAAQ/K,OAAS,GAAAwB,GAAA1R,QACrD8H,EAAK/D,KAAOM,EAAArE,QAAW6D,QAAO,KAAUmX,EAAMzW,SAAUR,GACxD+D,EAAKoT,aACLT,EAAeQ,EACTA,EAAQE,kBACR,IAAK7M,OAAO8M,cAAgB9M,OAAO+M,oBAEzCX,EAAaO,EACPA,EAAQK,gBACRd,IAEe,OAAjB1S,EAAK/D,KAAKsD,KACVS,EAAK/D,KAAKsD,GAAKC,EAAAtH,QAAKuH,YAGpBkT,GAAgB3S,EAAK/D,KAAKwX,QAC1BzT,EAAK0T,gBAAL1T,GAGAA,EAAKmT,SAAWR,GAAgB3S,EAAKmT,QAAQlX,KAAK0X,gBAClD3T,EAAKmT,QAAQS,WAAY,GAGzB5T,EAAKmT,SAASnT,EAAKmT,QAAQU,MAAM1d,IAAI,UAAUuW,IAAI1M,EAAK/D,KAAKsD,GAA/CS,GAElBA,EAAK8T,OA7BkB9T,iDAgCrB+T,GAEF,MADAC,GAAWD,EAAOA,EAAM9X,KAAKqG,KACtByR,kCAGHE,GACJA,EAAUC,WAAW,gCAGpBC,EAAQnH,GACT,GAAI+G,GAAQ5X,IAMZ,OAJsB,kBAAXgY,KAAwBnH,EAAWmH,GAEzCA,GAA4B,kBAAXA,KAAuBA,EAAS,WAEjDJ,EAAM9X,KAAKmY,OAQXL,EAAM9X,KAAKkY,OAAOA,IAKvBJ,EAAMM,cAAcN,EAAO,SAAUpK,GACjCA,EAAKwK,OAASA,CAEd,IAAIG,GAAO3K,EAAK2K,IAAM,EAAK3K,EAAK2K,IAAMP,EAAM9X,KAAKkY,OAAOA,GAAQ,GAAK,IACjEzT,EAAWqT,EAAM9X,KAAKkY,OAAOA,GAAQ,GAAK,IAAOxK,EAAK2K,GACtD3K,GAAK2K,IAAM,IAAGA,EAAMP,EAAM9X,KAAKkY,OAAOA,GAAQ,GAAK,IAAOG,EAC9D,IAImDC,GAJ/CC,KAAUT,EAAM9X,KAAKuY,OAAQT,EAAM9X,KAAKkY,OAAOA,GAAQ,IAEvDM,EAA+B,gBAAbzH,GAChBA,EACAtY,KAAKggB,MAAMC,KAAKvI,MAAQ1X,KAAK+F,UAAY,IAE/C,WACI,GAAIwB,IACAsD,GAAIkV,EACJN,OAAQA,EACRK,KAAMA,EAGVD,GAAUvF,WAAW,WACb2D,IAAiB6B,IACjBT,EAAMa,UAAUb,EAAO9X,EAAKsD,IAAIsV,QAAS,EACzCd,EAAMa,UAAUb,EAAO9X,EAAKsD,IAAI+U,IAAM,EACtCP,EAAMe,eAAef,EAAO9X,EAAKsD,KAErCwU,EAAM3L,OAAOC,QAAQ,SAAUoM,IAC/B/T,EAAWqT,EAAM9X,KAAK8Y,KAAQ,KAElChB,EAAM9X,KAAK+Y,WAAWtN,MAAMuN,MAAOV,EAAShV,GAAItD,EAAKsD,OAGzD,IAAI2V,GAAYnB,EAAM9X,KAAKkY,OAAOA,GAAQ,GAAK,IAC3CgB,EAAUpB,EAAM9X,KAAKkY,OAAOA,GAAQ,GAAK,GAiB7C,OAfAxK,GAAKpK,GAAKkV,EACV9K,EAAKkL,QAAS,EACdO,EAAcrB,GAAQS,EAAMU,EAAWC,GAAUV,GACjDV,EAAM9X,KAAKoZ,UAAY1C,EAAa2C,YACpC3L,EAAKoJ,KAAKlT,MAAQkU,EAAM9X,KAAKsZ,OAEU,mBAA5B5L,GAAK6L,aAAazU,MACzByT,EAAO7K,EAAK6L,aAAaC,YAAY,EAAGnB,EAAK,OAAS3K,EAAK6L,aAAaC,YAAY,EAAGnB,EAAK5T,GAE5F8T,EAAO7K,EAAK6L,aAAazU,MAAM,EAAGuT,EAAK,OAAS3K,EAAK6L,aAAazU,MAAM,EAAGuT,EAAK5T,GAGpFqT,EAAM3L,OAAOC,QAAQ,QACG,kBAAb2E,IAAyBA,EAASyH,GAEtCV,IAGJA,IAxDqB,kBAAb/G,IAAyBA,IAC7B+G,IATPA,EAAM3L,OAAO6E,GAAG,OAAQ,WACpB8G,EAAM2B,KAAKvB,EAAQnH,KAGhB+G,kCA+DR4B,GACH,QAAKA,EAAWH,eAAgBG,EAAWd,UAI3Cc,EAAWd,QAAS,EACgBxe,QAAhCsf,EAAWH,aAAa3I,KACxB8I,EAAWH,aAAaI,QAAQ,GAEhCD,EAAWH,aAAa3I,KAAK,IAE1B,iCAGL8I,GACF,QAAKA,EAAWH,eAAgBG,EAAWd,UAI3Cc,EAAWd,QAAS,EAEwB,mBAAjCc,GAAWH,aAAa3I,KAC/B8I,EAAWH,aAAaI,QAAQ,GAEhCD,EAAWH,aAAa3I,KAAK,IAE1B,iCAGL8I,GACFA,EAAW5C,KAAKlT,MAAQ,kCAGpB8V,GACJA,EAAW5C,KAAKlT,MAAQ1D,KAAKF,KAAKsZ,uCAG9BI,EAAYE,GAChBF,EAAW5C,KAAKlT,MAAQgW,oCAGlBF,EAAYvhB,GAClB,MAAUiC,UAANjC,GAAwB,GAALA,EAAkBuhB,EAAWrB,IAC7CqB,EAAWrB,KAAO3B,EAAa2C,YAAcnZ,KAAKF,KAAKoZ,0CAG3DM,EAAYrY,EAAGE,EAAGsY,GACjBH,IACAxZ,KAAKF,KAAK8Z,OAASzY,EAAGE,EAAGsY,GACzBH,EAAWK,OAAOC,YAAY3Y,EAAGE,EAAGsY,GACpCH,EAAWK,OAAOE,aAAe/Z,KAAKF,KAAKka,OAAS,kDAKxD,GAAIpC,GAAQ5X,KACRwN,EAAOoK,EAAMX,UACb/H,EAAQ0I,EAAMX,UAAU7e,MAiB5B,OAfAoV,GAAK0B,GAAsChV,SAA5Bsc,EAAaE,WACtBF,EAAaG,iBACbH,EAAaE,aAEnBlJ,EAAK0B,GAAO0H,KAAKlT,MAAQkU,EAAM9X,KAAKsZ,OACpC5L,EAAK0B,GAAOwJ,QAAS,EACrBlL,EAAK0B,GAAOiJ,IAAM,EAClB3K,EAAK0B,GAAO+K,WAAa,EACzBzM,EAAK0B,GAAO2H,QAAQJ,GAEpBjJ,EAAK0B,GAAO2K,OAASrD,EAAa0D,eAClC1M,EAAK0B,GAAO2K,OAAOE,aAAenC,EAAM9X,KAAKka,OAAS,aACtDxM,EAAK0B,GAAO2K,OAAOC,YAAYlC,EAAM9X,KAAK8Z,MAAM,GAAIhC,EAAM9X,KAAK8Z,MAAM,GAAIhC,EAAM9X,KAAK8Z,MAAM,IAC1FpM,EAAK0B,GAAO2K,OAAOhD,QAAQrJ,EAAK0B,IAEzB1B,EAAK0B,yCAIF0I,EAAO/G,GAGjB,IAAK,GAFDrD,GAAO,KAEFlV,EAAI,EAAGA,EAAIsf,EAAMX,UAAU7e,OAAQE,IACxC,GAAIsf,EAAMX,UAAU3e,GAAGogB,QAA4C,IAAlCd,EAAMX,UAAU3e,GAAG2hB,WAAkB,CAClEpJ,EAAS+G,EAAMX,UAAU3e,IACzBkV,GAAO,CACP,OAMR,GAFAoK,EAAMuC,WAAWvC,IAEbpK,EAAJ,CAEA,GAAI4M,GAAUxC,EAAML,iBACpB1G,GAASuJ,uCAGFxC,GAGP,IAAK,GAFDyC,GAAW,EAEN/hB,EAAI,EAAGA,EAAIsf,EAAMX,UAAU7e,OAAQE,IACpCsf,EAAMX,UAAU3e,GAAGogB,QAAQ2B,GAGnC,KAAK/hB,EAAIsf,EAAMX,UAAU7e,OAAS,EAAGE,GAAK,KAClC+hB,GAAY,GADyB/hB,IAGrCsf,EAAMX,UAAU3e,GAAGogB,SACflC,GAAcoB,EAAMX,UAAU3e,GAAGyf,WAAW,GAChDH,EAAMX,UAAU7X,OAAO9G,EAAG,GAC1B+hB,6CAvPKtD,EAAAA,6CAEb3T,GAAI,KACJ+C,OACAmU,OAAQ,KACRC,UAAU,EAEVhW,SAAU,EACV8T,MAAM,EACNL,UACAoB,OAAQ,EACRoB,OAAO,EACPZ,OAAQ,EAAG,GAAG,IACdhB,KAAM,EAENX,QAAQ,EACRX,QAAQ,EACR0C,MAAO,KACPnB,2BAlBa9B,CAoQrB,IAAIc,GAAa,SAAUD,EAAO6C,GAC9B,GAAIA,IAAO7W,GAIP,MAHAgU,GAAM9X,KAAKyE,SAAWX,EAAM6W,GAAKlW,aAEjCmW,GAAU9C,EAId,IAAI,sBAAsB+C,KAAKF,GAAM,CAGjC,IAAK,GAFD3a,GAAO8a,KAAKH,EAAII,MAAM,KAAK,IAC3BC,EAAW,GAAI9U,YAAWlG,EAAK1H,QAC1BE,EAAI,EAAGA,EAAIwH,EAAK1H,SAAUE,EAC/BwiB,EAASxiB,GAAKwH,EAAKib,WAAWziB,EAGlC0iB,GAAgBF,EAASxD,OAAQM,EAAO6C,OACrC,CACH,GAAIQ,GAAM,GAAIC,eACdD,GAAIE,KAAK,MAAOV,GAAK,GACrBQ,EAAIG,aAAe,cACnBH,EAAII,OAAS,WACTL,EAAgBC,EAAIK,SAAU1D,EAAO6C,IAEzCQ,EAAIM,QAAU,WACN/E,IACAoB,EAAM9X,KAAKwX,QAAS,EACpBM,EAAMX,mBACCW,GAAM4D,eACN5X,GAAM6W,GACb7C,EAAMD,QAGd,KACIsD,EAAIQ,OACN,MAAO7Q,GACLqQ,EAAIM,aAWZP,EAAkB,SAAUU,EAAa9D,EAAO6C,GAChDjE,EAAawE,gBACTU,EACA,SAAUpE,GACFA,IACA1T,EAAM6W,GAAOnD,EACboD,EAAU9C,EAAON,KAGzB,SAAUqE,GACN/D,EAAM3L,OAAOC,QAAQ,YAAayP,MAU1CjB,EAAY,SAAU9C,EAAON,GAC7BM,EAAM9X,KAAKyE,SAAY+S,EAAUA,EAAO/S,SAAWqT,EAAM9X,KAAKyE,SAED,IAAzDhF,OAAOiV,oBAAoBoD,EAAM9X,KAAKkY,QAAQ5f,SAC9Cwf,EAAM9X,KAAKkY,QAAUjc,SAAU,EAAyB,IAAtB6b,EAAM9X,KAAKyE,YAG5CqT,EAAM9X,KAAKmY,SACZL,EAAM9X,KAAKmY,QAAS,EACpBL,EAAM3L,OAAOC,QAAQ,SAGrB0L,EAAM9X,KAAKya,UACX3C,EAAM2B,QAUVN,EAAgB,SAAUrB,EAAOS,EAAMjV,GACvC,GAAIoK,GAAOoK,EAAMa,UAAUb,EAAOxU,EAElCoK,GAAK6L,aAAe7C,EAAaoF,qBACjCpO,EAAK6L,aAAa/B,OAAS1T,EAAMgU,EAAM9X,KAAKqG,KAC5CqH,EAAK6L,aAAaxC,QAAQrJ,EAAKqM,QAC/BrM,EAAK6L,aAAahB,KAAOA,EAAK,GAC1BA,EAAK,KACL7K,EAAK6L,aAAaN,UAAYV,EAAK,GACnC7K,EAAK6L,aAAaL,QAAUX,EAAK,GAAKA,EAAK,IAG/C7K,EAAK6L,aAAawC,aAAanY,MAAQkU,EAAM9X,KAAK8Y,ooCCnYlDhV,KACAkY,EAAYzR,OAAO0R,MAUFA,EAAAA,WAkBjB,QAAAA,GAAYjc,EAAMkX,GAASjX,EAAAC,KAAA+b,EACvB,IAAIC,GAAQhc,IACZgc,GAAMhF,QAAsB9c,SAAZ8c,EAAwBA,EAAU,KAClDgF,EAAM/P,OAAW+P,EAAMhF,QAAUgF,EAAMhF,QAAQ/K,OAAS,GAAAwB,GAAA1R,QACxDigB,EAAMlc,KAAOM,EAAArE,QAAW6D,QAAO,KAAUmc,EAAMzb,SAAUR,GAEzDkc,EAAM/E,aAEgB,OAAlB+E,EAAMlc,KAAKsD,KACX4Y,EAAMlc,KAAKsD,GAAKC,EAAAtH,QAAKuH,YAGrB0Y,EAAMhF,SAASgF,EAAMhF,QAAQU,MAAM1d,IAAI,UAAUuW,IAAIyL,EAAMlc,KAAKsD,GAAI4Y,GAExEA,EAAMrE,+CAIJqE,GACF,GAAI/E,GAAY,GAAI6E,EAEpB7E,GAAU7Q,iBAAiB,QAAS,WAChCkO,QAAQqH,OAAOzZ,KAAM+U,EAAU0E,MAAQ1E,EAAU0E,MAAMM,KAAO,MAC/D,GAEHD,EAAM/E,UAAU1L,KAAK0L,GAErBA,EAAU9Q,IAAM6V,EAAMlc,KAAKqG,IAC3B8Q,EAAUkB,IAAM,EAChBlB,EAAUiF,QAAU,OACpBjF,EAAUmC,OAAY4C,EAAMhF,QACrBgF,EAAMhF,QAAQwD,MAAS,EAAIwB,EAAMlc,KAAKsZ,QAAU4C,EAAMhF,QAAQoC,OAAS,KACvE4C,EAAMlc,KAAK0a,MAAS,EAAIwB,EAAMlc,KAAKsZ,MAE1C,IAAI+C,GAAW,QAAXA,KACAH,EAAMlc,KAAKyE,SAAWhM,KAAK6jB,KAA0B,GAArBnF,EAAU1S,UAAiB,GAEE,IAAzDhF,OAAOiV,oBAAoBwH,EAAMlc,KAAKkY,QAAQ5f,SAC9C4jB,EAAMlc,KAAKkY,QAAUjc,SAAU,EAAyB,IAAtBigB,EAAMlc,KAAKyE,YAG5CyX,EAAMlc,KAAKmY,SACZ+D,EAAMlc,KAAKmY,QAAS,EACpB+D,EAAM/P,OAAOC,QAAQ,SAGrB8P,EAAMlc,KAAKya,UACXyB,EAAMzC,OAGVtC,EAAUrK,oBAAoB,iBAAkBuP,GAAU,GAK9D,OAHAlF,GAAU7Q,iBAAiB,iBAAkB+V,GAAU,GACvDlF,EAAUU,OAEHqE,iCAIP,GAAIA,GAAQhc,KACRya,EAAM,GAAI4B,EAAY,EAE1B,IAAIL,EAAMhF,SAAcgF,EAAMhF,QAAQsF,eAElC,MADAhI,SAAQiI,KAAK,sBACN,CAGX,IAAIC,GAAgB,SAAUC,EAAQnC,GAClC,GAAIA,EAAQ,MAAOA,EAEnB,IAAI+B,GAAY,0BAA0BK,KAAKD,EAK/C,OAJKJ,KACDA,EAAY,aAAaK,KAAKD,EAAO5B,MAAM,IAAK,GAAG,KAGnDwB,EACOA,EAAU,GAAGpY,eAEpBqQ,QAAQiI,KAAK,gEAEV,MAGX,IAAIP,EAAMlc,KAAKqG,cAAerH,OAAO,CACjC,IAAK,GAAIxG,GAAI,EAAGA,EAAI0jB,EAAMlc,KAAKqG,IAAI/N,SAC/BqiB,EAAMuB,EAAMlc,KAAKqG,IAAI7N,GACrB+jB,EAAYG,EAAcR,EAAMlc,KAAKqG,IAAI7N,GAAI0jB,EAAMlc,KAAKwa,QACpD,OAAS+B,GAH0B/jB,KAK3C0jB,EAAMlc,KAAKqG,IAAMsU,MACd,CAAA,GAA8B,gBAAnBuB,GAAMlc,KAAKqG,IAIzB,MADAmO,SAAQiI,KAAK,yBACN,CAHPF,GAAYG,EAAcR,EAAMlc,KAAKqG,IAAK6V,EAAMlc,KAAKwa,QAMzD,MAAI0B,GAAMhF,SAAWgF,EAAMhF,QAAQ2F,eAAeN,IAC9C/H,QAAQiI,KAAK,sBACN,GAGJP,EAAMY,MAAMZ,mCAGf/E,GACJA,EAAU9Q,IAAM,oCAOhB,IAAK,GAHD6V,GAAQhc,KAER6c,EAAQb,EAAM/E,UACT3e,EAAI,EAAGA,EAAI0jB,EAAM/E,UAAU7e,OAAQE,IACnCukB,EAAMvkB,GAAGogB,SACVsD,EAAMtL,KAAKmM,EAAMvkB,GAAG8K,IACpB4Y,EAAM/P,OAAOC,QAAQ,SAAU2Q,EAAMvkB,GAAG8K,KAE5C4Y,EAAMc,QAAQD,EAAMvkB,GAGxB,KAAKA,EAAI,EAAGA,EAAI0jB,EAAMlc,KAAK+Y,WAAWzgB,OAAQE,IAC1CykB,aAAaf,EAAMlc,KAAK+Y,WAAWvgB,GAAGwgB,MAG1C,IAAIkD,EAAMhF,QAAS,CACf,GAAIgG,GAAShd,KAAKgX,QAAQhd,IAAI,UAC1BkV,EAAQ8N,EAAO1R,QAAQ0Q,EACb,QAAV9M,GAAkBA,GAAS,GAC3B8N,EAAO5d,OAAO8P,EAAO,SAItBtL,GAAMoY,EAAMlc,KAAKqG,KACxB6V,EAAQ,iCAGRS,GACA,GAAIT,GAAQhc,IASZ,OAPIyc,KACAT,EAAMtL,OACNsL,EAAMlc,KAAKqG,IAAMsW,EACjBT,EAAMlc,KAAKmY,QAAS,EACpB+D,EAAMrE,QAGH,kCAGNK,EAAQnH,GACT,GAAImL,GAAQhc,IAKZ,OAHsB,kBAAXgY,KAAuBnH,EAAWmH,GACxCA,GAA4B,kBAAXA,KAAuBA,EAAS,WAEjDgE,EAAMlc,KAAKmY,OAQX+D,EAAMlc,KAAKkY,OAAOA,IAKvBgE,EAAM9D,cAAc8D,EAAO,SAAUxO,GACjCA,EAAKwK,OAASA,CAEd,IAMmDI,GAN/CD,EAAO3K,EAAK2K,IAAM,EAAK3K,EAAK2K,IAAM6D,EAAMlc,KAAKkY,OAAOA,GAAQ,GAAK,IACjEzT,EAAWyX,EAAMlc,KAAKkY,OAAOA,GAAQ,GAAK,KAAQG,EAAM6D,EAAMlc,KAAKkY,OAAOA,GAAQ,GAAK,KACvFK,KAAU2D,EAAMlc,KAAKuY,OAAQ2D,EAAMlc,KAAKkY,OAAOA,GAAQ,IAEvDM,EAA+B,gBAAbzH,GAChBA,EACAtY,KAAKggB,MAAMC,KAAKvI,MAAQ1X,KAAK+F,UAAY,EAuB/C,OArBA,YACI,GAAIwB,IACAsD,GAAIkV,EACJN,OAAQA,EACRK,KAAMA,EAGVD,GAAUvF,WAAW;AACbwF,EACA2D,EAAMtL,KAAK5Q,EAAKsD,IAAImW,KAAKvB,EAAQlY,EAAKsD,IAEtC4Y,EAAMtL,KAAK5Q,EAAKsD,IAGpB4Y,EAAM/P,OAAOC,QAAQ,SAAUoM,IAC/B/T,EAAWyX,EAAMlc,KAAK8Y,KAAQ,KAElCoD,EAAMlc,KAAK+Y,WAAWtN,MAAMuN,MAAOV,EAAShV,GAAItD,EAAKsD,QAIjC,IAApBoK,EAAKyM,aAAqBzM,EAAKyM,YAAcgD,UAAUC,YACvD1P,EAAKpK,GAAKkV,EACV9K,EAAK2L,YAAchB,EAEnB3K,EAAKgN,MAAQwB,EAAMhF,QACZgF,EAAMhF,QAAQwD,OAAShN,EAAKgN,MAC5BwB,EAAMlc,KAAK0a,OAAShN,EAAKgN,MAEhChN,EAAK4L,OAAS4C,EAAMhF,QACdgF,EAAMlc,KAAKsZ,QAAU4C,EAAMhF,QAAQoC,OAAS,KAC5C4C,EAAMlc,KAAKsZ,OAEjBvG,WAAW,WACPrF,EAAK+L,QACN,GAqBPyC,EAAM/P,OAAOC,QAAQ,QACG,kBAAb2E,IAAyBA,EAASyH,GAEtC0D,IAtBHA,EAAMrD,eAAeL,GAErB,WACI,GAAI0D,GAAQA,EACRmB,EAAanF,EACbvf,EAAKoY,EACLuJ,EAAU5M,EAEV2O,EAAW,QAAXA,KACAH,EAAMzC,KAAK4D,EAAY1kB,GACvB2hB,EAAQxN,oBAAoB,iBAAkBuP,GAAU,GAG5D/B,GAAQhU,iBAAiB,iBAAkB+V,GAAU,MAGlDH,KASRA,IA7EqB,kBAAbnL,IAAyBA,IAC7BmL,IATPA,EAAM/P,OAAO6E,GAAG,OAAQ,WACpBkL,EAAMzC,KAAKvB,EAAQnH,KAGhBmL,kCAoFRxC,GAEH,MADAA,GAAW4D,SACJ,gCAGLha,GACF,GAAI4Y,GAAQhc,IAEZ,KAAKgc,EAAMlc,KAAKmY,OAIZ,MAHA+D,GAAM/P,OAAO6E,GAAG,OAAQ,WACpBkL,EAAMoB,MAAMha,KAET4Y,CAGXA,GAAMrD,eAAeqD,EAAO5Y,EAE5B,IAAIoW,GAAcpW,EAAM4Y,EAAMvD,UAAUrV,GAAM4Y,EAAMqB,YAAYrB,EAChE,IAAIxC,EAAY,CACZA,EAAWrB,IAAM6D,EAAM7D,IAAI,KAAM/U,EACjC,IAAIyL,GAASmN,EAAMsB,OAAO9D,EAC1B,IAAI3K,EAAQ,MAAOmN,GAKvB,MAFAA,GAAM/P,OAAOC,QAAQ,SAEd8P,gCAGLxC,GAKF,MAJKlI,OAAMkI,EAAWjV,YAClBiV,EAAW4D,QACX5D,EAAWL,YAAc,IAEtB,+BAGN/V,GACD,GAAI4Y,GAAQhc,IAEZ,KAAKgc,EAAMlc,KAAKmY,OAKZ,MAJA+D,GAAM/P,OAAO6E,GAAG,OAAQ,WACpBkL,EAAMtL,KAAKtN,KAGR4Y,CAGXA,GAAMrD,eAAeqD,EAAO5Y,EAE5B,IAAIoW,GAAcpW,EAAM4Y,EAAMvD,UAAUuD,EAAO5Y,GAAM4Y,EAAMqB,YAAYrB,EACvE,IAAIxC,EAAY,CACZA,EAAWrB,IAAM,CACjB,IAAItJ,GAASmN,EAAMuB,MAAM/D,EACzB,IAAI3K,EAAQ,MAAOmN,GAGvB,MAAOA,iCAGLxC,GACFA,EAAWgB,OAAQ,+BAGlBpX,GACD,GAAI4Y,GAAQhc,IAEZ,KAAKgc,EAAMlc,KAAKmY,OAIZ,MAHA+D,GAAM/P,OAAO6E,GAAG,OAAQ,WACpBkL,EAAMwB,KAAKpa,KAER4Y,CAGX,IAAIxC,GAAcpW,EAAM4Y,EAAMvD,UAAUrV,GAAM4Y,EAAMqB,YAAYrB,EAGhE,OAFIxC,IAAYwC,EAAMyB,QAEfzB,kCAGHxC,GACJA,EAAWgB,OAAQ,iCAGhBpX,GACH,GAAI4Y,GAAQhc,IAEZ,KAAKgc,EAAMlc,KAAKmY,OAIZ,MAHA+D,GAAM/P,OAAO6E,GAAG,OAAQ,WACpBkL,EAAM0B,OAAOta,KAEV4Y,CAGX,IAAIxC,GAAcpW,EAAM4Y,EAAMvD,UAAUrV,GAAM4Y,EAAMqB,YAAYrB,EAGhE,OAFIxC,IAAYwC,EAAM2B,UAEf3B,kCAGHxC,EAAYE,GAChBF,EAAWJ,OAASM,iCAGjBA,EAAKtW,GACR,GAAI4Y,GAAQhc,IAIZ,IAFA0Z,EAAMlI,WAAWkI,GAEbA,GAAO,GAAKA,GAAO,EAAG,CAGtB,GAFAsC,EAAMlc,KAAKsZ,OAASM,GAEfsC,EAAMlc,KAAKmY,OAIZ,MAHA+D,GAAM/P,OAAO6E,GAAG,OAAQ,WACpBkL,EAAM5C,OAAOM,EAAKtW,KAEf4Y,CAGX,IAAIxC,GAAcpW,EAAM4Y,EAAMvD,UAAUrV,GAAM4Y,EAAMqB,YAAYrB,EAQhE,OAPIxC,KACAE,EAAMsC,EAAMhF,QACN0C,GAAOsC,EAAMhF,QAAQoC,OAAS,KAC9B4C,EAAMlc,KAAKsZ,OACjB4C,EAAM4B,QAAQlE,IAGXsC,EAEX,MAAOA,GAAMlc,KAAKsZ,oCAGjBf,GACD,GAAI2D,GAAQhc,IAEZ,OAAoB,iBAATqY,IACP2D,EAAMlc,KAAKuY,KAAOA,EACX2D,GAEJA,EAAMlc,KAAKuY,oCAGfL,GACH,GAAIgE,GAAQhc,IAEZ,OAAsB,YAAlB,mBAAOgY,GAAP,YAAA1Y,EAAO0Y,KACPgE,EAAMlc,KAAKkY,OAASA,EACbgE,GAEJA,EAAMlc,KAAKkY,yCAGZwB,EAAYvhB,GAClB,MAAOuhB,GAAWL,wCAGlBhB,EAAK/U,GACL,GAAI4Y,GAAQhc,IAEZ,KAAKgc,EAAMlc,KAAKmY,OAIZ,MAHA+D,GAAM/P,OAAO6E,GAAG,OAAQ,WACpBkL,EAAM7D,IAAIA,KAEQ,gBAARA,GAAmB6D,EAAQA,EAAMlc,KAAKqY,KAAO,CAG/DA,GAAM3G,WAAW2G,EAEjB,IAAIqB,GAAcpW,EAAM4Y,EAAMvD,UAAUrV,GAAM4Y,EAAMqB,YAAYrB,EAChE,IAAIxC,EACA,MAAIrB,IAAO,GACP6D,EAAMoB,MAAMha,GACZoW,EAAWrB,IAAMA,EACjB6D,EAAMzC,KAAKC,EAAWxB,OAAQ5U,GACvB4Y,GAEAA,EAAM6B,UAAUrE,GAAY,EAEpC,IAAIrB,GAAO,EACd,MAAO6D,EAEP,KAAK,GAAI1jB,GAAI,EAAGA,EAAI0jB,EAAM/E,UAAU7e,OAAQE,IACxC,GAAI0jB,EAAM/E,UAAU3e,GAAGogB,QAA4C,IAAlCsD,EAAM/E,UAAU3e,GAAG2hB,WAChD,MAAO+B,GAAM6B,UAAU7B,EAAM/E,UAAU3e,IAAI,kCAMpDkhB,EAAYrY,EAAGE,EAAGyc,GACrB,MAAO,oCAGL3c,EAAGE,EAAGsY,EAAGvW,GACX,GAAI4Y,GAAQhc,IAKZ,IAHAqB,EAAkB,mBAANA,IAAsBA,EAASA,EAAJ,EACvCsY,EAAkB,mBAANA,IAAsBA,EAAYA,GAAP,IAElCqC,EAAMlc,KAAKmY,OAIZ,MAHA+D,GAAM/P,OAAO6E,GAAG,OAAQ,WACpBkL,EAAMpC,MAAMzY,EAAGE,EAAGsY,EAAGvW,KAElB4Y,CAGX,MAAI7a,GAAK,GAAKA,EAAI,GAId,MAAO6a,GAAMlc,KAAK8Z,KAHlB,IAAIJ,GAAcpW,EAAM4Y,EAAMvD,UAAUrV,GAAM4Y,EAAMqB,YAAYrB,EAMpE,OALIA,GAAM+B,OAAOvE,EAAYrY,EAAGE,EAAGsY,GAK5BqC,oCAIDA,EAAO5Y,GAGb,IAAK,GAFDoK,GAAOwO,EAAM/E,UAAU,GAElB3e,EAAI,EAAGA,EAAI0jB,EAAM/E,UAAU7e,OAAQE,IACxC,GAAI0jB,EAAM/E,UAAU3e,GAAG8K,KAAOA,EAAI,CAC9BoK,EAAOwO,EAAM/E,UAAU3e,EACvB,OAIR,MAAOkV,0CAGIwO,EAAO5Y,GAGlB,IAAK,GAFD8L,IAAQ,EAEH5W,EAAI,EAAGA,EAAI0jB,EAAMlc,KAAK+Y,WAAWzgB,OAAQE,IAC9C,GAAI0jB,EAAMlc,KAAK+Y,WAAWvgB,GAAG8K,KAAOA,EAAI,CACpC8L,EAAQ5W,CACR,OAIR,GAAIwgB,GAAQkD,EAAMlc,KAAK+Y,WAAW3J,EAC9B4J,KACAiE,aAAajE,EAAMA,OACnBkD,EAAMlc,KAAK+Y,WAAWzZ,OAAO8P,EAAO,wCAIhC8M,GAGR,IAAK,GAFDxO,GAAO,KAEFlV,EAAI,EAAGA,EAAI0jB,EAAM/E,UAAU7e,OAAQE,IACxC,IAAK0jB,EAAM/E,UAAU3e,GAAGogB,OAAQ,CAC5BlL,EAAOwO,EAAM/E,UAAU3e,EACvB,OAMR,MAFA0jB,GAAM7B,WAAW6B,GAEVxO,wCAGGwO,EAAOnL,GAGjB,IAAK,GAFDrD,GAAO,KAEFlV,EAAI,EAAGA,EAAI0jB,EAAM/E,UAAU7e,OAAQE,IACxC,GAAI0jB,EAAM/E,UAAU3e,GAAGogB,QAA4C,IAAlCsD,EAAM/E,UAAU3e,GAAG2hB,WAAkB,CAClEpJ,EAASmL,EAAM/E,UAAU3e,IACzBkV,GAAO,CACP,OAMR,GAFAwO,EAAM7B,WAAW6B,IAEbxO,EAAJ,CAEAwO,EAAMrE,MACN,IAAIyC,GAAU4B,EAAM/E,UAAU+E,EAAM/E,UAAU7e,OAAS,GACnD4lB,EAAgBf,UAAUC,WAAa,iBAAmB,iBAC1Df,EAAW,QAAXA,KACA/B,EAAQxN,oBAAoBoR,EAAe7B,GAAU,GACrDtL,EAASuJ,GAEbA,GAAQhU,iBAAiB4X,EAAe7B,GAAU,uCAG3CH,GAGP,IAAK,GAFD3B,GAAW,EAEN/hB,EAAI,EAAGA,EAAI0jB,EAAM/E,UAAU7e,OAAQE,IACpC0jB,EAAM/E,UAAU3e,GAAGogB,QAAQ2B,GAGnC,KAAK/hB,EAAI0jB,EAAM/E,UAAU7e,OAAS,EAAGE,GAAK,KAClC+hB,GAAY,GADyB/hB,IAGrC0jB,EAAM/E,UAAU3e,GAAGogB,SACnBsD,EAAM/E,UAAU7X,OAAO9G,EAAG,GAC1B+hB,oCAljBK0B,EAAAA,6CAEb3Y,GAAI,KACJ+C,OACAmU,OAAQ,KACRC,UAAU,EAEVhW,SAAU,EACV8T,MAAM,EACNL,UACAoB,OAAQ,EACRoB,OAAO,EACPZ,OAAQ,EAAG,GAAG,IAEd3B,QAAQ,EACRY,2BAfakD,osBCPAkC,EAAAA,yGACN,oDAGP,MAAOje,MAAKke,0EAMPhP,oCAGDA,uBAbS+O,0tDCJRE,EAAAA,EAAAA,aAAe,WAEPC,EAAAA,SAAAA,GAejB,QAAAA,GAAYrI,GAAMhW,EAAAC,KAAAoe,EAAA,IAAAva,GAAA5D,EAAAD,MAAAoe,EAAAle,WAAAX,OAAAY,eAAAie,IAAAnf,KAAAe,MACPoD,GAAAA,GAAO+a,EAAepI,IADf,OAAAxW,QAAA2J,eAAArF,EAAA,aAAAsF,YAAA,EAAAC,UAAA,EAAA1F,OAZN,IAYMnE,OAAA2J,eAAArF,EAAA,aAAAsF,YAAA,EAAAC,UAAA,EAAA1F,WAED,WAATqS,IAAmBlS,EAAKwa,WAAY,GAF1Bxa,+CARdnE,GACA,MAAOM,MAAKgW,OAAL,GAAemI,EAAeze,IAAUM,KAAKgW,OAAOtW,IAAQ,iCAGnEA,GACA,MAAgDxF,UAAzC8F,KAAKgW,OAAL,GAAemI,EAAeze,IAA6CxF,SAArB8F,KAAKgW,OAAOtW,sCAQzE8N,EAAM0B,GAEN,GADAA,EAAkBhV,SAAVgV,EAAsBlP,KAAK2Q,QAAU3Q,KAAKse,KAAK,QAAUpP,EAC7D1B,EAAK0I,WAAWkI,IAAUpe,KAAKqe,UAAW,CAC1C,GAAkCnkB,SAA9B8F,KAAKue,UAAU/Q,EAAKuI,MACpB,KAAM,IAAAzD,GAAAvW,QAAA,gDAAqEyR,EAAKuI,KAA1E,IAEV/V,MAAKue,UAAU/Q,EAAKuI,MAAQvI,EAC5BxN,KAAKgW,OAAOxI,EAAKuI,MAAQvI,EACzBxN,KAAKgW,OAAO5W,OAAO8P,EAAO,EAAG1B,OAE1B,CAAA,GAAIA,EAAK0I,WAAWkI,KAAWpe,KAAKqe,UACvC,MAAM,EAAA/L,EAAAvW,SAAiB,gDAChByR,GAAK0I,WAALsI,EAAAziB,UAA6BiE,KAAKqe,UACzCre,KAAKgW,OAAOhW,KAAKse,KAAK,SAAS/N,IAAI/C,GAC5BA,EAAK0I,WAALsI,EAAAziB,WAA8BiE,KAAKqe,WAC1C/R,EAAA8R,EAAArf,UAAAmB,WAAAX,OAAAY,eAAAie,EAAArf,WAAA,MAAAiB,MAAAf,KAAAe,KAAUwN,GAEd,MAAOxN,qCAGJwN,GAKH,MAJIA,GAAK0I,WAAWkI,UACTpe,MAAKue,UAAU/Q,EAAKuI,MAE/BzJ,EAAA8R,EAAArf,UAAAmB,WAAAX,OAAAY,eAAAie,EAAArf,WAAA,SAAAiB,MAAAf,KAAAe,KAAawN,GACNxN,qCAIP,MAAOA,MAAKgW,OAAO5d,oCAGlBsH,GACD,GAAI8N,GAAOxN,KAAKgW,OAAL,GAAemI,EAAeze,EACzC,OAAK8N,GACExN,KAAKgW,OAAO1K,QAAQkC,GADT,6CAtDL4Q,EAAAA,8CACE,cADFA,u7BCMjBtC,EAAYzR,OAAO0R,MACnBvF,GAAe,EACfiI,GAAa,CAEjB,KAEI,GAAItH,GAAe9M,OAAO8M,cAAgB9M,OAAO+M,kBACjDZ,GAAe,GAAIW,GACrB,MAAOvM,GACL0J,QAAQiI,KAAK,kDAGjB,IAEIkC,IAAe,GAAI3C,GACrB,MAAOlR,GACL0J,QAAQiI,KAAK,gDAGjB,GAAI/F,EAAc,CACd,GAAIC,GAA0Cvc,SAA5Bsc,EAAaE,WACzBF,EAAaG,iBACbH,EAAaE,YACnBD,GAAWG,KAAKlT,MAAQ,EACxB+S,EAAWI,QAAQL,EAAaM,gBAaf4H,GAAAA,WAQjB,QAAAA,GAAYC,EAAK7e,GAcb,GAdmBC,EAAAC,KAAA0e,GACNxkB,SAAT4F,IAAoBA,MACxBE,KAAK2e,IAAMA,EACX3e,KAAKF,KAAOM,EAAArE,QAAW6D,QAAO,KAAU8e,EAAape,SAAUR,GAC/DE,KAAKiM,OAAS,GAAAwB,GAAA1R,QACdiE,KAAK0X,MAAQ,GAAAkH,GAAA7iB,QAEbiE,KAAK0X,MAAMnH,IAAI,SAAU,GAAAqO,GAAA7iB,SACzBiE,KAAK0X,MAAMnH,IAAI,SAAU,GAAAqO,GAAA7iB,SACzBiE,KAAK0X,MAAMnH,IAAI,SAAU,GAAAqO,GAAA7iB,SAEzBiE,KAAKoZ,OAA4B,IAAnBpZ,KAAKF,KAAKsZ,OACxBpZ,KAAK6e,YAAa,EAEdrI,GAAgBiI,EAAY,CAC5B,GAAI9D,GAAO,GAAImB,EACf9b,MAAKF,KAAKgf,QACNC,MAAOpE,EAAKqE,YAAY,eAAelc,QAAQ,OAAQ,IACvDmc,OAAQtE,EAAKqE,YAAY,4BAA4Blc,QAAQ,OAAQ,IACrEoc,MAAOvE,EAAKqE,YAAY,8BAA8Blc,QAAQ,OAAQ,IACtEqc,MAAOxE,EAAKqE,YAAY,yBAAyBlc,QAAQ,OAAQ,IACjEsc,MAAOzE,EAAKqE,YAAY,cAAclc,QAAQ,OAAQ,IACtDuc,OAAQ1E,EAAKqE,YAAY,iBAAmBrE,EAAKqE,YAAY,eAAiBrE,EAAKqE,YAAY,eAAelc,QAAQ,OAAQ,IAC9Hwc,OAAQ3E,EAAKqE,YAAY,iBAAmBrE,EAAKqE,YAAY,eAAiBrE,EAAKqE,YAAY,eAAelc,QAAQ,OAAQ,IAC9Hyc,OAAQ5E,EAAKqE,YAAY,+BAA+Blc,QAAQ,OAAQ,KAE5E6X,EAAO,0DA2FX,MAAOnE,2CAIP,MAAOC,kCAKP,MADAzW,MAAKwa,OAAQ,EACNxa,sCAKP,MADAA,MAAKwa,OAAQ,EACNxa,4CAGIwf,GACX,QAASxf,KAAKF,KAAKgf,OAAOU,oCAGrB1f,GAEL,MADA,IAAIiX,OAAMjX,EAAME,MACTA,sCAGFF,GAEL,MADA,IAAIic,OAAMjc,EAAME,MACTA,sCAGFF,GAEL,MAAOE,oCAOLoD,GACF,MAAOpD,MAAK0X,MAAM1d,IAAI,UAAUA,IAAIoJ,iCAGlCA,GACF,MAAOpD,MAAK0X,MAAM1d,IAAI,UAAUA,IAAIoJ,iCAGlCA,GACF,MAAOpD,MAAK0X,MAAM1d,IAAI,UAAUA,IAAIoJ,uCAG5BA,GAKR,MAJIpD,MAAK0X,MAAM1d,IAAI,UAAUkY,SAAS9O,KAClCpD,KAAK0X,MAAM1d,IAAI,UAAUA,IAAIoJ,GAAIsN,OACjC1Q,KAAK0X,MAAM1d,IAAI,UAAUyW,OAAOrN,IAE7BpD,yCAGCoD,GAKR,MAJIpD,MAAK0X,MAAM1d,IAAI,UAAUkY,SAAS9O,KAClCpD,KAAK0X,MAAM1d,IAAI,UAAUA,IAAIoJ,GAAIsN,OACjC1Q,KAAK0X,MAAM1d,IAAI,UAAUyW,OAAOrN,IAE7BpD,yCAGCoD,GAKR,MAJIpD,MAAK0X,MAAM1d,IAAI,UAAUkY,SAAS9O,KAClCpD,KAAK0X,MAAM1d,IAAI,UAAUA,IAAIoJ,GAAIsN,OACjC1Q,KAAK0X,MAAM1d,IAAI,UAAUyW,OAAOrN,IAE7BpD,oCA/JP,MAA0B,KAAnBA,KAAKF,KAAKsZ,qBAGV1V,GAGP,GAFA1D,KAAKF,KAAKsZ,OAAS5H,WAAW9N,EAAQ,KAElCA,GAAS,GAAKA,GAAS,EACvB,GAAI8S,EACAC,EAAWG,KAAKlT,MAAQ1D,KAAKF,KAAKsZ,WAC/B,CACH,GAAIqG,GAASzf,KAAK0X,MAAM1d,IAAI,SAC5B,KAAK,GAAI0F,KAAO+f,GACZ,GAAIA,EAAO9f,eAAeD,KAAS+f,EAAO/f,GAAKggB,SAC3C,IAAK,GAAIpnB,GAAI,EAAGA,EAAImnB,EAAO/f,GAAKuX,UAAU7e,OAAQE,IAC9CmnB,EAAO/f,GAAKuX,UAAU3e,GAAG8gB,OAASqG,EAAO/f,GAAK0Z,OAASpZ,KAAKF,KAAKsZ,MAI7EqG,GAAS,oCAMjB,QAASzf,KAAKF,KAAK0a,oBAGb9W,GAGN,GAFA1D,KAAKF,KAAK0a,QAAU9W,EAEhB8S,EACAC,EAAWG,KAAKlT,MAAQ1D,KAAKF,KAAK0a,MAAQ,EAAIxa,KAAKF,KAAKsZ,WACrD,CACH,GAAIqG,GAASzf,KAAK0X,MAAM1d,IAAI,SAC5B,KAAK,GAAI0F,KAAO+f,GACZ,GAAIA,EAAO9f,eAAeD,IAAQ+f,EAAO/f,GAAKggB,YAAa,EACvD,IAAK,GAAIpnB,GAAI,EAAGA,EAAImnB,EAAO/f,GAAKuX,UAAU7e,OAAQE,IAC9CmnB,EAAO/f,GAAKuX,UAAU3e,GAAGkiB,MAAQxa,KAAKF,KAAK0a,KAIvDiF,GAAS,wCAKb,QAASzf,KAAKF,KAAK0X,4BAGT9T,GACV,GAAI8S,IAAiBxW,KAAK6e,aAAe,oBAAoBlE,KAAKsC,UAAU0C,YACxE,MAAOjc,EAEX1D,MAAK6e,YAAa,CAElB,IAAIe,GAAS,QAATA,KACA,GAAItI,GAASd,EAAatR,aAAa,EAAG,EAAG,OACzCuX,EAASjG,EAAaoF,oBAC1Ba,GAAOnF,OAASA,EAChBmF,EAAO5F,QAAQL,EAAaM,aAEP5c,SAAjBuiB,EAAO7X,MACP6X,EAAOoD,OAAO,GAEdpD,EAAO7X,MAAM,GAGjBiO,WAAW,WACF4J,EAAOqD,gBAAkBrD,EAAOsD,eAC9BtD,EAAOqD,gBAAkBrD,EAAOuD,iBACnChgB,KAAK6e,YAAa,EAClB7e,KAAKF,KAAK0X,eAAgB,EAE1BnN,OAAOuC,oBAAoB,WAAYgT,GAAQ,KAEpD,GAEPvV,QAAOjE,iBAAiB,WAAYwZ,GAAQ,0CAI5C,OAAQpJ,IAAiBiI,iCAxHZC,EAAAA,6CAEbtF,OAAQ,EACRoB,OAAO,EACPsE,UACAtH,eAAe,eALFkH,goBC0PrB,QAASuB,QAAOxgB,EAAQiE,GACpB,MAAOnE,QAAO6L,KAAK3L,GAAQygB,OAAO,SAAUxgB,GACxC,MAAOD,GAAOC,KAASgE,IACxB,wZAtSHyc,YAAc,QAAdA,aAAwBvV,EAAGwV,gBACJlmB,SAAnBkmB,iBAA8BA,gBAAiB,EAEnD,IAAIzB,KAAM/T,EAAE9K,KAAKkX,QAAQ2H,IACrB3H,QAAUpM,EAAE9K,KAAKkX,QACjBjM,QAAUH,EAAEyV,MACZC,OAAS1V,EAAE9K,KAAKkX,QAAQsJ,MAE5B,KAAK,GAAIpR,SAASoR,QACd,GAAIA,OAAO3gB,eAAeuP,OAAQ,CAC9B,GAAIxL,OAAQ4c,OAAOpR,MACnB,KAAKqR,EAAEC,QAAQ9c,MAAM,KAAOA,MAAM,KAAOqH,SAAarH,MAAM,GAOxD,MANwB,gBAAbA,OAAM,KACbA,MAAM,GAAK+c,KAAK,IAAM/c,MAAM,GAAK,MAEZ,kBAAbA,OAAM,IAAsB0c,gBACpC1c,MAAM,GAAGib,IAAKjb,MAAM,KAEjB,CACJ,IAAI6c,EAAEC,QAAQ9c,MAAM,KACpBsT,QAAQlX,KAAK4gB,YAAYzO,OAAOvO,MAAM,KAASA,MAAM,GAQxD,MANwB,gBAAbA,OAAM,KACbA,MAAM,GAAK+c,KAAK,IAAM/c,MAAM,GAAK,MAEb,kBAAbA,OAAM,IAAqB0c,gBAClC1c,MAAM,GAAGib,IAAKjb,MAAM,KAEjB,EAInB,OAAO,GAEPuI,QACA0U,aAAc,SAAU/V,GACpB,GAAIoM,GAAUpM,EAAE9K,KAAKkX,OACrB,KAAKA,EAAQlX,KAAK8gB,UAAY5J,EAAQ2H,IAAIkC,SAAW7J,EAAQ2H,IAAImC,QAAQC,SAAS,UAAW,OAAO,CACpG,IAAIL,GAAc1J,EAAQlX,KAAK4gB,YAC3B3V,EAAUkV,OAAOe,wBAAwBthB,IAAKkL,EAAEyV,QAAU,eAAiBzV,EAAEyV,MAC7EY,EAAQjK,EAAQlX,KAAKmhB,KAEJ,KAAjBrW,EAAE9K,KAAK8Q,OACc,IAAjBhG,EAAE9K,KAAK8Q,QACH,IAAO2P,EAAEW,QAAQF,wBAAwBthB,IAAIqL,GAAU2V,KACvDA,EAAYnV,KAAKyV,wBAAwBthB,IAAIqL,IAEzCiM,EAAQlX,KAAKqhB,uBACbF,EAAMG,cAAcjgB,EAAIyJ,EAAEc,MAC1BuV,EAAMG,cAAc/f,EAAIuJ,EAAEe,MAC1BsV,EAAMvW,SAAW,EAEjBsM,EAAQlX,KAAKuhB,YAAczW,EAAEoB,aAGjCmU,YAAYvV,GAAG,IAAUoM,EAAQlX,KAAKwhB,aACtC1W,EAAEE,oBAGFqV,YAAYvV,IAAMoM,EAAQlX,KAAKwhB,aAC/B1W,EAAEE,iBAEFkM,EAAQlX,KAAKqhB,uBACbF,EAAMM,iBAAmBN,EAAMvW,SAC/BuW,EAAMG,cAAcjgB,EAAI,EACxB8f,EAAMG,cAAc/f,EAAI,GAG5Bqf,EAAYthB,OACRshB,EAAYpV,QAAQ0V,wBAAwBthB,IAAIqL,IAAW,IAGnEiM,EAAQ8J,QAAQ5U,QAAyB,IAAjBtB,EAAE9K,KAAK8Q,MAC3B,eAAiB,cAAe7F,QAASA,KAGzCoV,YAAYvV,GAAG,IACfA,EAAEE,kBAKd0W,aAAc,SAAU5W,GACpB,GAAIoM,GAAUpM,EAAE9K,KAAKkX,OACrB,KAAKA,EAAQlX,KAAK8gB,UAAY5J,EAAQ2H,IAAIkC,SAAW7J,EAAQ2H,IAAImC,QAAQC,SAAS,UAAW,OAAO,CACpG,IAAIL,GAAc1J,EAAQlX,KAAK4gB,YAC3B3V,EAAWH,EAAE6W,cAAcpV,WAAa,IAAM,EAC9C4T,OAAOe,wBAAwBthB,IAAK,GAAKugB,OAAOe,wBAAwBthB,IAAK,EAEjFkL,GAAEyV,MAASzV,EAAE6W,cAAcpV,WAAa,IAAM,EAAK,EAAI,GAEnD,IAAOkU,EAAEW,QAAQF,wBAAwBthB,IAAIqL,GAAU2V,IACvDA,EAAYnV,KAAKyV,wBAAwBthB,IAAIqL,KAG7CoV,YAAYvV,IAAMoM,EAAQlX,KAAKwhB,cAC/B1W,EAAEE,iBACFkM,EAAQ0K,iBAGZ1K,EAAQ8J,QAAQ5U,QAAQ,cAAenB,QAASA,KAGpD4W,iBAAkB,SAAUjB,EAAa3V,GACrC2V,EAAYthB,OACRshB,EAAYpV,QAAQ0V,wBAAwBthB,IAAIqL,IAAW,IAInE6W,YAAa,SAAUhX,GACnB,GAAIoM,GAAUpM,EAAE9K,KAAKkX,QACjBiK,EAAQrW,EAAE9K,KAAKkX,QAAQlX,KAAKmhB,KAEhCjK,GAAQlX,KAAKmhB,MAAMY,gBAAgB1gB,EAAIyJ,EAAEc,MACzCsL,EAAQlX,KAAKmhB,MAAMY,gBAAgBxgB,EAAIuJ,EAAEe,MAErCf,EAAE9K,KAAKkX,QAAQlX,KAAKqhB,uBACpBF,EAAMvW,SAAWnS,KAAKiD,KAClBjD,KAAKQ,IAAKkoB,EAAMY,gBAAgB1gB,EAAI8f,EAAMG,cAAcjgB,EAAI,GAC1D5I,KAAKQ,IAAKkoB,EAAMY,gBAAgBxgB,EAAI4f,EAAMG,cAAc/f,EAAI,IAChE+K,QAAQ,KAIlB0V,gBAAiB,SAAUlX,GACvB,GAAIoM,GAAUpM,EAAE9K,KAAKkX,OACrB,KAAKA,EAAQlX,KAAK8gB,UAAY5J,EAAQ2H,IAAIkC,SAAW7J,EAAQ8J,QAAQC,SAAS,UAAW,OAAO,CAChG,IAAIL,GAAc1J,EAAQlX,KAAK4gB,YAC3B3V,EAAUkV,OAAOe,wBAAwBthB,IAAKkL,EAAEyV,QAAU,eAAiBzV,EAAEyV,KACjF,IAAqB,IAAjBzV,EAAE9K,KAAK8Q,QAAe,IAASoG,EAAQlX,KAAKiiB,UAAW,CACvD,GAAIC,GAAOvN,OAAOwN,aAAarX,EAAEyV,OAASzV,EAAEG,QAC5CH,GAAEE,iBACFkM,EAAQ8J,QAAQoB,QAAQhW,QAAQ,qBAC5BxM,IAAKkL,EAAEyV,OAASzV,EAAEG,QAClBA,QAASA,EACTiX,KAAMA,IAIO,IAAjBpX,EAAE9K,KAAK8Q,QAAe,IAAUoG,EAAQlX,KAAKiiB,YACxB,IAAjBnX,EAAE9K,KAAK8Q,QACH,IAAO2P,EAAEW,QAAQF,wBAAwBthB,IAAIqL,GAAU2V,KACvDA,EAAYnV,KAAKyV,wBAAwBthB,IAAIqL,IACzCiM,EAAQlX,KAAKqhB,uBACbnK,EAAQlX,KAAKuhB,YAAczW,EAAEoB,aAGjCmU,YAAYvV,GAAG,IAAUoM,EAAQlX,KAAKwhB,aACtC1W,EAAEE,oBAGFqV,YAAYvV,IAAMoM,EAAQlX,KAAKwhB,aAC/B1W,EAAEE,iBAGN4V,EAAYthB,OACRshB,EAAYpV,QAAQ0V,wBAAwBthB,IAAIqL,IAAW,IAInEiM,EAAQ8J,QAAQ5U,QAAyB,IAAjBtB,EAAE9K,KAAK8Q,MAC3B,kBAAoB,iBAAkB7F,QAASA,EAASrL,IAAKkL,EAAEyV,OAASzV,EAAEG,WAI7D,IAAjBH,EAAE9K,KAAK8Q,QAAe,IAASoG,EAAQlX,KAAKiiB,WAC5C/K,EAAQ8J,QAAQ5U,QAAyB,IAAjBtB,EAAE9K,KAAK8Q,MAC3B,kBAAoB,iBAAkB7F,QAASA,EAASrL,IAAKkL,EAAEyV,OAASzV,EAAEG,WAKtFoX,WAAY,SAAUvX,GAClB,GAAIoM,GAAUpM,EAAE9K,KAAKkX,OACrB,KAAKA,EAAQlX,KAAK8gB,UAAY5J,EAAQ2H,IAAIkC,SAAW7J,EAAQ2H,IAAImC,QAAQC,SAAS,UAAW,OAAO,CACpG,IAAIL,GAAc1J,EAAQlX,KAAK4gB,YAC3B3V,EAAUkV,OAAOe,wBAAwBthB,IAAKkL,EAAEyV,MAAQ,IAAM,eAAiBzV,EAAEyV,MACjF+B,EAAQxX,EAAE6W,cAAcY,QAAQ,IAAMzX,EAAE6W,cAAca,eAAe,GACrErB,EAAQjK,EAAQlX,KAAKmhB,KAEJ,KAAjBrW,EAAE9K,KAAK8Q,QACH,IAAO2P,EAAEW,QAAQF,wBAAwBthB,IAAIqL,GAAU2V,KACvDA,EAAYnV,KAAKyV,wBAAwBthB,IAAIqL,IACzCiM,EAAQlX,KAAKqhB,uBACbF,EAAMG,cAAcjgB,EAAIihB,EAAM1W,MAC9BuV,EAAMG,cAAc/f,EAAI+gB,EAAMzW,MAC9BsV,EAAMvW,SAAW,EAEjBsM,EAAQlX,KAAKuhB,YAAczW,EAAEoB,aAGjCmU,YAAYvV,GAAG,IAAUoM,EAAQlX,KAAKwhB,aACtC1W,EAAEE,oBAGFqV,YAAYvV,IAAMoM,EAAQlX,KAAKwhB,aAC/B1W,EAAEE,iBAGFkM,EAAQlX,KAAKqhB,uBACbF,EAAMM,iBAAmBN,EAAMvW,SAC/BuW,EAAMG,cAAcjgB,EAAI,EACxB8f,EAAMG,cAAc/f,EAAI,GAG5Bqf,EAAYthB,OACRshB,EAAYpV,QAAQ0V,wBAAwBthB,IAAIqL,IAAW,IAInEiM,EAAQ8J,QAAQ5U,QAAyB,IAAjBtB,EAAE9K,KAAK8Q,MAC3B,eAAiB,cAAe7F,QAASA,KAIjDwX,YAAa,SAAU3X,GACnB,GAAIwX,GAAQxX,EAAE6W,cAAcY,QAAQ,IAAMzX,EAAE6W,cAAca,eAAe,GACrErB,EAAQrW,EAAE9K,KAAKkX,QAAQlX,KAAKmhB,KAEhCA,GAAMY,gBAAgB1gB,EAAIihB,EAAM1W,MAAMU,QAAQ,GAC9C6U,EAAMY,gBAAgBxgB,EAAI+gB,EAAMzW,MAAMS,QAAQ,GAE1CxB,EAAE9K,KAAKkX,QAAQlX,KAAKqhB,uBACpBF,EAAMvW,SAAWnS,KAAKiD,KAClBjD,KAAKQ,IAAKkoB,EAAMY,gBAAgB1gB,EAAI8f,EAAMG,cAAcjgB,EAAI,GAC1D5I,KAAKQ,IAAKkoB,EAAMY,gBAAgBxgB,EAAI4f,EAAMG,cAAc/f,EAAI,IAChE+K,QAAQ,MAQlBoW,WAAa,SAAUxL,GACvB,GAAIyL,GAAW,SAAWzL,EAAQ5T,GAAK,GAEvCmd,GAAEjW,UAAUwG,GAAG,cAAe2R,GAAWzL,QAASA,EAASpG,MAAO,GAAI3E,OAAO0U,cAC7EJ,EAAEjW,UAAUwG,GAAG,YAAa2R,GAAWzL,QAASA,EAASpG,MAAO,GAAI3E,OAAO0U,cAC3EJ,EAAEjW,UAAUwG,GAAG,UAAW2R,GAAWzL,QAASA,EAASpG,MAAO,GAAI3E,OAAO0U,cACzEJ,EAAEjW,UAAUwG,GAAG,aAAc2R,GAAWzL,QAASA,GAAU/K,OAAOuV,cAClEjB,EAAEjW,UAAUwG,GAAG,YAAa2R,GAAWzL,QAASA,GAAU/K,OAAO2V,aAEjErB,EAAEjW,UAAUwG,GAAG,UAAW,MAAOkG,QAASA,EAASpG,MAAO,GAAI3E,OAAO6V,iBACrEvB,EAAEjW,UAAUwG,GAAG,QAAS,MAAOkG,QAASA,EAASpG,MAAO,GAAI3E,OAAO6V,iBACnEvB,EAAEjW,UAAUwG,GAAG,WAAY,MAAOkG,QAASA,EAASpG,MAAO,GAAI3E,OAAO6V,iBAEtEvB,EAAEjW,UAAUwG,GAAG,aAAc2R,GAAWzL,QAASA,EAASpG,MAAO,GAAI3E,OAAOkW,YAC5E5B,EAAEjW,UAAUwG,GAAG,WAAY2R,GAAWzL,QAASA,EAASpG,MAAO,GAAI3E,OAAOkW,YAC1E5B,EAAEjW,UAAUwG,GAAG,aAAc2R,GAAWzL,QAASA,GAAU/K,OAAOsW,cAMlEG,aAAe,SAAU1L,GACzB,GAAIyL,GAAW,SAAWzL,EAAQ5T,GAAK,GAEvCmd,GAAEjW,UAAUyG,IAAI,cAAe0R,GAAWzL,QAASA,EAASpG,MAAO,GAAI3E,OAAO0U,cAC9EJ,EAAEjW,UAAUyG,IAAI,YAAa0R,GAAWzL,QAASA,EAASpG,MAAO,GAAI3E,OAAO0U,cAC5EJ,EAAEjW,UAAUyG,IAAI,UAAW0R,GAAWzL,QAASA,EAASpG,MAAO,GAAI3E,OAAO0U,cAC1EJ,EAAEjW,UAAUyG,IAAI,aAAc0R,GAAWzL,QAASA,GAAU/K,OAAOuV,cACnEjB,EAAEjW,UAAUyG,IAAI,YAAa0R,GAAWzL,QAASA,GAAU/K,OAAO2V,aAElErB,EAAEjW,UAAUyG,IAAI,UAAW,MAAOiG,QAASA,EAASpG,MAAO,GAAI3E,OAAO6V,iBACtEvB,EAAEjW,UAAUyG,IAAI,QAAS,MAAOiG,QAASA,EAASpG,MAAO,GAAI3E,OAAO6V,iBACpEvB,EAAEjW,UAAUyG,IAAI,WAAY,MAAOiG,QAASA,EAASpG,MAAO,GAAI3E,OAAO6V,iBAEvEvB,EAAEjW,UAAUyG,IAAI,aAAc0R,GAAWzL,QAASA,EAASpG,MAAO,GAAI3E,OAAOkW,YAC7E5B,EAAEjW,UAAUyG,IAAI,WAAY0R,GAAWzL,QAASA,EAASpG,MAAO,GAAI3E,OAAOkW,YAC3E5B,EAAEjW,UAAUyG,IAAI,aAAc0R,GAAWzL,QAASA,GAAU/K,OAAOsW,cAQnEI,aAAe,SAAU3L,EAAS4L,GAClC,OAAK5L,EAAQlX,KAAKqhB,uBAEdyB,QAASA,EACT3U,KAAMuK,KAAKvI,MAAQ+G,EAAQlX,KAAKuhB,cAwBnBL,wBAAAA,WACjB,QAAAA,GAAYrC,GAAK5e,gBAAAC,KAAAghB,GACbhhB,KAAK2e,IAAMA,EAGX3e,KAAKoD,GAAKub,EAAI7e,KAAKsD,GAGnBpD,KAAK8gB,QAAUnC,EAAImC,QAEnB9gB,KAAKF,MACDmhB,OACIG,eACIjgB,EAAG,EACHE,EAAG,GAEPwgB,iBACI1gB,EAAG,EACHE,EAAG,GAEPkgB,iBAAkB,EAClB7W,SAAU,GAEdjK,UACImB,UACIT,EAAG,EACHE,EAAG,IAGXuf,SAAS,EACTO,sBAAsB,EACtBT,YAAa,GAAA9B,YAAA7iB,QACbgmB,WAAW,EACXV,YAAa,EACbC,YAAY,EAEZlX,QACIwW,SAAS,EACT3a,MAAO,SAIfjG,KAAKsgB,QAEDuC,aAAc7B,EAAwBthB,IAAIojB,SAAU9B,EAAwBthB,IAAIqjB,SAAU,sFAa9F,OALK/iB,KAAKF,KAAK8gB,SAAWvW,OAAO2Y,UAAUC,aACvCT,WAAWxiB,MAEXA,KAAKF,KAAK8gB,SAAU,GAEjB5gB,sCAOP,IAAKA,KAAKF,KAAK8gB,QAAS,OAAO,CAE/B,IAAIsC,GAAKljB,KAAK2e,IAAIhY,MAAMyB,OAAO+a,YAAcnjB,KAAK2e,IAAIhY,MAAM7G,KAAKkJ,MAC7Doa,EAAKpjB,KAAK2e,IAAIhY,MAAMyB,OAAOib,aAAerjB,KAAK2e,IAAIhY,MAAM7G,KAAKmJ,OAC9D9H,EAAInB,KAAKF,KAAKmhB,MAAMY,gBAAgB1gB,EAAI+hB,EACxC7hB,EAAIrB,KAAKF,KAAKmhB,MAAMY,gBAAgBxgB,EAAI+hB,EAExChiB,EAASpB,KAAK8gB,QAAQ1f,QAI1B,OAFApB,MAAKF,KAAKW,SAASU,EAAInB,KAAK2e,IAAIhY,MAAMlG,SAASU,EAAIA,EAAIC,EAAOkiB,KAC9DtjB,KAAKF,KAAKW,SAASY,EAAIrB,KAAK2e,IAAIhY,MAAMlG,SAASY,EAAIA,EAAID,EAAOmiB,KACvD,kCAQP,MADAvjB,MAAKF,KAAK4gB,YAAYtoB,OAAS,EACxB4H,qCAOP,MAAOA,8CAOP,GAAIwjB,GAAaxjB,KAAKF,KAAK4gB,WAM3B,QALI,IAAOH,EAAEW,QAAQF,EAAwBthB,IAAI+jB,gBAAiBD,GAC9DvX,OAAO0V,iBAAiB6B,EAAYxC,EAAwBthB,IAAI+jB,kBACzD,IAAOlD,EAAEW,QAAQF,EAAwBthB,IAAIgkB,kBAAmBF,IACvEvX,OAAO0V,iBAAiB6B,EAAYxC,EAAwBthB,IAAIgkB,mBAE7D1jB,sCAWP,MAJKA,MAAKF,KAAK8gB,UAEX5gB,KAAKF,KAAK8gB,SAAU,GAEjB5gB,uCAWP,MAJIA,MAAKF,KAAK8gB,UAEV5gB,KAAKF,KAAK8gB,SAAU,GAEjB5gB,kCAON2jB,GACD,GAAIC,GAAY7P,KAAKC,UAAUhU,KAAKsgB,OAEpC,OADAtgB,MAAKsgB,OAASvM,KAAK8P,MAAMF,GAClBC,iCAOP,MAAO7P,MAAKC,UAAUhU,KAAKsgB,wCASvBwD,GAEJ,MADA9jB,MAAKsgB,OAASC,EAAE3gB,QAAO,KAAUI,KAAKsgB,OAAQwD,GACvC9jB,oDAOP,MAAKA,MAAKF,KAAKqhB,sBACP4C,QAAS/jB,KAAKF,KAAKmhB,MAAMvW,SAAUsZ,SAAUhkB,KAAKF,KAAKmhB,MAAMM,kBADzB,8CAS5BqB,GAChB,MAAIrC,GAAEC,QAAQoC,GACNA,EAAQxqB,SAAW4H,KAAKF,KAAK4gB,YAAYtoB,SAElC4H,KAAKF,KAAK4gB,YAAYzO,OAAO2Q,IACpC5iB,KAAK0hB,gBACEiB,aAAa3iB,KAAM4iB,KAE9B5iB,KAAK0hB,iBACE,KAGPpQ,MAAMsR,MACN,IAAO5iB,KAAKF,KAAK4gB,YAAYpV,QAAQsX,IACrC5iB,KAAK0hB,gBACEiB,aAAa3iB,KAAM4iB,KAE9B5iB,KAAK0hB,iBACE,+CAOQhiB,GACf,GAAyBxF,SAArB8F,KAAKsgB,OAAO5gB,GAAoB,OAAO,CAC3C,IAAIkjB,GAAU5iB,KAAKsgB,OAAO5gB,GAAK,EAE/B,OAAOM,MAAKikB,oBAAoBrB,yCAIhC,MAAO,IAAArf,YAAAxH,QAAaiE,KAAKF,KAAKW,SAASU,EAAI,GAAKnB,KAAKF,KAAKW,SAASY,EAAI,yCAe9D6iB,GAET,MADAlkB,MAAKF,KAAKiiB,YAAcmC,EACjBlkB,2CAOP,QAASA,KAAKF,KAAKiiB,iDASR9b,GAGX,MAFAjG,MAAKF,KAAKsK,OAAOnE,MAAQ,QAAUA,EAAQ,WAC3Csa,EAAEvgB,KAAK8gB,SAASqD,IAAI,SAAUnkB,KAAKF,KAAKsK,OAAOnE,OACxCjG,0CAOEokB,GAaT,MAZelqB,UAAXkqB,EACApkB,KAAKF,KAAKsK,OAAOga,SAAWA,EAE5BpkB,KAAKF,KAAKsK,OAAOga,QAAUpkB,KAAKF,KAAKsK,OAAOga,OAG3CpkB,KAAKF,KAAKsK,OAAOga,OAIlB7D,EAAEvgB,KAAK8gB,SAASqD,IAAI,SAAUnkB,KAAKF,KAAKsK,OAAOnE,QAH/CjG,KAAKF,KAAKsK,OAAOnE,MAAQsa,EAAEvgB,KAAK2e,IAAImC,SAASqD,IAAI,UACjD5D,EAAEvgB,KAAK8gB,SAASqD,IAAI,SAAU,SAI3BnkB,+CAOP,QAASA,KAAKF,KAAKsK,OAAOga,sCAzQbpD,wBAAAA,wCAqRbqD,eAAgB,EAChBC,iBAAkB,EAClBC,gBAAiB,EAEjBd,gBAAiB,EACjBC,kBAAmB,EAEnBc,cAAe,EACfC,QAAS,EACTC,UAAW,GACXC,UAAW,GACX7B,SAAU,GACV8B,QAAS,GACTC,UAAW,GACXC,UAAW,GACXC,cAAe,GACfC,WAAY,GACZC,cAAe,GACfC,YAAa,GACbC,cAAe,GACfC,QAAS,GACTC,SAAU,GACVC,eAAgB,GAChBC,aAAc,GACdC,gBAAiB,GACjBC,eAAgB,GAChBC,WAAY,GACZC,WAAY,GACZC,MAAO,GACPC,MAAO,GACPC,MAAO,GACPC,MAAO,GACPC,MAAO,GACPC,MAAO,GACPC,MAAO,GACPC,MAAO,GACPC,MAAO,GACPC,MAAO,GACPC,MAAO,GACPC,MAAO,GACPC,MAAO,GACPC,MAAO,GACPC,MAAO,GACPC,MAAO,GACPC,MAAO,GACPC,MAAO,GACPC,MAAO,GACPC,MAAO,GACPC,MAAO,GACPC,MAAO,GACPC,MAAO,GACPC,MAAO,GACPC,MAAO,GACPC,MAAO,GACPC,MAAO,GACPC,MAAO,GACPC,MAAO,GACPC,MAAO,GACPC,MAAO,GACPC,MAAO,GACPC,MAAO,GACPC,MAAO,GACPC,MAAO,GACPC,MAAO,GACPC,oBAAqB,GACrBC,qBAAsB,GACtBC,eAAgB,GAChBC,aAAc,GACdC,aAAc,GACdC,aAAc,GACdC,aAAc,GACdC,aAAc,IACdC,aAAc,IACdC,aAAc,IACdC,aAAc,IACdC,aAAc,IACdC,aAAc,IACdC,aAAc,IACdC,QAAS,IACTC,aAAc,IACdC,kBAAmB,IACnBC,WAAY,IACZC,OAAQ,IACRC,OAAQ,IACRC,OAAQ,IACRC,OAAQ,IACRC,OAAQ,IACRC,OAAQ,IACRC,OAAQ,IACRC,OAAQ,IACRC,OAAQ,IACRC,QAAS,IACT5G,QAAS,IACT6G,QAAS,IACTC,aAAc,IACdC,gBAAiB,IACjBC,eAAgB,IAChBC,eAAgB,IAChBC,UAAW,IACXC,SAAU,IACVC,WAAY,IACZC,kBAAmB,IACnBC,iBAAkB,IAClBC,iBAAkB,IAClBC,eAAgB,IAChBC,kBAAmB,IACnBC,iBAAkB,IAClBC,iBAAkB,IAClBC,kBAAmB,uBAjYN3J,4aCzTjBqD,eAAgB,EAChBC,iBAAkB,EAClBC,gBAAiB,EAEjBd,gBAAiB,EACjBC,kBAAmB,EAEnBc,cAAe,EACfC,QAAS,EACTC,UAAW,GACXC,UAAW,GACX7B,SAAU,GACV8B,QAAS,GACTC,UAAW,GACXC,UAAW,GACXC,cAAe,GACfC,WAAY,GACZC,cAAe,GACfC,YAAa,GACbC,cAAe,GACfC,QAAS,GACTC,SAAU,GACVC,eAAgB,GAChBC,aAAc,GACdC,gBAAiB,GACjBC,eAAgB,GAChBC,WAAY,GACZC,WAAY,GACZC,MAAO,GACPC,MAAO,GACPC,MAAO,GACPC,MAAO,GACPC,MAAO,GACPC,MAAO,GACPC,MAAO,GACPC,MAAO,GACPC,MAAO,GACPC,MAAO,GACPC,MAAO,GACPC,MAAO,GACPC,MAAO,GACPC,MAAO,GACPC,MAAO,GACPC,MAAO,GACPC,MAAO,GACPC,MAAO,GACPC,MAAO,GACPC,MAAO,GACPC,MAAO,GACPC,MAAO,GACPC,MAAO,GACPC,MAAO,GACPC,MAAO,GACPC,MAAO,GACPC,MAAO,GACPC,MAAO,GACPC,MAAO,GACPC,MAAO,GACPC,MAAO,GACPC,MAAO,GACPC,MAAO,GACPC,MAAO,GACPC,MAAO,GACPC,MAAO,GACPC,oBAAqB,GACrBC,qBAAsB,GACtBC,eAAgB,GAChBC,aAAc,GACdC,aAAc,GACdC,aAAc,GACdC,aAAc,GACdC,aAAc,IACdC,aAAc,IACdC,aAAc,IACdC,aAAc,IACdC,aAAc,IACdC,aAAc,IACdC,aAAc,IACdC,QAAS,IACTC,aAAc,IACdC,kBAAmB,IACnBC,WAAY,IACZC,OAAQ,IACRC,OAAQ,IACRC,OAAQ,IACRC,OAAQ,IACRC,OAAQ,IACRC,OAAQ,IACRC,OAAQ,IACRC,OAAQ,IACRC,OAAQ,IACRC,QAAS,IACT5G,QAAS,IACT6G,QAAS,IACTC,aAAc,IACdC,gBAAiB,IACjBC,eAAgB,IAChBC,eAAgB,IAChBC,UAAW,IACXC,SAAU,IACVC,WAAY,IACZC,kBAAmB,IACnBC,iBAAkB,IAClBC,iBAAkB,IAClBC,eAAgB,IAChBC,kBAAmB,IACnBC,iBAAkB,IAClBC,iBAAkB,IAClBC,kBAAmB,IAGnBC,YAAa,IACbC,YAAa,IACbC,YAAa,IACbC,YAAa,IACbC,YAAa,IACbC,YAAa,IACbC,YAAa,IACbC,aAAc,+jCCzGGC,EAAAA,SAAAA,GACjB,QAAAA,GAAYC,GAAStrB,EAAAC,KAAAorB,EAAA,IAAAvnB,GAAA5D,EAAAD,MAAAorB,EAAAlrB,WAAAX,OAAAY,eAAAirB,IAAAnsB,KAAAe,KACXqrB,GADW,OAAA9rB,QAAA2J,eAAArF,EAAA,YAAAsF,YAAA,EAAAC,UAAA,EAAA1F,MAQV,WACP,MAAO1D,MAAKqrB,WATKxnB,wCADJunB,4iCCAAE,EAAAA,SAAAA,GACjB,QAAAA,GAAYD,GAAStrB,EAAAC,KAAAsrB,EAAA,IAAAznB,GAAA5D,EAAAD,MAAAsrB,EAAAprB,WAAAX,OAAAY,eAAAmrB,IAAArsB,KAAAe,KACXqrB,GADW,OAAA9rB,QAAA2J,eAAArF,EAAA,YAAAsF,YAAA,EAAAC,UAAA,EAAA1F,MAQV,WACP,MAAO1D,MAAKqrB,WATKxnB,wCADJynB;6DCAAC,EAAAA,SAAAA,GACjB,QAAAA,GAAYF,GAAStrB,EAAAC,KAAAurB,EAAA,IAAA1nB,GAAA5D,EAAAD,MAAAurB,EAAArrB,WAAAX,OAAAY,eAAAorB,IAAAtsB,KAAAe,KACXqrB,GADW,OAAA9rB,QAAA2J,eAAArF,EAAA,YAAAsF,YAAA,EAAAC,UAAA,EAAA1F,MAQV,WACP,MAAO1D,MAAKqrB,WATKxnB,wCADJ0nB,kjCCAAC,EAAAA,SAAAA,GACjB,QAAAA,GAAYH,GAAStrB,EAAAC,KAAAwrB,EAAA,IAAA3nB,GAAA5D,EAAAD,MAAAwrB,EAAAtrB,WAAAX,OAAAY,eAAAqrB,IAAAvsB,KAAAe,KACXqrB,GADW,OAAA9rB,QAAA2J,eAAArF,EAAA,YAAAsF,YAAA,EAAAC,UAAA,EAAA1F,MAQV,WACP,MAAO1D,MAAKqrB,WATKxnB,wCADJ2nB,ojCCAAC,EAAAA,SAAAA,GACjB,QAAAA,GAAYJ,GAAStrB,EAAAC,KAAAyrB,EAAA,IAAA5nB,GAAA5D,EAAAD,MAAAyrB,EAAAvrB,WAAAX,OAAAY,eAAAsrB,IAAAxsB,KAAAe,KACXqrB,GADW,OAAA9rB,QAAA2J,eAAArF,EAAA,YAAAsF,YAAA,EAAAC,UAAA,EAAA1F,MAQV,WACP,MAAO1D,MAAKqrB,WATKxnB,wCADJ4nB,wiCCAAC,EAAAA,SAAAA,GACjB,QAAAA,GAAYL,GAAStrB,EAAAC,KAAA0rB,EAAA,IAAA7nB,GAAA5D,EAAAD,MAAA0rB,EAAAxrB,WAAAX,OAAAY,eAAAurB,IAAAzsB,KAAAe,KACXqrB,GADW,OAAA9rB,QAAA2J,eAAArF,EAAA,YAAAsF,YAAA,EAAAC,UAAA,EAAA1F,MAQV,WACP,MAAO1D,MAAKqrB,WATKxnB,wCADJ6nB,0iCCAAC,EAAAA,SAAAA,GACjB,QAAAA,GAAYN,GAAStrB,EAAAC,KAAA2rB,EAAA,IAAA9nB,GAAA5D,EAAAD,MAAA2rB,EAAAzrB,WAAAX,OAAAY,eAAAwrB,IAAA1sB,KAAAe,KACXqrB,GADW,OAAA9rB,QAAA2J,eAAArF,EAAA,YAAAsF,YAAA,EAAAC,UAAA,EAAA1F,MAQV,WACP,MAAO1D,MAAKqrB,WATKxnB,wCADJ8nB,+sCCFAC,GAAAA,SAAAA,GACjB,QAAAA,GAAYP,GAAStrB,EAAAC,KAAA4rB,EAAA,IAAA/nB,GAAA5D,EAAAD,MAAA4rB,EAAA1rB,WAAAX,OAAAY,eAAAyrB,IAAA3sB,KAAAe,KACXqrB,GADW,OAEjBxnB,GAAKwnB,QAAUA,EAMfxnB,EAAKZ,SAAW,WACZ,MAAOjD,MAAKqrB,SATCxnB,qBADcgG,kBAAlB+hB,wjCCEAC,EAAAA,SAAAA,GACjB,QAAAA,GAAYR,GAAStrB,EAAAC,KAAA6rB,EAAA,IAAAhoB,GAAA5D,EAAAD,MAAA6rB,EAAA3rB,WAAAX,OAAAY,eAAA0rB,IAAA5sB,KAAAe,KACXqrB,GADW,OAAA9rB,QAAA2J,eAAArF,EAAA,YAAAsF,YAAA,EAAAC,UAAA,EAAA1F,MAQV,WACP,MAAO1D,MAAKqrB,WATKxnB,wCADJgoB,4jCCAAC,EAAAA,SAAAA,GACjB,QAAAA,GAAYT,GAAStrB,EAAAC,KAAA8rB,EAAA,IAAAjoB,GAAA5D,EAAAD,MAAA8rB,EAAA5rB,WAAAX,OAAAY,eAAA2rB,IAAA7sB,KAAAe,KACXqrB,GADW,OAAA9rB,QAAA2J,eAAArF,EAAA,YAAAsF,YAAA,EAAAC,UAAA,EAAA1F,MAQV,WACP,MAAO1D,MAAKqrB,WATKxnB,wCADJioB,+pCCLjBC,EAAiB,SAAU1pB,EAAQ5B,GACnC,GAAIX,IACAsB,QAASD,EAAG,EAAGE,EAAG,GAClBQ,MAAOV,EAAG,EAAGE,EAAG,GAChBS,MAAO,EACPf,MAAON,EAASM,MAUpB,OAPAjB,GAAKsB,OAAOD,EAAIkB,EAAO2pB,QAAUvrB,EAASW,OAAOD,EACjDrB,EAAKsB,OAAOC,EAAIgB,EAAO4pB,QAAUxrB,EAASW,OAAOC,EAEjDvB,EAAK+B,KAAKV,EAAKkB,EAAOlB,EAAIV,EAASoB,KAAKV,EAAKkB,EAAOlB,EAAIV,EAASoB,KAAKV,EACtErB,EAAK+B,KAAKR,EAAKgB,EAAOhB,EAAIZ,EAASoB,KAAKR,EAAKgB,EAAOhB,EAAIZ,EAASoB,KAAKR,EAEtEvB,EAAKgC,MAAQrB,EAASqB,QAAWO,EAAOlB,EAAIV,EAASoB,KAAKV,EAAMkB,EAAOhB,EAAIZ,EAASoB,KAAKR,GAAM,GACxFvB,GAeUosB,EAAAA,WACjB,QAAAA,KAAcnsB,EAAAC,KAAAksB,GAEVlsB,KAAKmsB,QAAU,GAAAvN,GAAA7iB,QAGfiE,KAAKosB,OAAS,oBAGdpsB,KAAKqC,QACDlB,EAAG,EACHE,EAAG,EACH2qB,QAAS,EACTC,QAAS,GAGbjsB,KAAKqsB,MAAO,EAEZrsB,KAAKF,MACDsB,QAASD,EAAG,EAAKE,EAAG,GACpBQ,MAAOV,EAAG,EAAKE,EAAG,GAClBS,MAAO,EACPf,MAAO,+CAQLjB,GACN,GAAmB,WAAf,mBAAOA,GAAP,YAAAR,EAAOQ,IAAkB,CACzB,GAAIA,YAAgBhB,QAAwB,GAAfgB,EAAK1H,OAO9B,MANA4H,MAAKqC,QACDlB,EAAGrB,EAAK,GACRuB,EAAGvB,EAAK,GACRksB,QAAShsB,KAAKqC,OAAO2pB,QACrBC,QAASjsB,KAAKqC,OAAO4pB,SAElBjsB,IAEI9F,UAAX4F,EAAKqB,GAA8BjH,SAAX4F,EAAKuB,IAC7BrB,KAAKqC,QACDlB,EAAGrB,EAAKqB,EACRE,EAAGvB,EAAKuB,EACR2qB,QAAShsB,KAAKqC,OAAO2pB,QACrBC,QAASjsB,KAAKqC,OAAO4pB,UAIjC,MAAOjsB,wCAODF,GACN,GAAmB,WAAf,mBAAOA,GAAP,YAAAR,EAAOQ,IAAkB,CACzB,GAAIA,YAAgBhB,QAAwB,GAAfgB,EAAK1H,OAO9B,MANA4H,MAAKqC,QACDlB,EAAGnB,KAAKqC,OAAOlB,EACfE,EAAGrB,KAAKqC,OAAOhB,EACf2qB,QAASlsB,EAAK,GACdmsB,QAASnsB,EAAK,IAEXE,IAEI9F,UAAX4F,EAAKqB,GAA8BjH,SAAX4F,EAAKuB,IAC7BrB,KAAKqC,QACDlB,EAAGnB,KAAKqC,OAAOlB,EACfE,EAAGrB,KAAKqC,OAAOhB,EACf2qB,QAASlsB,EAAKqB,EACd8qB,QAASnsB,EAAKuB,IAI1B,MAAOrB,wCAQDN,EAAK8N,GACX,GAAIA,YAAAA,GAAAA,QAEA,MADAxN,MAAKmsB,QAAQ5b,IAAI7Q,EAAK8N,GACfxN,0CASFN,GAWT,MAVAM,MAAKmsB,QAAQ1b,OAAO/Q,GAChBM,KAAKosB,QAAU1sB,IACfM,KAAKosB,OAAS,oBACdpsB,KAAKF,MACDsB,QAASD,EAAG,EAAKE,EAAG,GACpBQ,MAAOV,EAAG,EAAKE,EAAG,GAClBS,MAAO,EACPf,MAAO,IAGRf,4CAOIN,GAIX,MAH0BxF,UAAtB8F,KAAKmsB,QAAQzsB,IAAsBM,KAAKmsB,QAAQzsB,YAAb4sB,GAAAvwB,UACnCiE,KAAKF,KAAOE,KAAKmsB,QAAQzsB,GAAK6sB,kBAAkBvsB,KAAKqC,OAAQ0pB,IAE1D/rB,yCAUCoB,EAAQS,GAchB,MAbe3H,UAAXkH,GAAyC,WAAjB,mBAAOA,GAAP,YAAA9B,EAAO8B,KAC3BA,YAAAA,GAAAA,UACApB,KAAKF,KAAKsB,OAASA,EAAOuB,aAIrBzI,SAAT2H,GAAqC,WAAf,mBAAOA,GAAP,YAAAvC,EAAOuC,KACzBA,YAAAA,GAAAA,UACA7B,KAAKF,KAAK+B,KAAOA,EAAKc,aAI9B3C,KAAKF,KAAOisB,EAAe/rB,KAAKqC,OAAQrC,KAAKF,MACtCE,gDAOQS,GAKf,MAJKT,MAAKqsB,OACNrsB,KAAKF,KAAOW,EACZT,KAAKqsB,MAAO,GAETrsB,2CAOP,MAAOA,MAAKF,wBAlKCosB,6tCCjBAM,EAAAA,WAwBjB,QAAAA,GAAY7N,GAAK5e,EAAAC,KAAAwsB,GACbxsB,KAAKysB,gBAAkBzsB,KAAKysB,gBAAgB1Z,KAAK/S,MACjDA,KAAK4E,MAAQ5E,KAAK4E,MAAMmO,KAAK/S,MAG7BA,KAAK2e,IAAMA,EAGX3e,KAAKoI,OAAS,KAGdpI,KAAKQ,QAAU,KAGfR,KAAK0sB,aAAeC,EAAA5wB,QAAa6wB,OAGjC5sB,KAAK6sB,cAAgB,GAAAC,GAAA/wB,QAGrBiE,KAAK+sB,gBAAkB,GAAAC,GAAAjxB,QAGvBiE,KAAKitB,kBAAoB,GAAAC,GAAAnxB,WAA0BiE,KAAKysB,iBAExDzsB,KAAKmtB,oEAgDYzf,GACjB,GAAI0f,GAAeptB,KACfkE,EAAcwJ,EAAMxJ,WAOxB,OAN2B,kBAAhBA,IAA+DhK,SAAjCgK,EAAYnF,UAAUgI,SAC3D7C,EAAYnF,UAAUgI,OAAS,SAAU6L,EAAW9S,GAEhD,MADAstB,GAAaC,QAAQC,iBAAiBvmB,OAAOjH,IACtC,IAGRoE,+BAONiG,GAgCD,MA/BAnK,MAAKF,KAAOM,EAAArE,QAAW6D,QAAO,KAAU4sB,EAAalsB,SAAU6J,GAE/DnK,KAAK2e,IAAIzS,QAAQ,cAEjBlM,KAAKF,KAAKytB,cAAgBvtB,KAAKF,KAAKkJ,MACpChJ,KAAKF,KAAK0tB,eAAiBxtB,KAAKF,KAAKmJ,OACrCjJ,KAAKF,KAAK2tB,eAAiBC,iBAAiB1tB,KAAK2e,IAAImC,SAA1B,OAE3B9gB,KAAK2e,IAAImC,QAAQtW,MAAMxB,MAAQhJ,KAAKF,KAAKkJ,MAAQ,KACjDhJ,KAAK2e,IAAImC,QAAQtW,MAAMvB,OAASjJ,KAAKF,KAAKmJ,OAAS,KAEnDjJ,KAAK2tB,aAEL3tB,KAAK+sB,gBAAgBa,WACjBzsB,EAAGnB,KAAKF,KAAKkJ,MACb3H,EAAGrB,KAAKF,KAAKmJ,SACd4kB,oBACCzsB,QACID,EAAG,EACHE,EAAG,GAEPQ,MACIV,EAAGnB,KAAKF,KAAKkJ,MACb3H,EAAGrB,KAAKF,KAAKmJ,QAEjBnH,MAAO,EACPf,MAAO,IAGXf,KAAK2e,IAAIzS,QAAQ,aAEVlM,0CAUP,MAHKA,MAAK6sB,cAAciB,SAAS,UAC7B9tB,KAAK6sB,cAAckB,SAAS,QAAS,GAElC/tB,0CAqCP,MA9ByF,KAArFsK,SAAS0jB,iBAAiB,cAAgBhuB,KAAK2e,IAAI7e,KAAKsD,GAAK,aAAahL,SAC1E4H,KAAKoI,OAASkC,SAAS2jB,cAAc,UAErCjuB,KAAKoI,OAAOY,MAAQhJ,KAAKF,KAAKkJ,MAC9BhJ,KAAKoI,OAAOa,OAASjJ,KAAKF,KAAKmJ,OAC/BjJ,KAAKoI,OAAOoC,MAAM0jB,OAASluB,KAAKF,KAAKouB,OACrCluB,KAAKoI,OAAOoC,MAAM5I,SAAW5B,KAAKF,KAAK8B,SAEvC5B,KAAKoI,OAAOoC,MAAM8Y,KAAOtjB,KAAKF,KAAKwjB,KACnCtjB,KAAKoI,OAAOoC,MAAM+Y,IAAMvjB,KAAKF,KAAKyjB,IAE9BvjB,KAAK2e,IAAI7e,KAAKquB,MAEdnuB,KAAKQ,QAAUR,KAAKoI,OAAOgmB,WAAW,YAEtCpuB,KAAKQ,QAAUR,KAAKoI,OAAOgmB,WAAW,MAGrCpuB,KAAK2e,IAAI7e,KAAKuuB,WACfruB,KAAK2e,IAAIlQ,KAAK6f,iBAAiBtuB,KAAKQ,SAGxCR,KAAKQ,QAAQ+tB,YAAc,gBACvBvuB,KAAKF,KAAK0uB,kBAAiBxuB,KAAKwuB,gBAAkBxuB,KAAKF,KAAK0uB,iBAC5DxuB,KAAKF,KAAKzB,UAAS2B,KAAK3B,QAAU2B,KAAKF,KAAKzB,SAC5C2B,KAAKF,KAAKa,UAASX,KAAKW,QAAUX,KAAKF,KAAKa,SAC5CX,KAAKF,KAAKouB,SAAQluB,KAAKkuB,OAAS,IAAOluB,KAAKF,KAAKouB,QAErDluB,KAAK2e,IAAImC,QAAQ2N,YAAYzuB,KAAKoI,SAE/BpI,mCAQLmY,EAAKtW,GAMP,MALY3H,UAARie,GAA8Bje,SAAT2H,EACrB7B,KAAKQ,QAAQkuB,UAAUvW,EAAIhX,EAAInB,KAAKS,SAASU,EAAGgX,EAAI9W,EAAIrB,KAAKS,SAASY,EAAGQ,EAAKV,EAAGU,EAAKR,GAEtFrB,KAAKQ,QAAQkuB,UAAU,EAAG,EAAG1uB,KAAKF,KAAKkJ,MAAOhJ,KAAKF,KAAKmJ,QAErDjJ,oCAQJgJ,EAAOC,GAeV,MAdAjJ,MAAKoI,OAAOY,MAAQhJ,KAAKF,KAAKkJ,MAAQA,EACtChJ,KAAKoI,OAAOa,OAASjJ,KAAKF,KAAKmJ,OAASA,EAEpCjJ,KAAKF,KAAK0uB,kBACVxuB,KAAKQ,QAAQQ,OAEbhB,KAAKqtB,QACLrtB,KAAKwuB,gBAAkBxuB,KAAKF,KAAK0uB,gBAEjCxuB,KAAKQ,QAAQuB,WAEZ/B,KAAK2e,IAAI7e,KAAKuuB,WACfruB,KAAK2e,IAAIlQ,KAAK6f,iBAAiBtuB,KAAKQ,SAEjCR,6CAQK2uB,GACZ,GAAIvB,GAAeptB,IACnBotB,GAAattB,KAAK6uB,UAAYA,GAAa,WAC3CvB,EAAaV,aAAahc,KAAK0c,EAAazO,IAAI7e,KAAKsD,GAErD,IAAIwrB,GAAkBxB,EAAayB,qBAC/BzB,EAAaH,kBAAkB6B,SAASH,IAGxCI,EAAe,GAAIH,GAAgBxB,EAAaH,qBAmBpD,OAlBA8B,GAAa1C,MACTxb,SAAU,WACNke,EAAapX,MACT9G,SAAU,WACNuc,EAAaV,aAAa9nB,MAAMwoB,EAAazO,IAAI7e,KAAKsD,GAAI2rB,GACtDpQ,IAAKyO,EAAazO,IAClBqQ,WAAYC,aAAaD,aAG7B5B,EAAazO,IAAIzS,QAAQ,oBAGzBkhB,EAAaH,kBAAkBiC,mBAAmBC,eAM3DnvB,mCAQL6Q,EAAU/Q,GAEZ,MADA+S,YAAWhC,EAAS5R,KAAK4R,EAAU/Q,GAAO,GACnCE,qCAOP,GAAIotB,GAAeptB,IACfotB,GAAazO,IAAI7e,KAAKsvB,IACtBhC,EAAazO,IAAI7e,KAAKsvB,GAAG/C,OAE7Be,EAAazO,IAAIzS,QAAQ,eAEzBkhB,EAAaV,aAAahc,KAAK0c,EAAazO,IAAI7e,KAAKsD,GAErD,IAAIwrB,GAAkBxB,EAAayB,qBAC/BzB,EAAaH,kBAAkBoC,cAG/BN,EAAe,GAAIH,GAAgBxB,EAAaH,qBAgBpD,OAfA8B,GAAa1C,MACTxb,SAAU,WACNke,EAAapX,MACT9G,SAAU,WACNuc,EAAaV,aAAa9nB,MAAMwoB,EAAazO,IAAI7e,KAAKsD,GAAI2rB,GACtDpQ,IAAKyO,EAAazO,IAClBqQ,WAAYC,aAAaD,aAG7B5B,EAAazO,IAAIzS,QAAQ,oBAMlCkhB,iCAQP,MADAptB,MAAK0sB,aAAahc,KAAK1Q,KAAK2e,IAAI7e,KAAKsD,IAC9BpD,wCAOAsvB,GACP,GAAIxO,GAAUxW,SAASilB,eAAevvB,KAAK2e,IAAImC,QAAQ0O,KAAK,MAsB5D,OApBIt1B,UAAc4mB,EAAQ2O,oBAEtB3O,EAAQ2O,kBAAoB3O,EAAQ4O,yBAC7B5O,EAAQ6O,yBACR7O,EAAQ8O,sBACR9O,EAAQ+O,qBAGf31B,SAAcoQ,SAASwlB,iBAEvBxlB,SAASwlB,eAAiBxlB,SAASylB,sBAC5BzlB,SAAS0lB,wBACT1lB,SAAS2lB,qBACT3lB,SAAS4lB,kBAEhBZ,EACAxO,EAAQ2O,oBAERnlB,SAASwlB,iBAEN9vB,8CAOMsvB,GACb,GAAI3Q,GAAM3e,KAAK2e,IACXyO,EAAeptB,IAoCnB,OAlCIsvB,IACAlC,EAAattB,KAAKytB,cAAgBH,EAAattB,KAAKkJ,MACpDokB,EAAattB,KAAK0tB,eAAiBJ,EAAattB,KAAKmJ,OAErDmkB,EAAa+C,OAAOxR,EAAI3a,OAAOgF,MAAO2V,EAAI3a,OAAOiF,QACjDmkB,EAAattB,KAAKswB,kBAAmB,EAErCzR,EAAImC,QAAQtW,MAAMxB,MAAQ2V,EAAI3a,OAAOgF,MAAQ,KAC7C2V,EAAImC,QAAQtW,MAAMvB,OAAS0V,EAAI3a,OAAOiF,OAAS,KAC/C0V,EAAImC,QAAQtW,MAAM6lB,OAAS,EAE3BjD,EAAaL,gBAAgBa,WACzBzsB,EAAGwd,EAAI3a,OAAOgF,MACd3H,EAAGsd,EAAI3a,OAAOiF,SACfqnB,WACCnvB,IAAKwd,EAAI3a,OAAOgF,MAAQokB,EAAattB,KAAKytB,eAAiB,EAC3DlsB,IAAKsd,EAAI3a,OAAOiF,OAASmkB,EAAattB,KAAK0tB,gBAAkB,MAGjEJ,EAAa+C,OAAO/C,EAAattB,KAAKytB,cAAeH,EAAattB,KAAK0tB,gBACvEJ,EAAattB,KAAKswB,kBAAmB,EAErCzR,EAAImC,QAAQtW,MAAMxB,MAAQokB,EAAattB,KAAKytB,cAAgB,KAC5D5O,EAAImC,QAAQtW,MAAMvB,OAASmkB,EAAattB,KAAK0tB,eAAiB,KAC9D7O,EAAImC,QAAQtW,MAAM6lB,OAASjD,EAAattB,KAAK2tB,eAE7CL,EAAaL,gBAAgBa,WACzBzsB,EAAGisB,EAAattB,KAAKytB,cACrBlsB,EAAG+rB,EAAattB,KAAK0tB,iBACtB8C,WACCnvB,EAAG,EACHE,EAAG,KAGJrB,8CAQM2e,EAAK7e,GASlB,MARa5F,UAAT4F,IACAA,GAAQwvB,YAAY,KAEnB3Q,EAAIhY,MAAMypB,kBAAoBtwB,EAAKwvB,WACpC3Q,EAAIhY,MAAM4pB,YAAW,GAErB5R,EAAIhY,MAAM4pB,YAAW,GAElBvwB,6CAOP,MAAOA,MAAK6sB,cAAciB,SAAS,kDAUnC,MAHI9tB,MAAKF,KAAK0uB,kBACVxuB,KAAKwuB,gBAAkBxuB,KAAKF,KAAK0uB,iBAE9BxuB,oCAOJF,GACH,GAAIstB,GAAeptB,IASnB,OARAotB,GAAaP,cAAc2D,OAAO1hB,QAAQ,SAAUpL,EAAOwL,GACvDke,EAAaP,cAAc2D,OAAOthB,GAAOnI,OACrCqmB,EAAa5sB,QACb4sB,EAAaL,gBAAgB0D,cAC7BrD,EAAaP,cAAc6D,iBAC3B5wB,SAGDE,iCAQPwN,EAAM9N,GAIN,MAHIM,MAAK6sB,cAAc6D,iBAAiBta,IAAI,UACxCpW,KAAK6sB,cAAc6D,iBAAiB12B,IAAI,SAASuW,IAAI/C,EAAM9N,GAExDM,oCAQJwN,EAAM9N,GAIT,MAHIM,MAAK6sB,cAAc6D,iBAAiBta,IAAI,UACxCpW,KAAK6sB,cAAc6D,iBAAiB12B,IAAI,SAASyW,OAAOjD,EAAM9N,GAE3DM,4CAOIwN,GAEX,MADAxN,MAAK+sB,gBAAgB4D,UAAUnjB,EAAK1N,KAAKsD,GAAIoK,GACtCxN,sDAOc2G,GAOrB,MALAA,GAAMomB,gBAAgB6D,YAClB,GAAArtB,GAAAxH,QAAa,EAAG,GAChB,GAAAwH,GAAAxH,QAAa4K,EAAM7G,KAAKkJ,MAAOrC,EAAM7G,KAAKmJ,SAGvCtC,yCAOI6G,GACX,MAAatT,UAATsT,EAA2BxN,KAAK6wB,yBAAyB7wB,OAC7DA,KAAK+sB,gBAAgB+D,eAAetjB,EAAK1N,KAAKsD,IACvCpD,8CAhcP,MAAOA,MAAKF,KAAK0uB,8BAGD9qB,GAChB1D,KAAKF,KAAK0uB,gBAAkB9qB,EAC5B1D,KAAKQ,QAAQiB,UAAYiC,EACzB1D,KAAKQ,QAAQmB,SAAS,EAAG,EAAG3B,KAAKF,KAAKkJ,MAAOhJ,KAAKF,KAAKmJ,wCAIvD,MAAOjJ,MAAKF,KAAKzB,sBAGTqF,GACR1D,KAAKF,KAAKzB,QAAUqF,EACpB1D,KAAKoI,OAAOoC,MAAMnM,QAAUqF,kCAI5B,MAAO1D,MAAKF,KAAKa,sBAGT+C,GACR1D,KAAKF,KAAKa,UAAY+C,EACtB1D,KAAKoI,OAAOoC,MAAMumB,QAAartB,EAAS,QAAU,sCAIlD,MAAO,KAAO1D,KAAKF,KAAKouB,qBAGjBxqB,GACP1D,KAAKF,KAAKouB,OAAS,IAAOxqB,EAC1B1D,KAAKoI,OAAOoC,MAAM0jB,OAAS,IAAOxqB,mCAIlC,MAAO1D,MAAKF,KAAKW,wCA1FJ+rB,EAAAA,6CAEbxjB,MAAO,EACPC,OAAQ,EAERskB,cAAe,EACfC,eAAgB,EAChBC,eAAgB,EAEhB9sB,SAAS,EACTiB,SAAU,WACV2hB,IAAK,EACLD,KAAM,EACN4K,OAAQ,IACR7vB,QAAS,EACTmwB,iBAAiB,EAEjBQ,WAAY,GAEZgC,kBAAkB,EAElBvwB,UAAWU,EAAG,EAAGE,EAAG,gBArBPmrB,s4BCbAyE,EAAAA,WACjB,QAAAA,KAAclxB,EAAAC,KAAAixB,GAEVjxB,KAAK0wB,iBAAmB,GAAAQ,GAAAn1B,SAAoBqH,GAAI,gBAGhDpD,KAAKwwB,UAGLxwB,KAAKkP,MAAQ,+CASR9K,EAAM8pB,EAAQ1gB,GAGnB,GAFApJ,EAAOA,GAAQf,EAAAtH,QAAKuH,WAEPpJ,SAATsT,GAAsBA,YAAAA,GAAAA,QAatB,MAZetT,UAAXg0B,GACAA,EAASluB,KAAKkP,MACdlP,KAAKkP,SAELgf,GAAU,IAGd1gB,EAAOA,GAAQ,GAAA0jB,GAAAn1B,SAAoBqH,GAAIgB,EAAM8pB,OAAQA,IAErDluB,KAAK0wB,iBAAiBngB,IAAI/C,EAAMpJ,GAChCpE,KAAKwwB,OAAOtC,GAAU1gB,EAEfxN,yCASHoE,GAGR,aAFOpE,MAAKwwB,OAAOxwB,KAAK0wB,iBAAiB12B,IAAIoK,GAAM8pB,QACnDluB,KAAK0wB,iBAAiBjgB,OAAO,KAAMrM,GAC5BpE,sCAOFoE,GACL,MAAIpE,MAAK0wB,iBAAiBta,IAAIhS,GACnBpE,KAAK0wB,iBAAiB12B,IAAIoK,GAE9B,uCAQDA,EAAM8pB,GAMZ,MALIluB,MAAK0wB,iBAAiBta,IAAIhS,WACnBpE,MAAKwwB,OAAOxwB,KAAK0wB,iBAAiB12B,IAAIoK,GAAM8pB,QACnDluB,KAAK0wB,iBAAiB12B,IAAIoK,GAAM8pB,OAASA,EACzCluB,KAAKwwB,OAAOtC,GAAUluB,KAAK0wB,iBAAiB12B,IAAIoK,IAE7CpE,wBAvEMixB,mkCCQAE,EAAAA,WAUjB,QAAAA,GAAYrxB,EAAMsxB,GAAerxB,EAAAC,KAAAmxB,GAC7BnxB,KAAKF,KAAOM,EAAArE,QAAW6D,QAAO,KAAUuxB,EAAkB7wB,SAAUR,GACpEE,KAAKuQ,IAAI,GAAA8gB,GAAAt1B,SACTiE,KAAKoxB,cAAgBA,6CAehBhuB,GACL,MAAWlJ,UAAPkJ,EAAyBpD,KAAKqvB,aAC9BrvB,KAAKF,KAAKwxB,OAAOpf,SAAS9O,GACnBpD,KAAKF,KAAKwxB,OAAOluB,GAErB,gDAIP,MAAOpD,MAAKF,KAAKwxB,OAAOt3B,IAAIgG,KAAKF,KAAKwxB,OAAOtxB,KAAKF,KAAKyxB,uDAIvD,MAAyCr3B,UAArC8F,KAAKF,KAAKwxB,OAAOtxB,KAAK0N,MAAQ,GACvB1N,KAAKF,KAAKwxB,OAAOt3B,IAAIgG,KAAKF,KAAKwxB,OAAOtxB,KAAK0N,MAAQ,IAEvD,0CAIP,MAAO1N,MAAKF,KAAKwxB,OAAOt3B,IAAIgG,KAAKF,KAAKwxB,OAAOtxB,KAAKF,KAAKsO,gDAMlDhL,GAOL,MANIpD,MAAKF,KAAKwxB,OAAOpf,SAAS9O,KAC1BpD,KAAKF,KAAKyxB,cAAgBvxB,KAAKF,KAAKsO,aACpCpO,KAAKF,KAAKsO,aAAepO,KAAKF,KAAKwxB,OAAOhmB,QAAQlI,GAClDpD,KAAKoxB,cAAchuB,IAGhBpD,4CAUP,MANyC9F,UAArC8F,KAAKF,KAAKwxB,OAAOtxB,KAAK0N,MAAQ,KAC9B1N,KAAKF,KAAKyxB,cAAgBvxB,KAAKF,KAAKsO,aACpCpO,KAAKF,KAAKsO,aAAepO,KAAK0N,MAAQ,EACtC1N,KAAKoxB,cAAcpxB,KAAKF,KAAKwxB,OAAOtxB,KAAK0N,SAGtC1N,gDAIP,GAAkD9F,SAA9C8F,KAAKF,KAAKwxB,OAAOtxB,KAAKF,KAAKyxB,eAA8B,CACzD,GAAI7jB,GAAQ1N,KAAKF,KAAKyxB,aACtBvxB,MAAKF,KAAKyxB,cAAgBvxB,KAAKF,KAAKsO,aACpCpO,KAAKF,KAAKsO,aAAeV,EACzB1N,KAAKoxB,cAAcpxB,KAAKF,KAAKwxB,OAAO5jB,IAGxC,MAAO1N,kCAOP0N,EAAOtK,GAKP,MAJWlJ,UAAPkJ,IAAkBA,EAAKsK,EAAM5N,KAAKsD,KACjCpD,KAAKF,KAAKwxB,OAAOpf,SAAS9O,IAAOsK,YAAAA,GAAAA,SAClC1N,KAAKF,KAAKwxB,OAAO/gB,IAAInN,EAAIsK,GAEtB1N,oCAMJoD,GAIH,MAHIpD,MAAKF,KAAKwxB,OAAOpf,SAAS9O,IAC1BpD,KAAKF,KAAKwxB,OAAO7gB,OAAOrN,GAErBpD,mCAvFP,MAAOA,MAAKF,KAAKsO,2BAGX1K,GACN1D,KAAKF,KAAKsO,aAAe1K,iCArBZytB,EAAAA,6CAKbI,cAAe,KACfnjB,aAAc,EACdkjB,OAAQ,GAAA1S,GAAA7iB,qBAPKo1B,0nCCVAK,EAAAA,WAGjB,QAAAA,KAAc,GAAA3tB,GAAA7D,IAAAD,GAAAC,KAAAwxB,GAC0Bt3B,SAAhC8F,KAAKkE,YAAYutB,aAA0BzxB,KAAKkE,YAAYutB,cAEhE,IAAIC,KAGmB,UAAnBC,EAAA51B,QAAO61B,SAAsBD,EAAA51B,QAAO81B,QAAU,KAC9C7xB,KAAKE,UAAYX,OAAOsU,UAAW7T,KAAKjB,WAO5C,IAAI+yB,GAAY,QAAZA,GAAaryB,GAMb,GAJuB,SAAnBkyB,EAAA51B,QAAO61B,SAAsBD,EAAA51B,QAAO81B,QAAU,KAC9CpyB,EAAOS,UAAYX,OAAOsU,UAAWpU,EAAOV,kBAGN,WAAtCU,EAAOS,UAAUgE,YAAYE,MACOlK,SAAjCuF,EAAOS,UAAUgE,aACjBzE,EAAOS,UAAUgE,YAAYutB,WAAWr5B,OAAS,GAFxD,CAKA,IAAK,GAAIE,GAAI,EAAGA,EAAImH,EAAOS,UAAUgE,YAAYutB,WAAWr5B,OAAQE,IAC1Do5B,EAAMpmB,QAAQ7L,EAAOS,UAAUgE,YAAYutB,WAAWn5B,GAAG8L,SAAU,IACrEstB,EAAMnmB,KAAK9L,EAAOS,UAAUgE,YAAYutB,WAAWn5B,GAAG8L,MACtDP,EAAKK,YAAYutB,WAAWlmB,KAAK9L,EAAOS,UAAUgE,YAAYutB,WAAWn5B,IAIjFw5B,GAAUryB,EAAOS,YAGrB4xB,GAAU9xB,KAAKE,wDAGRuxB,GACP,GAAIn5B,GAAI,CACR,IAA0B,YAAtB,mBAAOm5B,GAAP,YAAAnyB,EAAOmyB,KAA2BA,YAAsB3yB,OACxD,IAAKxG,EAAI,EAAGA,EAAIm5B,EAAWr5B,OAAQE,IAC/B,GAA6B,kBAAlBm5B,GAAWn5B,IAAqB,GAAKm5B,GAAWn5B,YAAhBy5B,GAAAh2B,SACvC,GAAIiE,KAAKkE,YAAYutB,WAAWnmB,QAAQmmB,EAAWn5B,OAAQ,EAAI,OAAO,MACnE,CAAA,GAA6B,kBAAlBm5B,GAAWn5B,GAEtB,KAAM,IAAIuR,OAAM,WAAa4nB,EAAWn5B,GAAG4L,YAAYE,KAAO,sBADjE,MAAMpE,eAAgByxB,GAAWn5B,IAAK,OAAO,MAGlD,CAAA,GAA0B,kBAAfm5B,IAA6B,GAAKA,aAALM,GAAAh2B,QAC3C,MAAOiE,MAAKkE,YAAYutB,WAAWnmB,QAAQmmB,MAAgB,CACxD,IAA0B,kBAAfA,GAGd,KAAM,IAAI5nB,OAAM,WAAa4nB,EAAWvtB,YAAYE,KAAO,sBAF3D,MAAMpE,eAAgByxB,IAAa,OAAO,EAI9C,OAAO,qCAIP,MAAOzxB,MAAKE,UAAUgE,YAAYE,oCA9DrBotB,EAAAA,6DAAAA,y6BCHAQ,EAAAA,+EAGNP,GACP,GAAIn5B,GAAI,EAAGoX,EAAI,CACf,IAA0B,YAAtB,mBAAO+hB,GAAP,YAAAnyB,EAAOmyB,KAA2BA,YAAsB3yB,OACxD,IAAKxG,EAAI,EAAGA,EAAIm5B,EAAWr5B,OAAQE,IAAK,CACpC,KAA6B,kBAAlBm5B,GAAWn5B,IAAqB,GAAKm5B,GAAWn5B,YAAe05B,IAInE,KAAM,IAAInoB,OAAM,WAAa4nB,EAAWn5B,GAAG4L,YAAYE,KAAO,sBAHjE,KAAKsL,EAAI,EAAGA,EAAI1P,KAAKkE,YAAYutB,WAAWr5B,OAAQsX,IAChD,KAAM,GAAK1P,MAAKkE,YAAYutB,WAAW/hB,YAAe+hB,GAAWn5B,IAAK,OAAO,MAItF,CAAA,KAA0B,kBAAfm5B,IAA6B,GAAKA,aAAuBO,IAKvE,KAAM,IAAInoB,OAAM,WAAa4nB,EAAWvtB,YAAYE,KAAO,sBAJ3D,KAAK9L,EAAI,EAAGA,EAAI0H,KAAKkE,YAAYutB,WAAWr5B,OAAQE,IAChD,KAAM,GAAK0H,MAAKkE,YAAYutB,WAAWn5B,YAAem5B,IAAa,OAAO,EAKlF,OAAO,iCApBMO,EAAAA,+CACIA,eADJA;iICGAC,EAAAA,SAAAA,GAOjB,QAAAA,KAAclyB,EAAAC,KAAAiyB,EAAA,IAAApuB,GAAA5D,EAAAD,MAAAiyB,EAAA/xB,WAAAX,OAAAY,eAAA8xB,IAAAhzB,KAAAe,MAAA,OAAAT,QAAA2J,eAAArF,EAAA,cAAAsF,YAAA,EAAAC,UAAA,EAAA1F,OAJD,IAICnE,OAAA2J,eAAArF,EAAA,UAAAsF,YAAA,EAAAC,UAAA,EAAA1F,MAFL,OAEKG,gDAITquB,GAID,MAHqBh4B,UAAjBg4B,IACAlyB,KAAKiM,OAASimB,GAEXlyB,sCASP,MADAA,MAAKqS,YAAa,EACXrS,uCAKP,MADAA,MAAKqS,YAAa,EACXrS,oCAGJmyB,GAOH,MANej4B,UAAXi4B,IAAsBA,GAAUnyB,KAAK6K,WACrCsnB,EACAnyB,KAAKokB,SAELpkB,KAAKoyB,UAEFpyB,uCApBP,MAAOA,MAAKqS,mDAnBC4f,EAAAA,+CACGI,EAAAt2B,qBADHk2B,+qCCEAK,EAAAA,SAAAA,GAGjB,QAAAA,KAAc,MAAAvyB,GAAAC,KAAAsyB,GAAAryB,EAAAD,MAAAsyB,EAAApyB,WAAAX,OAAAY,eAAAmyB,IAAArzB,KAAAe,yDAHGsyB,EAAAA,+CACGC,EAAAx2B,qBADHu2B,qsBCLAE,EAAAA,WAGjB,QAAAA,GAAY5oB,GAAO7J,EAAAC,KAAAwyB,GAAAjzB,OAAA2J,eAAAlJ,KAAA,SAAAmJ,YAAA,EAAAC,UAAA,EAAA1F,MAFXxJ,SAGUA,SAAV0P,IAAqB5J,KAAK4J,MAAQA,8CAItC,OAAO,oCAIP,OAAO,+BAGNA,GAED,MADc1P,UAAV0P,GAAsC1P,SAAf8F,KAAK4J,QAAqB5J,KAAK4J,MAAQA,IAC3D,mCAIP,OAAO,kCAIP,OAAO,qCAIP,MAAO,UAAU5F,GACb,MAAQA,GAAO,GAAGC,cAAgBD,EAAOhF,MAAM,IACjDgB,KAAKkE,YAAYuuB,YAAczyB,KAAKkE,YAAYE,yBA/BrCouB,ujDCCAE,EAAAA,SAAAA,GAGjB,QAAAA,GAAYjzB,EAAQ0K,GAChB,GADyBpK,EAAAC,KAAA0yB,GACVx4B,SAAXuF,GAA0C,YAAlB,mBAAOA,GAAP,YAAAH,EAAOG,IAC/B,KAAM,IAAAkU,GAAA5X,QAA6B,oDAGvB7B,UAAZiQ,IAAuBA,MACZjQ,SAAXuF,IAAsBA,KAND,IAAAoE,GAAA5D,EAAAD,MAAA0yB,EAAAxyB,WAAAX,OAAAY,eAAAuyB,IAAAzzB,KAAAe,KAQnBP,GARmB,OAUzBoE,GAAK8uB,kBAAoBxoB,EAVAtG,oDAab,IAAA,GAAA8Q,GAAAzV,UAAA9G,OAANyG,EAAMC,MAAA6V,GAAAC,EAAA,EAAAA,EAAAD,EAAAC,IAAN/V,EAAM+V,GAAA1V,UAAA0V,EACZ8d,GAAQ9yB,OAARiV,MAAA6d,IAAe,EAAMpzB,EAAOU,QAASlB,YAAiBkB,MAAtDsP,OAA+DzQ,uCAG5C,IAAA,GAAAkW,GAAA7V,UAAA9G,OAANyG,EAAMC,MAAAiW,GAAAC,EAAA,EAAAA,EAAAD,EAAAC,IAANnW,EAAMmW,GAAA9V,UAAA8V,EACnB,IAAI7V,IAAW,CACQ,kBAAZN,GAAK,KACZM,EAAWN,EAAK,GAChBA,EAAKO,OAAO,EAAG,GAUnB,KAAK,GAPDC,GAAMR,EAAK,IAAM,WACb,MAAgB3E,UAAZ2E,EAAK,IAAgC,OAAZA,EAAK,IAAkC,WAAnBS,EAAOT,EAAK,IAClDU,OAAOC,OAAOX,EAAK,UAK7BvG,EAAI,EAAGA,EAAIuG,EAAKzG,OAAQE,IAAK,CAElC,GAAImH,GAASZ,EAAKvG,EAElB,IAAKmH,EAEL,IAAK,GAAIC,KAAOD,GACRA,EAAOE,eAAeD,KACK,WAAvBJ,EAAOG,EAAOC,KAAqC,OAAhBD,EAAOC,GAC1CL,EAAIK,GAAOP,EAAWuzB,EAAQ9yB,OAAOT,EAAUE,EAAIK,GAAMD,EAAOC,IAAQD,EAAOC,GAE/EL,EAAIK,GAAOD,EAAOC,IAMlC,MAAOL,UAnDsBE,kBAAhBmzB,o0CCHAE,EAAAA,SAAAA,yJAEb,OAAQzxB,EAAG,EAAGE,EAAG,EAAGsY,EAAG,+BAFViZ,wxDCGAC,EAAAA,SAAAA,GAcjB,QAAAA,KAAc9yB,EAAAC,KAAA6yB,EAAA,IAAAhvB,GAAA5D,EAAAD,MAAA6yB,EAAA3yB,WAAAX,OAAAY,eAAA0yB,IAAA5zB,KAAAe,MAAA,OAAAT,QAAA2J,eAAArF,EAAA,WAAAsF,YAAA,EAAAC,UAAA,EAAA1F,MAFJ,GAAAovB,GAAA/2B,QAAU,YAIhB8H,EAAK0M,IAAI,GAAAuiB,GAAA/2B,QAAU,SAFT8H,gDAKTquB,EAAc/nB,GACfmC,EAAAumB,EAAA9zB,UAAAmB,WAAAX,OAAAY,eAAA0yB,EAAA9zB,WAAA,OAAAiB,MAAAf,KAAAe,KAAWkyB,GACXlyB,KAAK8D,MAAQC,EAAAhI,QAAQ6D,QAAO,KAAUizB,EAAcvyB,SAAU6J,+BAO9DzK,GACAM,KAAK+yB,QAAQ/4B,IAAI0F,+BAGjBA,GACAM,KAAK+yB,QAAQ3c,IAAI1W,+BAGjB8N,EAAM0B,GACF1B,EAAK0I,WAALsI,EAAAziB,UACAiE,KAAK+yB,QAAQxiB,IAAI/C,EAAM0B,kCAIxB1B,GACCA,EAAK0I,WAALsI,EAAAziB,UACAiE,KAAK+yB,QAAQtiB,OAAOjD,kCAnBxB,MAAOxN,MAAK+yB,gDAzBCF,EAAAA,2DAAAA,2tBCLAG,EAAAA,oGACX,SAACzyB,GACH,MAAO,eAAiBA,EAAQ,oOAW7B,SAACA,GACJ,MAAO,eAAiBA,EAAQ,gIAO1B8qB,EAAS4H,GACf,MAAIhW,WAAU0C,UAAU1b,cAAcqH,QAAQ,WAAY,GACnD2R,UAAU0C,UAAU1b,cAAcqH,QAAQ,YAAa,EAEnDgJ,QAAQC,IAAI,4BACfvU,KAAKmkB,IAAI,WAAYnkB,KAAKmkB,IAAI,WAC9BnkB,KAAKmkB,IAAI,WAAYkH,EACrBrrB,KAAKmkB,IAAI,WAAYnkB,KAAKmkB,IAAI,WAC9BnkB,KAAKizB,KAAK,QAASjzB,KAAKizB,KAAK,QAASA,GAEhC3e,QAAQC,IAAI8W,EAAS4H,+BAGnC5H,EAAS6H,GACT,GAAI/O,GAAM,EAEV,QADqB,gBAAV+O,KAAoBA,EAAQA,EAAMjvB,eACrCivB,GACJ,IAAK,OACDA,EAAQ,OACR/O,EAAM,oDACN,MACJ,KAAK,OACL,IAAK,UACD+O,EAAQ,UACR/O,EAAM,oDACN,MACJ,KAAK,QACD+O,EAAQ,QACR/O,EAAM,oDACN,MACJ,KAAK,UACD+O,EAAQ,UACR/O,EAAM,oDACN,MACJ,KAAK,QACL,IAAKjqB,QACL,QACIg5B,EAAQ,QACR/O,EAAM,qDAGd,MAAIlH,WAAU0C,UAAU1b,cAAcqH,QAAQ,WAAY,GACnD2R,UAAU0C,UAAU1b,cAAcqH,QAAQ,YAAa,EAEnDjB,OAAOiK,QAAQC,IAAI,OAAQ4P,EAAK+O,EAAO7H,GACpChhB,OAAOiK,QAAQC,IAAI8W,sBAlEpB2H,y0BCSAR,EAAAA,WAcjB,QAAAA,KAAczyB,EAAAC,KAAAwyB,EACV,IAAIW,GAAgB30B,SAASjG,KAAK6F,IAC9BkM,SAAS8oB,gBAAT,YACA9oB,SAASC,KAAT,YACAD,SAAS8oB,gBAAT,YACA9oB,SAASC,KAAT,YACAD,SAAS8oB,gBAAT,cAGAC,EAAiB70B,SAASjG,KAAK6F,IAC/BkM,SAAS8oB,gBAAT,aACA9oB,SAASC,KAAT,aACAD,SAAS8oB,gBAAT,aACA9oB,SAASC,KAAT,aACAD,SAAS8oB,gBAAT,cAGJpzB,MAAKgJ,MAAQmqB,EAAgB30B,SAAS6D,OAAO2G,OAASmqB,EAAgB30B,SAAS6D,OAAO2G,OACtFhJ,KAAKiJ,OAASoqB,EAAiB70B,SAAS6D,OAAO4G,QAAUoqB,EAAiB70B,SAAS6D,OAAO4G,uDA1B1F,MADKupB,GAAOc,UAAUd,EAAOe,aACtBf,EAAOc,yCAKd,MADKd,GAAOgB,UAAUhB,EAAOe,aACtBf,EAAOgB,mDA8Bd,MAFAxzB,MAAKgJ,MAAQqB,OAAOopB,WACpBzzB,KAAKiJ,OAASoB,OAAOqpB,YACd1zB,wCAOP,MAAOA,MAAKgJ,0CAOZ,MAAOhJ,MAAKiJ,yCAOZ,MAAO,IAAA1F,GAAAxH,QAAaiE,KAAKgJ,MAAOhJ,KAAKiJ,uCA9DxBupB,EAAAA,2EAAAA,EAAAA,2EAAAA,EAAAA,8CAiEG,WAChB,GAAI7S,GAAY1C,UAAU0C,UAAWtO,EAAAA,OACjCsiB,EAAQhU,EAAUgU,MAAM,sFAE5B,OAAI,WAAWhZ,KAAKgZ,EAAM,KAAO,QAAQhZ,KAAKgZ,EAAM,KAChDtiB,EAAO,kBAAkBqL,KAAKiD,OAE9B6S,EAAOc,SAAW,KAClBd,EAAOgB,SAAWhiB,WAAWH,EAAK,IAAM,KAChC,KAAMA,EAAK,IAAM,KAGZ,WAAbsiB,EAAM,KACNtiB,EAAOsO,EAAUgU,MAAM,sCACV,OAATtiB,IACAmhB,EAAOc,SAAWjiB,EAAK,GAAGvO,QAAQ,MAAO,SACzC0vB,EAAOgB,SAAWhiB,WAAWH,EAAK,KAC1BA,EAAK,GAAGvO,QAAQ,MAAO,SAAUuO,EAAK,MAGtDsiB,EAAQA,EAAM,IAAMA,EAAM,GAAIA,EAAM,KAAO1W,UAAU2W,QAAS3W,UAAU4W,WAAY,MAChC,QAA/CxiB,EAAOsO,EAAUgU,MAAM,qBAA8BA,EAAMv0B,OAAO,EAAG,EAAGiS,EAAK,IAElFmhB,EAAOc,SAAWK,EAAM,GACxBnB,EAAOgB,SAAWhiB,WAAWmiB,EAAM,KAE3BA,EAAM,GAAIA,EAAM,kBA3FXnB,wrECHA3rB,EAAAA,SAAAA,GA8DjB,QAAAA,KAAc9G,EAAAC,KAAA6G,EAAA,IAAAhD,GAAA5D,EAAAD,MAAA6G,EAAA3G,WAAAX,OAAAY,eAAA0G,IAAA5H,KAAAe,MAAA,OAAAT,QAAA2J,eAAArF,EAAA,SAAAsF,YAAA,EAAAC,UAAA,EAAA1F,OAtBVqD,OAAQ,OAERsP,eAAe,EACfzP,YACIisB,eAAe,EACfD,iBAAiB,MAiBXrzB,OAAA2J,eAAArF,EAAA,YAAAsF,YAAA,EAAAC,UAAA,EAAA1F,OAJVowB,UACAC,eAGUx0B,OAAA2J,eAAArF,EAAA,sBAAAsF,YAAA,EAAAC,UAAA,EAAA1F,MA6JO,SAACkH,GAClBA,EAAEE,iBACFjH,EAAKC,MAAMuS,eAAgB,KA/JjB9W,OAAA2J,eAAArF,EAAA,0BAAAsF,YAAA,EAAAC,UAAA,EAAA1F,MAmKW,SAACkH,GACtBA,EAAEE,iBACFjH,EAAKmwB,cACLnwB,EAAKC,MAAMuS,eAAgB,KAtKjBxS,gDA0DTquB,EAAc+B,EAAQ9pB,GACvBmC,EAAAzF,EAAA9H,UAAAmB,WAAAX,OAAAY,eAAA0G,EAAA9H,WAAA,OAAAiB,MAAAf,KAAAe,KAAWkyB,GAEP/nB,GAA8B,YAAnB,mBAAOA,GAAP,YAAA7K,EAAO6K,MAAsBnK,KAAKmK,QAAUA,GAC3DA,EAAUpG,EAAAhI,QAAQ6D,QAAO,KAAUiH,EAAavG,SAAU6J,GAC/BjQ,SAAvBiQ,EAAQvD,kBAAiCuD,GAAQvD,WAErD5G,KAAKk0B,QAAUD,EACfj0B,KAAK8D,MAAQC,EAAAhI,QAAQ6D,QAAO,KAAUI,KAAK8D,MAAOqG,GAElDnK,KAAK2tB,kDAIL,GAAMpN,GAAAA,cAAkBvgB,KAAKk0B,QAAQne,KAA/B,KAGFvI,EAAOlD,SAAS6pB,cAAc5T,EAClC,IAAa,OAAT/S,EAAe,CACf,GAAsB,QAAlBA,EAAK4mB,SAAoB,CACzB,GAAIvX,GAAQvS,SAAS0jB,iBAAiBzN,EAAI,UAC1C,IAAqB,IAAjB1D,EAAMzkB,OAAc,CACpB,GAAIgQ,GAASiC,OAAOC,SAAS2jB,cAAc,SAC3CzgB,GAAKihB,YAAYrmB,GACjByU,GAASzU,OACN,IAAIyU,EAAMzkB,OAAS,EACtB,IAAK,GAAIE,GAAI,EAAGA,EAAIukB,EAAMzkB,OAAQE,IACpB,IAANA,GAASkV,EAAK6mB,YAAYxX,EAAMvkB,GAG5CkV,GAAOqP,EAAM,GAGjB,GAAsB,WAAlBrP,EAAK4mB,SAAuB,CAC5B5mB,EAAKxE,MAAQhJ,KAAK8D,MAAMkF,MACxBwE,EAAKvE,OAASjJ,KAAK8D,MAAMmF,OACzBuE,EAAKhD,MAAM0jB,OAASluB,KAAK8D,MAAMoqB,OAC/B1gB,EAAKhD,MAAM5I,SAAW5B,KAAK8D,MAAMlC,SAEjC4L,EAAKhD,MAAM8Y,KAAOtjB,KAAK8D,MAAMwf,KAC7B9V,EAAKhD,MAAM8pB,MAAQt0B,KAAK8D,MAAMwwB,MAC9B9mB,EAAKhD,MAAM+Y,IAAMvjB,KAAK8D,MAAMyf,IAC5B/V,EAAKhD,MAAM+pB,OAASv0B,KAAK8D,MAAMywB,OAE/B/mB,EAAKhD,MAAMgkB,gBAAkBxuB,KAAK8D,MAAM0qB,eAExC,KACI,GAA2B,SAAtBxuB,KAAK8D,MAAMiD,QAA2C,WAAtB/G,KAAK8D,MAAMiD,UACxC/G,KAAKw0B,SAAWhnB,EAAK4gB,WAAW,WAAa5gB,EAAK4gB,WAAW,wBAG9D,GAA2B,SAAtBpuB,KAAK8D,MAAMiD,QAA2C,UAAtB/G,KAAK8D,MAAMiD,UAC/C/G,KAAKw0B,SAAWhnB,EAAK4gB,WAAW,UAAY5gB,EAAK4gB,WAAW,uBAG7D,CAAA,GAA2B,SAAtBpuB,KAAK8D,MAAMiD,QAA2C,aAAtB/G,KAAK8D,MAAMiD,UAC/C/G,KAAKw0B,SAAWhnB,EAAK4gB,WAAW,OAKpC,KAAM,IAAA9b,GAAAvW,QAAA,6BAAwE,SAAtBiE,KAAK8D,MAAMiD,OAC7D,MADiD,IACrC/G,KAAK8D,MAAMiD,OAD0B,KAAjD,gBAHN/G,MAAK8D,MAAMiD,OAAS,eAJpB/G,MAAK8D,MAAMiD,OAAS,YAJpB/G,MAAK8D,MAAMiD,OAAS,SAc1B,MAAO4U,GAEL,WADA3b,MAAKk0B,QAAQ3f,IAAIoH,EAAO,SAIvB3b,KAAK8D,MAAMuqB,WACZxnB,EAAaynB,iBAAiBtuB,KAAKw0B,UAGvCx0B,KAAKw0B,SAASjG,YAAc,mBAEF,WAAtBvuB,KAAK8D,MAAMiD,QAA6C,UAAtB/G,KAAK8D,MAAMiD,SAC7C/G,KAAKy0B,mBAAmBjnB,GACxBxN,KAAKg0B,eAGTh0B,KAAK00B,SAAWlnB,EAEhBxN,KAAKk0B,QAAQ3f,IAAb,yBAA0CvU,KAAKk0B,QAAQne,KAAvD,MAAiE/V,KAAK8D,MAAMiD,OAAO4tB,cAAnF,IAAqG,gDAM7G,GAAI3vB,GAAKhF,KAAKw0B,QAEdxvB,GAAGvE,SAAS,EAAG,EAAGuE,EAAGoD,OAAOY,MAAOhE,EAAGoD,OAAOa,QAC7CjE,EAAGof,OAAOpf,EAAG4vB,WACb5vB,EAAG6vB,SAAS7vB,EAAG8vB,OACf9vB,EAAGof,OAAOpf,EAAG+vB,YACb/vB,EAAGgwB,UAAUhwB,EAAGiwB,QAChBjwB,EAAGof,OAAOpf,EAAGkwB,OACblwB,EAAGmwB,UAAUnwB,EAAGowB,UAAWpwB,EAAGqwB,gEAef7nB,GACfA,EAAKpH,iBAAiB,mBAAoBpG,KAAKs1B,oBAAoB,GACnE9nB,EAAKpH,iBAAiB,uBAAwBpG,KAAKu1B,wBAAwB,gDAG1D/nB,GACjBA,EAAKZ,oBAAoB,mBAAoB5M,KAAKs1B,oBAAoB,GACtE9nB,EAAKZ,oBAAoB,uBAAwB5M,KAAKu1B,wBAAwB,wCAInD,WAAtBv1B,KAAK8D,MAAMiD,QAA6C,UAAtB/G,KAAK8D,MAAMiD,SAAuB/G,KAAKw0B,SAASgB,iBACnFx1B,KAAKw0B,SAASiB,aAAa,sBAAsBC,0DAIrCC,GAChB,GAAI3wB,GAAKhF,KAAKw0B,QACY,YAAtBx0B,KAAK8D,MAAMiD,QAA6C,UAAtB/G,KAAK8D,MAAMiD,QACzC4uB,EAAc7sB,cAAgB6sB,EAAcC,iBAC5CD,EAAc7uB,eAAiB9B,EAAG6wB,gBAElCF,EAAcG,eAAiBjvB,EAAakvB,cAAc/wB,EACtDA,EAAGgxB,aAAahxB,EAAGixB,eACnBN,EAAc7sB,cAElB6sB,EAAcO,gBAAkBrvB,EAAakvB,cAAc/wB,EACvDA,EAAGgxB,aAAahxB,EAAGmxB,iBACnBR,EAAcC,gBAGlB5wB,EAAGoxB,aAAaT,EAAc7uB,eAAgB6uB,EAAcG,gBAC5D9wB,EAAGoxB,aAAaT,EAAc7uB,eAAgB6uB,EAAcO,iBAE5DlxB,EAAGqxB,YAAYV,EAAc7uB,gBAExB9B,EAAGsxB,oBAAoBX,EAAc7uB,eAAgB9B,EAAGuxB,cACzDjiB,QAAQkiB,KAAK,6DAoBzB92B,GACAM,KAAKwwB,OAAOx2B,IAAI0F,+BAGhBA,GACAM,KAAKwwB,OAAOpa,IAAI1W,+BAGhB8N,EAAM0B,GACNlP,KAAKwwB,OAAOjgB,IAAI/C,EAAM0B,kCAGnB1B,GACHxN,KAAKwwB,OAAO/f,OAAOjD,mCAuBnB,GAAIxN,KAAK8D,MAAMiD,OAAOC,WAAW,SAAU,CACvC,GAAIhC,GAAKhF,KAAKw0B,QACdxvB,GAAGyxB,WAAW,EAAK,EAAK,EAAK,GAC7BzxB,EAAGqoB,MAAMroB,EAAG0xB,iBAAmB1xB,EAAG2xB,sBAElC32B,MAAKw0B,SAAS9F,UAAU,EAAG,EAAG1uB,KAAK00B,SAAS1rB,MAAOhJ,KAAK00B,SAASzrB,uCAIlEnJ,GACCA,EAAK8G,WAAWC,aAAa/C,MAAMuS,gBAEvCrW,KAAKqtB,QACLrtB,KAAKwwB,OAAOzpB,OAAO/G,KAAKw0B,SAAUx0B,KAAKS,SAAUX,uCA9QjD,MAAOE,MAAK6yB,cAAcrC,6CAO1B,MAAmD,iBAAxCxwB,MAAK8D,MAAM8C,WAAWisB,cACtB,KACG7yB,KAAK8D,MAAM8C,WAAWisB,4BAMtB+D,GACd,GAAwB,iBAAZA,IAAyBA,KAAY,GAAsB,OAAZA,EAEvD,YADA52B,KAAK8D,MAAM8C,WAAWisB,eAAgB,EAEnC,IAAuB,YAAnB,mBAAO+D,GAAP,YAAAt3B,EAAOs3B,MAAyBA,EAAQ1gB,WAARqc,EAAAx2B,SACvC,KAAM,IAAA4X,GAAA5X,QAA6B,0CAGvCiE,MAAK8D,MAAM8C,WAAWisB,cAAgB+D,mCAItC,MAAO52B,MAAK4yB,gBAAgBnyB,iDAO5B,MAAqD,iBAA1CT,MAAK8D,MAAM8C,WAAWgsB,gBACtB,KACG5yB,KAAK8D,MAAM8C,WAAWgsB,8BAMpBgE,GAChB,GAAwB,iBAAZA,IAAyBA,KAAY,GAAsB,OAAZA,EAEvD,YADA52B,KAAK8D,MAAM8C,WAAWgsB,iBAAkB,EAErC,IAAuB,YAAnB,mBAAOgE,GAAP,YAAAt3B,EAAOs3B,MAAyBA,EAAQ1gB,WAARqc,EAAAx2B,SACvC,KAAM,IAAA4X,GAAA5X,QAA6B,0CAGvCiE,MAAK8D,MAAM8C,WAAWgsB,gBAAkBgE,0CA6JvB5xB,EAAI6xB,EAAQpa,GAI7B,MAHAzX,GAAG8xB,aAAaD,EAAQpa,GACxBzX,EAAG+wB,cAAcc,GAEZ7xB,EAAG+xB,mBAAmBF,EAAQ7xB,EAAGgyB,gBAK/BH,GAJHviB,QAAQkiB,KAAKxxB,EAAGiyB,iBAAiBJ,IAC1B,+CA0BSr2B,GACpB,GAAI02B,GAAS7sB,OAAO4S,UAAU0C,UAAUgU,MAAM,4BAC1C9B,IAAUqF,GAAS14B,SAAS04B,EAAO,GAAI,GAEvC12B,GAAQb,eAAe,yBACvBa,EAAQ22B,uBAAwB,GAEhC32B,EAAA,uBAAmC,EACnCA,EAAA,0BAAsC,EACtCA,EAAA,wBAAoC,EAChCqxB,GAAWA,GAAW,KACtBrxB,EAAA,6BAAyC,GAE7CA,EAAA,yBAAqC,2CA/T5BqG,EAAAA,6CAkBbmC,MAAO,EACPC,OAAQ,EAERtI,SAAS,EACTiB,SAAU,WACV2hB,IAAK,EACLgR,OAAQ,OACRjR,KAAM,EACNgR,MAAO,OACPpG,OAAQ,IACR7vB,QAAS,EACTmwB,gBAAiB,KAEjBH,WAAW,eA/BExnB,wlDCAAooB,EAAAA,SAAAA,GA+BjB,QAAAA,KAAclvB,EAAAC,KAAAivB,EAAA,IAAAprB,GAAA5D,EAAAD,MAAAivB,EAAA/uB,WAAAX,OAAAY,eAAA8uB,IAAAhwB,KAAAe,MAAA,OAAAT,QAAA2J,eAAArF,EAAA,gBAAAsF,YAAA,EAAAC,UAAA,EAAA1F,WAAAnE,OAAA2J,eAAArF,EAAA,SAAAsF,YAAA,EAAAC,UAAA,EAAA1F,OAZVkB,OAAO,EACPwY,OAAO,EAEPnN,IAAKuI,KAAKvI,MACVmnB,SAAU5e,KAAKvI,MACfonB,UAAW,EACXC,SAAU,IAASrI,EAAasI,eAMtB1zB,gDAmBT+O,GAAW,GAAApN,GAAAxF,IAKZ,IAJmB9F,SAAf8F,KAAKw3B,QAAqBx3B,KAAKw3B,MAAQ,SAAC5kB,GACxCpN,EAAK6S,KAAKzF,KAGV5S,KAAKy3B,aAAar/B,QAAU,GAAK4H,KAAK8D,MAAMc,OAAS5E,KAAK8D,MAAMsZ,MAGhE,MAFA6R,GAAayI,sBAAuB,EACpC13B,KAAK8D,MAAMc,OAAQ,EACZ+yB,EAAqB33B,KAAKw3B,MAErCx3B,MAAK8D,MAAMc,OAAQ,EAEnBgzB,EAAsB53B,KAAKw3B,MAE3B,KAAK,GAAIl/B,GAAI,EAAGA,EAAI0H,KAAKy3B,aAAar/B,OAAQE,IAC1C,GAAK0H,KAAKy3B,aAAan/B,GAAGuS,UAA1B,CACA,GAAIopB,GAASj0B,KAAKy3B,aAAan/B,EAE1B27B,GAAOnwB,MAAMsZ,QACV6W,EAAO7E,IAAI6E,EAAO7E,GAAGle,SAEzBlR,KAAK8D,MAAMmM,IAAMuI,KAAKvI,MACtBjQ,KAAK8D,MAAMuzB,WAAar3B,KAAK8D,MAAMmM,IAAMjQ,KAAK8D,MAAMszB,UAAY,IAEpC,IAAvBp3B,KAAK8D,MAAMuzB,UAAqBr3B,KAAK8D,MAAMwzB,WAC5Ct3B,KAAK8D,MAAMszB,SAAWp3B,KAAK8D,MAAMmM,IAA+B,IAAvBjQ,KAAK8D,MAAMuzB,UAAqBr3B,KAAK8D,MAAMwzB,SAEpFrD,EAAOnwB,MAAM8O,UAAYA,EACzBqhB,EAAOnwB,MAAMuzB,UAAYr3B,KAAK8D,MAAMuzB,UAGhCpD,EAAO/iB,QAAmC,kBAAlB+iB,GAAO/iB,QAC/B+iB,EAAO/iB,OAAOlR,KAAK8D,MAAMuzB,UAAWzkB,GAIpCqhB,EAAOltB,QAAmC,kBAAlBktB,GAAOltB,QAC/BktB,EAAOltB,OAAO/G,KAAK8D,MAAMuzB,UAAWzkB,IAIxCqhB,EAAO7E,IAAI6E,EAAO7E,GAAG/B,wCAK/BwK,GAMF,MAL8C39B,UAA1C8F,KAAKy3B,aAAaI,EAAc9hB,QAChC/V,KAAKy3B,aAAaI,EAAc9hB,MAAQ8hB,EACxC73B,KAAKy3B,aAAalsB,KAAKssB,IAEtB73B,KAAK8D,MAAMc,OAAO5E,KAAKqY,KAAKG,KAAKvI,MAAQgf,EAAa6I,YACpD93B,kCAGN63B,GAKD,MAJ8C39B,UAA1C8F,KAAKy3B,aAAaI,EAAc9hB,cACzB/V,MAAKy3B,aAAaI,EAAc9hB,MACvC/V,KAAKy3B,aAAar4B,OAAOY,KAAKy3B,aAAansB,QAAQusB,EAAc9hB,MAAO,IAErE/V,kCAGNkyB,GAED,MADA5lB,GAAA2iB,EAAAlwB,UAAAmB,WAAAX,OAAAY,eAAA8uB,EAAAlwB,WAAA,OAAAiB,MAAAf,KAAAe,KAAWkyB,GACJlyB,sCAMP,MAFAsM,GAAA2iB,EAAAlwB,UAAAmB,WAAAX,OAAAY,eAAA8uB,EAAAlwB,WAAA,SAAAiB,MAAAf,KAAAe,MACAA,KAAK8D,MAAMsZ,OAAQ,EACZpd,uCAMP,MAFAsM,GAAA2iB,EAAAlwB,UAAAmB,WAAAX,OAAAY,eAAA8uB,EAAAlwB,WAAA,UAAAiB,MAAAf,KAAAe,MACAA,KAAK8D,MAAMsZ,OAAQ,EACZpd,uCApFP,MAAOA,MAAK8D,MAAMc,uCAIlB,MAAO5E,MAAK8D,MAAMsZ,uCAwFlB,MAAO6R,GAAa8I,WAAa9I,EAAa8I,SAAW,GAAI9I,qCApG3CvrB,GAIlB,MAHIA,IAAS,IAAMA,EAAQ,IACvBurB,EAAasI,YAAc7zB,GAExBurB,EAAasI,aAAe7zB,0CAvCtBurB,EAAAA,2EAAAA,EAAAA,8CAGG,0BAHHA,EAAAA,+CAII,2BAJJA,EAAAA,yDAMa,cANbA,CA2Id,IAAM2I,GAAAA,EAAAA,sBAAyB,WAClC,MAAOvtB,QAAO2tB,uBACV3tB,OAAO4tB,6BACP5tB,OAAO6tB,0BACP7tB,OAAO8tB,wBACP9tB,OAAO+tB,yBACN,SAACvnB,GACOoe,EAAayI,qBAadzI,EAAayI,sBAAuB,GAZhCzI,EAAa6I,YAAcvmB,OAAO8mB,iBAAmB,IAAGpJ,EAAa6I,WAAa,GACtD,IAA5B7I,EAAa6I,aAAkB7I,EAAa6I,WAAoC59B,SAAvBmQ,OAAO2F,YAC9DwI,KAAKvI,MACL5F,OAAO2F,YAAYC,OAIzB5F,OAAOwI,WAAWhC,EAASkC,KAAT7Y,OAA2CA,SAAvBmQ,OAAO2F,YACvCwI,KAAKvI,MAAQgf,EAAa6I,WAC1BztB,OAAO2F,YAAYC,MAAQgf,EAAa6I,YAC3C,IAAS7I,EAAasI,kBAO5BI,EAAAA,EAAAA,qBAAwB,WAEjC,MADA1I,GAAarc,UAAY,EAClBvI,OAAOiuB,sBACVjuB,OAAOkuB,4BACPluB,OAAOmuB,yBACPnuB,OAAOouB,uBACPpuB,OAAOquB,6jECjKMC,EAAAA,SAAAA,GA4BjB,QAAAA,KAAc54B,EAAAC,KAAA24B,EAAA,IAAA90B,GAAA5D,EAAAD,MAAA24B,EAAAz4B,WAAAX,OAAAY,eAAAw4B,IAAA15B,KAAAe,MAAA,OAAAT,QAAA2J,eAAArF,EAAA,aAAAsF,YAAA,EAAAC,UAAA,EAAA1F,OAlBVk1B,SAAAA,EAAAA,QAEAC,MAAAA,EAAAA,WAgBUt5B,OAAA2J,eAAArF,EAAA,OAAAsF,YAAA,EAAAC,UAAA,EAAA1F,MAXRi1B,EAAaG,MAcfj1B,EAAKiH,gBAAiB,EACtBjH,EAAKiG,MACLjG,EAAKsG,SACDC,OAAQ,QAGZvG,EAAKqG,SAELrG,EAAK/D,QAEL+D,EAAKk1B,YACDC,aAAcL,EAAaG,IAAIhW,SAAU6V,EAAaG,IAAI5P,QAAS,mCACnErG,aAAc8V,EAAaG,IAAIhW,SAAU6V,EAAaG,IAAI/V,SAAU,kCAf9Dlf,2DAoBV,IAAK,GAAIvL,GAAI,EAAGA,EAAI0H,KAAK8J,GAAG1R,OAAQE,IAChC,GAAI0H,KAAK8J,GAAGxR,GAAG8rB,YAAa,EAAO,OAAO,4CAK9C,IAAK,GAAI9rB,GAAI,EAAGA,EAAI0H,KAAK8J,GAAG1R,OAAQE,IAChC,GAAI0H,KAAK8J,GAAGxR,GAAG85B,aAAc,EAAO,OAAO;kCAK/C,IAAKpyB,KAAK6K,UAAW,OAAO,CAC5B,KAAK,GAAIvS,GAAI,EAAGA,EAAI0H,KAAK8J,GAAG1R,OAAQE,IAChC,GAAI0H,KAAK8J,GAAGxR,GAAG4Y,YAAa,EAAO,OAAO,CAE9C,QAAO,kCAIP,IAAKlR,KAAK6K,UAAW,OAAO,CAC5B,KAAK,GAAIvS,GAAI,EAAGA,EAAI0H,KAAK8J,GAAG1R,OAAQE,IAChC,GAAI0H,KAAK8J,GAAGxR,GAAG+0B,WAAY,EAAO,OAAO,CAE7C,QAAO,+BAGN4L,GACD,GAAIC,GAAgBnlB,KAAKC,UAAUhU,KAAK+4B,WAExC,OADA/4B,MAAK+4B,WAAahlB,KAAK8P,MAAMoV,GACtBC,iCAIP,MAAOnlB,MAAKC,UAAUhU,KAAK+4B,yFAeXnW,GAChB,MAAuB,YAAnB,mBAAOA,GAAP,YAAAtjB,EAAOsjB,KAAwBA,YAAmB9jB,QAC9C8jB,EAAQxqB,SAAW4H,KAAKF,KAAKsL,KAAKC,SAASjT,QAA/C,IAOAkZ,MAAMsR,MACN,IAAO5iB,KAAKF,KAAKsL,KAAKC,SAASC,QAAQsX,IAChC+V,EAAaQ,cAAcn5B,KAAM4iB,+CAK7BljB,GACf,MAA6BxF,UAAzB8F,KAAK+4B,WAAWr5B,IACbM,KAAKikB,oBAAoBjkB,KAAK+4B,WAAWr5B,GAAK,oCAGjDokB,GAEJ,MAAO9jB,mCAGNkyB,EAAc9C,EAAIjlB,GAKnB,GAJAmC,EAAAqsB,EAAA55B,UAAAmB,WAAAX,OAAAY,eAAAw4B,EAAA55B,WAAA,OAAAiB,MAAAf,KAAAe,KAAWkyB,GACP/nB,GAA8B,YAAnB,mBAAOA,GAAP,YAAA7K,EAAO6K,MAClBnK,KAAKmK,QAAUA,GAEfilB,GAAoB,YAAd,mBAAOA,GAAP,YAAA9vB,EAAO8vB,KAAmBA,YAActwB,OAAO,CACrDkB,KAAK8J,KACL,KAAK,GAAIxR,GAAI,EAAGA,EAAI82B,EAAGh3B,OAAQE,IAAK,CAChC,GAAI0L,GAASorB,EAAG92B,EAEhB,IAAsB,gBAAX0L,IAAiE9J,SAA1Cy+B,EAAa7uB,GAAG9F,EAAO2wB,gBAIrD,GAHA3wB,EAAS,IAAKhE,KAAKo5B,UAAUp1B,EAAO2wB,gBACpC30B,KAAK8J,GAAG9F,EAAOf,YAAce,EAC7BhE,KAAK8J,GAAGyB,KAAKvH,GACThE,KAAK8J,GAAG9F,EAAOf,YAAYopB,KAAKrsB,SAAU,EAC1C,KAAM,IAAI6J,OAAM,kBAAoB7F,EAAS,yBAE9C,CAAA,KAAsB,YAAlB,mBAAOA,GAAP,YAAA1E,EAAO0E,KAAuBA,YAAAA,GAAAA,SAOrC,KAAM,IAAI6F,OAAM,6BAA+B7F,EAAOf,WAAa,0BAJnE,IAFAjD,KAAK8J,GAAG9F,EAAOf,YAAce,EAC7BhE,KAAK8J,GAAGyB,KAAKvH,GACThE,KAAK8J,GAAG9F,EAAOf,YAAYopB,KAAKrsB,SAAU,EAC1C,KAAM,IAAI6J,OAAM,kBAAoB7F,EAAS,uBAO7D,MAAOhE,uCAMP,MAFAsM,GAAAqsB,EAAA55B,UAAAmB,WAAAX,OAAAY,eAAAw4B,EAAA55B,WAAA,SAAAiB,MAAAf,KAAAe,MACAA,KAAKq5B,gBACEr5B,uCAMP,MAFAsM,GAAAqsB,EAAA55B,UAAAmB,WAAAX,OAAAY,eAAAw4B,EAAA55B,WAAA,UAAAiB,MAAAf,KAAAe,MACAA,KAAKs5B,kBACEt5B,6CAzEUgX,EAAS4L,GAC1B,OACIA,QAASA,EACT3U,KAAM+I,EAAQ9M,MAAMkB,KAAKS,YAAY+W,EAAQ,6CA7FpC+V,EAAAA,uCAGbC,SAAU,WAEVC,MAAO,iCALMF,EAAAA,yEAAAA,EAAAA,+CAmBIA,EAAa55B,UAAUiM,aACxCC,WAAY,SAAUiE,GAClB,MAAOypB,GAAaG,IAAI5pB,IAAU,eAAiBA,GAEvDqqB,aAAc,SAAUxuB,GACpB,MAAO4tB,GAAaG,IAAI/tB,IAAY,gBAxB3B4tB,u0CCTAa,EAAAA,SAAAA,4YAQd5nB,EAAWf,GACV,GAAgC3W,SAA5B8F,KAAKy5B,QAAQ7nB,GAA0B,CACvC,GAAIE,GAAQ9R,KAAKy5B,QAAQ7nB,EACrBE,GAAMxG,QAAQuF,MAAc,GAC5BiB,EAAMvG,KAAKsF,OAGf7Q,MAAKy5B,QAAQ7nB,MACb5R,KAAKy5B,QAAQ7nB,GAAWrG,KAAKsF,EAEjC,OAAO7Q,mCAON4R,EAAWf,GACZ,GAA+B3W,SAA3B8F,KAAK05B,OAAO9nB,GAA0B,CACtC,GAAIE,GAAQ9R,KAAK05B,OAAO9nB,EACpBE,GAAMxG,QAAQuF,MAAc,GAC5BiB,EAAMvG,KAAKsF,OAGf7Q,MAAK05B,OAAO9nB,MACZ5R,KAAK05B,OAAO9nB,GAAWrG,KAAKsF,EAEhC,OAAO7Q,kCAOP4R,EAAWf,GACX,GAAgC3W,SAA5B8F,KAAKy5B,QAAQ7nB,GAA0B,CACvC,GAAIE,GAAQ9R,KAAKy5B,QAAQ7nB,EACrBE,GAAMxG,QAAQuF,MAAc,GAC5BiB,EAAM1S,OAAO0S,EAAMxG,QAAQuF,IAGnC,GAA+B3W,SAA3B8F,KAAK05B,OAAO9nB,GAA0B,CACtC,GAAIE,GAAQ9R,KAAK05B,OAAO9nB,EACpBE,GAAMxG,QAAQuF,MAAc,GAC5BiB,EAAM1S,OAAO0S,EAAMxG,QAAQuF,IAGnC,MAAO7Q,sCAOH4R,EAAW9R,GACf,GAAIgS,GAAAA,OAAOxZ,EAAAA,OAAGuW,EAAAA,MAEd,IAA+B3U,SAA3B8F,KAAK05B,OAAO9nB,GAA0B,CAEtC,IADAE,EAAQ9R,KAAK05B,OAAO9nB,GACftZ,EAAI,EAAGA,EAAIwZ,EAAM1Z,SAClByW,EAASiD,EAAMxZ,GAAG2G,KAAK6S,EAAMxZ,GAAIwH,GACX,iBAAX+O,IAAyBA,GAFVvW,KAK9B,GADA0H,KAAK05B,OAAO9nB,MACU,iBAAX/C,KAAyBA,EAAQ,MAAO7O,MAGvD,GAAgC9F,SAA5B8F,KAAKy5B,QAAQ7nB,GAEb,IADAE,EAAQ9R,KAAKy5B,QAAQ7nB,GAChBtZ,EAAI,EAAGA,EAAIwZ,EAAM1Z,SAClByW,EAASiD,EAAMxZ,GAAG2G,KAAK6S,EAAMxZ,GAAIwH,GACX,iBAAX+O,IAAyBA,GAFVvW,KAKlC,MAAO0H,oCAML4R,GAYF,MAXkB1X,UAAd0X,GACgC1X,SAA5B8F,KAAKy5B,QAAQ7nB,KACb5R,KAAKy5B,QAAQ7nB,OAEc1X,SAA3B8F,KAAK05B,OAAO9nB,KACZ5R,KAAK05B,OAAO9nB,SAGhB5R,KAAK05B,UACL15B,KAAKy5B,YAEFz5B,iCApGMw5B,4jCCQAG,EAAAA,SAAAA,GACjB,QAAAA,GAAYtO,GAAStrB,EAAAC,KAAA25B,EAAA,IAAA91B,GAAA5D,EAAAD,MAAA25B,EAAAz5B,WAAAX,OAAAY,eAAAw5B,IAAA16B,KAAAe,KACXqrB,GADW,OAAA9rB,QAAA2J,eAAArF,EAAA,YAAAsF,YAAA,EAAAC,UAAA,EAAA1F,MAQV,WACP,MAAO1D,MAAKqrB,WATKxnB,wCADJ81B,0pCCRAC,EAAAA,SAAAA,6IAAAA,0/CCEAC,EAAAA,SAAAA,GAMjB,QAAAA,GAAYz2B,GAAIrD,EAAAC,KAAA65B,EAAA,IAAAh2B,GAAA5D,EAAAD,MAAA65B,EAAA35B,WAAAX,OAAAY,eAAA05B,IAAA56B,KAAAe,MAGZ,IAHYT,OAAA2J,eAAArF,EAAA,cAAAsF,YAAA,EAAAC,UAAA,EAAA1F,OAFH,IAKHm2B,EAAOC,qBAAqBxuB,QAAQlI,MAAQ,EAC9C,KAAM,IAAAkP,GAAAvW,QAAA,iDAAsE8H,EAAKK,YAAYE,KAAvF,UAJE,OAKLy1B,GAAOC,qBAAqB16B,OAAOy6B,EAAOC,qBAAqBxuB,QAAQlI,GAAK,GALvES,oDAcZ,MADA7D,MAAKqS,YAAa,EACXrS,uCAKP,MADAA,MAAKqS,YAAa,EACXrS,oCAGJmyB,GAOH,MANej4B,UAAXi4B,IAAsBA,GAAUnyB,KAAK6K,WACrCsnB,EACAnyB,KAAKokB,SAELpkB,KAAKoyB,UAEFpyB,uCApBP,MAAOA,MAAKqS,mDAfCwnB,EAAAA,+CACGE,EAAAh+B,iCADH89B,EAAAA,uEAAAA,69ECeAG,EAAAA,SAAAA,GAmEjB,QAAAA,GAAYlZ,EAAShhB,GAAMC,EAAAC,KAAAg6B,EAAA,IAAAn2B,GAAA5D,EAAAD,MAAAg6B,EAAA95B,WAAAX,OAAAY,eAAA65B,IAAA/6B,KAAAe,KACR9F,SAAT4F,EAAqBA,EAAKsD,GAAK,MADd,OAAA7D,QAAA2J,eAAArF,EAAA,gBAAAsF,YAAA,EAAAC,UAAA,EAAA1F,OA1BZ,IA0BYnE,OAAA2J,eAAArF,EAAA,YAAAsF,YAAA,EAAAC,UAAA,EAAA1F,MAvBhB,OAuBgBnE,OAAA2J,eAAArF,EAAA,SAAAsF,YAAA,EAAAC,UAAA,EAAA1F,WAAAnE,OAAA2J,eAAArF,EAAA,UAAAsF,YAAA,EAAAC,UAAA,EAAA1F,MAjBlB,SAAC2zB,EAAWzkB,OAiBMrT,OAAA2J,eAAArF,EAAA,UAAAsF,YAAA,EAAAC,UAAA,EAAA1F,MAZlB,SAAC2zB,EAAWzkB,GACb/O,EAAKC,MAAM8C,WAAWC,cACtBhD,EAAKC,MAAM8C,WAAWC,aAAaE,OAAOlD,EAAKC,UAU5BvE,OAAA2J,eAAArF,EAAA,UAAAsF,YAAA,EAAAC,UAAA,EAAA1F,MALlB,GAAAiuB,GAAA51B,UAKkBwD,OAAA2J,eAAArF,EAAA,UAAAsF,YAAA,EAAAC,UAAA,EAAA1F,MAFlB,GAAAu2B,GAAAl+B,UAKL8H,EAAK6wB,SAAW5T,EAChBjd,EAAKC,MAAQhE,EAJU+D,mDAmLlB7D,KAAKk6B,cAAcl6B,KAAKm6B,oBAC7Bn6B,KAAKokB,SAELpkB,KAAKo6B,MAAMx1B,MAAM5E,MACjBA,KAAKiM,OAAOC,QAAQ,wCAIflM,KAAKk6B,cAAcl6B,KAAKm6B,oBAC7Bn6B,KAAKoyB,UAELpyB,KAAKo6B,MAAM1pB,KAAK1Q,MAChBA,KAAKiM,OAAOC,QAAQ,wCAIflM,KAAKk6B,cAAcl6B,KAAKm6B,oBAEzBn6B,KAAKovB,IAAIpvB,KAAKovB,GAAGne,QACjBjR,KAAK0X,OAAO1X,KAAK0X,MAAM0F,QAC3Bpd,KAAK8D,MAAMsZ,OAAQ,EACnBpd,KAAK00B,SAAS2F,UAAU9pB,IAAI,SAC5BvQ,KAAKiM,OAAOC,QAAQ,0CAIflM,KAAKk6B,cAAcl6B,KAAKm6B,oBAE7Bn6B,KAAK00B,SAAS2F,UAAU5pB,OAAO,SAC/BzQ,KAAK00B,SAASxS,QACdliB,KAAK8D,MAAMsZ,OAAQ,EACfpd,KAAKovB,IAAIpvB,KAAKovB,GAAGne,QACjBjR,KAAK0X,OAAO1X,KAAK0X,MAAM4iB,SAC3Bt6B,KAAKiM,OAAOC,QAAQ,sCAOpBmf,EAAS6H,GACTlzB,KAAKu6B,OAAOhmB,IAAI8W,EAAS6H,+CAIzB,IAAIlzB,KAAKk6B,aAAT,CAEA,GAAIM,GAAYx6B,KAAK8D,MAAM8C,UAGW,kBAA3B4zB,GAAUhB,cAA8BgB,EAAUhB,gBAAiB,IAC1EgB,EAAUhB,aAAe,GAAAiB,GAAA1+B,SAGS,WAAlCuD,EAAOk7B,EAAUhB,eAA6BgB,EAAUhB,uBAAVjH,GAAAx2B,SAC9Cy+B,EAAUhB,aAAapV,SAKW,iBAA3BoW,GAAU7B,cAA8B6B,EAAU7B,gBAAiB,IAC1E6B,EAAU7B,aAAe,GAAA+B,GAAA3+B,QACzBy+B,EAAU7B,aAAatM,KAAKmO,EAAUhB,cAClCkB,EAAA3+B,QAAa+N,GAAG8uB,SAChB8B,EAAA3+B,QAAa+N,GAAG+uB,QAEhBzuB,OAAQ,aAIsB,WAAlC9K,EAAOk7B,EAAU7B,eAA6B6B,EAAU7B,uBAAVpG,GAAAx2B,SAC9Cy+B,EAAU7B,aAAavU,SAIW,iBAA3BoW,GAAU3zB,cAA8B2zB,EAAU3zB,gBAAiB,IAC1E2zB,EAAU3zB,aAAe,GAAA8zB,GAAA5+B,QACzBy+B,EAAU3zB,aAAawlB,KAAKmO,EAAUhB,aAAcx5B,MAChDgJ,MAAO,IACPC,OAAQ,IACRulB,gBAAiB,UAGrBgM,EAAU3zB,aAAagsB,cAAgB,GAAA+H,GAAA7+B,QACvCy+B,EAAU3zB,aAAagsB,cAAcxG,KAAKmO,EAAUhB,cAEpDgB,EAAU3zB,aAAa+rB,gBAAkB,GAAAiI,GAAA9+B,QACzCy+B,EAAU3zB,aAAa+rB,gBAAgBvG,KAAKmO,EAAUhB,eAGN,WAAhDl6B,EAAOk7B,EAAU3zB,aAAagsB,gBAC3B2H,EAAU3zB,aAAagsB,wBAAvBN,GAAAx2B,SAEHy+B,EAAU3zB,aAAagsB,cAAczO,SAGa,WAAlD9kB,EAAOk7B,EAAU3zB,aAAa+rB,kBAC3B4H,EAAU3zB,aAAa+rB,0BAAvBL,GAAAx2B,SAEHy+B,EAAU3zB,aAAa+rB,gBAAgBxO,SAGL,WAAlC9kB,EAAOk7B,EAAUhB,eAA6BgB,EAAUhB,uBAAVjH,GAAAx2B,SAC9Cy+B,EAAU3zB,aAAaud,SAIW,iBAA3BoW,GAAUvL,cAA8BuL,EAAUvL,gBAAiB,IAC1EuL,EAAUvL,aAAe6L,EAAA/+B,QAAaswB,OACtCmO,EAAUvL,aAAa5C,KAAKmO,EAAUhB,eAGJ,WAAlCl6B,EAAOk7B,EAAUvL,eAA6BuL,EAAUvL,uBAAVsD,GAAAx2B,SAC9Cy+B,EAAUvL,aAAa7K,SAG3BpkB,KAAKk6B,cAAe,gCA/RpB,MAAOl6B,MAAK8D,MAAMV,kCAMlB,MAAOpD,MAAKw5B,kDAOZ,MAAkD,iBAAvCx5B,MAAK8D,MAAM8C,WAAW4yB,aACtB,KACGx5B,KAAK8D,MAAM8C,WAAW4yB,2BAMvB5C,GACb,GAAwB,iBAAZA,IAAyBA,KAAY,GAAsB,OAAZA,EAEvD,YADA52B,KAAK8D,MAAM8C,WAAW4yB,cAAe,EAElC,IAAuB,YAAnB,mBAAO5C,GAAP,YAAAt3B,EAAOs3B,MAAyBA,EAAQ1gB,WAARqc,EAAAx2B,SACvC,KAAM,IAAA4X,GAAA5X,QAA6B,0CAGvCiE,MAAK8D,MAAM8C,WAAW4yB,aAAe5C,gCAIrC,MAAO52B,MAAKivB,kDAOZ,MAAkD,iBAAvCjvB,MAAK8D,MAAM8C,WAAWqoB,aACtB,KACGjvB,KAAK8D,MAAM8C,WAAWqoB,2BAMvB2H,GACb,GAAwB,iBAAZA,IAAyBA,KAAY,GAAsB,OAAZA,EAEvD,YADA52B,KAAK8D,MAAM8C,WAAWqoB,cAAe,EAElC,IAAuB,YAAnB,mBAAO2H,GAAP,YAAAt3B,EAAOs3B,MAAyBA,EAAQ1gB,WAARqc,EAAAx2B,SACvC,KAAM,IAAA4X,GAAA5X,QAA6B,0CAGvCiE,MAAK8D,MAAM8C,WAAWqoB,aAAe2H,6BAIrC,MAAO52B,MAAK24B,kDAOZ,MAAkD,iBAAvC34B,MAAK8D,MAAM8C,WAAW+xB,aACtB,KACG34B,KAAK8D,MAAM8C,WAAW+xB,2BAMvB/B,GACb,GAAwB,iBAAZA,IAAyBA,KAAY,GAAsB,OAAZA,EAEvD,YADA52B,KAAK8D,MAAM8C,WAAW+xB,cAAe,EAElC,IAAuB,YAAnB,mBAAO/B,GAAP,YAAAt3B,EAAOs3B,MAAyBA,EAAQ1gB,WAARqc,EAAAx2B,SACvC,KAAM,IAAA4X,GAAA5X,QAA6B,0CAGvCiE,MAAK8D,MAAM8C,WAAW+xB,aAAe/B,gCAIrC,MAAO52B,MAAK+6B,kDAOZ,MAAkD,iBAAvC/6B,MAAK8D,MAAM8C,WAAWm0B,aACtB,KACG/6B,KAAK8D,MAAM8C,WAAWm0B,2BAMvBnE,GACb,GAAwB,iBAAZA,IAAyBA,KAAY,GAAsB,OAAZA,EAEvD,YADA52B,KAAK8D,MAAM8C,WAAWm0B,cAAe,EAElC,IAAuB,YAAnB,mBAAOnE,GAAP,YAAAt3B,EAAOs3B,MAAyBA,EAAQ1gB,WAARqc,EAAAx2B,SACvC,KAAM,IAAA4X,GAAA5X,QAA6B,0CAGvCiE,MAAK8D,MAAM8C,WAAWm0B,aAAenE,iCAIrC,MAAO52B,MAAKg7B,kDAOZ,MAAkD,iBAAvCh7B,MAAK8D,MAAM8C,WAAWo0B,aACtB,KACGh7B,KAAK8D,MAAM8C,WAAWo0B,2BAMvBpE,GACb,GAAwB,iBAAZA,IAAyBA,KAAY,GAAsB,OAAZA,EAEvD,YADA52B,KAAK8D,MAAM8C,WAAWo0B,cAAe,EAElC,IAAuB,YAAnB,mBAAOpE,GAAP,YAAAt3B,EAAOs3B,MAAyBA,EAAQ1gB,WAARqc,EAAAx2B,SACvC,KAAM,IAAA4X,GAAA5X,QAA6B,0CAGvCiE,MAAK8D,MAAM8C,WAAWo0B,aAAepE,gCAIrC,MAAO52B,MAAK6G,kDAOZ,MAAkD,iBAAvC7G,MAAK8D,MAAM8C,WAAWC,aACtB,KACG7G,KAAK8D,MAAM8C,WAAWC,2BAMvB+vB,GACb,GAAwB,iBAAZA,IAAyBA,KAAY,GAAsB,OAAZA,EAEvD,YADA52B,KAAK8D,MAAM8C,WAAWC,cAAe,EAElC,IAAuB,YAAnB,mBAAO+vB,GAAP,YAAAt3B,EAAOs3B,MAAyBA,EAAQ1gB,WAARqc,EAAAx2B,SACvC,KAAM,IAAA4X,GAAA5X,QAA6B,0CAGvCiE,MAAK8D,MAAM8C,WAAWC,aAAe+vB,iCAyI7BqE,EAAU9wB,GAiElB,QAAS+wB,KACL,GAAIjH,GAAAA,MAYJ,OAXIj0B,MAAKq6B,UAAUnoB,SAAS,UACxB+hB,EAAS+F,EAAUloB,MAAM9R,KAAKm7B,aAAa,UAAY,KACnDlH,GAAQA,EAAOqG,SACnBc,EAAWp7B,QACHA,KAAKq6B,UAAUnoB,SAAS,oBAAsBlS,KAAKq6B,UAAUnoB,SAAS,YAC9ElS,KAAKq6B,UAAU9pB,IAAI,UACnBvQ,KAAKkiB,QACL+R,EAAS+F,EAAUloB,MAAM9R,KAAKm7B,aAAa,UAAY,KACnDlH,GAAQA,EAAOqG,SACnBc,EAAWp7B,QAER,EA7EM9F,SAAb+gC,IAAwBA,EAAW,QACvB/gC,SAAZiQ,IAAuBA,MAE3BA,EAAUpG,EAAAhI,QAAQ6D,QAAO,KAAUo6B,EAAU15B,SAAU6J,EAEvD,IAAI0S,KACJ,IAAwB,gBAAboe,GACPpe,EAAQxS,OAAOC,SAAS0jB,iBAAiBiN,OACtC,CAAA,KAAwB,YAApB,mBAAOA,GAAP,YAAA37B,EAAO27B,KAA2C/gC,SAAlBmQ,OAAOgxB,QAAwBJ,YAAoB5wB,QAAOgxB,QAE9F,MAAO,KADVxe,GAAQoe,EAASjhC,MAKrB,IAAK,GAFDshC,MAEKhjC,EAAI,EAAGA,EAAIukB,EAAMzkB,OAAQE,IACzBukB,EAAMvkB,GAAGijC,aAAa,SAASD,EAAc/vB,KAAKsR,EAAMvkB,GAGjE,KAAK,GAAIA,GAAI,EAAGA,EAAIgjC,EAAcljC,OAAQE,IAAK,CAC3C6R,EAAQ/G,GAAKC,EAAAtH,QAAKuH,WAElBg4B,EAAchjC,GAAGkjC,aAAa,OAAQrxB,EAAQ/G,GAE9C,IAAIA,GAAKk4B,EAAchjC,GAAG6iC,aAAa,KAC5BjhC,UAAPkJ,GAA2B,OAAPA,GACpBk4B,EAAchjC,GAAGkjC,aAAa,OAAQrxB,EAAQ/G,GAGlD,IAAIq4B,GAAWH,EAAchjC,GAAG6iC,aAAa,WAC5BjhC,UAAbuhC,GAAuC,OAAbA,GAAqBA,KAAa,GAC5DH,EAAchjC,GAAGkjC,aAAa,WAAY,MAGzCF,EAAchjC,GAAG+hC,UAAUnoB,SAAS,QACrCopB,EAAchjC,GAAG+hC,UAAU9pB,IAAI,OAGnCmrB,EAAA3/B,QAAO+9B,qBAAqBvuB,KAAKpB,EAAQ/G,IACzC42B,EAAUloB,MAAM3H,EAAQ/G,IAAM,GAAI42B,GAAUsB,EAAchjC,GAAI6R,GAC9D6vB,EAAUloB,MAAMvG,KAAKpB,EAAQ/G,IAE7Bk4B,EAAchjC,GAAGqjC,QACjBL,EAAchjC,GAAG4pB,QAGrB,GAAIkZ,GAAa,SAACrX,GACd,GAAIlH,GAAAA,OAAOoX,EAAAA,MACXpX,GAAQxS,OAAOC,SAAS0jB,iBAAiB,mDACzC,KAAK,GAAI11B,GAAI,EAAGA,EAAIukB,EAAMzkB,OAAQE,IAC1ByrB,IAAYlH,EAAMvkB,KAClBukB,EAAMvkB,GAAG+hC,UAAU5pB,OAAO,UAC1BwjB,EAAS+F,EAAUloB,MAAM+K,EAAMvkB,GAAG6iC,aAAa,UAAY,KACvDlH,GAAQA,EAAO7W,QAI3BP,GAAQxS,OAAOC,SAAS0jB,iBAAiB,oDACzC,KAAK,GAAI11B,GAAI,EAAGA,EAAIukB,EAAMzkB,OAAQE,IAC1ByrB,IAAYlH,EAAMvkB,IAClBukB,EAAMvkB,GAAG+hC,UAAU5pB,OAAO,WAqBlCmrB,IACJ/e,GAAQxS,OAAOC,SAAS0jB,iBAAiB,aACzC,KAAK,GAAI11B,GAAI,EAAGA,EAAIukB,EAAMzkB,OAAQE,IAC9BsjC,EAAYrwB,KAAKyuB,EAAUloB,MAAM+K,EAAMvkB,GAAG6iC,aAAa,UAAY,MACnEte,EAAMvkB,GAAG8N,iBAAiB,QAAS80B,GACnCre,EAAMvkB,GAAG8N,iBAAiB,QAAS80B,GACnCre,EAAMvkB,GAAG8N,iBAAiB,aAAc80B,EAE5C,OAAQ,KAAMU,EAAYxjC,OAAUwjC,EAAY,GAAKA,gCAG5C/qB,GACLmpB,EAAU6B,WACN7B,EAAU8B,QACV9B,EAAU8B,QAAQxxB,UAAUyxB,MAAMlrB,GAC/BA,IAEHmpB,EAAU8B,QACV9B,EAAU8B,QAAQxxB,UAAUwG,GAAG,YAAa,WACxCkpB,EAAU8B,QAAQxxB,UAAUyxB,MAAMlrB,KAEnCxG,OAAOC,SAASlE,iBAAiB,YAAayK,kCAQ/CwqB,GAgBV,MAfArB,GAAU8B,QAAqB5hC,SAAXmhC,EAAuBA,EAAShxB,OAAOgxB,OAE3D,SAAW9a,GAMPA,EAAE9nB,GAAGkmB,IAAM,SAAUxU,GAEjB,GAAI4tB,GAAW/3B,IACf,OAAOg6B,GAAU3N,KAAK0L,EAAU5tB,KAErC6vB,EAAU8B,SAEN9B,EAAU8B,qDAOjB,GAAIE,IAAQ,CAGZ,IAAuB,SAAnBrK,EAAA51B,QAAO61B,SAAsBD,EAAA51B,QAAO81B,QAAU,GAAI,CAClD,GAAIxG,GAAU,mEACd4Q,OAAM5Q,GACN/W,QAAQqH,MAAM0P,GAEd2Q,GAAQ,EA0BZ,MAtBuB,OAAnBrK,EAAA51B,QAAO61B,SAAoBD,EAAA51B,QAAO81B,SAAW,KAC7C,WACI,GAAIqK,GAAc,SAACtrB,EAAOurB,GACtBA,EAASA,IAAWC,SAAS,EAAOC,YAAY,EAAOC,OAAQpiC,OAE/D,IAAIqiC,GAAcjyB,SAASkyB,YAAY,cAUvC,OATAD,GAAYE,gBAAgB7rB,EAAOurB,EAAOC,QAASD,EAAOE,WAAYF,EAAOG,QAC7EC,EAAYzxB,eAAiB,WACzBvL,OAAO2J,eAAelJ,KAAM,oBACxBhG,IAAK,WACD,OAAO,MAInBuiC,EAAYzxB,iBACLyxB,EAEXL,GAAYn9B,UAAYsL,OAAOqyB,MAAM39B,UACrCsL,OAAO6xB,YAAcA,KAItBF,0CA/hBMhC,EAAAA,2CAEA,sDAFAA,EAAAA,+CAKG,0BALHA,EAAAA,6CAoBb52B,GAAI,GACJga,OAAO,EACPia,UAAW,EACXzkB,UAAW,EACXhM,YACI4yB,cAAc,EACdvK,cAAc,EACd0J,cAAc,EACdoC,cAAc,EACdC,cAAc,EACdn0B,cAAc,4BA9BLmzB,EAAAA,oEAAAA,EAAAA,8DAAAA,GAoiBpBA,EAAU2C,WAAa,WAkBpB,QAASC,KACL,GAAIrM,GAAasM,GACjB,KAAKtM,EAAY,CACb,GAAI/iB,GAAAA,OAAMymB,EAAAA,MACVzmB,GAAOnD,OAAOC,SAAS6pB,cAAc,qBACjC3mB,IAAMymB,EAAS+F,EAAUloB,MAAMtE,EAAK2tB,aAAa,UAAY,MAC7DlH,GAAQA,EAAOttB,MAAMm2B,iBAAiBvM,GAE1C/iB,EAAOnD,OAAOC,SAAS6pB,cAAc,2BACjC3mB,IAAMymB,EAAS+F,EAAUloB,MAAMtE,EAAK2tB,aAAa,UAAY,MAC7DlH,GAAQA,EAAOxpB,QAAQ8lB,IA3BnC,GAAIyJ,EAAU6B,YAAc7B,EAAU+C,qBAAsB,OAAO,GAElE,GAAA9C,GAAAl+B,SAAqBihC,UAAtB,SACahD,EAAUiD,QADvB,cAC4CtL,EAAA51B,QAAO61B,QADnD,MACgED,EAAA51B,QAAO81B,QAAW,+BAGlF,IAAIgL,GAAe,WAEf,SAAUxyB,OAAOC,SAAS4yB,yBACnB7yB,OAAOC,SAAS6yB,iCACI,YAAnBxL,EAAA51B,QAAO61B,SAAyBD,EAAA51B,QAAO81B,QAAU,GAC/CxnB,OAAOC,SAAS8yB,qBAChB/yB,OAAOC,SAAS+yB,oBACnBhzB,OAAOC,SAASgzB,sBAkBvBC,EAAOlzB,OAAOC,SAAS6pB,cAAc,OA2CzC,OAzCKoJ,GAAKlD,UAAUnoB,SAAS,gBACzB7H,OAAOC,SAASlE,iBAAiB,mBAAoBw2B,GACrDvyB,OAAOC,SAASlE,iBAAiB,yBAA0Bw2B,GAC3DvyB,OAAOC,SAASlE,iBAAiB,sBAAuBw2B,GACxDvyB,OAAOC,SAASlE,iBAAiB,qBAAsBw2B,GAEvDvyB,OAAOjE,iBAAiB,QAAS,WAC7B,GAAIoH,GAAAA,OAAMymB,EAAAA,MACVzmB,GAAOnD,OAAOC,SAAS6pB,cAAc,2CACjC3mB,IAAMymB,EAAS+F,EAAUloB,MAAMtE,EAAK2tB,aAAa,UAAY,MAC7DlH,GAAQA,EAAOqG,WAGvBjwB,OAAOjE,iBAAiB,OAAQ,WAC5B,GAAIyW,GAAAA,OAAOoX,EAAAA,MACXpX,GAAQxS,OAAOC,SAAS0jB,iBAAiB,iCACzC,KAAK,GAAI11B,GAAI,EAAGA,EAAIukB,EAAMzkB,OAAQE,IAC1BukB,EAAMvkB,KAAI27B,EAAS+F,EAAUloB,MAAM+K,EAAMvkB,GAAG6iC,aAAa,UAAY,MACrElH,GAAQA,EAAO7W,UAI3B/S,OAAOjE,iBAAiB,SAAU,WAC9B,IAAK,GAAI9N,GAAI,EAAGA,EAAI0hC,EAAUloB,MAAM1Z,OAAQE,IACxC0hC,EAAUloB,MAAMkoB,EAAUloB,MAAMxZ,IAAI0L,OAAOw5B,UAG/C,IAAIjN,GAAasM,GACjB,IAAItM,EAAY,CACZ,GAAI/iB,GAAAA,OAAMymB,EAAAA,MACVzmB,GAAOnD,OAAOC,SAAS6pB,cAAc,qBACjC3mB,IAAMymB,EAAS+F,EAAUloB,MAAMtE,EAAK2tB,aAAa,UAAY,MAC7DlH,GAAQA,EAAOttB,MAAMm2B,iBAAiBvM,GAE9C,OAAO,IAEXgN,EAAKlD,UAAU9pB,IAAI,eAGvBlG,OAAOC,SAASmzB,cAAe,GAAIvB,aAAY,cAExClC,EAAU6B,YAAa","file":"j2d.min.js","sourcesContent":["let InterpolationEnum;\r\n\r\n/**\r\n * @class Interpolation\r\n * @exports module:transitions/utils/Interpolation\r\n *\r\n * @type {{Linear: Interpolation.Linear, Bezier: Interpolation.Bezier, CatmullRom: Interpolation.CatmullRom}}\r\n */\r\nlet Interpolation = {\r\n    /**\r\n     * @return {number}\r\n     */\r\n    Linear: function (v, k) {\r\n        var m = v.length - 1;\r\n        var f = m * k;\r\n        var i = Math.floor(f);\r\n        var fn = Interpolation.Utils.Linear;\r\n\r\n        if (k < 0) return fn(v[0], v[1], f);\r\n        if (k > 1) return fn(v[m], v[m - 1], m - f);\r\n\r\n        return fn(v[i], v[i + 1 > m ? m : i + 1], f - i);\r\n    },\r\n\r\n    /**\r\n     * @return {number}\r\n     */\r\n    Bezier: function (v, k) {\r\n        var b = 0;\r\n        var n = v.length - 1;\r\n        var pw = Math.pow;\r\n        var bn = Interpolation.Utils.Bernstein;\r\n\r\n        for (var i = 0; i <= n; i++) {\r\n            b += pw(1 - k, n - i) * pw(k, i) * v[i] * bn(n, i);\r\n        }\r\n\r\n        return b;\r\n    },\r\n\r\n    /**\r\n     * @return {number}\r\n     */\r\n    CatmullRom: function (v, k) {\r\n        var m = v.length - 1;\r\n        var f = m * k;\r\n        var i = Math.floor(f);\r\n        var fn = Interpolation.Utils.CatmullRom;\r\n\r\n        if (v[0] === v[m]) {\r\n            if (k < 0) i = Math.floor(f = m * (1 + k));\r\n\r\n            return fn(v[(i - 1 + m) % m], v[i], v[(i + 1) % m], v[(i + 2) % m], f - i);\r\n        } else {\r\n            if (k < 0) return v[0] - (fn(v[0], v[0], v[1], v[1], -f) - v[0]);\r\n            if (k > 1) return v[m] - (fn(v[m], v[m], v[m - 1], v[m - 1], f - m) - v[m]);\r\n\r\n            return fn(v[i ? i - 1 : 0], v[i], v[m < i + 1 ? m : i + 1], v[m < i + 2 ? m : i + 2], f - i);\r\n        }\r\n    },\r\n\r\n    Utils: {\r\n        /**\r\n         * @return {number}\r\n         */\r\n        Linear: function (p0, p1, t) {\r\n            return (p1 - p0) * t + p0;\r\n        },\r\n\r\n        /**\r\n         * @return {number}\r\n         */\r\n        Bernstein: function (n, i) {\r\n            var fc = Interpolation.Utils.Factorial;\r\n            return fc(n) / fc(i) / fc(n - i);\r\n        },\r\n\r\n        Factorial: (function () {\r\n            var a = [1];\r\n            return function (n) {\r\n                var s = 1;\r\n                if (a[n]) return a[n];\r\n\r\n                for (var i = n; i > 1; i--) {\r\n                    s *= i;\r\n                }\r\n                a[n] = s;\r\n\r\n                return s;\r\n            };\r\n        })(),\r\n\r\n        /**\r\n         * @return {number}\r\n         */\r\n        CatmullRom: function (p0, p1, p2, p3, t) {\r\n            var v0 = (p2 - p0) * 0.5;\r\n            var v1 = (p3 - p1) * 0.5;\r\n            var t2 = t * t;\r\n            var t3 = t * t2;\r\n\r\n            return (2 * p1 - 2 * p2 + v0 + v1) * t3 + (-3 * p1 + 3 * p2 - 2 * v0 - v1) * t2 + v0 * t + p1;\r\n        }\r\n    },\r\n\r\n    get: (interpolation) => {\r\n        if (InterpolationEnum[interpolation] !== undefined) {\r\n            return InterpolationEnum[interpolation];\r\n        }\r\n\r\n        // TODO:: Exceptions\r\n        //throw new InvalidArgumentException('Unknown interpolation: ' + interpolation);\r\n    },\r\n\r\n    register: (interpolation, interpolationFunction) => {\r\n        InterpolationEnum[interpolation] = interpolationFunction;\r\n    }\r\n};\r\n\r\nInterpolationEnum = {\r\n    'linear': Interpolation.Linear,\r\n    'bezier': Interpolation.Bezier,\r\n    'catmull-rom': Interpolation.CatmullRom\r\n};\r\n\r\nexport default Interpolation;\r\n","import Tween from \"transitions/Tween\";\r\n\r\nlet EasingEnum;\r\n\r\n/**\r\n * @class Easing\r\n * @exports module:transitions/utils/Easing\r\n *\r\n * @type {{Linear: {None: Easing.Linear.None}, Quadratic: {In: Easing.Quadratic.In, Out: Easing.Quadratic.Out, InOut: Easing.Quadratic.InOut}, Cubic: {In: Easing.Cubic.In, Out: Easing.Cubic.Out, InOut: Easing.Cubic.InOut}, Quartic: {In: Easing.Quartic.In, Out: Easing.Quartic.Out, InOut: Easing.Quartic.InOut}, Quintic: {In: Easing.Quintic.In, Out: Easing.Quintic.Out, InOut: Easing.Quintic.InOut}, Sinusoidal: {In: Easing.Sinusoidal.In, Out: Easing.Sinusoidal.Out, InOut: Easing.Sinusoidal.InOut}, Exponential: {In: Easing.Exponential.In, Out: Easing.Exponential.Out, InOut: Easing.Exponential.InOut}, Circular: {In: Easing.Circular.In, Out: Easing.Circular.Out, InOut: Easing.Circular.InOut}, Elastic: {In: Easing.Elastic.In, Out: Easing.Elastic.Out, InOut: Easing.Elastic.InOut}, Back: {In: Easing.Back.In, Out: Easing.Back.Out, InOut: Easing.Back.InOut}, Bounce: {In: Easing.Bounce.In, Out: Easing.Bounce.Out, InOut: Easing.Bounce.InOut}}}\r\n */\r\nlet Easing = {\r\n    Linear: {\r\n        /**\r\n         * @return {number}\r\n         */\r\n        None: function (k) {\r\n            return k;\r\n        }\r\n    },\r\n    Quadratic: {\r\n        /**\r\n         * @return {number}\r\n         */\r\n        In: function (k) {\r\n            return k * k;\r\n        },\r\n\r\n        /**\r\n         * @return {number}\r\n         */\r\n        Out: function (k) {\r\n            return k * (2 - k);\r\n        },\r\n\r\n        /**\r\n         * @return {number}\r\n         */\r\n        InOut: function (k) {\r\n            if ((k *= 2) < 1) return 0.5 * k * k;\r\n            return -0.5 * (--k * (k - 2) - 1);\r\n        }\r\n    },\r\n\r\n    Cubic: {\r\n        /**\r\n         * @return {number}\r\n         */\r\n        In: function (k) {\r\n            return k * k * k;\r\n        },\r\n\r\n        /**\r\n         * @return {number}\r\n         */\r\n        Out: function (k) {\r\n            return --k * k * k + 1;\r\n        },\r\n\r\n        /**\r\n         * @return {number}\r\n         */\r\n        InOut: function (k) {\r\n            if ((k *= 2) < 1) return 0.5 * k * k * k;\r\n            return 0.5 * ((k -= 2) * k * k + 2);\r\n        }\r\n    },\r\n\r\n    Quartic: {\r\n        /**\r\n         * @return {number}\r\n         */\r\n        In: function (k) {\r\n            return k * k * k * k;\r\n        },\r\n\r\n        /**\r\n         * @return {number}\r\n         */\r\n        Out: function (k) {\r\n            return 1 - (--k * k * k * k);\r\n        },\r\n\r\n        /**\r\n         * @return {number}\r\n         */\r\n        InOut: function (k) {\r\n            if ((k *= 2) < 1)  return 0.5 * k * k * k * k;\r\n            return -0.5 * ((k -= 2) * k * k * k - 2);\r\n        }\r\n    },\r\n\r\n    Quintic: {\r\n        /**\r\n         * @return {number}\r\n         */\r\n        In: function (k) {\r\n            return k * k * k * k * k;\r\n        },\r\n\r\n        /**\r\n         * @return {number}\r\n         */\r\n        Out: function (k) {\r\n            return --k * k * k * k * k + 1;\r\n        },\r\n\r\n        /**\r\n         * @return {number}\r\n         */\r\n        InOut: function (k) {\r\n            if ((k *= 2) < 1) return 0.5 * k * k * k * k * k;\r\n            return 0.5 * ((k -= 2) * k * k * k * k + 2);\r\n        }\r\n\r\n    },\r\n\r\n    Sinusoidal: {\r\n        /**\r\n         * @return {number}\r\n         */\r\n        In: function (k) {\r\n            return 1 - Math.cos(k * Math.PI / 2);\r\n        },\r\n\r\n        /**\r\n         * @return {number}\r\n         */\r\n        Out: function (k) {\r\n            return Math.sin(k * Math.PI / 2);\r\n        },\r\n\r\n        /**\r\n         * @return {number}\r\n         */\r\n        InOut: function (k) {\r\n            return 0.5 * (1 - Math.cos(Math.PI * k));\r\n        }\r\n    },\r\n\r\n    Exponential: {\r\n        /**\r\n         * @return {number}\r\n         */\r\n        In: function (k) {\r\n            return k === 0 ? 0 : Math.pow(1024, k - 1);\r\n        },\r\n\r\n        /**\r\n         * @return {number}\r\n         */\r\n        Out: function (k) {\r\n            return k === 1 ? 1 : 1 - Math.pow(2, -10 * k);\r\n        },\r\n\r\n        /**\r\n         * @return {number}\r\n         */\r\n        InOut: function (k) {\r\n            if (k === 0) return 0;\r\n            if (k === 1) return 1;\r\n            if ((k *= 2) < 1) return 0.5 * Math.pow(1024, k - 1);\r\n\r\n            return 0.5 * (-Math.pow(2, -10 * (k - 1)) + 2);\r\n        }\r\n    },\r\n\r\n    Circular: {\r\n        /**\r\n         * @return {number}\r\n         */\r\n        In: function (k) {\r\n            return 1 - Math.sqrt(1 - k * k);\r\n        },\r\n\r\n        /**\r\n         * @return {number}\r\n         */\r\n        Out: function (k) {\r\n            return Math.sqrt(1 - (--k * k));\r\n        },\r\n\r\n        /**\r\n         * @return {number}\r\n         */\r\n        InOut: function (k) {\r\n            if ((k *= 2) < 1) return -0.5 * (Math.sqrt(1 - k * k) - 1);\r\n            return 0.5 * (Math.sqrt(1 - (k -= 2) * k) + 1);\r\n        }\r\n    },\r\n\r\n    Elastic: {\r\n        /**\r\n         * @return {number}\r\n         */\r\n        In: function (k) {\r\n            var s;\r\n            var a = 0.1;\r\n            var p = 0.4;\r\n\r\n            if (k === 0) return 0;\r\n            if (k === 1) return 1;\r\n\r\n            if (!a || a < 1) {\r\n                a = 1;\r\n                s = p / 4;\r\n            } else {\r\n                s = p * Math.asin(1 / a) / (2 * Math.PI);\r\n            }\r\n\r\n            return -(a * Math.pow(2, 10 * (k -= 1)) * Math.sin((k - s) * (2 * Math.PI) / p));\r\n        },\r\n\r\n        /**\r\n         * @return {number}\r\n         */\r\n        Out: function (k) {\r\n            var s;\r\n            var a = 0.1;\r\n            var p = 0.4;\r\n\r\n            if (k === 0) return 0;\r\n            if (k === 1) return 1;\r\n\r\n            if (!a || a < 1) {\r\n                a = 1;\r\n                s = p / 4;\r\n            } else {\r\n                s = p * Math.asin(1 / a) / (2 * Math.PI);\r\n            }\r\n\r\n            return (a * Math.pow(2, -10 * k) * Math.sin((k - s) * (2 * Math.PI) / p) + 1);\r\n        },\r\n\r\n        /**\r\n         * @return {number}\r\n         */\r\n        InOut: function (k) {\r\n\r\n            var s;\r\n            var a = 0.1;\r\n            var p = 0.4;\r\n\r\n            if (k === 0) return 0;\r\n            if (k === 1) return 1;\r\n\r\n            if (!a || a < 1) {\r\n                a = 1;\r\n                s = p / 4;\r\n            } else {\r\n                s = p * Math.asin(1 / a) / (2 * Math.PI);\r\n            }\r\n\r\n            if ((k *= 2) < 1) {\r\n                return -0.5 * (a * Math.pow(2, 10 * (k -= 1)) * Math.sin((k - s) * (2 * Math.PI) / p));\r\n            }\r\n\r\n            return a * Math.pow(2, -10 * (k -= 1)) * Math.sin((k - s) * (2 * Math.PI) / p) * 0.5 + 1;\r\n\r\n        }\r\n\r\n    },\r\n\r\n    Back: {\r\n        /**\r\n         * @return {number}\r\n         */\r\n        In: function (k) {\r\n            var s = 1.70158;\r\n\r\n            return k * k * ((s + 1) * k - s);\r\n        },\r\n\r\n        /**\r\n         * @return {number}\r\n         */\r\n        Out: function (k) {\r\n            var s = 1.70158;\r\n\r\n            return --k * k * ((s + 1) * k + s) + 1;\r\n        },\r\n\r\n        /**\r\n         * @return {number}\r\n         */\r\n        InOut: function (k) {\r\n            var s = 1.70158 * 1.525;\r\n            if ((k *= 2) < 1) return 0.5 * (k * k * ((s + 1) * k - s));\r\n\r\n            return 0.5 * ((k -= 2) * k * ((s + 1) * k + s) + 2);\r\n        }\r\n    },\r\n\r\n    Bounce: {\r\n        /**\r\n         * @return {number}\r\n         */\r\n        In: function (k) {\r\n            return 1 - Tween.Easing.Bounce.Out(1 - k);\r\n        },\r\n\r\n        /**\r\n         * @return {number}\r\n         */\r\n        Out: function (k) {\r\n            if (k < (1 / 2.75)) {\r\n                return 7.5625 * k * k;\r\n            } else if (k < (2 / 2.75)) {\r\n                return 7.5625 * (k -= (1.5 / 2.75)) * k + 0.75;\r\n            } else if (k < (2.5 / 2.75)) {\r\n                return 7.5625 * (k -= (2.25 / 2.75)) * k + 0.9375;\r\n            } else {\r\n                return 7.5625 * (k -= (2.625 / 2.75)) * k + 0.984375;\r\n            }\r\n        },\r\n\r\n        /**\r\n         * @return {number}\r\n         */\r\n        InOut: function (k) {\r\n            if (k < 0.5) return Tween.Easing.Bounce.In(k * 2) * 0.5;\r\n            return Tween.Easing.Bounce.Out(k * 2 - 1) * 0.5 + 0.5;\r\n        }\r\n    },\r\n\r\n    get: (easing) => {\r\n        if (EasingEnum[easing] !== undefined) {\r\n            return EasingEnum[easing];\r\n        }\r\n\r\n        // TODO:: Exceptions\r\n        //throw new InvalidArgumentException('Unknown easing: ' + easing);\r\n    },\r\n    register: (easing, easingFunction) => {\r\n        EasingEnum[easing] = easingFunction;\r\n    }\r\n};\r\n\r\nEasingEnum = {\r\n    'linear': Easing.Linear.None,\r\n\r\n    'quadratic-in': Easing.Quadratic.In,\r\n    'quadratic-out': Easing.Quadratic.Out,\r\n    'quadratic-in-out': Easing.Quadratic.InOut,\r\n\r\n    'cubic-in': Easing.Cubic.In,\r\n    'cubic-out': Easing.Cubic.Out,\r\n    'cubic-in-out': Easing.Cubic.InOut,\r\n\r\n    'quartic-in': Easing.Quartic.In,\r\n    'quartic-out': Easing.Quartic.Out,\r\n    'quartic-in-out': Easing.Quartic.InOut,\r\n\r\n    'quintic-in': Easing.Quintic.In,\r\n    'quintic-out': Easing.Quintic.Out,\r\n    'quintic-in-out': Easing.Quintic.InOut,\r\n\r\n    'sinusoidal-in': Easing.Sinusoidal.In,\r\n    'sinusoidal-out': Easing.Sinusoidal.Out,\r\n    'sinusoidal-in-out': Easing.Sinusoidal.InOut,\r\n\r\n    'exponential-in': Easing.Exponential.In,\r\n    'exponential-out': Easing.Exponential.Out,\r\n    'exponential-in-out': Easing.Exponential.InOut,\r\n\r\n    'circular-in': Easing.Circular.In,\r\n    'circular-out': Easing.Circular.Out,\r\n    'circular-in-out': Easing.Circular.InOut,\r\n\r\n    'elastic-in': Easing.Elastic.In,\r\n    'elastic-out': Easing.Elastic.Out,\r\n    'elastic-in-out': Easing.Elastic.InOut,\r\n\r\n    'back-in': Easing.Back.In,\r\n    'back-out': Easing.Back.Out,\r\n    'back-in-out': Easing.Back.InOut,\r\n\r\n    'bounce-in': Easing.Bounce.In,\r\n    'bounce-out': Easing.Bounce.Out,\r\n    'bounce-in-out': Easing.Bounce.InOut\r\n};\r\n\r\nexport default Easing;\r\n","/**\r\n * @class MathUtil\r\n * @exports module:utils/MathUtil\r\n *\r\n * @constructor\r\n */\r\nexport default class MathUtil {\r\n    /**\r\n     * @param {number} number\r\n     * @returns {number}\r\n     */\r\n    static number2Integer(number) {\r\n        return number >> 0;\r\n    }\r\n\r\n    /**\r\n     * @param {number} number\r\n     * @returns {boolean}\r\n     */\r\n    static isInteger(number) {\r\n        return typeof number === \"number\" && isFinite(number)\r\n            && number > -9007199254740992 && number < 9007199254740992\r\n            && Math.floor(number) === number;\r\n    }\r\n\r\n    /**\r\n     * @param {number} min\r\n     * @param {number} max\r\n     * @param {number} opacity\r\n     * @returns {string}\r\n     */\r\n    static randomColor(min, max, opacity) {\r\n        return 'rgba('\r\n            + MathUtil.random(min, max) + ', '\r\n            + MathUtil.random(min, max) + ', '\r\n            + MathUtil.random(min, max) + ', '\r\n            + opacity + ')';\r\n    }\r\n\r\n    static vectorColorToRGBA(vector4) {\r\n        return 'rgba('\r\n            + parseInt(vector4[0] / (1 / 255)) + ', '\r\n            + parseInt(vector4[1] / (1 / 255)) + ', '\r\n            + parseInt(vector4[2] / (1 / 255)) + ', '\r\n            + vector4[3] + ')';\r\n    }\r\n\r\n    /**\r\n     * @param {number} min\r\n     * @param {number} max\r\n     * @param {boolean} [omitZero]\r\n     * @returns {number}\r\n     */\r\n    static random(min, max, omitZero) {\r\n        let random = (Math.floor(Math.random() * (max - min + 1) + min));\r\n        return (omitZero && random === 0)\r\n            ? MathUtil.random(min, max, omitZero)\r\n            : random;\r\n    }\r\n\r\n    /**\r\n     * @param {number} degree\r\n     * @returns {number}\r\n     */\r\n    static degree2Radian(degree) {\r\n        return degree * (Math.PI / 180);\r\n    }\r\n\r\n    /**\r\n     * @param {number} radian\r\n     * @returns {number}\r\n     */\r\n    static radian2Degree(radian) {\r\n        return radian * (180 / Math.PI);\r\n    }\r\n}\r\n","/**\r\n * @class ObjectUtil\r\n * @exports module:utils/ObjectUtil\r\n *\r\n * @constructor\r\n */\r\nexport default class ObjectUtil {\r\n    static extend() {\r\n        let args = Array.prototype.slice.call(arguments);\r\n        let deepness = false;\r\n        if (typeof args[0] === 'boolean') {\r\n            deepness = args[0];\r\n            args.splice(0, 1);\r\n        }\r\n\r\n        let out = args[0] || function () {\r\n                if (args[1] !== undefined && args[1] !== null && typeof args[1] === 'object') {\r\n                    return Object.create(args[1])\r\n                }\r\n                return {};\r\n            }();\r\n\r\n        for (let i = 1; i < args.length; i++) {\r\n            let object = args[i];\r\n\r\n            if (!object) continue;\r\n\r\n            for (let key in object) {\r\n                //noinspection JSUnresolvedFunction\r\n                if (object.hasOwnProperty(key)) {\r\n                    if (typeof object[key] === 'object' && object[key] !== null) {\r\n                        out[key] = deepness ? ObjectUtil.extend(deepness, out[key], object[key]) : object[key];\r\n                    } else {\r\n                        out[key] = object[key];\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        return out;\r\n    }\r\n}\r\n","import ObjectUtil from \"../../utils/ObjectUtil\";\r\nimport AnimatedNode from \"nodes/AnimatedNode\";\r\nimport MathUtil from \"../../utils/MathUtil\";\r\n\r\n/**\r\n * @class RectNode\r\n * @exports module:nodes/RectNode\r\n *\r\n * @constructor\r\n * @extends nodes/_deprecated_AnimatedNode\r\n * @param {BaseNode.defaults|AnimatedNode.defaults|RectNode.defaults|Object} [data]\r\n * @property {BaseNode.defaults|AnimatedNode.defaults|RectNode.defaults} data\r\n */\r\nexport default class _deprecated_RectNode extends _deprecated_AnimatedNode {\r\n    static defaults = {\r\n        type: 'RectNode',\r\n        color: '#000000'\r\n    };\r\n\r\n    constructor(data) {\r\n        super(ObjectUtil.extend(true, {}, RectNode.defaults, data));\r\n    }\r\n\r\n    /**\r\n     * @returns {string}\r\n     */\r\n    getColor() {\r\n        return this.data.color;\r\n    }\r\n\r\n    /**\r\n     * @param {string} color\r\n     * @returns {RectNode}\r\n     */\r\n    setColor(color) {\r\n        this.data.color = color;\r\n        return this;\r\n    }\r\n\r\n    /* ------------------------------ Draw ------------------------------ */\r\n\r\n    /**\r\n     * @param {CanvasRenderingContext2D} context\r\n     * @param {{offset: {x: number, y: number}, size: {x: number, y: number}, scale: number, angle: number}} viewport\r\n     * @param {_deprecated_CollectionNode} collection\r\n     * @param {object} data\r\n     * @returns {null}\r\n     */\r\n    draw(context, viewport, collection, data) {\r\n        if (this.data.visible && this.inViewport(viewport)) {\r\n            //console.log(this.inViewport(viewport));\r\n            if (this.data.opacity !== 1.0) {\r\n                var tempOpacity = context.globalAlpha;\r\n                context.globalAlpha = this.data.opacity;\r\n            }\r\n\r\n            if (this.data.angle || viewport.angle !== 0.0) {\r\n                context.save();\r\n\r\n                context.translate(\r\n                    this.getPosition().x - viewport.offset.x,\r\n                    this.getPosition().y - viewport.offset.y);\r\n                context.rotate(MathUtil.degree2Radian(this.data.angle + viewport.angle));\r\n                context.translate(\r\n                    -(this.getPosition().x - viewport.offset.x),\r\n                    -(this.getPosition().y - viewport.offset.y));\r\n            }\r\n\r\n            context.fillStyle = this.data.color;\r\n            context.lineWidth = 0;\r\n\r\n            context.fillRect(\r\n                this.data.position.x - viewport.offset.x,\r\n                this.data.position.y - viewport.offset.y,\r\n                this.data.size.x * this.data.scale * viewport.scale,\r\n                this.data.size.y * this.data.scale * viewport.scale\r\n            );\r\n\r\n            if (this.data.angle || viewport.angle !== 0.0) {\r\n                context.restore();\r\n            }\r\n\r\n            if (this.data.opacity !== 1.0) {\r\n                context.globalAlpha = tempOpacity;\r\n            }\r\n        }\r\n        return null;\r\n    }\r\n\r\n    /* ------------------------------ Render ------------------------------ */\r\n\r\n    /**\r\n     * @override\r\n     *\r\n     * @param {CanvasRenderingContext2D} context\r\n     * @param {{offset: {x: number, y: number}, size: {x: number, y: number}, scale: number, angle: number}} viewport\r\n     * @param {_deprecated_CollectionNode} collection\r\n     * @param {object} data\r\n     * @returns {BaseNode|AnimatedNode|_deprecated_RectNode}\r\n     */\r\n    render(context, viewport, collection, data) {\r\n        this.draw(context, viewport, collection, data);\r\n        return this;\r\n    }\r\n}\r\n","import ObjectUtil from \"../../utils/ObjectUtil\";\r\nimport AnimatedNode from \"nodes/AnimatedNode\";\r\n\r\n/**\r\n * @class CameraNode\r\n * @exports module:nodes/CameraNode\r\n *\r\n * @constructor\r\n * @extends nodes/_deprecated_AnimatedNode\r\n * @param {BaseNode.defaults|AnimatedNode.defaults|CameraNode.defaults|Object} [data]\r\n * @property {BaseNode.defaults|AnimatedNode.defaults|CameraNode.defaults} data\r\n */\r\nexport default class _deprecated_CameraNode extends _deprecated_AnimatedNode {\r\n    static defaults = {\r\n        type: 'CameraNode'\r\n    };\r\n\r\n    constructor(data) {\r\n        super(ObjectUtil.extend(true, {}, CameraNode.defaults, data));\r\n    }\r\n\r\n    /**\r\n     * @param {{x: number, y: number, offsetX: number, offsetY: number}} screen\r\n     * @param {Function|callback} calculate\r\n     * @returns {{offset: {x: number, y: number}, size: {x: number, y: number}, scale: number, angle: number}}\r\n     */\r\n    getCameraViewport(screen, calculate) {\r\n        return calculate(screen, {\r\n            offset: this.data.position,\r\n            size: this.data.size,\r\n            angle: this.data.angle,\r\n            scale: this.data.scale\r\n        });\r\n    };\r\n\r\n    /* ------------------------------ Render ------------------------------ */\r\n\r\n    /**\r\n     * @override\r\n     *\r\n     * @param {CanvasRenderingContext2D} context\r\n     * @param {{offset: {x: number, y: number}, size: {x: number, y: number}, scale: number, angle: number}} viewport\r\n     * @param {_deprecated_CollectionNode} collection\r\n     * @param {object} data\r\n     * @returns {BaseNode|AnimatedNode|CameraNode}\r\n     */\r\n    render(context, viewport, collection, data) {\r\n        return this;\r\n    }\r\n}\r\n","/**\r\n * @class Vector2d\r\n * @exports module:utils/Vector2d\r\n *\r\n * @constructor\r\n * @param {number} x\r\n * @param {number} y\r\n */\r\nexport default class Vector2d {\r\n    constructor(x, y) {\r\n        this.x = x;\r\n        this.y = y;\r\n    }\r\n\r\n    /**\r\n     * @returns {number}\r\n     */\r\n    getX() {\r\n        return this.x;\r\n    }\r\n\r\n    /**\r\n     * @returns {number}\r\n     */\r\n    getY() {\r\n        return this.y;\r\n    }\r\n\r\n    /**\r\n     * @returns {{x: number, y: number}}\r\n     */\r\n    getVector() {\r\n        return {x: this.x, y: this.y};\r\n    }\r\n\r\n    /**\r\n     * @returns {Array.<number>}\r\n     */\r\n    toArray() {\r\n        return [this.x, this.y];\r\n    }\r\n\r\n    /**\r\n     * @param {Array.<number>} array\r\n     * @returns {Vector2d}\r\n     */\r\n    fromArray(array) {\r\n        this.x = array[0];\r\n        this.y = array[1];\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @returns {string}\r\n     */\r\n    toString() {\r\n        return \"(\" + this.x + \",\" + this.y + \")\";\r\n    }\r\n\r\n    /**\r\n     * @param {Vector2d} vector1\r\n     * @param {Vector2d} vector2\r\n     * @returns {number}\r\n     */\r\n    static getDistance(vector1, vector2) {\r\n        return Math.sqrt(\r\n            Math.pow(vector2.getVector().x - vector1.getVector().x, 2) +\r\n            Math.pow(vector2.getVector().y - vector1.getVector().y, 2)\r\n        );\r\n    }\r\n\r\n    /**\r\n     * @param {Vector2d} vector1\r\n     * @param {Vector2d} vector2\r\n     * @returns {number}\r\n     */\r\n    static getAngle(vector1, vector2) {\r\n        return Math.atan2(\r\n                vector2.getVector().y - vector1.getVector().y,\r\n                vector2.getVector().x - vector1.getVector().x\r\n            ) * (180 / Math.PI);\r\n    }\r\n}\r\n","/**\r\n * Class for generate uuid\r\n *\r\n * @class UUID\r\n * @exports module:utils/UUID\r\n *\r\n * @constructor\r\n */\r\nexport default class UUID {\r\n    static generate = function () {\r\n        return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {\r\n            let r = Math.random() * 16 | 0, v = c == 'x' ? r : (r & 0x3 | 0x8);\r\n            return v.toString(16);\r\n        });\r\n    }\r\n}\r\n","import ObjectUtil from \"../../utils/ObjectUtil\";\r\nimport UUID from \"../../utils/UUID\";\r\nimport Vector2d from \"../../utils/Vector2d\";\r\n\r\n/**\r\n * @class BaseNode\r\n * @exports module:nodes/BaseNode\r\n *\r\n * @abstract\r\n * @constructor\r\n * @param {BaseNode.defaults|Object} [data]\r\n * @property {BaseNode.defaults} data\r\n */\r\n\r\nexport default class _deprecated_BaseNode {\r\n    static defaults = {\r\n        /** @type {string|null} */\r\n        id: null,\r\n        type: 'BaseNode',\r\n\r\n        position: {\r\n            x: 0.0,\r\n            y: 0.0\r\n        },\r\n        size: {\r\n            x: 0.0,\r\n            y: 0.0\r\n        },\r\n        offset: {\r\n            x: 0.0,\r\n            y: 0.0\r\n        },\r\n\r\n        visible: true,\r\n        angle: 0.0,\r\n        scale: 1.0,\r\n        opacity: 1.0,\r\n\r\n        cache: null,\r\n        enabledCache: false // TODO:: Collections & AnimatedPrimitiveNode\r\n    };\r\n\r\n    constructor(data) {\r\n        this.data = ObjectUtil.extend(true, {}, BaseNode.defaults, data);\r\n\r\n        if (this.data.id === null) {\r\n            this.data.id = UUID.generate();\r\n        }\r\n    }\r\n\r\n    get opacity() {\r\n        return this.data.opacity;\r\n    }\r\n\r\n    set opacity(value) {\r\n        this.data.opacity = value;\r\n    }\r\n\r\n    get visible() {\r\n        return this.data.visible;\r\n    }\r\n\r\n    set visible(value) {\r\n        this.data.visible = !!value;\r\n    }\r\n\r\n    get angle() {\r\n        return this.data.angle;\r\n    }\r\n\r\n    set angle(value) {\r\n        this.data.angle = value % 360;\r\n    }\r\n\r\n    get scale() {\r\n        return this.data.scale;\r\n    }\r\n\r\n    set scale(value) {\r\n        this.data.scale = value;\r\n    }\r\n\r\n    get cache() {\r\n        return this.data.enabledCache;\r\n    }\r\n\r\n    set cache(value) {\r\n        this.data.enabledCache = !!value;\r\n    }\r\n\r\n    /**\r\n     * @param {BaseNode.defaults|Object} data\r\n     */\r\n    load(data) {\r\n        this.data = ObjectUtil.extend(true, {}, this.data, data);\r\n    }\r\n\r\n    /**\r\n     * @returns {BaseNode.defaults}\r\n     */\r\n    save() {\r\n        return this.data;\r\n    }\r\n\r\n    /**\r\n     * @returns {Vector2d}\r\n     */\r\n    getPosition() {\r\n        return new Vector2d(this.data.position.x, this.data.position.y);\r\n    }\r\n\r\n    /**\r\n     * @param {Vector2d|BaseNode} position\r\n     * @returns {BaseNode}\r\n     */\r\n    setPosition(position) {\r\n        if (position !== undefined) {\r\n            if (position instanceof Vector2d) {\r\n                this.data.position = position.getVector();\r\n            } else if (position instanceof BaseNode) {\r\n                this.data.position = position.getPosition().getVector();\r\n            }\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @returns {Vector2d}\r\n     */\r\n    getSize() {\r\n        return new Vector2d(this.data.size.x, this.data.size.y);\r\n    }\r\n\r\n    /**\r\n     * @param {Vector2d|BaseNode} size\r\n     * @returns {BaseNode}\r\n     */\r\n    setSize(size) {\r\n        if (size !== undefined) {\r\n            if (size instanceof Vector2d) {\r\n                this.data.size = size.getVector();\r\n            } else if (size instanceof BaseNode) {\r\n                this.data.size = size.getSize().getVector();\r\n            }\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @returns {Vector2d}\r\n     */\r\n    getOffset() {\r\n        return new Vector2d(this.data.offset.x, this.data.offset.y);\r\n    }\r\n\r\n    /**\r\n     * @param {Vector2d|BaseNode} offset\r\n     * @returns {BaseNode}\r\n     */\r\n    setOffset(offset) {\r\n        if (offset !== undefined) {\r\n            if (offset instanceof Vector2d) {\r\n                this.data.offset = offset.getVector();\r\n            } else if (offset instanceof BaseNode) {\r\n                this.data.offset = offset.getOffset().getVector();\r\n            }\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /* ------------------------------ Render ------------------------------ */\r\n\r\n    /**\r\n     * Must be override this in child!\r\n     *\r\n     * @deprecated\r\n     * @overridable\r\n     *\r\n     * @param {CanvasRenderingContext2D} context\r\n     * @param {{offset: {x: number, y: number}, size: {x: number, y: number}, scale: number, angle: number}} viewport\r\n     * @param {CollectionNode} collection\r\n     * @param {object} data\r\n     * @returns {BaseNode}\r\n     */\r\n    render(context, viewport, collection, data) {\r\n        // throw new Exception('Trying to render base node.'); // TODO:: exceptions\r\n        return this;\r\n    }\r\n\r\n    //TODO:: Fix on fullscreen\r\n    /**\r\n     * @param {{offset: {x: number, y: number}, size: {x: number, y: number}, scale: number, angle: number}} viewport\r\n     * @returns {boolean}\r\n     */\r\n    inViewport(viewport) {\r\n        return !((this.data.position.x > viewport.offset.x + viewport.size.x\r\n        || this.data.position.x + viewport.size.x < viewport.offset.x)\r\n        || (this.data.position.y > viewport.offset.y + viewport.size.y\r\n        || this.data.position.y + viewport.size.y < viewport.offset.y));\r\n    }\r\n}\r\n\r\n\r\n\r\n\r\n","import PrototypeObject from \"api/PrototypeObject\";\r\nimport UUID from \"utils/UUID\";\r\nimport Mutable from \"objects/Mutable\";\r\n\r\n/**\r\n * @property {BaseNode.defaults|{}} _data\r\n */\r\nexport default class BaseNode extends PrototypeObject {\r\n    static NodeName = 'BaseNode';\r\n    static isSpecial = false;\r\n\r\n    /** @type {{id: null|string}} */\r\n    static defaults = {\r\n        id: null\r\n    };\r\n\r\n    _data;\r\n\r\n    constructor(data) {\r\n        super();\r\n        if (typeof data === 'string') data = {id: data};\r\n        this._data = Mutable.extend(true, {}, BaseNode.defaults, data);\r\n        if (this._data.id === null) this._data.id = UUID.generate();\r\n    }\r\n\r\n    get guid() {\r\n        return this._data.id;\r\n    }\r\n\r\n    get isSpecialNode() {\r\n        return this.constructor.isSpecial || false;\r\n    }\r\n\r\n    toString() {\r\n        return function (device) {\r\n            return (device[0].toLowerCase() + device.slice(1))\r\n        }(this.constructor.NodeName || this.constructor.name);\r\n    }\r\n}\r\n","import ObjectUtil from \"../../utils/ObjectUtil\";\r\nimport BaseNode from \"../BaseNode\";\r\nimport Vector2d from \"../../utils/Vector2d\";\r\nimport Tween from \"transitions/Tween\";\r\n\r\n// TODO:: move(+v.x, +v.y)\r\n\r\n/**\r\n * @class AnimatedNode\r\n * @exports module:nodes/AnimatedNode\r\n *\r\n * @abstract\r\n * @constructor\r\n * @extends nodes/BaseNode\r\n * @param {BaseNode.defaults|AnimatedNode.defaults|Object} [data]\r\n * @property {BaseNode.defaults|AnimatedNode.defaults} data\r\n */\r\nexport default class AnimatedNode extends BaseNode {\r\n    static defaults = {\r\n        type: 'AnimatedNode'\r\n    };\r\n\r\n    constructor(data) {\r\n        super(ObjectUtil.extend(true, {}, AnimatedNode.defaults, data));\r\n    }\r\n\r\n    /**\r\n     * @param {Vector2d|BaseNode} position\r\n     * @param {number} [duration]\r\n     * @param {boolean} [durationAsSpeed]\r\n     */\r\n    moveTo(position, duration, durationAsSpeed) {\r\n        if (duration === undefined || typeof duration !== 'number') duration = 1000.0;\r\n\r\n        if (typeof position === 'object') {\r\n            var tween = new Tween(this);\r\n\r\n            if (position instanceof Vector2d) {\r\n                if (durationAsSpeed) duration = Vector2d.getDistance(this.getPosition(), position) / duration;\r\n                tween.to({\r\n                    position: {\r\n                        x: position.getVector().x,\r\n                        y: position.getVector().y\r\n                    }\r\n                }, duration);\r\n            } else if (position instanceof BaseNode) {\r\n                if (durationAsSpeed) duration = Vector2d.getDistance(this.getPosition(), position.getPosition()) / duration;\r\n                tween.to({\r\n                    position: {\r\n                        x: position.getPosition().getVector().x,\r\n                        y: position.getPosition().getVector().y\r\n                    }\r\n                }, duration);\r\n            }\r\n\r\n            tween.start();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @param {Vector2d|BaseNode} size\r\n     * @param {number} [duration]\r\n     * @param {boolean} [durationAsSpeed]\r\n     */\r\n    resizeTo(size, duration, durationAsSpeed) {\r\n        if (duration === undefined || typeof duration !== 'number') duration = 1000.0;\r\n        if (typeof position === 'object') {\r\n            var tween = new Tween(this);\r\n\r\n            if (size instanceof Vector2d) {\r\n                if (durationAsSpeed) duration = Vector2d.getDistance(this.getSize(), size) / duration;\r\n                tween.to({\r\n                    size: {\r\n                        x: size.getVector().x,\r\n                        y: size.getVector().y\r\n                    }\r\n                }, duration);\r\n            } else if (size instanceof BaseNode) {\r\n                if (durationAsSpeed) duration = Vector2d.getDistance(this.getSize(), size.getSize()) / duration;\r\n                tween.to({\r\n                    size: {\r\n                        x: size.getSize().getVector().x,\r\n                        y: size.getSize().getVector().y\r\n                    }\r\n                }, duration);\r\n            }\r\n\r\n            tween.start();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @param {number|BaseNode} angle\r\n     * @param {number} [duration]\r\n     */\r\n    rotateTo(angle, duration) {\r\n        if (duration === undefined || typeof duration !== 'number') duration = 1000.0;\r\n        var tween = new Tween(this);\r\n\r\n        if (typeof angle === 'number') {\r\n            tween.to({angle: angle % 360}, duration);\r\n        } else if (typeof angle === 'object' && angle instanceof BaseNode) {\r\n            tween.to({\r\n                angle: Vector2d.getAngle(angle.getPosition(), this.getPosition())\r\n            }, duration);\r\n        }\r\n\r\n        tween.start();\r\n    }\r\n\r\n    /**\r\n     * @param {number} [velocity]\r\n     */\r\n    turn(velocity) {\r\n        if (velocity === undefined || typeof velocity !== 'number') velocity = 1.0;\r\n        this.angle += velocity;\r\n    }\r\n}\r\n","import Rectangle from \"nodes/primitive2D/Rectangle\";\r\n\r\n/**\r\n * Rectangle\r\n * @constructor\r\n *\r\n * @property {BaseNode._data|{position: Array.<number>, size: Array.<number>}} _data\r\n */\r\nexport default class Sprite extends Rectangle {\r\n    textureBuffer = null;\r\n    texture = null;\r\n\r\n    bindTextureBuffer(gl) {\r\n        this.textureBuffer = gl.createBuffer();\r\n        gl.bindBuffer(gl.ARRAY_BUFFER, this.textureBuffer);\r\n\r\n        gl.bufferData(gl.ARRAY_BUFFER, new Float32Array([\r\n            0.0, 0.0,\r\n            1.0, 0.0,\r\n            0.0, 1.0,\r\n            0.0, 1.0,\r\n            1.0, 0.0,\r\n            1.0, 1.0\r\n        ]), gl.STATIC_DRAW);\r\n    }\r\n\r\n    bindTexture(gl) {\r\n        this.texture = gl.createTexture();\r\n        gl.bindTexture(gl.TEXTURE_2D, this.texture);\r\n        gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, 1, 1, 0, gl.RGBA, gl.UNSIGNED_BYTE, new Uint8Array([0, 0, 0, 0]));\r\n\r\n        let image = new Image();\r\n        image.src = 'img/logo.png';\r\n        image.addEventListener('load', () => {\r\n            gl.bindTexture(gl.TEXTURE_2D, this.texture);\r\n            gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA,gl.UNSIGNED_BYTE, image);\r\n            gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\r\n            gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR_MIPMAP_NEAREST);\r\n            gl.generateMipmap(gl.TEXTURE_2D);\r\n            gl.bindTexture(gl.TEXTURE_2D, null);\r\n        });\r\n    }\r\n\r\n    draw(context, viewport, data) {\r\n        let gl = context, scene = data.components.SceneHandler;\r\n\r\n        if (Sprite._shaderProgram && scene._data.render.startsWith('webgl')) {\r\n            // WebGL Render\r\n\r\n            let attributes = {\r\n                aPosition: gl.getAttribLocation(Sprite._shaderProgram, 'aPosition'),\r\n                aTexture: gl.getAttribLocation(Sprite._shaderProgram, 'aTexture'),\r\n                uTexture: gl.getUniformLocation(Sprite._shaderProgram, 'uTexture'),\r\n                uResolution: gl.getUniformLocation(Sprite._shaderProgram, 'uResolution'),\r\n                uPosition: gl.getUniformLocation(Sprite._shaderProgram, 'uPosition'),\r\n                uAngle: gl.getUniformLocation(Sprite._shaderProgram, 'uAngle'),\r\n                uScale: gl.getUniformLocation(Sprite._shaderProgram, 'uScale'),\r\n                uCenter: gl.getUniformLocation(Sprite._shaderProgram, 'uCenter')\r\n            };\r\n\r\n            if (this.positionBuffer === null) this.bindPositionBuffer(gl);\r\n            if (this.textureBuffer === null) this.bindTextureBuffer(gl);\r\n            if (this.texture === null) this.bindTexture(gl);\r\n\r\n            gl.useProgram(Sprite._shaderProgram);\r\n\r\n            gl.bindTexture(gl.TEXTURE_2D, this.texture);\r\n\r\n            gl.enableVertexAttribArray(attributes.aPosition);\r\n            gl.bindBuffer(gl.ARRAY_BUFFER, this.positionBuffer);\r\n            gl.vertexAttribPointer(attributes.aPosition, 2, gl.FLOAT, false, 0, 0);\r\n\r\n            gl.enableVertexAttribArray(attributes.aTexture);\r\n            gl.bindBuffer(gl.ARRAY_BUFFER, this.textureBuffer);\r\n            gl.vertexAttribPointer(attributes.aTexture, 2, gl.FLOAT, false, 0, 0);\r\n\r\n            gl.uniform2fv(attributes.uResolution, new Float32Array([gl.canvas.clientWidth, gl.canvas.clientHeight]));\r\n            gl.uniform2fv(attributes.uPosition, new Float32Array(this._data.position));\r\n            gl.uniform1f(attributes.uAngle, this._data.angle);\r\n            gl.uniform2fv(attributes.uScale, new Float32Array(this._data.scale));\r\n            gl.uniform2fv(attributes.uCenter, new Float32Array(this._data.center));\r\n\r\n            gl.uniform1i(attributes.uTexture, 0);\r\n\r\n            gl.drawArrays(gl.TRIANGLES, 0, 6);\r\n        } else {\r\n            // Canvas2D Render\r\n            let tempOpacity = 1.0;\r\n\r\n            if (this._data.opacity !== 1.0) {\r\n                tempOpacity = context.globalAlpha;\r\n                context.globalAlpha = this._data.opacity;\r\n            }\r\n\r\n            if (this._data.angle) {\r\n                context.save();\r\n\r\n                context.translate(this._data.position[0], this._data.position[1]);\r\n                context.rotate(this._data.angle);\r\n                context.translate(-(this._data.position[0]), -(this._data.position[1]));\r\n            }\r\n\r\n            context.fillStyle = this._colorRGBA;\r\n            context.lineWidth = 0;\r\n\r\n            context.fillRect(\r\n                this._data.position[0] - this._data.size[0] / 2,\r\n                this._data.position[1] - this._data.size[1] / 2,\r\n                this._data.size[0] * this._data.scale[0],\r\n                this._data.size[1] * this._data.scale[1]\r\n            );\r\n\r\n            if (this._data.angle) {\r\n                context.restore();\r\n            }\r\n\r\n            if (this._data.opacity !== 1.0) {\r\n                context.globalAlpha = tempOpacity;\r\n            }\r\n        }\r\n    }\r\n\r\n    static _vertextShader = null;\r\n    static _fragmentShader = null;\r\n    static _shaderProgram = null;\r\n\r\n    static VertexShader = Rectangle.VertexShader;\r\n\r\n    // language=GLSL\r\n    static FragmentShader = `\r\n        precision mediump float;\r\n        varying vec2 vTexture; \r\n        uniform sampler2D uTexture;\r\n        \r\n        void main() {\r\n            gl_FragColor = texture2D(uTexture, vTexture);\r\n        }\r\n    `;\r\n}\r\n","import BaseNode from \"nodes/BaseNode\";\r\nimport MathUtil from \"utils/MathUtil\";\r\n\r\n/**\r\n * Rectangle\r\n * @constructor\r\n *\r\n * @property {BaseNode._data|{position: Array.<number>, size: Array.<number>}} _data\r\n */\r\nexport default class Rectangle extends BaseNode {\r\n    positionBuffer = null;\r\n\r\n    constructor(x, y, width, height) {\r\n        super({\r\n            position: [x || 0.0, y || 0.0],\r\n            size: [width || 0.0, height || 0.0],\r\n            angle: MathUtil.degree2Radian(45),\r\n            scale: [1.0, 1.0],\r\n            center: [0.0, 0.0],\r\n            color: [Math.random(), Math.random(), Math.random(), 1.0],\r\n            opacity: 1.0\r\n        });\r\n\r\n        this._colorRGBA = MathUtil.vectorColorToRGBA(this._data.color);\r\n\r\n        this.toCenter();\r\n    }\r\n\r\n    toCenter(cx, cy) {\r\n        if (cx === undefined) cx = this._data.size[0] / 2;\r\n        if (cy === undefined) cy = this._data.size[1] / 2;\r\n\r\n        this._data.center = [-cx, -cy];\r\n    }\r\n\r\n    bindPositionBuffer(gl) {\r\n        this.positionBuffer = gl.createBuffer();\r\n        gl.bindBuffer(gl.ARRAY_BUFFER, this.positionBuffer);\r\n\r\n        let x = [0, this._data.size[0]];\r\n        let y = [0, this._data.size[1]];\r\n\r\n        gl.bufferData(gl.ARRAY_BUFFER, new Float32Array([\r\n            x[0], y[0],\r\n            x[1], y[0],\r\n            x[0], y[1],\r\n            x[0], y[1],\r\n            x[1], y[0],\r\n            x[1], y[1],\r\n        ]), gl.STATIC_DRAW);\r\n    }\r\n\r\n    draw(context, viewport, data) {\r\n        let gl = context, scene = data.components.SceneHandler;\r\n\r\n        if (Rectangle._shaderProgram && scene._data.render.startsWith('webgl')) {\r\n            // WebGL Render\r\n\r\n            let attributes = {\r\n                aPosition: gl.getAttribLocation(Rectangle._shaderProgram, 'aPosition'),\r\n                uColor: gl.getUniformLocation(Rectangle._shaderProgram, 'uColor'),\r\n                uResolution: gl.getUniformLocation(Rectangle._shaderProgram, 'uResolution'),\r\n                uPosition: gl.getUniformLocation(Rectangle._shaderProgram, 'uPosition'),\r\n                uAngle: gl.getUniformLocation(Rectangle._shaderProgram, 'uAngle'),\r\n                uScale: gl.getUniformLocation(Rectangle._shaderProgram, 'uScale'),\r\n                uCenter: gl.getUniformLocation(Rectangle._shaderProgram, 'uCenter')\r\n            };\r\n\r\n            if (this.positionBuffer === null) this.bindPositionBuffer(gl);\r\n\r\n            gl.useProgram(Rectangle._shaderProgram);\r\n\r\n            gl.enableVertexAttribArray(attributes.aPosition);\r\n            gl.bindBuffer(gl.ARRAY_BUFFER, this.positionBuffer);\r\n            gl.vertexAttribPointer(attributes.aPosition, 2, gl.FLOAT, false, 0, 0);\r\n\r\n            gl.uniform2fv(attributes.uResolution, new Float32Array([gl.canvas.clientWidth, gl.canvas.clientHeight]));\r\n            gl.uniform2fv(attributes.uPosition, new Float32Array(this._data.position));\r\n            gl.uniform1f(attributes.uAngle, this._data.angle);\r\n            gl.uniform2fv(attributes.uScale, new Float32Array(this._data.scale));\r\n            gl.uniform2fv(attributes.uCenter, new Float32Array(this._data.center));\r\n\r\n            gl.uniform4fv(attributes.uColor, new Float32Array(this._data.color));\r\n\r\n            gl.drawArrays(gl.TRIANGLES, 0, 6);\r\n        } else {\r\n            // Canvas2D Render\r\n            let tempOpacity = 1.0;\r\n\r\n            if (this._data.opacity !== 1.0) {\r\n                tempOpacity = context.globalAlpha;\r\n                context.globalAlpha = this._data.opacity;\r\n            }\r\n\r\n            if (this._data.angle) {\r\n                context.save();\r\n\r\n                context.translate(this._data.position[0], this._data.position[1]);\r\n                context.rotate(this._data.angle);\r\n                context.translate(-(this._data.position[0]), -(this._data.position[1]));\r\n            }\r\n\r\n            context.fillStyle = this._colorRGBA;\r\n            context.lineWidth = 0;\r\n\r\n            context.fillRect(\r\n                this._data.position[0] - this._data.size[0] / 2,\r\n                this._data.position[1] - this._data.size[1] / 2,\r\n                this._data.size[0] * this._data.scale[0],\r\n                this._data.size[1] * this._data.scale[1]\r\n            );\r\n\r\n            if (this._data.angle) {\r\n                context.restore();\r\n            }\r\n\r\n            if (this._data.opacity !== 1.0) {\r\n                context.globalAlpha = tempOpacity;\r\n            }\r\n        }\r\n    }\r\n\r\n    render(context, viewport, data) {\r\n        this.draw(context, viewport, data);\r\n    }\r\n\r\n    static _vertextShader = null;\r\n    static _fragmentShader = null;\r\n    static _shaderProgram = null;\r\n\r\n    // language=GLSL\r\n    static VertexShader = `\r\n        precision mediump float;\r\n\r\n        attribute vec2 aPosition;\r\n        uniform vec2 uResolution;\r\n        uniform vec2 uPosition;\r\n        uniform float uAngle;\r\n        uniform vec2 uScale;\r\n        uniform vec2 uCenter;\r\n        \r\n        attribute vec2 aTexture;\r\n        varying vec2 vTexture;\r\n        \r\n        mat3 projection () {\r\n            return mat3(\r\n                2.0 / uResolution[0], 0.0, 0.0,\r\n                0.0, -2.0 / uResolution[1], 0.0,\r\n                -1.0, 1.0, 1.0\r\n            );\r\n        }\r\n        \r\n        mat3 translate (mat3 m) {\r\n            return m * mat3(\r\n                1.0, 0.0, 0.0,\r\n                0.0, 1.0, 0.0,\r\n                uPosition[0], uPosition[1], 1.0\r\n            );\r\n        }\r\n        \r\n         mat3 rotate (mat3 m) {\r\n            float s = sin(uAngle);\r\n            float c = cos(uAngle);\r\n            return m * mat3(\r\n                c, s, 0.0,\r\n                -s, c, 0.0,\r\n                0.0, 0.0, 1.0\r\n            );\r\n        }\r\n        \r\n        mat3 scale (mat3 m) {\r\n            return m * mat3(\r\n                uScale[0], 0.0, 0.0,\r\n                0.0, uScale[1], 0.0,\r\n                0.0, 0.0, 1.0\r\n            );\r\n        }\r\n        \r\n        mat3 center (mat3 m) {\r\n            return m * mat3(\r\n                1.0, 0.0, 0.0,\r\n                0.0, 1.0, 0.0,\r\n                uCenter[0], uCenter[1], 1.0\r\n            );\r\n        }\r\n\r\n        void main() {\r\n            gl_Position = vec4((center(scale(rotate(translate(projection())))) * vec3(aPosition, 1)).xy, 0, 1);\r\n            vTexture = aTexture;\r\n        }\r\n    `;\r\n\r\n    // language=GLSL\r\n    static FragmentShader = `\r\n        precision mediump float;\r\n        \r\n        uniform vec4 uColor;\r\n        \r\n        void main() {\r\n            gl_FragColor = uColor;\r\n        }\r\n    `;\r\n};\r\n","import Pointer from \"io/devices/Pointer\";\r\n\r\nexport default class Touch extends Pointer {\r\n    static DeviceName = Pointer.prototype.constructor.name; // this fix device name in InputHandler\r\n\r\n    constructor(input) {\r\n        super(input);\r\n    }\r\n\r\n    init(input) {\r\n        if (input !== undefined && this.input === undefined) this.input = input;\r\n        return true;\r\n    };\r\n\r\n    update() {\r\n        return true;\r\n    };\r\n\r\n    clear() {\r\n        return true;\r\n    };\r\n\r\n    enable() {\r\n        throw new Error('Error. IO interface \"' + Touch.IO + '\" exist, but not supported yet.');\r\n        //return true;\r\n    };\r\n\r\n    disable() {\r\n        throw new Error('Error. IO interface \"' + Touch.IO + '\" exist, but not supported yet.');\r\n        //return true;\r\n    };\r\n}\r\n","import Device from \"api/Device\";\r\n\r\nexport default class Pointer extends Device {\r\n    constructor(input) {\r\n        super(input);\r\n        if (this.constructor.name === 'Pointer') {\r\n            throw new Error('Error. Pointer is abstract class.');\r\n        }\r\n    }\r\n\r\n    setPointerImage(image) {\r\n        if (image) {\r\n            switch (image) {\r\n                case 'none':\r\n                case 'default':\r\n                case 'auto':\r\n                case 'crosshair':\r\n                case 'e-resize':\r\n                case 'help':\r\n                case 'move':\r\n                case 'n-resize':\r\n                case 'ne-resize':\r\n                case 'nw-resize':\r\n                case 'pointer':\r\n                case 'progress':\r\n                case 's-resize':\r\n                case 'se-resize':\r\n                case 'sw-resize':\r\n                case 'text':\r\n                case 'w-resize':\r\n                case 'wait':\r\n                case 'inherit':\r\n                    break;\r\n                default:\r\n                    image = 'url(\"' + image + '\"), auto'\r\n            }\r\n        }\r\n        this.input.data.pointer.image = this.input.store.pointer.image = this.input.options.cursor = image;\r\n        window.document.body.style.cursor = this.input.data.pointer.image;\r\n        return this;\r\n    };\r\n\r\n    toggleCursor(toggle) {\r\n        if (this.input.data.image !== 'none' && (toggle === undefined || toggle === false)) {\r\n            this.input.store.pointer.image = window.document.body.style.cursor;\r\n            window.document.body.style.cursor = 'none';\r\n        } else {\r\n            window.document.body.style.cursor = this.input.store.pointer.image;\r\n        }\r\n        return this;\r\n    };\r\n\r\n    isPointerVisible() {\r\n        return this.input.data.pointer.image === 'none';\r\n    };\r\n\r\n    getPointerPosition() {\r\n        if (this.data.pointer === undefined) return [0, 0];\r\n        return [this.data.pointer.x, this.data.pointer.y];\r\n    };\r\n\r\n    getPointerMoveDistance() {\r\n        if (this.data.pointer === undefined) return 0;\r\n        return this.data.pointer.distance;\r\n    };\r\n}\r\n","import Pointer from \"io/devices/Pointer\";\r\n\r\nexport default class Mouse extends Pointer {\r\n    static DeviceName = Pointer.prototype.constructor.name; // this fix device name in InputHandler\r\n\r\n    __fixMouseButtonId = (id) => {\r\n        if (id > 2) {\r\n            return id;\r\n        } else if (id === 0) {\r\n            return 'LEFT';\r\n        } else if (id === 1) {\r\n            return 'MIDDLE';\r\n        } else if (id === 2) {\r\n            return 'RIGHT';\r\n        }\r\n    };\r\n\r\n    keyMouseDownEventHandler = (e) => {\r\n        if (this.input.isEnabled && this.input.preventDefault) e.preventDefault();\r\n\r\n        let keyCode = this.input.KEYS_HELPER.getKeyById('KEY_MOUSE_' + this.__fixMouseButtonId(e.button));\r\n        if (!(this.input.data.keys.keysDown.indexOf(keyCode) !== -1)) {\r\n            this.input.data.keys.keysDown.push(keyCode);\r\n        }\r\n\r\n        this.input.store.recordMouseDragDistance = true;\r\n        this.input.store.pointer = {\r\n            tracker: {\r\n                x: e.pageX,\r\n                y: e.pageY\r\n            }\r\n        };\r\n\r\n        this.input.store.recordMouseClickTime = true;\r\n        if (this.input.store.keys.pressedTime[keyCode] !== undefined) {\r\n            this.input.store.keys.pressedTime[keyCode].delta = this.input.store.keys.pressedTime[keyCode].startTime - e.timeStamp\r\n        } else {\r\n            this.input.store.keys.pressedTime[keyCode] = {\r\n                startTime: e.timeStamp,\r\n                delta: 0\r\n            };\r\n        }\r\n\r\n        this.input.events.trigger('io.mouseKeyDown', e);\r\n    };\r\n\r\n    keyMouseUpEventHandler = (e) => {\r\n        if (this.input.isEnabled && this.input.preventDefault) e.preventDefault();\r\n\r\n        let keyCode = this.input.KEYS_HELPER.getKeyById('KEY_MOUSE_' + this.__fixMouseButtonId(e.button));\r\n        if (!(this.input.data.keys.keysUp.indexOf(keyCode) !== -1)) {\r\n            this.input.data.keys.keysUp.push(keyCode);\r\n        }\r\n\r\n        this.input.store.recordMouseDragDistance = false;\r\n        this.input.data.pointer.distance = 0;\r\n        this.input.store.pointer = {\r\n            tracker: {\r\n                x: 0,\r\n                y: 0\r\n            }\r\n        };\r\n\r\n        this.input.store.recordMouseClickTime = false;\r\n        if (this.input.store.keys.pressedTime[keyCode] !== undefined) {\r\n            this.input.store.keys.pressedTime.splice(keyCode, 1)\r\n        }\r\n\r\n        this.input.events.trigger('io.mouseKeyUp', e);\r\n    };\r\n\r\n    keyMouseMoveEventHandler = (e) => {\r\n        if (this.input.isEnabled && this.input.preventDefault) e.preventDefault();\r\n\r\n        this.input.data.pointer = {\r\n            x: e.pageX,\r\n            y: e.pageY,\r\n            distance: (this.input.store.recordMouseDragDistance) ? Math.sqrt(\r\n                Math.pow((e.pageX - this.input.store.pointer.tracker.x), 2)\r\n                + Math.pow((e.pageY - this.input.store.pointer.tracker.y), 2)\r\n            ).toFixed(2) : 0.0,\r\n            image: this.input.data.pointer.image\r\n        };\r\n\r\n        this.input.events.trigger('io.mouseMove', e);\r\n    };\r\n\r\n    scrollMouseEventHandler = (e) => {\r\n        if (this.input.isEnabled && this.input.preventDefault) e.preventDefault();\r\n\r\n        let keyCode = (e.wheelDelta / 120 > 0)\r\n            ? this.input.KEYS_HELPER.getKeyById('SCROLL_MOUSE_UP')\r\n            : this.input.KEYS_HELPER.getKeyById('SCROLL_MOUSE_DOWN');\r\n\r\n        if (!(this.input.data.keys.keysUp.indexOf(keyCode) !== -1)) {\r\n            this.input.data.keys.keysUp.push(keyCode);\r\n            this.input.data.keys.keysDown.push(keyCode);\r\n        }\r\n\r\n        this.input.events.trigger('io.mouseScroll', e);\r\n    };\r\n\r\n    init(input) {\r\n        super.init(input);\r\n        this.input.data.keys = {\r\n            keysUp: [],\r\n            keysDown: []\r\n        };\r\n        this.input.store.keys = {\r\n            pressedTime: []\r\n        };\r\n        this.input.data.pointer = {\r\n            image: this.input.options.cursor || 'none',\r\n            x: 0,\r\n            y: 0,\r\n            distance: 0\r\n        };\r\n        this.input.store.pointer = {\r\n            tracker: {\r\n                x: 0,\r\n                y: 0\r\n            },\r\n            image: this.input.options.cursor || 'none'\r\n        };\r\n        this.input.store.recordMouseDragDistance = false;\r\n        this.input.store.recordMouseClickTime = false;\r\n        this.setPointerImage(this.input.options.cursor || 'none');\r\n    };\r\n\r\n    update() {\r\n        //TODO:: fix pointer by viewport scene\r\n        return true;\r\n    };\r\n\r\n    clear() {\r\n        if (this.input.data.keys !== undefined) {\r\n            this.input.data.keys = {\r\n                keysUp: [],\r\n                keysDown: []\r\n            };\r\n        }\r\n        if (this.input.data.pointer !== undefined) {\r\n            this.input.data.pointer = {\r\n                image: this.input.options.pointer || 'none',\r\n                x: 0,\r\n                y: 0,\r\n                distance: 0\r\n            };\r\n        }\r\n        return true;\r\n    };\r\n\r\n    enable() {\r\n        window.addEventListener('mousedown', this.keyMouseDownEventHandler, false);\r\n        window.addEventListener('mouseup', this.keyMouseUpEventHandler, false);\r\n        window.addEventListener('mousemove', this.keyMouseMoveEventHandler, false);\r\n        window.addEventListener('wheel', this.scrollMouseEventHandler, false);\r\n        return true;\r\n    };\r\n\r\n    disable() {\r\n        window.removeEventListener('mousedown', this.keyMouseDownEventHandler, false);\r\n        window.removeEventListener('mouseup', this.keyMouseUpEventHandler, false);\r\n        window.removeEventListener('mousemove', this.keyMouseMoveEventHandler, false);\r\n        window.removeEventListener('wheel', this.scrollMouseEventHandler, false);\r\n        return true;\r\n    };\r\n}\r\n","import Device from \"api/Device\";\r\n\r\nexport default class Keyboard extends Device {\r\n    keyDownEventHandler = (e) => {\r\n        if (this.input.isEnabled && this.input.preventDefault) e.preventDefault();\r\n        if (!(this.input.data.keys.keysDown.indexOf(e.keyCode) !== -1)) {\r\n            this.input.data.keys.keysDown.push(e.keyCode);\r\n        }\r\n\r\n        this.input.store.recordKeyPressTime = true;\r\n        if (this.input.store.keys.pressedTime[e.keyCode] !== undefined) {\r\n            this.input.store.keys.pressedTime[e.keyCode].delta = this.input.store.keys.pressedTime[e.keyCode].startTime - e.timeStamp\r\n        } else {\r\n            this.input.store.keys.pressedTime[e.keyCode] = {\r\n                startTime: e.timeStamp,\r\n                delta: 0\r\n            };\r\n        }\r\n\r\n        this.input.events.trigger('io.keyboardKeyDown', e);\r\n    };\r\n\r\n    keyUpEventHandler = (e) => {\r\n        if (this.input.isEnabled && this.input.preventDefault) e.preventDefault();\r\n        if (!(this.input.data.keys.keysUp.indexOf(e.keyCode) !== -1)) {\r\n            this.input.data.keys.keysUp.push(e.keyCode);\r\n        }\r\n\r\n        this.input.store.recordKeyPressTime = false;\r\n        if (this.input.store.keys.pressedTime[e.keyCode] !== undefined) {\r\n            this.input.store.keys.pressedTime.splice(e.keyCode, 1)\r\n        }\r\n\r\n        this.input.events.trigger('io.keyboardKeyUp', e);\r\n    };\r\n\r\n    init(input) {\r\n        super.init(input);\r\n        this.input.data.keys = {\r\n            keysUp: [],\r\n            keysDown: []\r\n        };\r\n        this.input.store.keys = {\r\n            pressedTime: []\r\n        };\r\n        this.input.store.recordKeyPressTime = false;\r\n    };\r\n\r\n    update() {\r\n        return true;\r\n    };\r\n\r\n    clear() {\r\n        if (this.input.data.keys !== undefined) {\r\n            this.input.data.keys = {\r\n                keysUp: [],\r\n                keysDown: []\r\n            };\r\n        }\r\n        return true;\r\n    };\r\n\r\n    enable() {\r\n        window.addEventListener('keydown', this.keyDownEventHandler, false);\r\n        window.addEventListener('keyup', this.keyUpEventHandler, false);\r\n        return true;\r\n    };\r\n\r\n    disable() {\r\n        window.removeEventListener('keydown', this.keyDownEventHandler, false);\r\n        window.removeEventListener('keyup', this.keyUpEventHandler, false);\r\n        return true;\r\n    };\r\n};\r\n","import Device from \"api/Device\";\r\n\r\nexport default class Joystick extends Device {\r\n    constructor(input) {\r\n        super(input);\r\n    }\r\n\r\n    init(input) {\r\n        if (input !== undefined && this.input === undefined) this.input = input;\r\n        return true;\r\n    };\r\n\r\n    update() {\r\n        return true;\r\n    };\r\n\r\n    clear() {\r\n        return true;\r\n    };\r\n\r\n    enable() {\r\n        throw new Error('Error. IO interface \"' + Joystick.IO + '\" exist, but not supported yet.');\r\n        //return true;\r\n    };\r\n\r\n    disable() {\r\n        throw new Error('Error. IO interface \"' + Joystick.IO + '\" exist, but not supported yet.');\r\n        //return true;\r\n    };\r\n}\r\n\r\n","import PrototypeInterface from \"api/PrototypeInterface\";\r\n\r\n/**\r\n * IInputHandler\r\n * @constructor\r\n */\r\nexport default class IInputHandler extends PrototypeInterface {\r\n};\r\n","import PrototypeInterface from \"api/PrototypeInterface\";\r\n\r\n/**\r\n * IHandler\r\n * @constructor\r\n */\r\nexport default class IHandler extends PrototypeInterface {\r\n}\r\n","import PrototypeInterface from \"api/PrototypeInterface\";\r\n\r\n/**\r\n * IEngine\r\n * @constructor\r\n */\r\nexport default class IEngine extends PrototypeInterface {\r\n};\r\n","import ObjectUtil from \"utils/ObjectUtil\";\r\nimport Events from \"utils/Events\";\r\nimport Easing from \"transitions/utils/Easing\";\r\nvar tweens = [];\r\n\r\n/**\r\n * @class Tween\r\n * @exports module:transitions/Tween\r\n *\r\n * @constructor\r\n * @param {BaseNode|{data: object}} tweenNode\r\n * @param {Tween.defaults|Object} [data]\r\n * @property {Tween.defaults} data\r\n */\r\nexport default class Tween {\r\n    static defaults = {\r\n        currentStateAnimation: 0,\r\n        tweenStateStack: [],\r\n        tweenStateTimings: [],\r\n        chainedTweensStack: [],\r\n\r\n        isAnimated: false,\r\n        isStarted: false,\r\n        startTime: null,\r\n\r\n        delayTime: 0,\r\n\r\n        defaultDuration: 1000\r\n    };\r\n\r\n    static stateDefaults = {\r\n        data: null,\r\n        duration: 1000,\r\n        delay: 0,\r\n        easing: 'linear',\r\n        interpolation: 'linear'\r\n    };\r\n\r\n    static Easing = Easing;\r\n\r\n    constructor(tweenNode, data) {\r\n        this.data = ObjectUtil.extend(true, {}, Tween.defaults, data);\r\n        this.node = tweenNode;\r\n        this.events = new Events();\r\n\r\n        this.state = {};\r\n\r\n        // TODO:: Exceptions\r\n        // if (!(node instanceof BaseNode) || typeof node.data !== 'object') {\r\n        //     throw new InvalidArgumentException('Unknown tween node');\r\n        // }\r\n    }\r\n\r\n    /* Methods */\r\n    /**\r\n     * @param {Tween.defaults|Object} data\r\n     * @returns {{data: null, duration: number, delay: number, easing: string, interpolation: string}}\r\n     */\r\n    _tweenStateData(data) {\r\n        return (data !== undefined && typeof data === 'object')\r\n            ? ObjectUtil.extend(true, {}, Tween.stateDefaults, data)\r\n            : Tween.stateDefaults;\r\n    }\r\n\r\n    /**\r\n     * @param {Object} properties\r\n     * @param {Tween.defaults|Object} [data]\r\n     * @returns {Tween}\r\n     */\r\n    to(properties, data) {\r\n        var tween = this;\r\n\r\n        if (!tween.data.isStarted) {\r\n\r\n            if (typeof data === 'number') data = {data: data};\r\n            var stateData = (typeof data !== 'number') ? this._tweenStateData(data) : data;\r\n            if (data !== undefined && typeof data === 'number') stateData.duration = data;\r\n\r\n            tween.data.tweenStateStack.push([properties, stateData]);\r\n\r\n            return tween;\r\n        }\r\n\r\n        // TODO:: Exceptions\r\n        // throw new RuntimeException('You can not add a state after the start of the tween.');\r\n    }\r\n\r\n    /**\r\n     * @param {number} time\r\n     * @returns {boolean}\r\n     */\r\n    update(time) {\r\n        var tween = this;\r\n\r\n        var nextState = tween.data.tweenStateStack[tween.data.currentStateAnimation + 1];\r\n\r\n        if (time < tween.data.startTime || nextState === undefined) return true;\r\n\r\n        if (!tween.data.isStarted) {\r\n            tween.events.trigger('start', [tween.node]);\r\n            tween.data.isStarted = true;\r\n        }\r\n\r\n        var currentState = tween.data.tweenStateStack[tween.data.currentStateAnimation];\r\n\r\n        var previousStatesTime = tween.getStateTimeDuration(tween.data.currentStateAnimation, true);\r\n\r\n        var elapsed = (time - (tween.data.startTime + previousStatesTime)) / nextState[1].duration;\r\n        elapsed = elapsed > 1 ? 1 : elapsed;\r\n\r\n        tween.node.import(\r\n            Tween.util.animateTween(currentState[0], nextState[0], Easing.get(nextState[1].easing)(elapsed))\r\n        );\r\n\r\n        tween.events.trigger('update', [tween.node]);\r\n\r\n        if (elapsed === 1) {\r\n            if (tween.data.currentStateAnimation < tween.data.tweenStateStack.length) {\r\n                tween.data.currentStateAnimation++;\r\n            } else {\r\n                tween.events.trigger('complete', [tween.node]);\r\n\r\n                for (var i = 0; i < tween.data.chainedTweensStack.length; i++) {\r\n                    tween.data.chainedTweensStack[i].start(\r\n                        tween.data.startTime + tween.getStateTimeDuration(tween.data.currentStateAnimation - 1, true)\r\n                    );\r\n                }\r\n                return false;\r\n            }\r\n        }\r\n        return true;\r\n    }\r\n\r\n\r\n    _calculateStackStateTimings(tweenStateStack) {\r\n        var result = [];\r\n\r\n        tweenStateStack.forEach(function (value) {\r\n            result.push(value[1].duration);\r\n        });\r\n\r\n        return result;\r\n    }\r\n\r\n    /**\r\n     * @param {number} [position]\r\n     * @param {boolean} [withPrevious]\r\n     *\r\n     * @returns {number}\r\n     */\r\n    getStateTimeDuration(position, withPrevious) {\r\n        if (position === undefined || position === null) position = this.data.currentStateAnimation;\r\n        if (withPrevious === undefined) withPrevious = false;\r\n\r\n        if (this.data.tweenStateTimings[position] === undefined) return 0;\r\n\r\n        if (withPrevious) {\r\n            var result = 0;\r\n            for (var i = 1; i <= position; i++) {\r\n                result += this.data.tweenStateTimings[i];\r\n            }\r\n            return result;\r\n        } else {\r\n            return this.data.tweenStateTimings[position];\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @param {Array.<Object, Tween.stateDefaults>} startState\r\n     * @param {Array.<Array<Object, Tween.stateDefaults>>} tweenStateStack\r\n     */\r\n    _calculateStackState(startState, tweenStateStack) {\r\n        var result = [startState];\r\n        var index = 1;\r\n\r\n        var parsedTweenStateStack = [startState];\r\n        var nextStateDelay = 0;\r\n        var nextAllStateDelay = 0;\r\n\r\n        tweenStateStack.forEach(function (value) {\r\n            if (typeof value[0] === 'object' && !(value[0] instanceof Array)) {\r\n                if (nextStateDelay !== 0) {\r\n                    value[1].delay = nextStateDelay;\r\n                    nextStateDelay = 0;\r\n                } else if (nextAllStateDelay !== 0) {\r\n                    value[1].delay = nextAllStateDelay;\r\n                }\r\n                parsedTweenStateStack.push([value[0], value[1]]);\r\n                index++;\r\n            } else if (typeof value[0] === 'string') {\r\n                var i = 0;\r\n                switch (value[0]) {\r\n                    case 'delay':\r\n                        nextStateDelay = value[1].data;\r\n                        break;\r\n                    case 'delayAll':\r\n                        nextAllStateDelay = value[1].data;\r\n                        break;\r\n                    case 'repeat':\r\n                        for (i = 0; i < value[1].data; i++) {\r\n                            parsedTweenStateStack.push(parsedTweenStateStack[index]);\r\n                            index++;\r\n                        }\r\n                        break;\r\n                    case 'repeatAll':\r\n                        for (i = 0; i < value[1].data; i++) {\r\n                            parsedTweenStateStack.concat(parsedTweenStateStack);\r\n                            index++;\r\n                        }\r\n                        break;\r\n                    case 'yoyo':\r\n                    case 'reverse':\r\n                        for (i = 0; i < value[1].data; i++) {\r\n                            if (parsedTweenStateStack[index - 1] !== undefined) {\r\n                                parsedTweenStateStack.push([\r\n                                    Tween.util.reverseProperties(parsedTweenStateStack[index - 1][0]),\r\n                                    parsedTweenStateStack[index - 1][1]\r\n                                ]);\r\n                                index++;\r\n                            }\r\n                        }\r\n                        break;\r\n                    case 'yoyoAll':\r\n                    case 'reverseAll':\r\n                        for (i = 0; i < value[1].data; i++) {\r\n                            var stateStack = parsedTweenStateStack.slice(0);\r\n\r\n                            var stackLength = stateStack.length;\r\n                            for (var j = 0; j < stackLength; j++) {\r\n                                var sIndex = stackLength - j - 1;\r\n                                if (stateStack[sIndex] !== undefined) {\r\n                                    parsedTweenStateStack.push([\r\n                                        Tween.util.reverseProperties(stateStack[sIndex][0]),\r\n                                        stateStack[sIndex][1]\r\n                                    ]);\r\n                                    index++;\r\n                                }\r\n                            }\r\n                        }\r\n                        break;\r\n                }\r\n            }\r\n        });\r\n\r\n        // parsedTweenStateStack.forEach(function (value) {\r\n        //     console.info(value[0].position.x);\r\n        // });\r\n\r\n        index = 0;\r\n        parsedTweenStateStack.shift();\r\n        parsedTweenStateStack.forEach(function (value) {\r\n            if (typeof value[0] === 'object' && !(value[0] instanceof Array)) {\r\n                result.push([Tween.util.calculateProperties(result[index][0], ObjectUtil.extend(true, {}, result[index][0], value[0])), value[1]]);\r\n                index++;\r\n            }\r\n        });\r\n\r\n        return result;\r\n    }\r\n\r\n    /**\r\n     * @param {number} [time]\r\n     * @returns {Tween}\r\n     */\r\n    start(time) {\r\n        var tween = this;\r\n        if (time === undefined) time = global.performance.now();\r\n        tween.data.isAnimated = true;\r\n\r\n        if (!tween.data.isStarted) {\r\n            tween.data.isStarted = true;\r\n            tween.state = [Tween.util.cleanProperties(tween.node.data), Tween.stateDefaults];\r\n            tween.data.tweenStateStack = this._calculateStackState(tween.state, tween.data.tweenStateStack);\r\n            tween.data.tweenStateTimings = this._calculateStackStateTimings(tween.data.tweenStateStack);\r\n        }\r\n\r\n        tween.data.startTime = time + tween.data.delayTime;\r\n\r\n        return Tween.add(tween);\r\n    }\r\n\r\n    /**\r\n     * @returns {Tween}\r\n     */\r\n    stop() {\r\n        var tween = this;\r\n        if (!tween.data.isAnimated) return this;\r\n\r\n        tween.data.isAnimated = false;\r\n        tween.events.trigger('stop', [tween.node]);\r\n        tween.stopChainedTweens();\r\n\r\n        return Tween.remove(tween);\r\n    }\r\n\r\n    /**\r\n     * @returns {Tween}\r\n     */\r\n    stopChainedTweens() {\r\n        var tween = this;\r\n        for (var i = 0; i < tween.data.chainedTweensStack.length; i++) {\r\n            tween.data.chainedTweensStack[i].stop();\r\n        }\r\n\r\n        return tween;\r\n    }\r\n\r\n\r\n    /* Extended animation methods */\r\n    /**\r\n     * @param {number} delay\r\n     * @returns {Tween}\r\n     */\r\n    delay(delay) {\r\n        if (delay === undefined) delay = 1000;\r\n        this.to('delay', delay);\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {number} delay\r\n     * @returns {Tween}\r\n     */\r\n    delayAll(delay) {\r\n        if (delay === undefined) delay = 1000;\r\n        this.to('delayAll', delay);\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {number} [count]\r\n     * @returns {Tween}\r\n     */\r\n    repeat(count) {\r\n        if (count === undefined) count = 1;\r\n        this.to('repeat', count);\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {number} [count]\r\n     * @returns {Tween}\r\n     */\r\n    repeatAll(count) {\r\n        if (count === undefined) count = 1;\r\n        this.to('repeatAll', count);\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {number} [count]\r\n     * @returns {Tween}\r\n     */\r\n    yoyo(count) {\r\n        if (count === undefined) count = 1;\r\n        this.to('yoyo', count);\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {number} [count]\r\n     * @returns {Tween}\r\n     */\r\n    reverse(count) {\r\n        if (count === undefined) count = 1;\r\n        this.to('reverse', count);\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {number} [count]\r\n     * @returns {Tween}\r\n     */\r\n    yoyoAll(count) {\r\n        if (count === undefined) count = 1;\r\n        this.to('yoyoAll', count);\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {number} [count]\r\n     * @returns {Tween}\r\n     */\r\n    reverseAll(count) {\r\n        if (count === undefined) count = 1;\r\n        this.to('reverseAll', count);\r\n        return this;\r\n    }\r\n\r\n\r\n    /* Events wrappers */\r\n    /**\r\n     * @param {string} event\r\n     * @param {function} callback\r\n     * @returns {boolean}\r\n     */\r\n    on(event, callback) {\r\n        return this.events.on(event, callback);\r\n    }\r\n\r\n    /**\r\n     * @param {string} event\r\n     * @param {function} callback\r\n     * @returns {boolean}\r\n     */\r\n    off(event, callback) {\r\n        return this.events.off(event, callback);\r\n    }\r\n\r\n    /**\r\n     * @param {string} event\r\n     * @param {function} callback\r\n     * @returns {boolean}\r\n     */\r\n    once(event, callback) {\r\n        return this.events.once(event, callback);\r\n    }\r\n\r\n    /**\r\n     * @param {string} event\r\n     * @returns {boolean}\r\n     */\r\n    flush(event) {\r\n        return this.events.flush(event);\r\n    }\r\n\r\n    /**\r\n     * @param {string} event\r\n     * @param {Array.<*>} data\r\n     * @returns {boolean}\r\n     */\r\n    trigger(event, data) {\r\n        return this.events.trigger(event, data);\r\n    }\r\n\r\n    /* Static Methods */\r\n    /**\r\n     * @param {number} index\r\n     * @returns {Array.<Tween>|Tween}\r\n     */\r\n    static get(index) {\r\n        return (index === undefined) ? tweens : tweens[index];\r\n    }\r\n\r\n    /**\r\n     * @param {Tween} tween\r\n     * @returns {Tween}\r\n     */\r\n    static add(tween) {\r\n        tweens.push(tween);\r\n        return tween;\r\n    }\r\n\r\n    /**\r\n     * @param {Tween} tween\r\n     * @returns {Tween}\r\n     */\r\n    static remove(tween) {\r\n        var i = tweens.indexOf(tween);\r\n        if (i !== -1) tweens.splice(i, 1);\r\n        return tween;\r\n    }\r\n\r\n    /**\r\n     * @returns {void}\r\n     */\r\n    static flush() {\r\n        tweens = [];\r\n    }\r\n\r\n    /**\r\n     * @param {number} time\r\n     * @returns {boolean}\r\n     */\r\n    static update(time) {\r\n        if (tweens.length === 0) return false;\r\n\r\n        var i = 0;\r\n\r\n        while (i < tweens.length) {\r\n            if (tweens[i].update(time)) {\r\n                i++;\r\n            } else {\r\n                tweens.splice(i, 1);\r\n            }\r\n        }\r\n        return true;\r\n    }\r\n\r\n    static util = {\r\n        animateTween: function (currentState, nextState, value) {\r\n            var result = {};\r\n            var property;\r\n            var temp;\r\n\r\n            for (property in nextState) {\r\n                if (nextState.hasOwnProperty(property) && currentState.hasOwnProperty(property)) {\r\n                    temp = null;\r\n\r\n                    if (typeof nextState[property] === 'number') {\r\n                        if (currentState[property] === nextState[property]) {\r\n                            temp = currentState[property];\r\n                        } else {\r\n                            temp = currentState[property] + (nextState[property] - currentState[property]) * value;\r\n                        }\r\n                    } else if (typeof nextState[property] === 'object') {\r\n                        temp = this.animateTween(currentState[property], nextState[property], value);\r\n                    }\r\n                    if (temp !== null) result[property] = temp;\r\n                }\r\n            }\r\n\r\n            return Object.keys(result).length > 0 ? result : null;\r\n        },\r\n\r\n        cleanProperties: function (properties) {\r\n            var result = {};\r\n            var property;\r\n            var temp;\r\n\r\n            for (property in properties) {\r\n                if (properties.hasOwnProperty(property) && property !== 'id') {\r\n                    temp = null;\r\n                    if ((typeof properties[property] === 'string' && !isNaN(properties[property]))\r\n                        || typeof properties[property] === 'number'\r\n                    ) {\r\n                        temp = properties[property];\r\n                    } else if (typeof properties[property] === 'object') {\r\n                        temp = this.cleanProperties(properties[property]);\r\n                    }\r\n                    if (temp !== null) result[property] = temp;\r\n                }\r\n            }\r\n\r\n            return Object.keys(result).length > 0 ? result : null;\r\n        },\r\n\r\n        reverseProperties: function (properties) {\r\n            var result = {};\r\n            var property;\r\n            var temp;\r\n\r\n            for (property in properties) {\r\n                if (properties.hasOwnProperty(property) && property !== 'id') {\r\n                    temp = null;\r\n                    if (typeof properties[property] === 'string' && !isNaN(properties[property])) {\r\n                        temp = Number(parseFloat(properties[property]) * -1).toString();\r\n                    } else if (typeof properties[property] === 'number') {\r\n                        temp = properties[property];\r\n                    } else if (typeof properties[property] === 'object') {\r\n                        temp = this.reverseProperties(properties[property]);\r\n                    }\r\n                    if (temp !== null) result[property] = temp;\r\n                }\r\n            }\r\n\r\n            return Object.keys(result).length > 0 ? result : null;\r\n        },\r\n\r\n        calculateProperties: function (startProperties, endProperties) {\r\n            var result = {};\r\n            var property;\r\n            var temp;\r\n\r\n            for (property in endProperties) {\r\n                if (endProperties.hasOwnProperty(property) && startProperties.hasOwnProperty(property) && property !== 'id') {\r\n                    temp = null;\r\n\r\n                    if (typeof endProperties[property] === 'string' && !isNaN(endProperties[property]) && typeof startProperties[property] === 'number') {\r\n                        temp = startProperties[property] + parseFloat(endProperties[property]);\r\n                    } else if (typeof endProperties[property] === 'number' && typeof startProperties[property] === 'string' && !isNaN(startProperties[property])) {\r\n                        temp = endProperties[property] - parseFloat(startProperties[property]);\r\n                    } else if (typeof endProperties[property] === 'number' && typeof startProperties[property] === 'number') {\r\n                        temp = endProperties[property];\r\n                    } else if (typeof endProperties[property] === 'object') {\r\n                        temp = this.calculateProperties(startProperties[property], endProperties[property]);\r\n                    }\r\n\r\n                    if (temp !== null) result[property] = temp;\r\n                }\r\n            }\r\n            return Object.keys(result).length > 0 ? result : null;\r\n        }\r\n    }\r\n}\r\n","/**\r\n * @class Events\r\n * @exports module:utils/Events\r\n *\r\n * @constructor\r\n */\r\nexport default class Events {\r\n    events = [];\r\n    onces = [];\r\n\r\n    constructor() {\r\n        this.flush();\r\n    }\r\n\r\n    /**\r\n     * @param {string} [eventName]\r\n     */\r\n    flush(eventName) {\r\n        if (eventName !== undefined) {\r\n            if (this.events[eventName] !== undefined) {\r\n                this.events[eventName] = [];\r\n            }\r\n            if (this.onces[eventName] !== undefined) {\r\n                this.onces[eventName] = [];\r\n            }\r\n        } else {\r\n            this.onces = [];\r\n            this.events = [];\r\n        }\r\n    }\r\n\r\n\r\n    /**\r\n     * @param {string} eventName\r\n     * @param {function} callback\r\n     */\r\n    on(eventName, callback) {\r\n        if (this.events[eventName] !== undefined) {\r\n            var stack = this.events[eventName];\r\n            if (stack.indexOf(callback) === -1) {\r\n                stack.push(callback);\r\n            }\r\n        } else {\r\n            this.events[eventName] = [];\r\n            this.events[eventName].push(callback)\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @param {string} eventName\r\n     * @param {function} callback\r\n     */\r\n    once(eventName, callback) {\r\n        if (this.onces[eventName] !== undefined) {\r\n            var stack = this.onces[eventName];\r\n            if (stack.indexOf(callback) === -1) {\r\n                stack.push(callback);\r\n            }\r\n        } else {\r\n            this.onces[eventName] = [];\r\n            this.onces[eventName].push(callback)\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @param {string} eventName\r\n     * @param {function} callback\r\n     */\r\n    off(eventName, callback) {\r\n        if (this.onces[eventName] !== undefined) {\r\n            var stack = this.events[eventName];\r\n            if (stack.indexOf(callback) !== -1) {\r\n                stack.splice(stack.indexOf(callback));\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @param {string} eventName\r\n     * @param {Object} [data]\r\n     */\r\n    trigger(eventName, data) {\r\n        var stack, i;\r\n\r\n        if (this.events[eventName] !== undefined) {\r\n            stack = this.events[eventName];\r\n            for (i = 0; i < stack.length; i++) {\r\n                stack[i].call(stack[i], data);\r\n            }\r\n        }\r\n\r\n        if (this.onces[eventName] !== undefined) {\r\n            stack = this.onces[eventName];\r\n            for (i = 0; i < stack.length; i++) {\r\n                stack[i].call(stack[i], data);\r\n            }\r\n            this.flush(eventName);\r\n        }\r\n    };\r\n}\r\n","/**\r\n * @class ArrayMap\r\n * @exports module:utils/ArrayMap\r\n *\r\n * @constructor\r\n * @extends Array\r\n * @param args\r\n */\r\nexport default class ArrayMap extends Array {\r\n    last = () => {\r\n        return this[this.length - 1];\r\n    };\r\n\r\n    constructor(args) {\r\n        super(args);\r\n    }\r\n\r\n    /**\r\n     * @param {ArrayMap.<T>} array\r\n     * @returns {boolean}\r\n     */\r\n    equals(array) {\r\n        if (!array)\r\n            return false;\r\n\r\n        if (this.length != array.length)\r\n            return false;\r\n\r\n        for (var i = 0, l = this.length; i < l; i++) {\r\n            if (this[i] instanceof Array && array[i] instanceof Array) {\r\n                if (!this[i].equals(array[i]))\r\n                    return false;\r\n            }\r\n            else if (this[i] != array[i]) {\r\n                return false;\r\n            }\r\n        }\r\n        return true;\r\n    }\r\n\r\n    /**\r\n     * @param {string|Object} object\r\n     * @returns {boolean}\r\n     */\r\n    contains(object) {\r\n        var i = this.length;\r\n        while (i--) {\r\n            if (this[i] === object) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * @param {Function} callback\r\n     * @returns {boolean}\r\n     */\r\n    each(callback) {\r\n        if (!callback) return false;\r\n        var result = false;\r\n        for (var i = 0; i < this.length; i++) {\r\n            if ((result = callback(this[i], i)) == false) {\r\n                return result;\r\n            }\r\n        }\r\n        return result;\r\n    }\r\n\r\n    /**\r\n     * @param {string|Object} key\r\n     * @param {*} value\r\n     * @returns {ArrayMap.<T>}\r\n     */\r\n    add(key, value) {\r\n        if (this.contains(key))\r\n            this[key] = value;\r\n        else {\r\n            this.push(key);\r\n            this[key] = value;\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {string|Object} key\r\n     * @returns {*}\r\n     */\r\n    get(key) {\r\n        return this.contains(key) ? this[key] : null;\r\n    }\r\n\r\n    /**\r\n     * @param {string|Object} key\r\n     * @returns {ArrayMap.<T>}\r\n     */\r\n    remove(key) {\r\n        for (var i = 0; i < this.length; ++i) {\r\n            if (this[i] == key) {\r\n                this.splice(i, 1);\r\n                delete this[key];\r\n                return this;\r\n            }\r\n        }\r\n        return this;\r\n    }\r\n}\r\n","import Immutable from \"objects/Immutable\";\r\nimport Mutable from \"objects/Mutable\";\r\nimport Handler from \"api/Handler\";\r\nimport RuntimeException from \"exceptions/RuntimeException\";\r\n\r\nexport default class BaseStore extends Handler {\r\n    /** @type Immutable */\r\n    state;\r\n\r\n    constructor(state) {\r\n        super();\r\n        this.state = new Immutable(state);\r\n    }\r\n\r\n    /**\r\n     * @return {Immutable}\r\n     */\r\n    getState() {\r\n        return this.state;\r\n    }\r\n\r\n    /**\r\n     * @param {Object} state\r\n     * @param {function(Immutable, Immutable)} callback(newState, oldState)\r\n     */\r\n    setState(state, callback) {\r\n        if (!this._isEnabled) throw new RuntimeException('Trying setState() on disabled store.');\r\n\r\n        let oldState = this.state;\r\n        this.state = new Immutable(Mutable.extend(true, {}, oldState.toJS(), state));\r\n\r\n        if (this.events) {\r\n            this.events.trigger('update', {\r\n                newState: this.state,\r\n                oldState\r\n            });\r\n        }\r\n\r\n        if (callback) callback(this.state, oldState);\r\n    }\r\n}\r\n","import BaseGameState from \"states/BaseGameState\";\r\n\r\n/**\r\n * Default game state\r\n *\r\n * @class DefaultGameState\r\n * @abstract\r\n * @constructor\r\n *\r\n * @param {GameStatesManager} gsm\r\n * @param {DefaultGameState.defaults|BaseGameState.defaults|Object} [data]\r\n * @property {DefaultGameState.defaults|BaseGameState.defaults|Object} data\r\n */\r\nexport default class DefaultGameState extends BaseGameState {\r\n    constructor(gsm, data) {\r\n        if (data === undefined) data = {};\r\n        data.id = 'init_j2d';\r\n        super(gsm, data);\r\n    }\r\n\r\n    // init(data) {\r\n    //     return BaseGameState.prototype.init.call(this, data);\r\n    // }\r\n    //\r\n    // load(data) {\r\n    //     return BaseGameState.prototype.load.call(this, data);\r\n    // }\r\n\r\n    update(timestamp, data) {\r\n        setTimeout(function () {\r\n            this.gsm.setNextState();\r\n        }.bind(this), 1000);\r\n        return true;\r\n    }\r\n\r\n    // render(timestamp, data) {\r\n    //     return true;\r\n    // }\r\n    //\r\n    // unload(data) {\r\n    //     return BaseGameState.prototype.unload.call(this, data);\r\n    // }\r\n}\r\n","import ObjectUtil from \"utils/ObjectUtil\";\r\nimport UUID from \"utils/UUID\";\r\nimport Events from \"utils/Events\";\r\n/**\r\n * Base class of state\r\n *\r\n * @class BaseGameState\r\n * @abstract\r\n * @constructor\r\n *\r\n * @param {GameStatesManager} gsm\r\n * @param {BaseGameState.defaults|Object} [data]\r\n * @property {BaseGameState.defaults|Object} data\r\n * @property {string} id\r\n */\r\nexport default class BaseGameState {\r\n    static defaults = {\r\n        id: 'BaseState',\r\n        currentState: 0\r\n    };\r\n\r\n    static STATE = {\r\n        STATE_NOT_LOADED: 0,\r\n        STATE_INIT: 1,\r\n        STATE_LOAD: 2,\r\n        STATE_UPDATE: 3,\r\n        STATE_RENDER: 4,\r\n        STATE_UNLOAD: 5\r\n    };\r\n\r\n    constructor(gsm, data) {\r\n        if (data === undefined) data = {};\r\n        if (data === undefined) data = {};\r\n        data.currentState = 0;\r\n        if (data.id === undefined || data.id === null) {\r\n            data.id = UUID.generate();\r\n        }\r\n        this.data = ObjectUtil.extend(true, {}, BaseGameState.defaults, data);\r\n\r\n        this.gsm = gsm;\r\n        this.loader = null;\r\n        this.events = new Events();\r\n    }\r\n\r\n    get id() {\r\n        return this.data.id;\r\n    }\r\n\r\n    set id(value) {\r\n        this.data.id = value;\r\n    }\r\n\r\n    init(data) {\r\n        if (typeof data === 'object' && data.callback !== undefined) {\r\n            data.callback();\r\n        }\r\n        return true;\r\n    }\r\n\r\n    load(data) {\r\n        if (typeof data === 'object' && data.callback !== undefined) data.callback();\r\n        return true;\r\n    }\r\n\r\n    update(timestamp, data) {\r\n        return true;\r\n    }\r\n\r\n    render(timestamp, data) {\r\n        return true;\r\n    }\r\n\r\n    unload(data) {\r\n        if (typeof data === 'object' && data.callback !== undefined) data.callback();\r\n        return true;\r\n    }\r\n\r\n    /* Events wrappers */\r\n    /**\r\n     * @param {string} event\r\n     * @param {function} callback\r\n     * @returns {boolean}\r\n     */\r\n    on(event, callback) {\r\n        return this.events.on(event, callback);\r\n    }\r\n\r\n    /**\r\n     * @param {string} event\r\n     * @param {function} callback\r\n     * @returns {boolean}\r\n     */\r\n    off(event, callback) {\r\n        return this.events.off(event, callback);\r\n    }\r\n\r\n    /**\r\n     * @param {string} event\r\n     * @param {function} callback\r\n     * @returns {boolean}\r\n     */\r\n    once(event, callback) {\r\n        return this.events.once(event, callback);\r\n    }\r\n\r\n    /**\r\n     * @param {string} event\r\n     * @returns {boolean}\r\n     */\r\n    flush(event) {\r\n        return this.events.flush(event);\r\n    }\r\n\r\n    /**\r\n     * @param {string} event\r\n     * @param {Array.<*>} data\r\n     * @returns {boolean}\r\n     */\r\n    trigger(event, data) {\r\n        return this.events.trigger(event, data);\r\n    }\r\n}\r\n","import InvalidArgumentException from \"exceptions/InvalidArgumentException\";\r\nimport Mutable from \"objects/Mutable\";\r\n\r\nconst FREEZE_NODE_METHODS = ['get', 'set', 'toJS', 'toJSON'];\r\nconst FREEZE_NODE_ARRAY_METHODS = [\r\n    'concat', 'copyWithin', 'fill', 'filter', 'map', 'pop', 'reduce',\r\n    'reduceRight', 'reverse', 'shift', 'slice', 'sort', 'splice', 'unshift',\r\n];\r\n\r\n/**\r\n * @exports module:objects/Immutable\r\n */\r\nexport default class Immutable extends Object {\r\n    __$ImmutableOptions;\r\n\r\n    constructor(object, options) {\r\n        if (object !== undefined && typeof object !== 'object') {\r\n            throw new InvalidArgumentException('Attribute object type must be instance of Object.');\r\n        }\r\n\r\n        if (options === undefined) options = {};\r\n        if (object === undefined) object = {};\r\n\r\n        super(object instanceof Array ? new ImmutableArray(object, options) : Object.assign({}, object));\r\n\r\n        this.__$ImmutableOptions = options;\r\n\r\n        if (!Object.isFrozen(this)) Immutable.freeze(this, options);\r\n    }\r\n\r\n    toJS = () => Immutable.unFreeze(Object.assign(this instanceof Array ? [] : {}, this));\r\n\r\n    toJSON = () => JSON.stringify(\r\n        Immutable.unFreeze(Object.assign(this instanceof Array ? [] : {}, this))\r\n    );\r\n\r\n    get = () => Immutable.freeze(Object.assign(this instanceof Array ? [] : {}, this), this.__$ImmutableOptions);\r\n\r\n    set = (data) => {\r\n        if (data !== undefined && typeof data !== 'object') {\r\n            throw new InvalidArgumentException('Attribute object type must be instance of Object.');\r\n        }\r\n\r\n        if (Object.isFrozen(this)) {\r\n            let oldObject = Immutable.unFreeze(Object.assign(this instanceof Array ? [] : {}, this));\r\n            let newObject = Mutable.extend(true, oldObject instanceof Array ? [] : {}, oldObject, data);\r\n            console.log(oldObject, this, newObject);\r\n\r\n            return Immutable.freeze(newObject, this.__$ImmutableOptions);\r\n        }\r\n\r\n        return null;\r\n    };\r\n\r\n    /**\r\n     * @param {Object} object\r\n     * @param {Object} options\r\n     * @return {Object}\r\n     */\r\n    static freeze(object, options) {\r\n        let properties = Object.getOwnPropertyNames(object);\r\n        for (let i = 0; i < properties.length; i++) {\r\n            if (object.hasOwnProperty(properties[i])\r\n                && object[properties[i]] !== null\r\n                && (typeof object[properties[i]] === 'object' || typeof object[properties[i]] === 'function')\r\n                && !Object.isFrozen(object[properties[i]])\r\n                && !(FREEZE_NODE_METHODS.indexOf(properties[i]) !== -1)\r\n                && !(FREEZE_NODE_ARRAY_METHODS.indexOf(properties[i]) !== -1)\r\n                && properties[i] !== '__$ImmutableOptions'\r\n            ) {\r\n                object[properties[i]] = new Immutable(object[properties[i]], options);\r\n            }\r\n        }\r\n\r\n        Object.freeze(object);\r\n        return object;\r\n    }\r\n\r\n    /**\r\n     * @param {Object} object\r\n     * @return {Object}\r\n     */\r\n    static unFreeze(object) {\r\n        let result = object instanceof Array ? [] : {};\r\n\r\n        if (object instanceof Array) {\r\n            for (let i = 0; i < object.length; i++) result.push(object[i]);\r\n        } else if (object instanceof String) {\r\n            result = String(object).toString();\r\n        } else if (typeof object === 'object') {\r\n            for (let property in object) {\r\n                if (object.hasOwnProperty(property)\r\n                    && !(FREEZE_NODE_METHODS.indexOf(property) !== -1)\r\n                    && !(FREEZE_NODE_ARRAY_METHODS.indexOf(property) !== -1)\r\n                    && property !== '__$ImmutableOptions'\r\n                ) {\r\n                    result[property] = (typeof object[property] === 'object' && Object.isFrozen(object[property]))\r\n                        ? Immutable.unFreeze(object[property])\r\n                        : object[property];\r\n                }\r\n            }\r\n        }\r\n\r\n        return result;\r\n    }\r\n}\r\n\r\nclass ImmutableArray extends Array {\r\n    __$ImmutableOptions;\r\n\r\n    constructor(array, options) {\r\n        if (options === undefined) options = {};\r\n\r\n        super([]);\r\n\r\n        this.__$ImmutableOptions = options;\r\n\r\n        if ((typeof array === 'object' && array instanceof Array)) {\r\n            for (let i = 0; i < array.length; i++) this[i] = array[i];\r\n        }\r\n    }\r\n\r\n    // Immutable methods\r\n    /**\r\n     * @param args\r\n     * @return {Immutable|ImmutableArray|Object}\r\n     */\r\n    concat(...args) {\r\n        return Immutable.freeze(super.concat(...args), this.__$ImmutableOptions);\r\n    }\r\n\r\n    /**\r\n     * @param args\r\n     * @return {Immutable|ImmutableArray|Object}\r\n     */\r\n    copyWithin(...args) {\r\n        return Immutable.freeze(super.copyWithin(...args), this.__$ImmutableOptions);\r\n    }\r\n\r\n    /**\r\n     * @param args\r\n     * @return {Immutable|ImmutableArray|Object}\r\n     */\r\n    fill(...args) {\r\n        let array = Immutable.unFreeze(Object.assign([], this));\r\n        return Immutable.freeze(array.fill(...args), this.__$ImmutableOptions);\r\n    }\r\n\r\n    /**\r\n     * @param args\r\n     * @return {Immutable|ImmutableArray|Object}\r\n     */\r\n    filter(...args) {\r\n        return Immutable.freeze(super.filter(...args), this.__$ImmutableOptions);\r\n    }\r\n\r\n    /**\r\n     * @param args\r\n     * @return {Immutable|ImmutableArray|Object}\r\n     */\r\n    map(...args) {\r\n        return Immutable.freeze(super.map(...args), this.__$ImmutableOptions);\r\n    }\r\n\r\n    /**\r\n     * @param args\r\n     * @return {Immutable|ImmutableArray|Object}\r\n     */\r\n    pop(...args) {\r\n        let array = Immutable.unFreeze(Object.assign([], this));\r\n        array.pop(...args);\r\n        return Immutable.freeze(array, this.__$ImmutableOptions);\r\n    }\r\n\r\n    /**\r\n     * @param args\r\n     * @return {Immutable|ImmutableArray|Object}\r\n     */\r\n    push(...args) {\r\n        let array = Immutable.unFreeze(Object.assign([], this));\r\n        array.push(...args);\r\n        return Immutable.freeze(array, this.__$ImmutableOptions);\r\n    }\r\n\r\n    /**\r\n     * @param args\r\n     * @return {Immutable|ImmutableArray|Object}\r\n     */\r\n    reduce(...args) {\r\n        let array = Immutable.unFreeze(Object.assign([], this));\r\n        return Immutable.freeze(array.reduce(...args), this.__$ImmutableOptions);\r\n    }\r\n\r\n    /**\r\n     * @param args\r\n     * @return {Immutable|ImmutableArray|Object}\r\n     */\r\n    reduceRight(...args) {\r\n        let array = Immutable.unFreeze(Object.assign([], this));\r\n        return Immutable.freeze(array.reduceRight(...args), this.__$ImmutableOptions);\r\n    }\r\n\r\n    /**\r\n     * @param args\r\n     * @return {Immutable|ImmutableArray|Object}\r\n     */\r\n    reverse(...args) {\r\n        let array = Immutable.unFreeze(Object.assign([], this));\r\n        return Immutable.freeze(array.reverse(...args), this.__$ImmutableOptions);\r\n    }\r\n\r\n    /**\r\n     * @param args\r\n     * @return {Immutable|ImmutableArray|Object}\r\n     */\r\n    shift(...args) {\r\n        let array = Immutable.unFreeze(Object.assign([], this));\r\n        array.shift(...args);\r\n        return Immutable.freeze(array, this.__$ImmutableOptions);\r\n    }\r\n\r\n    /**\r\n     * @param args\r\n     * @return {Immutable|ImmutableArray|Object}\r\n     */\r\n    slice(...args) {\r\n        let array = Immutable.unFreeze(Object.assign([], this));\r\n        return Immutable.freeze(array.slice(...args), this.__$ImmutableOptions);\r\n    }\r\n\r\n    /**\r\n     * @param args\r\n     * @return {Immutable|ImmutableArray|Object}\r\n     */\r\n    sort(...args) {\r\n        let array = Immutable.unFreeze(Object.assign([], this));\r\n        return Immutable.freeze(array.sort(...args), this.__$ImmutableOptions);\r\n    }\r\n\r\n    /**\r\n     * @param args\r\n     * @return {Immutable|ImmutableArray|Object}\r\n     */\r\n    splice(...args) {\r\n        let array = Immutable.unFreeze(Object.assign([], this));\r\n        return Immutable.freeze(array.splice(...args), this.__$ImmutableOptions);\r\n    }\r\n\r\n    /**\r\n     * @param args\r\n     * @return {Immutable|ImmutableArray|Object}\r\n     */\r\n    unshift(...args) {\r\n        let array = Immutable.unFreeze(Object.assign([], this));\r\n        array.unshift(...args);\r\n        return Immutable.freeze(array, this.__$ImmutableOptions);\r\n    }\r\n}\r\n","import BaseNode from \"nodes/BaseNode\";\r\nimport RuntimeException from \"exceptions/RuntimeException\";\r\n\r\nexport default class GroupNode extends BaseNode {\r\n    /** @type {Array.<BaseNode|GroupNode>} */\r\n    _nodes = [];\r\n\r\n    get(guid) {\r\n        return this._nodes[guid] || null;\r\n    }\r\n\r\n    has(guid) {\r\n        return this._nodes[guid] !== undefined;\r\n    }\r\n\r\n    add(node) {\r\n        if (node.isSpecialNode) {\r\n            throw new RuntimeException(`You try add the ${node.constructor.name} to GroupNode, but this not work.`);\r\n        }\r\n        if (node.instanceOf(BaseNode)) {\r\n            this._nodes[node.guid] = node;\r\n            this._nodes.push(node);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    insert(node, index) {\r\n        if (node.isSpecialNode) {\r\n            throw new RuntimeException(`You try add the ${node.constructor.name} to GroupNode, but this not work.`);\r\n        }\r\n        if (node.instanceOf(BaseNode)) {\r\n            this._nodes[node.guid] = node;\r\n            this._nodes.splice(index, 0, node);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    remove(node) {\r\n        if (node.instanceOf(BaseNode) && this.has(node.guid)) {\r\n            this._nodes.splice(this._nodes.indexOf(node), 1);\r\n            delete this._nodes[node.guid];\r\n        }\r\n        return this;\r\n    }\r\n\r\n    flush() {\r\n        this._nodes = [];\r\n        return this;\r\n    }\r\n\r\n    render(context, viewport, data) {\r\n        if (data.components.SceneHandler._data.isLostContext) return;\r\n\r\n        if (this._nodes.length !== 0) {\r\n            for (let i = 0; i < this._nodes.length; i++) {\r\n                this._nodes[i].render(context, viewport, data);\r\n            }\r\n        }\r\n    }\r\n}\r\n","import BaseNode from \"nodes/BaseNode\";\r\n\r\nexport default class CameraNode extends BaseNode {\r\n\r\n}\r\n","/**\r\n * @class Video\r\n * @exports module:media/Video\r\n *\r\n * @constructor\r\n */\r\nexport default class Video {\r\n}\r\n","import ObjectUtil from \"utils/ObjectUtil\";\r\nimport UUID from \"utils/UUID\";\r\nimport Events from \"utils/Events\";\r\nimport Audio from \"media/Audio\";\r\n\r\nvar cache = {};\r\nvar audioContext;\r\nvar masterGain;\r\n\r\nfunction createMasterGain() {\r\n    if (audioContext) {\r\n        masterGain = (audioContext.createGain === undefined)\r\n            ? audioContext.createGainNode()\r\n            : audioContext.createGain();\r\n        masterGain.gain.value = 1;\r\n        masterGain.connect(audioContext.destination);\r\n        return masterGain;\r\n    }\r\n    return null;\r\n}\r\n\r\n/**\r\n * @class Sound\r\n * @exports module:media/Sound\r\n *\r\n * @constructor\r\n * @extends media/Audio\r\n * @param {Audio.defaults|Object} [data]\r\n * @param {MediaManager} [manager]\r\n */\r\nexport default class Sound extends Audio {\r\n    static defaults = {\r\n        id: null,\r\n        src: [],\r\n        format: null,\r\n        autoPlay: false,\r\n\r\n        duration: 0,\r\n        loop: false,\r\n        sprite: {},\r\n        volume: 1,\r\n        muted: false,\r\n        pos3d: [0, 0, -0.5],\r\n        rate: 1,\r\n\r\n        loaded: false,\r\n        buffer: false,\r\n        model: null,\r\n        onEndTimer: []\r\n    };\r\n\r\n    constructor(data, manager) {\r\n        super(data, manager);\r\n\r\n        this.manager = manager;\r\n        this.events = !!this.manager ? this.manager.events : new Events();\r\n        this.data = ObjectUtil.extend(true, {}, Sound.defaults, data);\r\n        this.audioNode = [];\r\n        audioContext = manager\r\n            ? manager.getAudioContext()\r\n            : new (window.AudioContext || window.webkitAudioContext);\r\n\r\n        masterGain = manager\r\n            ? manager.getMasterGain()\r\n            : createMasterGain();\r\n\r\n        if (this.data.id === null) {\r\n            this.data.id = UUID.generate();\r\n        }\r\n\r\n        if (audioContext && this.data.buffer) {\r\n            this._setupAudioNode(this);\r\n        }\r\n\r\n        if (this.manager && audioContext && this.manager.data.iOSAutoEnable) {\r\n            this.manager.iOSEnable = true;\r\n        }\r\n\r\n        if (this.manager) this.manager.media.get('sounds').add(this.data.id, this);\r\n\r\n        this.load();\r\n    }\r\n\r\n    _load(sound) {\r\n        loadBuffer(sound, sound.data.src);\r\n        return sound;\r\n    }\r\n\r\n    _unload(soundNode) {\r\n        soundNode.disconnect(0);\r\n    }\r\n\r\n    play(sprite, callback) {\r\n        var sound = this;\r\n\r\n        if (typeof sprite === 'function')  callback = sprite;\r\n\r\n        if (!sprite || typeof sprite === 'function') sprite = 'default';\r\n\r\n        if (!sound.data.loaded) {\r\n            sound.events.on('load', function () {\r\n                sound.play(sprite, callback);\r\n            });\r\n\r\n            return sound;\r\n        }\r\n\r\n        if (!sound.data.sprite[sprite]) {\r\n            if (typeof callback === 'function') callback();\r\n            return sound;\r\n        }\r\n\r\n        sound._inactiveNode(sound, function (node) {\r\n            node.sprite = sprite;\r\n\r\n            var pos = (node.pos > 0) ? node.pos : sound.data.sprite[sprite][0] / 1000;\r\n            var duration = sound.data.sprite[sprite][1] / 1000 - node.pos;\r\n            if (node.pos > 0) pos = sound.data.sprite[sprite][0] / 1000 + pos;\r\n            var loop = !!(sound.data.loop || sound.data.sprite[sprite][2]);\r\n\r\n            var soundId = (typeof callback === 'string')\r\n                ? callback\r\n                : Math.round(Date.now() * Math.random()) + '', timerId;\r\n\r\n            (function () {\r\n                var data = {\r\n                    id: soundId,\r\n                    sprite: sprite,\r\n                    loop: loop\r\n                };\r\n\r\n                timerId = setTimeout(function () {\r\n                    if (audioContext && !loop) {\r\n                        sound._nodeById(sound, data.id).paused = true;\r\n                        sound._nodeById(sound, data.id).pos = 0;\r\n                        sound._clearEndTimer(sound, data.id);\r\n                    }\r\n                    sound.events.trigger('unload', soundId);\r\n                }, (duration / sound.data.rate) * 1000);\r\n\r\n                sound.data.onEndTimer.push({timer: timerId, id: data.id});\r\n            })();\r\n\r\n            var loopStart = sound.data.sprite[sprite][0] / 1000,\r\n                loopEnd = sound.data.sprite[sprite][1] / 1000;\r\n\r\n            node.id = soundId;\r\n            node.paused = false;\r\n            refreshBuffer(sound, [loop, loopStart, loopEnd], soundId);\r\n            sound.data.playStart = audioContext.currentTime;\r\n            node.gain.value = sound.data.volume;\r\n\r\n            if (typeof node.bufferSource.start === 'undefined') {\r\n                loop ? node.bufferSource.noteGrainOn(0, pos, 86400) : node.bufferSource.noteGrainOn(0, pos, duration);\r\n            } else {\r\n                loop ? node.bufferSource.start(0, pos, 86400) : node.bufferSource.start(0, pos, duration);\r\n            }\r\n\r\n            sound.events.trigger('play');\r\n            if (typeof callback === 'function') callback(soundId);\r\n\r\n            return sound;\r\n        });\r\n\r\n        return sound;\r\n    }\r\n\r\n    _pause(activeNode) {\r\n        if (!activeNode.bufferSource || activeNode.paused) {\r\n            return true;\r\n        }\r\n\r\n        activeNode.paused = true;\r\n        if (activeNode.bufferSource.stop == undefined) {\r\n            activeNode.bufferSource.noteOff(0);\r\n        } else {\r\n            activeNode.bufferSource.stop(0);\r\n        }\r\n        return false;\r\n    }\r\n\r\n    _stop(activeNode) {\r\n        if (!activeNode.bufferSource || activeNode.paused) {\r\n            return true;\r\n        }\r\n\r\n        activeNode.paused = true;\r\n\r\n        if (typeof activeNode.bufferSource.stop === 'undefined') {\r\n            activeNode.bufferSource.noteOff(0);\r\n        } else {\r\n            activeNode.bufferSource.stop(0);\r\n        }\r\n        return false;\r\n    }\r\n\r\n    _mute(activeNode) {\r\n        activeNode.gain.value = 0;\r\n    }\r\n\r\n    _unMute(activeNode) {\r\n        activeNode.gain.value = this.data.volume;\r\n    }\r\n\r\n    _volume(activeNode, vol) {\r\n        activeNode.gain.value = vol;\r\n    }\r\n\r\n    _position(activeNode, v) {\r\n        if (v !== undefined && v == true) return activeNode.pos;\r\n        return activeNode.pos + (audioContext.currentTime - this.data.playStart);\r\n    }\r\n\r\n    _pos3d(activeNode, x, y, z) {\r\n        if (activeNode) {\r\n            this.data.pos3d = [x, y, z];\r\n            activeNode.panner.setPosition(x, y, z);\r\n            activeNode.panner.panningModel = this.data.model || 'HRTF';\r\n        }\r\n    }\r\n\r\n    _setupAudioNode() {\r\n        var sound = this,\r\n            node = sound.audioNode,\r\n            index = sound.audioNode.length;\r\n\r\n        node[index] = (audioContext.createGain === undefined)\r\n            ? audioContext.createGainNode()\r\n            : audioContext.createGain();\r\n\r\n        node[index].gain.value = sound.data.volume;\r\n        node[index].paused = true;\r\n        node[index].pos = 0;\r\n        node[index].readyState = 4;\r\n        node[index].connect(masterGain);\r\n\r\n        node[index].panner = audioContext.createPanner();\r\n        node[index].panner.panningModel = sound.data.model || 'equalpower';\r\n        node[index].panner.setPosition(sound.data.pos3d[0], sound.data.pos3d[1], sound.data.pos3d[2]);\r\n        node[index].panner.connect(node[index]);\r\n\r\n        return node[index];\r\n    }\r\n\r\n    /* Private */\r\n    _inactiveNode(sound, callback) {\r\n        var node = null;\r\n\r\n        for (var i = 0; i < sound.audioNode.length; i++) {\r\n            if (sound.audioNode[i].paused && sound.audioNode[i].readyState === 4) {\r\n                callback(sound.audioNode[i]);\r\n                node = true;\r\n                break;\r\n            }\r\n        }\r\n\r\n        sound._drainPool(sound);\r\n\r\n        if (node) return;\r\n\r\n        var newNode = sound._setupAudioNode();\r\n        callback(newNode);\r\n    }\r\n\r\n    _drainPool(sound) {\r\n        var inactive = 0;\r\n\r\n        for (var i = 0; i < sound.audioNode.length; i++) {\r\n            if (sound.audioNode[i].paused) inactive++;\r\n        }\r\n\r\n        for (i = sound.audioNode.length - 1; i >= 0; i--) {\r\n            if (inactive <= 5) break;\r\n\r\n            if (sound.audioNode[i].paused) {\r\n                if (audioContext) sound.audioNode[i].disconnect(0);\r\n                sound.audioNode.splice(i, 1);\r\n                inactive--;\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n\r\n/* WebAudioAPI Helpers */\r\n/**\r\n * Buffer a sound from URL (or from cache) and decode to audio source (Web Audio API).\r\n * @param  {Object} sound The Sound object for the sound to load.\r\n * @param  {String} url The path to the sound file.\r\n */\r\nvar loadBuffer = function (sound, url) {\r\n    if (url in cache) {\r\n        sound.data.duration = cache[url].duration;\r\n\r\n        loadSound(sound);\r\n        return;\r\n    }\r\n\r\n    if (/^data:[^;]+;base64,/.test(url)) {\r\n        var data = atob(url.split(',')[1]);\r\n        var dataView = new Uint8Array(data.length);\r\n        for (var i = 0; i < data.length; ++i) {\r\n            dataView[i] = data.charCodeAt(i);\r\n        }\r\n\r\n        decodeAudioData(dataView.buffer, sound, url);\r\n    } else {\r\n        var xhr = new XMLHttpRequest();\r\n        xhr.open('GET', url, true);\r\n        xhr.responseType = 'arraybuffer';\r\n        xhr.onload = function () {\r\n            decodeAudioData(xhr.response, sound, url);\r\n        };\r\n        xhr.onerror = function () {\r\n            if (audioContext) {\r\n                sound.data.buffer = true;\r\n                sound.audioNode = [];\r\n                delete sound.gainNode;\r\n                delete cache[url];\r\n                sound.load();\r\n            }\r\n        };\r\n        try {\r\n            xhr.send();\r\n        } catch (e) {\r\n            xhr.onerror();\r\n        }\r\n    }\r\n};\r\n\r\n/**\r\n * Decode audio data from an array buffer.\r\n * @param  {ArrayBuffer} arraybuffer The audio data.\r\n * @param  {Object} sound The Sound object for the sound to load.\r\n * @param  {String} url The path to the sound file.\r\n */\r\nvar decodeAudioData = function (arraybuffer, sound, url) {\r\n    audioContext.decodeAudioData(\r\n        arraybuffer,\r\n        function (buffer) {\r\n            if (buffer) {\r\n                cache[url] = buffer;\r\n                loadSound(sound, buffer);\r\n            }\r\n        },\r\n        function (error) {\r\n            sound.events.trigger('loaderror', error);\r\n        }\r\n    );\r\n};\r\n\r\n/**\r\n * Finishes loading the Web Audio API sound and fires the loaded event\r\n * @param  {Object}  sound    The Sound object for the sound to load.\r\n * @param  {Object} [buffer] The decoded buffer sound source.\r\n */\r\nvar loadSound = function (sound, buffer) {\r\n    sound.data.duration = (buffer) ? buffer.duration : sound.data.duration;\r\n\r\n    if (Object.getOwnPropertyNames(sound.data.sprite).length === 0) {\r\n        sound.data.sprite = {default: [0, sound.data.duration * 1000]};\r\n    }\r\n\r\n    if (!sound.data.loaded) {\r\n        sound.data.loaded = true;\r\n        sound.events.trigger('load');\r\n    }\r\n\r\n    if (sound.data.autoPlay) {\r\n        sound.play();\r\n    }\r\n};\r\n\r\n/**\r\n * Load the sound back into the buffer source.\r\n * @param  {Object} sound   The sound to load.\r\n * @param  {Array}  loop  Loop boolean, pos, and duration.\r\n * @param  {String} id    (optional) The play instance ID.\r\n */\r\nvar refreshBuffer = function (sound, loop, id) {\r\n    var node = sound._nodeById(sound, id);\r\n\r\n    node.bufferSource = audioContext.createBufferSource();\r\n    node.bufferSource.buffer = cache[sound.data.src];\r\n    node.bufferSource.connect(node.panner);\r\n    node.bufferSource.loop = loop[0];\r\n    if (loop[0]) {\r\n        node.bufferSource.loopStart = loop[1];\r\n        node.bufferSource.loopEnd = loop[1] + loop[2];\r\n    }\r\n    //noinspection JSPrimitiveTypeWrapperUsage\r\n    node.bufferSource.playbackRate.value = sound.data.rate;\r\n};\r\n","import ObjectUtil from \"utils/ObjectUtil\";\r\nimport UUID from \"utils/UUID\";\r\nimport Events from \"utils/Events\";\r\n\r\nvar cache = {};\r\nvar AudioNode = window.Audio;\r\n\r\n/**\r\n * @class Audio\r\n * @exports module:media/Audio\r\n *\r\n * @constructor\r\n * @param {Audio.defaults|Object} [data]\r\n * @param {MediaManager} [manager]\r\n */\r\nexport default class Audio {\r\n    static defaults = {\r\n        id: null,\r\n        src: [],\r\n        format: null,\r\n        autoPlay: false,\r\n\r\n        duration: 0,\r\n        loop: false,\r\n        sprite: {},\r\n        volume: 1,\r\n        muted: false,\r\n        pos3d: [0, 0, -0.5],\r\n\r\n        loaded: false,\r\n        onEndTimer: []\r\n    };\r\n\r\n    constructor(data, manager) {\r\n        var audio = this;\r\n        audio.manager = manager !== undefined ? manager : null;\r\n        audio.events = !!audio.manager ? audio.manager.events : new Events();\r\n        audio.data = ObjectUtil.extend(true, {}, Audio.defaults, data);\r\n\r\n        audio.audioNode = [];\r\n\r\n        if (audio.data.id === null) {\r\n            audio.data.id = UUID.generate();\r\n        }\r\n\r\n        if (audio.manager) audio.manager.media.get('audios').add(audio.data.id, audio);\r\n\r\n        audio.load();\r\n    }\r\n\r\n\r\n    _load(audio) {\r\n        var audioNode = new AudioNode();\r\n\r\n        audioNode.addEventListener('error', function () {\r\n            console.error({type: audioNode.error ? audioNode.error.code : 0});\r\n        }, false);\r\n\r\n        audio.audioNode.push(audioNode);\r\n\r\n        audioNode.src = audio.data.src;\r\n        audioNode.pos = 0;\r\n        audioNode.preload = 'auto';\r\n        audioNode.volume = (!!audio.manager)\r\n            ? (audio.manager.muted) ? 0 : audio.data.volume * (audio.manager.volume / 100)\r\n            : (audio.data.muted) ? 0 : audio.data.volume;\r\n\r\n        var listener = function () {\r\n            audio.data.duration = Math.ceil(audioNode.duration * 10) / 10;\r\n\r\n            if (Object.getOwnPropertyNames(audio.data.sprite).length === 0) {\r\n                audio.data.sprite = {default: [0, audio.data.duration * 1000]};\r\n            }\r\n\r\n            if (!audio.data.loaded) {\r\n                audio.data.loaded = true;\r\n                audio.events.trigger('load');\r\n            }\r\n\r\n            if (audio.data.autoPlay) {\r\n                audio.play();\r\n            }\r\n\r\n            audioNode.removeEventListener('canplaythrough', listener, false);\r\n        };\r\n        audioNode.addEventListener('canplaythrough', listener, false);\r\n        audioNode.load();\r\n\r\n        return audio;\r\n    }\r\n\r\n    load() {\r\n        var audio = this;\r\n        var url = '', extension = '';\r\n\r\n        if (audio.manager && (!!audio.manager.isSupportAudio)) {\r\n            console.warn('No audio support.');\r\n            return false;\r\n        }\r\n\r\n        var extractFormat = function (source, format) {\r\n            if (format) return format;\r\n\r\n            var extension = /^data:audio\\/([^;,]+);/i.exec(source);\r\n            if (!extension) {\r\n                extension = /\\.([^.]+)$/.exec(source.split('?', 1)[0]);\r\n            }\r\n\r\n            if (extension) {\r\n                return extension[1].toLowerCase();\r\n            } else {\r\n                console.warn('Could not extract format from passed URLs, please add format');\r\n            }\r\n            return null;\r\n        };\r\n\r\n        if (audio.data.src instanceof Array) {\r\n            for (var i = 0; i < audio.data.src.length; i++) {\r\n                url = audio.data.src[i];\r\n                extension = extractFormat(audio.data.src[i], audio.data.format);\r\n                if (null !== extension) break;\r\n            }\r\n            audio.data.src = url;\r\n        } else if (typeof audio.data.src === 'string') {\r\n            extension = extractFormat(audio.data.src, audio.data.format);\r\n        } else {\r\n            console.warn('Unknown audio source');\r\n            return false;\r\n        }\r\n\r\n        if (audio.manager && audio.manager.isSupportCodec[extension]) {\r\n            console.warn('Codec not support');\r\n            return false;\r\n        }\r\n\r\n        return audio._load(audio);\r\n    }\r\n\r\n    _unload(audioNode) {\r\n        audioNode.src = '';\r\n    }\r\n\r\n    unload() {\r\n        var audio = this;\r\n\r\n        var nodes = audio.audioNode;\r\n        for (var i = 0; i < audio.audioNode.length; i++) {\r\n            if (!nodes[i].paused) {\r\n                audio.stop(nodes[i].id);\r\n                audio.events.trigger('unload', nodes[i].id);\r\n            }\r\n            audio._unload(nodes[i]);\r\n        }\r\n\r\n        for (i = 0; i < audio.data.onEndTimer.length; i++) {\r\n            clearTimeout(audio.data.onEndTimer[i].timer);\r\n        }\r\n\r\n        if (audio.manager) {\r\n            var audios = this.manager.get('audios');\r\n            var index = audios.indexOf(audio);\r\n            if (index !== null && index >= 0) {\r\n                audios.splice(index, 1);\r\n            }\r\n        }\r\n\r\n        delete cache[audio.data.src];\r\n        audio = null;\r\n    };\r\n\r\n    src(source) {\r\n        var audio = this;\r\n\r\n        if (source) {\r\n            audio.stop();\r\n            audio.data.src = source;\r\n            audio.data.loaded = false;\r\n            audio.load();\r\n        } //TODO:: else throw\r\n\r\n        return null;\r\n    }\r\n\r\n    play(sprite, callback) {\r\n        var audio = this;\r\n\r\n        if (typeof sprite === 'function') callback = sprite;\r\n        if (!sprite || typeof sprite === 'function') sprite = 'default';\r\n\r\n        if (!audio.data.loaded) {\r\n            audio.events.on('load', function () {\r\n                audio.play(sprite, callback);\r\n            });\r\n\r\n            return audio;\r\n        }\r\n\r\n        if (!audio.data.sprite[sprite]) {\r\n            if (typeof callback === 'function') callback();\r\n            return audio;\r\n        }\r\n\r\n        audio._inactiveNode(audio, function (node) {\r\n            node.sprite = sprite;\r\n\r\n            var pos = (node.pos > 0) ? node.pos : audio.data.sprite[sprite][0] / 1000;\r\n            var duration = audio.data.sprite[sprite][1] / 1000 - (pos - audio.data.sprite[sprite][0] / 1000);\r\n            var loop = !!(audio.data.loop || audio.data.sprite[sprite][2]);\r\n\r\n            var soundId = (typeof callback === 'string')\r\n                ? callback\r\n                : Math.round(Date.now() * Math.random()) + '', timerId;\r\n\r\n            (function () {\r\n                var data = {\r\n                    id: soundId,\r\n                    sprite: sprite,\r\n                    loop: loop\r\n                };\r\n\r\n                timerId = setTimeout(function () {\r\n                    if (loop) {\r\n                        audio.stop(data.id).play(sprite, data.id);\r\n                    } else {\r\n                        audio.stop(data.id);\r\n                    }\r\n\r\n                    audio.events.trigger('unload', soundId);\r\n                }, (duration / audio.data.rate) * 1000);\r\n\r\n                audio.data.onEndTimer.push({timer: timerId, id: data.id});\r\n            })();\r\n\r\n\r\n            if (node.readyState === 4 || !node.readyState && navigator.isCocoonJS) {\r\n                node.id = soundId;\r\n                node.currentTime = pos;\r\n\r\n                node.muted = audio.manager\r\n                    ? (audio.manager.muted || node.muted)\r\n                    : (audio.data.muted || node.muted);\r\n\r\n                node.volume = audio.manager\r\n                    ? audio.data.volume * (audio.manager.volume / 100)\r\n                    : audio.data.volume;\r\n\r\n                setTimeout(function () {\r\n                    node.play();\r\n                }, 0);\r\n            } else {\r\n                audio._clearEndTimer(soundId);\r\n\r\n                (function () {\r\n                    var audio = audio,\r\n                        playSprite = sprite,\r\n                        fn = callback,\r\n                        newNode = node;\r\n\r\n                    var listener = function () {\r\n                        audio.play(playSprite, fn);\r\n                        newNode.removeEventListener('canplaythrough', listener, false);\r\n                    };\r\n\r\n                    newNode.addEventListener('canplaythrough', listener, false);\r\n                })();\r\n\r\n                return audio;\r\n            }\r\n\r\n            audio.events.trigger('play');\r\n            if (typeof callback === 'function') callback(soundId);\r\n\r\n            return audio;\r\n        });\r\n\r\n        return audio;\r\n    }\r\n\r\n    _pause(activeNode) {\r\n        activeNode.pause();\r\n        return false;\r\n    }\r\n\r\n    pause(id) {\r\n        var audio = this;\r\n\r\n        if (!audio.data.loaded) {\r\n            audio.events.on('play', function () {\r\n                audio.pause(id);\r\n            });\r\n            return audio;\r\n        }\r\n\r\n        audio._clearEndTimer(audio, id);\r\n\r\n        var activeNode = (id) ? audio._nodeById(id) : audio._activeNode(audio);\r\n        if (activeNode) {\r\n            activeNode.pos = audio.pos(null, id);\r\n            var result = audio._pause(activeNode);\r\n            if (result) return audio;\r\n        }\r\n\r\n        audio.events.trigger('pause');\r\n\r\n        return audio;\r\n    }\r\n\r\n    _stop(activeNode) {\r\n        if (!isNaN(activeNode.duration)) {\r\n            activeNode.pause();\r\n            activeNode.currentTime = 0;\r\n        }\r\n        return false;\r\n    }\r\n\r\n    stop(id) {\r\n        var audio = this;\r\n\r\n        if (!audio.data.loaded) {\r\n            audio.events.on('play', function () {\r\n                audio.stop(id);\r\n            });\r\n\r\n            return audio;\r\n        }\r\n\r\n        audio._clearEndTimer(audio, id);\r\n\r\n        var activeNode = (id) ? audio._nodeById(audio, id) : audio._activeNode(audio);\r\n        if (activeNode) {\r\n            activeNode.pos = 0;\r\n            var result = audio._stop(activeNode);\r\n            if (result) return audio;\r\n        }\r\n\r\n        return audio;\r\n    }\r\n\r\n    _mute(activeNode) {\r\n        activeNode.muted = true;\r\n    }\r\n\r\n    mute(id) {\r\n        var audio = this;\r\n\r\n        if (!audio.data.loaded) {\r\n            audio.events.on('play', function () {\r\n                audio.mute(id);\r\n            });\r\n            return audio;\r\n        }\r\n\r\n        var activeNode = (id) ? audio._nodeById(id) : audio._activeNode(audio);\r\n        if (activeNode) audio._mute();\r\n\r\n        return audio;\r\n    }\r\n\r\n    _unMute(activeNode) {\r\n        activeNode.muted = false;\r\n    }\r\n\r\n    unMute(id) {\r\n        var audio = this;\r\n\r\n        if (!audio.data.loaded) {\r\n            audio.events.on('play', function () {\r\n                audio.unMute(id);\r\n            });\r\n            return audio;\r\n        }\r\n\r\n        var activeNode = (id) ? audio._nodeById(id) : audio._activeNode(audio);\r\n        if (activeNode) audio._unMute();\r\n\r\n        return audio;\r\n    }\r\n\r\n    _volume(activeNode, vol) {\r\n        activeNode.volume = vol;\r\n    }\r\n\r\n    volume(vol, id) {\r\n        var audio = this;\r\n\r\n        vol = parseFloat(vol);\r\n\r\n        if (vol >= 0 && vol <= 1) {\r\n            audio.data.volume = vol;\r\n\r\n            if (!audio.data.loaded) {\r\n                audio.events.on('play', function () {\r\n                    audio.volume(vol, id);\r\n                });\r\n                return audio;\r\n            }\r\n\r\n            var activeNode = (id) ? audio._nodeById(id) : audio._activeNode(audio);\r\n            if (activeNode) {\r\n                vol = audio.manager\r\n                    ? vol * (audio.manager.volume / 100)\r\n                    : audio.data.volume;\r\n                audio._volume(vol);\r\n            }\r\n\r\n            return audio;\r\n        }\r\n        return audio.data.volume;\r\n    }\r\n\r\n    loop(loop) {\r\n        var audio = this;\r\n\r\n        if (typeof loop === 'boolean') {\r\n            audio.data.loop = loop;\r\n            return audio;\r\n        }\r\n        return audio.data.loop;\r\n    }\r\n\r\n    sprite(sprite) {\r\n        var audio = this;\r\n\r\n        if (typeof sprite === 'object') {\r\n            audio.data.sprite = sprite;\r\n            return audio;\r\n        }\r\n        return audio.data.sprite;\r\n    }\r\n\r\n    _position(activeNode, v) {\r\n        return activeNode.currentTime;\r\n    }\r\n\r\n    pos(pos, id) {\r\n        var audio = this;\r\n\r\n        if (!audio.data.loaded) {\r\n            audio.events.on('load', function () {\r\n                audio.pos(pos);\r\n            });\r\n            return typeof pos === 'number' ? audio : audio.data.pos || 0;\r\n        }\r\n\r\n        pos = parseFloat(pos);\r\n\r\n        var activeNode = (id) ? audio._nodeById(id) : audio._activeNode(audio);\r\n        if (activeNode) {\r\n            if (pos >= 0) {\r\n                audio.pause(id);\r\n                activeNode.pos = pos;\r\n                audio.play(activeNode.sprite, id);\r\n                return audio;\r\n            } else {\r\n                return audio._position(activeNode, false);\r\n            }\r\n        } else if (pos >= 0) {\r\n            return audio;\r\n        } else {\r\n            for (var i = 0; i < audio.audioNode.length; i++) {\r\n                if (audio.audioNode[i].paused && audio.audioNode[i].readyState === 4) {\r\n                    return audio._position(audio.audioNode[i], true);\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    _pos3d(activeNode, x, y, zsaz) {\r\n        return null;\r\n    }\r\n\r\n    pos3d(x, y, z, id) {\r\n        var audio = this;\r\n\r\n        y = (typeof y === 'undefined' || !y) ? 0 : y;\r\n        z = (typeof z === 'undefined' || !z) ? -0.5 : z;\r\n\r\n        if (!audio.data.loaded) {\r\n            audio.events.on('play', function () {\r\n                audio.pos3d(x, y, z, id);\r\n            });\r\n            return audio;\r\n        }\r\n\r\n        if (x >= 0 || x < 0) {\r\n            var activeNode = (id) ? audio._nodeById(id) : audio._activeNode(audio);\r\n            audio._pos3d(activeNode, x, y, z);\r\n        } else {\r\n            return audio.data.pos3d;\r\n        }\r\n\r\n        return audio;\r\n    }\r\n\r\n    /* Private */\r\n    _nodeById(audio, id) {\r\n        var node = audio.audioNode[0];\r\n\r\n        for (var i = 0; i < audio.audioNode.length; i++) {\r\n            if (audio.audioNode[i].id === id) {\r\n                node = audio.audioNode[i];\r\n                break;\r\n            }\r\n        }\r\n\r\n        return node;\r\n    }\r\n\r\n    _clearEndTimer(audio, id) {\r\n        var index = -1;\r\n\r\n        for (var i = 0; i < audio.data.onEndTimer.length; i++) {\r\n            if (audio.data.onEndTimer[i].id === id) {\r\n                index = i;\r\n                break;\r\n            }\r\n        }\r\n\r\n        var timer = audio.data.onEndTimer[index];\r\n        if (timer) {\r\n            clearTimeout(timer.timer);\r\n            audio.data.onEndTimer.splice(index, 1);\r\n        }\r\n    }\r\n\r\n    _activeNode(audio) {\r\n        var node = null;\r\n\r\n        for (var i = 0; i < audio.audioNode.length; i++) {\r\n            if (!audio.audioNode[i].paused) {\r\n                node = audio.audioNode[i];\r\n                break;\r\n            }\r\n        }\r\n\r\n        audio._drainPool(audio);\r\n\r\n        return node;\r\n    }\r\n\r\n    _inactiveNode(audio, callback) {\r\n        var node = null;\r\n\r\n        for (var i = 0; i < audio.audioNode.length; i++) {\r\n            if (audio.audioNode[i].paused && audio.audioNode[i].readyState === 4) {\r\n                callback(audio.audioNode[i]);\r\n                node = true;\r\n                break;\r\n            }\r\n        }\r\n\r\n        audio._drainPool(audio);\r\n\r\n        if (node) return;\r\n\r\n        audio.load();\r\n        var newNode = audio.audioNode[audio.audioNode.length - 1];\r\n        var listenerEvent = navigator.isCocoonJS ? 'canplaythrough' : 'loadedmetadata';\r\n        var listener = function () {\r\n            newNode.removeEventListener(listenerEvent, listener, false);\r\n            callback(newNode);\r\n        };\r\n        newNode.addEventListener(listenerEvent, listener, false);\r\n    }\r\n\r\n    _drainPool(audio) {\r\n        var inactive = 0;\r\n\r\n        for (var i = 0; i < audio.audioNode.length; i++) {\r\n            if (audio.audioNode[i].paused) inactive++;\r\n        }\r\n\r\n        for (i = audio.audioNode.length - 1; i >= 0; i--) {\r\n            if (inactive <= 5) break;\r\n\r\n            if (audio.audioNode[i].paused) {\r\n                audio.audioNode.splice(i, 1);\r\n                inactive--;\r\n            }\r\n        }\r\n    }\r\n}\r\n","/**\r\n * Assets Loader\r\n *\r\n * @class AssetsLoader\r\n * @exports module:loaders/AssetsLoader\r\n *\r\n * @constructor\r\n */\r\nexport default class AssetsLoader {\r\n    progress = 0;\r\n\r\n    getProgress() {\r\n        return this.progress;\r\n    }\r\n\r\n    load() {\r\n    }\r\n\r\n    isLoaded(index) {\r\n    }\r\n\r\n    dispose(index) {\r\n    }\r\n}\r\n","import GroupNode from \"nodes/GroupNode\";\r\nimport BaseNode from \"nodes/BaseNode\";\r\nimport RuntimeException from \"exceptions/RuntimeException\";\r\n\r\nexport const LAYER_PREFIX = '__layer$';\r\n\r\nexport default class Layer extends GroupNode {\r\n    static isSpecial = true; // This fix situation when add Layer in GroupNode.\r\n\r\n    _isGlobal = false;\r\n\r\n    _registry = [];\r\n\r\n    get(key) {\r\n        return this._nodes[`${LAYER_PREFIX}${key}`] || this._nodes[key] || null;\r\n    }\r\n\r\n    has(key) {\r\n        return this._nodes[`${LAYER_PREFIX}${key}`] !== undefined || this._nodes[key] !== undefined;\r\n    }\r\n\r\n    constructor(guid) {\r\n        super({id: `${LAYER_PREFIX}${guid}`});\r\n        if (guid === 'global') this._isGlobal = true;\r\n    }\r\n\r\n    add(node, index) {\r\n        index = index === undefined ? this.count() : this.find('main') + index;\r\n        if (node.instanceOf(Layer) && this._isGlobal) {\r\n            if (this._registry[node.guid] !== undefined) {\r\n                throw new RuntimeException(`Global layer already contain layer with id: \"${node.guid}\"`);\r\n            }\r\n            this._registry[node.guid] = node;\r\n            this._nodes[node.guid] = node;\r\n            this._nodes.splice(index, 0, node);\r\n            //TODO:: registry of layers\r\n        } else if (node.instanceOf(Layer) && !this._isGlobal) {\r\n            throw RuntimeException('Only global layer has another layer as child.');\r\n        } else if (node.instanceOf(BaseNode) && this._isGlobal) {\r\n            this._nodes[this.find('main')].add(node);\r\n        } else if (node.instanceOf(BaseNode) && !this._isGlobal) {\r\n            super.add(node)\r\n        }\r\n        return this;\r\n    }\r\n\r\n    remove(node) {\r\n        if (node.instanceOf(Layer)) {\r\n            delete this._registry[node.guid];\r\n        }\r\n        super.remove(node);\r\n        return this;\r\n    }\r\n\r\n    count() {\r\n        return this._nodes.length;\r\n    }\r\n\r\n    find(key) {\r\n        let node = this._nodes[`${LAYER_PREFIX}${key}`];\r\n        if (!node) return null;\r\n        return this._nodes.indexOf(node);\r\n    }\r\n}\r\n","import ObjectUtil from \"../utils/ObjectUtil\";\r\nimport Events from \"../utils/Events\";\r\nimport ArrayMap from \"../utils/ArrayMap\";\r\n/**\r\n * j2D (JavaScript 2D Engine)\r\n *\r\n * @authors DeVinterX, James Simpson of GoldFire Studios(howler.js)\r\n * @original_source https://github.com/goldfire/howler.js/blob/master/howler.js\r\n * @license BSD, MIT(howler.js)\r\n * @version 0.2.0-dev\r\n */\r\n\r\nvar AudioNode = window.Audio;\r\nvar audioContext = false;\r\nvar html5Audio = false;\r\n\r\ntry {\r\n    //noinspection JSUnresolvedVariable\r\n    var AudioContext = window.AudioContext || window.webkitAudioContext;\r\n    audioContext = new AudioContext();\r\n} catch (e) {\r\n    console.warn('Web Audio API is not supported in your browser');\r\n}\r\n\r\ntry {\r\n    //noinspection JSUnresolvedFunction\r\n    html5Audio = !!new AudioNode();\r\n} catch (e) {\r\n    console.warn('HTML5 Audio is not supported in your browser');\r\n}\r\n\r\nif (audioContext) {\r\n    var masterGain = (audioContext.createGain === undefined)\r\n        ? audioContext.createGainNode()\r\n        : audioContext.createGain();\r\n    masterGain.gain.value = 1;\r\n    masterGain.connect(audioContext.destination);\r\n}\r\n\r\n/* MediaManager */\r\n\r\n/**\r\n * @class MediaManager\r\n * @exports module:io/MediaManager\r\n *\r\n * @param {EngineJ2D} j2d\r\n * @param {MediaManager.defaults|Object|undefined} [data]\r\n * @constructor\r\n */\r\nexport default class MediaManager {\r\n    static defaults = {\r\n        volume: 1,\r\n        muted: false,\r\n        codecs: {},\r\n        iOSAutoEnable: true\r\n    };\r\n\r\n    constructor(j2d, data) {\r\n        if (data === undefined) data = {};\r\n        this.j2d = j2d;\r\n        this.data = ObjectUtil.extend(true, {}, MediaManager.defaults, data);\r\n        this.events = new Events();\r\n        this.media = new ArrayMap();\r\n\r\n        this.media.add('sounds', new ArrayMap());\r\n        this.media.add('audios', new ArrayMap());\r\n        this.media.add('videos', new ArrayMap());\r\n\r\n        this.volume = this.data.volume * 100;\r\n        this.iOSEnabled = false;\r\n\r\n        if (audioContext || html5Audio) {\r\n            var test = new AudioNode();\r\n            this.data.codecs = {\r\n                mp3: !!test.canPlayType('audio/mpeg;').replace(/^no$/, ''),\r\n                opus: !!test.canPlayType('audio/ogg; codecs=\"opus\"').replace(/^no$/, ''),\r\n                ogg: !!test.canPlayType('audio/ogg; codecs=\"vorbis\"').replace(/^no$/, ''),\r\n                wav: !!test.canPlayType('audio/wav; codecs=\"1\"').replace(/^no$/, ''),\r\n                aac: !!test.canPlayType('audio/aac;').replace(/^no$/, ''),\r\n                m4a: !!(test.canPlayType('audio/x-m4a;') || test.canPlayType('audio/m4a;') || test.canPlayType('audio/aac;')).replace(/^no$/, ''),\r\n                mp4: !!(test.canPlayType('audio/x-mp4;') || test.canPlayType('audio/mp4;') || test.canPlayType('audio/aac;')).replace(/^no$/, ''),\r\n                weba: !!test.canPlayType('audio/webm; codecs=\"vorbis\"').replace(/^no$/, '')\r\n            };\r\n            test = null;\r\n        }\r\n    }\r\n\r\n    get volume() {\r\n        return this.data.volume * 100;\r\n    }\r\n\r\n    set volume(value) {\r\n        this.data.volume = parseFloat(value / 100);\r\n\r\n        if (value >= 0 && value <= 1) {\r\n            if (audioContext) {\r\n                masterGain.gain.value = this.data.volume;\r\n            } else {\r\n                var sounds = this.media.get('sounds');\r\n                for (var key in sounds) {\r\n                    if (sounds.hasOwnProperty(key) && !sounds[key].webAudio) {\r\n                        for (var i = 0; i < sounds[key].audioNode.length; i++) {\r\n                            sounds[key].audioNode[i].volume = sounds[key].volume * this.data.volume;\r\n                        }\r\n                    }\r\n                }\r\n                sounds = null;\r\n            }\r\n        }\r\n    }\r\n\r\n    get muted() {\r\n        return !!this.data.muted;\r\n    }\r\n\r\n    set muted(value) {\r\n        this.data.muted = !!value;\r\n\r\n        if (audioContext) {\r\n            masterGain.gain.value = this.data.muted ? 0 : this.data.volume;\r\n        } else {\r\n            var sounds = this.media.get('sounds');\r\n            for (var key in sounds) {\r\n                if (sounds.hasOwnProperty(key) && sounds[key].webAudio === false) {\r\n                    for (var i = 0; i < sounds[key].audioNode.length; i++) {\r\n                        sounds[key].audioNode[i].muted = this.data.muted;\r\n                    }\r\n                }\r\n            }\r\n            sounds = null;\r\n        }\r\n    }\r\n\r\n    get iOSEnable() {\r\n        return !!this.data.iOSAutoEnable;\r\n    }\r\n\r\n    set iOSEnable(value) {\r\n        if (audioContext && (this.iOSEnabled || !/iPhone|iPad|iPod/i.test(navigator.userAgent))) {\r\n            return value;\r\n        }\r\n        this.iOSEnabled = false;\r\n\r\n        var unlock = function () {\r\n            var buffer = audioContext.createBuffer(1, 1, 22050);\r\n            var source = audioContext.createBufferSource();\r\n            source.buffer = buffer;\r\n            source.connect(audioContext.destination);\r\n\r\n            if (source.start === undefined) {\r\n                source.noteOn(0);\r\n            } else {\r\n                source.start(0);\r\n            }\r\n\r\n            setTimeout(function () {\r\n                if ((source.playbackState === source.PLAYING_STATE\r\n                    || source.playbackState === source.FINISHED_STATE)) {\r\n                    this.iOSEnabled = true;\r\n                    this.data.iOSAutoEnable = false;\r\n\r\n                    window.removeEventListener('touchend', unlock, false);\r\n                }\r\n            }, 0);\r\n        };\r\n        window.addEventListener('touchend', unlock, false);\r\n    }\r\n\r\n    get isSupportAudio() {\r\n        return !audioContext && !html5Audio;\r\n    }\r\n\r\n\r\n    getAudioContext() {\r\n        return audioContext;\r\n    }\r\n\r\n    getMasterGain() {\r\n        return masterGain;\r\n    }\r\n\r\n    mute() {\r\n        this.muted = true;\r\n        return this;\r\n    }\r\n\r\n    unMute() {\r\n        this.muted = false;\r\n        return this;\r\n    }\r\n\r\n    isSupportCodec(fileExtension) {\r\n        return !!this.data.codecs[fileExtension];\r\n    }\r\n\r\n    addSound(data) {\r\n        new Sound(data, this);\r\n        return this;\r\n    }\r\n\r\n    addAudio(data) {\r\n        new Audio(data, this);\r\n        return this;\r\n    }\r\n\r\n    addVideo(data) {\r\n        //new Video(this, data);\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {string} id\r\n     * @returns {Sound}\r\n     */\r\n    sound(id) {\r\n        return this.media.get('sounds').get(id);\r\n    }\r\n\r\n    audio(id) {\r\n        return this.media.get('audios').get(id);\r\n    }\r\n\r\n    video(id) {\r\n        return this.media.get('videos').get(id);\r\n    }\r\n\r\n    removeSound(id) {\r\n        if (this.media.get('sounds').contains(id)) {\r\n            this.media.get('sounds').get(id).stop();\r\n            this.media.get('sounds').remove(id);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    removeAudio(id) {\r\n        if (this.media.get('audios').contains(id)) {\r\n            this.media.get('audios').get(id).stop();\r\n            this.media.get('audios').remove(id);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    removeVideo(id) {\r\n        if (this.media.get('videos').contains(id)) {\r\n            this.media.get('videos').get(id).stop();\r\n            this.media.get('videos').remove(id);\r\n        }\r\n        return this;\r\n    }\r\n}\r\n","import ArrayMap from \"utils/ArrayMap\";\r\nimport Vector2d from \"utils/Vector2d\";\r\n\r\n/**\r\n * @param e\r\n * @param {boolean} [enableCallback]\r\n * @returns {boolean}\r\n */\r\nvar checkKeyMap = function (e, enableCallback) {\r\n    if (enableCallback === undefined) enableCallback = true;\r\n\r\n    var j2d = e.data.manager.j2d,\r\n        manager = e.data.manager,\r\n        keyCode = e.which,\r\n        keyMap = e.data.manager.keyMap;\r\n\r\n    for (var index in keyMap) {\r\n        if (keyMap.hasOwnProperty(index)) {\r\n            var value = keyMap[index];\r\n            if (!$.isArray(value[0]) && value[0] === keyCode && !!value[1]) {\r\n                if (typeof value[1] === 'string') {\r\n                    value[1] = eval('(' + value[1] + ')');\r\n                }\r\n                if ((typeof value[1] === 'function') && enableCallback) {\r\n                    value[1](j2d, value[2]);\r\n                }\r\n                return true;\r\n            } else if ($.isArray(value[0])\r\n                && manager.data.keysPressed.equals(value[0]) && !!value[1]\r\n            ) {\r\n                if (typeof value[1] === 'string') {\r\n                    value[1] = eval('(' + value[1] + ')');\r\n                }\r\n                if (typeof value[1] === 'function' && enableCallback) {\r\n                    value[1](j2d, value[2]);\r\n                }\r\n                return true\r\n            }\r\n        }\r\n    }\r\n    return false\r\n};\r\nvar events = {\r\n    onMouseClick: function (e) {\r\n        var manager = e.data.manager;\r\n        if (!manager.data.enabled || !manager.j2d.isPlay || !manager.j2d.element.hasClass('active')) return true;\r\n        var keysPressed = manager.data.keysPressed;\r\n        var keyCode = getKey(DEPRECATED_InputManager.key, e.which) || 'KEY_UNKNOWN_' + e.which;\r\n        var mouse = manager.data.mouse;\r\n\r\n        if (e.data.event !== 2) {\r\n            if (e.data.event === 0) {\r\n                if (-1 === $.inArray(DEPRECATED_InputManager.key[keyCode], keysPressed)) {\r\n                    keysPressed.push(DEPRECATED_InputManager.key[keyCode]);\r\n\r\n                    if (manager.data.enableAdditionalData) {\r\n                        mouse.startPosition.x = e.pageX;\r\n                        mouse.startPosition.y = e.pageY;\r\n                        mouse.distance = 0;\r\n\r\n                        manager.data.timePressed = e.timeStamp;\r\n                    }\r\n                }\r\n                if (checkKeyMap(e, false) || manager.data.preventAll) {\r\n                    e.preventDefault();\r\n                }\r\n            } else {\r\n                if (checkKeyMap(e) || manager.data.preventAll) {\r\n                    e.preventDefault();\r\n                }\r\n                if (manager.data.enableAdditionalData) {\r\n                    mouse.previousDistance = mouse.distance;\r\n                    mouse.startPosition.x = 0;\r\n                    mouse.startPosition.y = 0;\r\n                }\r\n\r\n                keysPressed.splice(\r\n                    keysPressed.indexOf(DEPRECATED_InputManager.key[keyCode]), 1\r\n                );\r\n            }\r\n            manager.element.trigger(e.data.event === 0 ?\r\n                'mouseKeyDown' : 'mouseKeyUp', {keyCode: keyCode}\r\n            );\r\n        } else {\r\n            if (checkKeyMap(e, false)) {\r\n                e.preventDefault();\r\n            }\r\n        }\r\n    },\r\n\r\n    onMouseWheel: function (e) {\r\n        var manager = e.data.manager;\r\n        if (!manager.data.enabled || !manager.j2d.isPlay || !manager.j2d.element.hasClass('active')) return true;\r\n        var keysPressed = manager.data.keysPressed;\r\n        var keyCode = (e.originalEvent.wheelDelta / 120 > 0) ?\r\n            getKey(DEPRECATED_InputManager.key, 4) : getKey(DEPRECATED_InputManager.key, 5);\r\n\r\n        e.which = (e.originalEvent.wheelDelta / 120 > 0) ? 4 : 5;\r\n\r\n        if (-1 === $.inArray(DEPRECATED_InputManager.key[keyCode], keysPressed)) {\r\n            keysPressed.push(DEPRECATED_InputManager.key[keyCode]);\r\n        }\r\n\r\n        if (checkKeyMap(e) || manager.data.preventAll) {\r\n            e.preventDefault();\r\n            manager.fixMouseWheel();\r\n        }\r\n\r\n        manager.element.trigger('mouseWheel', {keyCode: keyCode});\r\n    },\r\n\r\n    mouseWheelCancel: function (keysPressed, keyCode) {\r\n        keysPressed.splice(\r\n            keysPressed.indexOf(DEPRECATED_InputManager.key[keyCode]), 1\r\n        );\r\n    },\r\n\r\n    onMouseMove: function (e) {\r\n        var manager = e.data.manager;\r\n        var mouse = e.data.manager.data.mouse;\r\n\r\n        manager.data.mouse.currentPosition.x = e.pageX;\r\n        manager.data.mouse.currentPosition.y = e.pageY;\r\n\r\n        if (e.data.manager.data.enableAdditionalData) {\r\n            mouse.distance = Math.sqrt(\r\n                Math.pow((mouse.currentPosition.x - mouse.startPosition.x), 2)\r\n                + Math.pow((mouse.currentPosition.y - mouse.startPosition.y), 2)\r\n            ).toFixed(1);\r\n        }\r\n    },\r\n\r\n    onKeyboardPress: function (e) {\r\n        var manager = e.data.manager;\r\n        if (!manager.data.enabled || !manager.j2d.isPlay || !manager.element.hasClass('active')) return true;\r\n        var keysPressed = manager.data.keysPressed;\r\n        var keyCode = getKey(DEPRECATED_InputManager.key, e.which) || 'KEY_UNKNOWN_' + e.which;\r\n        if (e.data.event === 2 && true === manager.data.writeMode) {\r\n            var char = String.fromCharCode(e.which || e.keyCode);\r\n            e.preventDefault();\r\n            manager.element.focus().trigger('keyboardCharPress', {\r\n                key: e.which || e.keyCode,\r\n                keyCode: keyCode,\r\n                char: char\r\n            });\r\n        }\r\n\r\n        if (e.data.event !== 2 && false === manager.data.writeMode) {\r\n            if (e.data.event === 0) {\r\n                if (-1 === $.inArray(DEPRECATED_InputManager.key[keyCode], keysPressed)) {\r\n                    keysPressed.push(DEPRECATED_InputManager.key[keyCode]);\r\n                    if (manager.data.enableAdditionalData) {\r\n                        manager.data.timePressed = e.timeStamp;\r\n                    }\r\n                }\r\n                if (checkKeyMap(e, false) || manager.data.preventAll) {\r\n                    e.preventDefault();\r\n                }\r\n            } else {\r\n                if (checkKeyMap(e) || manager.data.preventAll) {\r\n                    e.preventDefault();\r\n                }\r\n\r\n                keysPressed.splice(\r\n                    keysPressed.indexOf(DEPRECATED_InputManager.key[keyCode]), 1\r\n                );\r\n            }\r\n\r\n            manager.element.trigger(e.data.event === 0 ?\r\n                'keyboardKeyDown' : 'keyboardKeyUp', {keyCode: keyCode, key: e.which || e.keyCode}\r\n            );\r\n        }\r\n\r\n        if (e.data.event !== 2 && true === manager.data.writeMode) {\r\n            manager.element.trigger(e.data.event === 0 ?\r\n                'keyboardKeyDown' : 'keyboardKeyUp', {keyCode: keyCode, key: e.which || e.keyCode}\r\n            );\r\n        }\r\n    },\r\n\r\n    onTouchTap: function (e) {\r\n        var manager = e.data.manager;\r\n        if (!manager.data.enabled || !manager.j2d.isPlay || !manager.j2d.element.hasClass('active')) return true;\r\n        var keysPressed = manager.data.keysPressed;\r\n        var keyCode = getKey(DEPRECATED_InputManager.key, e.which + 1) || 'KEY_UNKNOWN_' + e.which;\r\n        var touch = e.originalEvent.touches[0] || e.originalEvent.changedTouches[0];\r\n        var mouse = manager.data.mouse;\r\n\r\n        if (e.data.event === 0) {\r\n            if (-1 === $.inArray(DEPRECATED_InputManager.key[keyCode], keysPressed)) {\r\n                keysPressed.push(DEPRECATED_InputManager.key[keyCode]);\r\n                if (manager.data.enableAdditionalData) {\r\n                    mouse.startPosition.x = touch.pageX;\r\n                    mouse.startPosition.y = touch.pageY;\r\n                    mouse.distance = 0;\r\n\r\n                    manager.data.timePressed = e.timeStamp;\r\n                }\r\n            }\r\n            if (checkKeyMap(e, false) || manager.data.preventAll) {\r\n                e.preventDefault();\r\n            }\r\n        } else {\r\n            if (checkKeyMap(e) || manager.data.preventAll) {\r\n                e.preventDefault();\r\n            }\r\n\r\n            if (manager.data.enableAdditionalData) {\r\n                mouse.previousDistance = mouse.distance;\r\n                mouse.startPosition.x = 0;\r\n                mouse.startPosition.y = 0;\r\n            }\r\n\r\n            keysPressed.splice(\r\n                keysPressed.indexOf(DEPRECATED_InputManager.key[keyCode]), 1\r\n            );\r\n        }\r\n\r\n        manager.element.trigger(e.data.event === 0 ?\r\n            'mouseKeyDown' : 'mouseKeyUp', {keyCode: keyCode}\r\n        );\r\n    },\r\n\r\n    onTouchMove: function (e) {\r\n        var touch = e.originalEvent.touches[0] || e.originalEvent.changedTouches[0];\r\n        var mouse = e.data.manager.data.mouse;\r\n\r\n        mouse.currentPosition.x = touch.pageX.toFixed(0);\r\n        mouse.currentPosition.y = touch.pageY.toFixed(0);\r\n\r\n        if (e.data.manager.data.enableAdditionalData) {\r\n            mouse.distance = Math.sqrt(\r\n                Math.pow((mouse.currentPosition.x - mouse.startPosition.x), 2)\r\n                + Math.pow((mouse.currentPosition.y - mouse.startPosition.y), 2)\r\n            ).toFixed(1);\r\n        }\r\n    }\r\n};\r\n\r\n/**\r\n * @param {DEPRECATED_InputManager} manager\r\n */\r\nvar bindEvents = function (manager) {\r\n    var selector = '[guid=' + manager.id + ']';\r\n\r\n    $(document).on('contextmenu', selector, {manager: manager, event: 2}, events.onMouseClick);\r\n    $(document).on('mousedown', selector, {manager: manager, event: 0}, events.onMouseClick);\r\n    $(document).on('mouseup', selector, {manager: manager, event: 1}, events.onMouseClick);\r\n    $(document).on('mousewheel', selector, {manager: manager}, events.onMouseWheel);\r\n    $(document).on('mousemove', selector, {manager: manager}, events.onMouseMove);\r\n\r\n    $(document).on('keydown', null, {manager: manager, event: 0}, events.onKeyboardPress);\r\n    $(document).on('keyup', null, {manager: manager, event: 1}, events.onKeyboardPress);\r\n    $(document).on('keypress', null, {manager: manager, event: 2}, events.onKeyboardPress);\r\n\r\n    $(document).on('touchstart', selector, {manager: manager, event: 0}, events.onTouchTap);\r\n    $(document).on('touchend', selector, {manager: manager, event: 1}, events.onTouchTap);\r\n    $(document).on('touchmove ', selector, {manager: manager}, events.onTouchMove);\r\n};\r\n\r\n/**\r\n * @param {DEPRECATED_InputManager} manager\r\n */\r\nvar unbindEvents = function (manager) {\r\n    var selector = '[guid=' + manager.id + ']';\r\n\r\n    $(document).off('contextmenu', selector, {manager: manager, event: 1}, events.onMouseClick);\r\n    $(document).off('mousedown', selector, {manager: manager, event: 0}, events.onMouseClick);\r\n    $(document).off('mouseup', selector, {manager: manager, event: 1}, events.onMouseClick);\r\n    $(document).off('mousewheel', selector, {manager: manager}, events.onMouseWheel);\r\n    $(document).off('mousemove', selector, {manager: manager}, events.onMouseMove);\r\n\r\n    $(document).off('keydown', null, {manager: manager, event: 0}, events.onKeyboardPress);\r\n    $(document).off('keyup', null, {manager: manager, event: 1}, events.onKeyboardPress);\r\n    $(document).off('keypress', null, {manager: manager, event: 2}, events.onKeyboardPress);\r\n\r\n    $(document).off('touchstart', selector, {manager: manager, event: 0}, events.onTouchTap);\r\n    $(document).off('touchend', selector, {manager: manager, event: 1}, events.onTouchTap);\r\n    $(document).off('touchmove ', selector, {manager: manager}, events.onTouchMove);\r\n};\r\n\r\n/**\r\n * @param {DEPRECATED_InputManager} manager\r\n * @param {Array.<number>|number[]} keyList\r\n * @returns {{keyList: Array.<number>|number[]|number, time: number}|boolean}\r\n */\r\nvar getPressData = function (manager, keyList) {\r\n    if (!manager.data.enableAdditionalData) return true;\r\n    return {\r\n        keyList: keyList,\r\n        time: Date.now() - manager.data.timePressed\r\n    };\r\n};\r\n\r\n/**\r\n * @param {Object} object\r\n * @param {number} value\r\n * @returns {T}\r\n */\r\nfunction getKey(object, value) {\r\n    return Object.keys(object).filter(function (key) {\r\n        return object[key] === value\r\n    })[0];\r\n}\r\n\r\n/**\r\n * @class DEPRECATED_InputManager\r\n * @exports module:io/DEPRECATED_InputManager\r\n *\r\n * @param {EngineJ2D} j2d\r\n * @constructor\r\n *\r\n * @type {DEPRECATED_InputManager.key} key\r\n */\r\nexport default class DEPRECATED_InputManager {\r\n    constructor(j2d) {\r\n        this.j2d = j2d;\r\n\r\n        /** @type string */\r\n        this.id = j2d.data.id;\r\n\r\n        /** @type Element|jQuery */\r\n        this.element = j2d.element;\r\n\r\n        this.data = {\r\n            mouse: {\r\n                startPosition: {\r\n                    x: 0,\r\n                    y: 0\r\n                },\r\n                currentPosition: {\r\n                    x: 0,\r\n                    y: 0\r\n                },\r\n                previousDistance: 0,\r\n                distance: 0\r\n            },\r\n            viewport: {\r\n                position: {\r\n                    x: 0,\r\n                    y: 0\r\n                }\r\n            },\r\n            enabled: false,\r\n            enableAdditionalData: false,\r\n            keysPressed: new ArrayMap(),\r\n            writeMode: false,\r\n            timePressed: 0,\r\n            preventAll: false,\r\n\r\n            cursor: {\r\n                enabled: false,\r\n                image: 'auto'\r\n            }\r\n        };\r\n\r\n        this.keyMap = {\r\n            //DEBUG_INFO: [[DEPRECATED_InputManager.key.KEY_CTRL, DEPRECATED_InputManager.key.KEY_F1], 'j2d.debug.toggleScreen', {}],\r\n            FULLSCREEN: [[DEPRECATED_InputManager.key.KEY_CTRL, DEPRECATED_InputManager.key.KEY_F11], 'j2d.scene.toggleFullScreen', {}]\r\n        };\r\n    }\r\n\r\n    /**\r\n     * @returns {DEPRECATED_InputManager}\r\n     */\r\n    init() {\r\n        if (!this.data.enabled && window.j2dPlugin.pluginInit) {\r\n            bindEvents(this);\r\n\r\n            this.data.enabled = true;\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @returns {boolean}\r\n     */\r\n    update() {\r\n        if (!this.data.enabled) return false;\r\n\r\n        var dX = this.j2d.scene.canvas.offsetWidth / this.j2d.scene.data.width,\r\n            dY = this.j2d.scene.canvas.offsetHeight / this.j2d.scene.data.height,\r\n            x = this.data.mouse.currentPosition.x / dX,\r\n            y = this.data.mouse.currentPosition.y / dY;\r\n\r\n        var offset = this.element.offset();\r\n\r\n        this.data.viewport.x = this.j2d.scene.viewport.x + x - offset.left;\r\n        this.data.viewport.y = this.j2d.scene.viewport.y + y - offset.top;\r\n        return true;\r\n    }\r\n\r\n    /**\r\n     * @returns {DEPRECATED_InputManager}\r\n     */\r\n    flush() {\r\n        this.data.keysPressed.length = 0;\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @returns {DEPRECATED_InputManager}\r\n     */\r\n    clear() {\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @returns {DEPRECATED_InputManager}\r\n     */\r\n    fixMouseWheel() {\r\n        var keyPressed = this.data.keysPressed;\r\n        if (-1 !== $.inArray(DEPRECATED_InputManager.key.SCROLL_MOUSE_UP, keyPressed)) {\r\n            events.mouseWheelCancel(keyPressed, DEPRECATED_InputManager.key.SCROLL_MOUSE_UP);\r\n        } else if (-1 !== $.inArray(DEPRECATED_InputManager.key.SCROLL_MOUSE_DOWN, keyPressed)) {\r\n            events.mouseWheelCancel(keyPressed, DEPRECATED_InputManager.key.SCROLL_MOUSE_DOWN);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @returns {DEPRECATED_InputManager}\r\n     */\r\n    enable() {\r\n        if (!this.data.enabled) {\r\n            //bindEvents(this);\r\n            this.data.enabled = false;\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @returns {DEPRECATED_InputManager}\r\n     */\r\n    disable() {\r\n        if (this.data.enabled) {\r\n            //unbindEvents(this);\r\n            this.data.enabled = false;\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {string} newKeyMap\r\n     * @returns {string}\r\n     */\r\n    load(newKeyMap) {\r\n        var oldKeyMap = JSON.stringify(this.keyMap);\r\n        this.keyMap = JSON.parse(newKeyMap);\r\n        return oldKeyMap;\r\n    }\r\n\r\n    /**\r\n     * @returns {string}\r\n     */\r\n    save() {\r\n        return JSON.stringify(this.keyMap);\r\n    }\r\n\r\n    /**\r\n     * KeyMap Manager\r\n     *\r\n     * @param mapObject\r\n     * @returns {DEPRECATED_InputManager}\r\n     */\r\n    setKeys(mapObject) {\r\n        this.keyMap = $.extend(true, {}, this.keyMap, mapObject);\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @returns {{current: number, previous: number}}\r\n     */\r\n    getMouseMoveDistance() {\r\n        if (!this.data.enableAdditionalData) return 0;\r\n        return {current: this.data.mouse.distance, previous: this.data.mouse.previousDistance};\r\n    }\r\n\r\n    /* +Input Checkers **/\r\n    /**\r\n     * @param {Array.<number>|number[]|number} keyList\r\n     * @returns {boolean}\r\n     */\r\n    checkPressedKeyList(keyList) {\r\n        if ($.isArray(keyList)) {\r\n            if (keyList.length !== this.data.keysPressed.length) {\r\n                return false;\r\n            } else if (this.data.keysPressed.equals(keyList)) {\r\n                this.fixMouseWheel();\r\n                return getPressData(this, keyList);\r\n            }\r\n            this.fixMouseWheel();\r\n            return false;\r\n        }\r\n        //if (!this.data.keysPressed.equals([])) console.log(this.data.keysPressed);\r\n        if (isNaN(keyList)) return false;\r\n        if (-1 !== this.data.keysPressed.indexOf(keyList)) {\r\n            this.fixMouseWheel();\r\n            return getPressData(this, keyList);\r\n        }\r\n        this.fixMouseWheel();\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * @param {string} key\r\n     * @returns {boolean}\r\n     */\r\n    checkPressedKeyMap(key) {\r\n        if (this.keyMap[key] === undefined) return false;\r\n        var keyList = this.keyMap[key][0];\r\n\r\n        return this.checkPressedKeyList(keyList);\r\n    }\r\n\r\n    getPosition() {\r\n        return new Vector2d(this.data.viewport.x + 0.5, this.data.viewport.y + 0.3);\r\n    }\r\n\r\n//onNode (id) {\r\n//    if (!id.layer.visible) return false;\r\n//    return (this.data.viewport.x > id.options.position.x && this.data.viewport.x < id.options.position.x + id.options.size.x) &&\r\n//        (this.data.viewport.y > id.options.position.y && this.data.viewport.y < id.options.position.y + id.options.size.y);\r\n//}\r\n    /* -Input Checkers **/\r\n\r\n    /* +Input Write Mode **/\r\n    /**\r\n     * @param {boolean} mode\r\n     * @returns {DEPRECATED_InputManager}\r\n     */\r\n    setWriteMode(mode) {\r\n        this.data.writeMode = !!mode;\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @returns {boolean}\r\n     */\r\n    isWriteMode() {\r\n        return !!this.data.writeMode;\r\n    }\r\n\r\n    /* -Input Write Mode **/\r\n\r\n    /**\r\n     * @param {string} image\r\n     * @returns {DEPRECATED_InputManager}\r\n     */\r\n    setCursorImage(image) {\r\n        this.data.cursor.image = 'url(\"' + image + '\"), auto';\r\n        $(this.element).css('cursor', this.data.cursor.image);\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {boolean} enable\r\n     * @returns {DEPRECATED_InputManager}\r\n     */\r\n    toggleCursor(enable) {\r\n        if (enable !== undefined) {\r\n            this.data.cursor.enable = !!enable;\r\n        } else {\r\n            this.data.cursor.enable = !this.data.cursor.enable;\r\n        }\r\n\r\n        if (!this.data.cursor.enable) {\r\n            this.data.cursor.image = $(this.j2d.element).css('cursor');\r\n            $(this.element).css('cursor', 'none');\r\n        } else {\r\n            $(this.element).css('cursor', this.data.cursor.image);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @returns {boolean}\r\n     */\r\n    isCursorVisible() {\r\n        return !!this.data.cursor.enable;\r\n    }\r\n\r\n    /** -Cursor **/\r\n\r\n    /**\r\n     * Static keys arrayList\r\n     *\r\n     * @readonly\r\n     * @enum {number}\r\n     */\r\n    static key = {\r\n        KEY_MOUSE_LEFT: 1,\r\n        KEY_MOUSE_MIDDLE: 2,\r\n        KEY_MOUSE_RIGHT: 3,\r\n\r\n        SCROLL_MOUSE_UP: 4,\r\n        SCROLL_MOUSE_DOWN: 5,\r\n\r\n        KEY_BACKSPACE: 8,\r\n        KEY_TAB: 9,\r\n        KEY_ENTER: 13,\r\n        KEY_SHIFT: 16,\r\n        KEY_CTRL: 17,\r\n        KEY_ALT: 18,\r\n        KEY_PAUSE: 19,\r\n        KEY_BREAK: 19,\r\n        KEY_CAPS_LOCK: 20,\r\n        KEY_ESCAPE: 27,\r\n        KEY_SPACE_BAR: 32,\r\n        KEY_PAGE_UP: 33,\r\n        KEY_PAGE_DOWN: 34,\r\n        KEY_END: 35,\r\n        KEY_HOME: 36,\r\n        KEY_LEFT_ARROW: 37,\r\n        KEY_UP_ARROW: 38,\r\n        KEY_RIGHT_ARROW: 39,\r\n        KEY_DOWN_ARROW: 40,\r\n        KEY_INSERT: 45,\r\n        KEY_DELETE: 46,\r\n        KEY_0: 48,\r\n        KEY_1: 49,\r\n        KEY_2: 50,\r\n        KEY_3: 51,\r\n        KEY_4: 52,\r\n        KEY_5: 53,\r\n        KEY_6: 54,\r\n        KEY_7: 55,\r\n        KEY_8: 56,\r\n        KEY_9: 57,\r\n        KEY_A: 65,\r\n        KEY_B: 66,\r\n        KEY_C: 67,\r\n        KEY_D: 68,\r\n        KEY_E: 69,\r\n        KEY_F: 70,\r\n        KEY_G: 71,\r\n        KEY_H: 72,\r\n        KEY_I: 73,\r\n        KEY_J: 74,\r\n        KEY_K: 75,\r\n        KEY_L: 76,\r\n        KEY_M: 77,\r\n        KEY_N: 78,\r\n        KEY_O: 79,\r\n        KEY_P: 80,\r\n        KEY_Q: 81,\r\n        KEY_R: 82,\r\n        KEY_S: 83,\r\n        KEY_T: 84,\r\n        KEY_U: 85,\r\n        KEY_V: 86,\r\n        KEY_W: 87,\r\n        KEY_X: 88,\r\n        KEY_Y: 89,\r\n        KEY_Z: 90,\r\n        KEY_LEFT_WINDOW_KEY: 91,\r\n        KEY_RIGHT_WINDOW_KEY: 92,\r\n        KEY_SELECT_KEY: 93,\r\n        KEY_NUMPAD_0: 96,\r\n        KEY_NUMPAD_1: 97,\r\n        KEY_NUMPAD_2: 98,\r\n        KEY_NUMPAD_3: 99,\r\n        KEY_NUMPAD_4: 100,\r\n        KEY_NUMPAD_5: 101,\r\n        KEY_NUMPAD_6: 102,\r\n        KEY_NUMPAD_7: 103,\r\n        KEY_NUMPAD_8: 104,\r\n        KEY_NUMPAD_9: 105,\r\n        KEY_MULTIPLY: 106,\r\n        KEY_ADD: 107,\r\n        KEY_SUBTRACT: 109,\r\n        KEY_DECIMAL_POINT: 110,\r\n        KEY_DIVIDE: 111,\r\n        KEY_F1: 112,\r\n        KEY_F2: 113,\r\n        KEY_F3: 114,\r\n        KEY_F4: 115,\r\n        KEY_F5: 116,\r\n        KEY_F6: 117,\r\n        KEY_F7: 118,\r\n        KEY_F8: 119,\r\n        KEY_F9: 120,\r\n        KEY_F10: 121,\r\n        KEY_F11: 122,\r\n        KEY_F12: 123,\r\n        KEY_NUM_LOCK: 144,\r\n        KEY_SCROLL_LOCK: 145,\r\n        KEY_SEMI_COLON: 186,\r\n        KEY_EQUAL_SIGN: 187,\r\n        KEY_COMMA: 188,\r\n        KEY_DASH: 189,\r\n        KEY_PERIOD: 190,\r\n        KEY_FORWARD_SLASH: 191,\r\n        KEY_GRAVE_ACCENT: 192,\r\n        KEY_OPEN_BRACKET: 219,\r\n        KEY_BACK_SLASH: 220,\r\n        KEY_CLOSE_BRACKET: 221,\r\n        KEY_SINGLE_QUOTE: 222,\r\n        KEY_LEFT_COMMAND: 224,\r\n        KEY_RIGHT_COMMAND: 224\r\n    };\r\n}\r\n","export default {\r\n    KEY_MOUSE_LEFT: 1,\r\n    KEY_MOUSE_MIDDLE: 2,\r\n    KEY_MOUSE_RIGHT: 3,\r\n\r\n    SCROLL_MOUSE_UP: 4,\r\n    SCROLL_MOUSE_DOWN: 5,\r\n\r\n    KEY_BACKSPACE: 8,\r\n    KEY_TAB: 9,\r\n    KEY_ENTER: 13,\r\n    KEY_SHIFT: 16,\r\n    KEY_CTRL: 17,\r\n    KEY_ALT: 18,\r\n    KEY_PAUSE: 19,\r\n    KEY_BREAK: 19,\r\n    KEY_CAPS_LOCK: 20,\r\n    KEY_ESCAPE: 27,\r\n    KEY_SPACE_BAR: 32,\r\n    KEY_PAGE_UP: 33,\r\n    KEY_PAGE_DOWN: 34,\r\n    KEY_END: 35,\r\n    KEY_HOME: 36,\r\n    KEY_LEFT_ARROW: 37,\r\n    KEY_UP_ARROW: 38,\r\n    KEY_RIGHT_ARROW: 39,\r\n    KEY_DOWN_ARROW: 40,\r\n    KEY_INSERT: 45,\r\n    KEY_DELETE: 46,\r\n    KEY_0: 48,\r\n    KEY_1: 49,\r\n    KEY_2: 50,\r\n    KEY_3: 51,\r\n    KEY_4: 52,\r\n    KEY_5: 53,\r\n    KEY_6: 54,\r\n    KEY_7: 55,\r\n    KEY_8: 56,\r\n    KEY_9: 57,\r\n    KEY_A: 65,\r\n    KEY_B: 66,\r\n    KEY_C: 67,\r\n    KEY_D: 68,\r\n    KEY_E: 69,\r\n    KEY_F: 70,\r\n    KEY_G: 71,\r\n    KEY_H: 72,\r\n    KEY_I: 73,\r\n    KEY_J: 74,\r\n    KEY_K: 75,\r\n    KEY_L: 76,\r\n    KEY_M: 77,\r\n    KEY_N: 78,\r\n    KEY_O: 79,\r\n    KEY_P: 80,\r\n    KEY_Q: 81,\r\n    KEY_R: 82,\r\n    KEY_S: 83,\r\n    KEY_T: 84,\r\n    KEY_U: 85,\r\n    KEY_V: 86,\r\n    KEY_W: 87,\r\n    KEY_X: 88,\r\n    KEY_Y: 89,\r\n    KEY_Z: 90,\r\n    KEY_LEFT_WINDOW_KEY: 91,\r\n    KEY_RIGHT_WINDOW_KEY: 92,\r\n    KEY_SELECT_KEY: 93,\r\n    KEY_NUMPAD_0: 96,\r\n    KEY_NUMPAD_1: 97,\r\n    KEY_NUMPAD_2: 98,\r\n    KEY_NUMPAD_3: 99,\r\n    KEY_NUMPAD_4: 100,\r\n    KEY_NUMPAD_5: 101,\r\n    KEY_NUMPAD_6: 102,\r\n    KEY_NUMPAD_7: 103,\r\n    KEY_NUMPAD_8: 104,\r\n    KEY_NUMPAD_9: 105,\r\n    KEY_MULTIPLY: 106,\r\n    KEY_ADD: 107,\r\n    KEY_SUBTRACT: 109,\r\n    KEY_DECIMAL_POINT: 110,\r\n    KEY_DIVIDE: 111,\r\n    KEY_F1: 112,\r\n    KEY_F2: 113,\r\n    KEY_F3: 114,\r\n    KEY_F4: 115,\r\n    KEY_F5: 116,\r\n    KEY_F6: 117,\r\n    KEY_F7: 118,\r\n    KEY_F8: 119,\r\n    KEY_F9: 120,\r\n    KEY_F10: 121,\r\n    KEY_F11: 122,\r\n    KEY_F12: 123,\r\n    KEY_NUM_LOCK: 144,\r\n    KEY_SCROLL_LOCK: 145,\r\n    KEY_SEMI_COLON: 186,\r\n    KEY_EQUAL_SIGN: 187,\r\n    KEY_COMMA: 188,\r\n    KEY_DASH: 189,\r\n    KEY_PERIOD: 190,\r\n    KEY_FORWARD_SLASH: 191,\r\n    KEY_GRAVE_ACCENT: 192,\r\n    KEY_OPEN_BRACKET: 219,\r\n    KEY_BACK_SLASH: 220,\r\n    KEY_CLOSE_BRACKET: 221,\r\n    KEY_SINGLE_QUOTE: 222,\r\n    KEY_LEFT_COMMAND: 224,\r\n    KEY_RIGHT_COMMAND: 224,\r\n\r\n    //fix mouse with extra buttons\r\n    KEY_MOUSE_3: 403,\r\n    KEY_MOUSE_4: 404,\r\n    KEY_MOUSE_5: 405,\r\n    KEY_MOUSE_6: 406,\r\n    KEY_MOUSE_7: 407,\r\n    KEY_MOUSE_8: 408,\r\n    KEY_MOUSE_9: 409,\r\n    KEY_MOUSE_10: 410\r\n};\r\n","import Exception from \"exceptions/Exception\";\r\n\r\n/**\r\n * UnexpectedValueException\r\n * Create custom exception with message\r\n *\r\n * @class UnexpectedValueException\r\n * @exports module:exceptions/UnexpectedValueException\r\n *\r\n * @constructor\r\n * @extends Exception\r\n * @param {string} message\r\n * @property {string} message\r\n */\r\nexport default class UnexpectedValueException extends Exception {\r\n    constructor(message) {\r\n        super(message)\r\n    }\r\n\r\n    /**\r\n     * Convert exception to String\r\n     * @returns {string}\r\n     */\r\n    toString = function () {\r\n        return this.message;\r\n    }\r\n}\r\n","import Exception from \"exceptions/Exception\";\r\n\r\n/**\r\n * RuntimeException\r\n * Create custom exception with message\r\n *\r\n * @class RuntimeException\r\n * @exports module:exceptions/RuntimeException\r\n *\r\n * @constructor\r\n * @extends Exception\r\n * @param {string} message\r\n * @property {string} message\r\n */\r\nexport default class RuntimeException extends Exception {\r\n    constructor(message) {\r\n        super(message)\r\n    }\r\n\r\n    /**\r\n     * Convert exception to String\r\n     * @returns {string}\r\n     */\r\n    toString = function () {\r\n        return this.message;\r\n    }\r\n}\r\n","import Exception from \"exceptions/Exception\";\r\n\r\n/**\r\n * RangeException\r\n * Create custom exception with message\r\n *\r\n * @class RangeException\r\n * @exports module:exceptions/RangeException\r\n *\r\n * @constructor\r\n * @extends Exception\r\n * @param {string} message\r\n * @property {string} message\r\n */\r\nexport default class RangeException extends Exception {\r\n    constructor(message) {\r\n        super(message)\r\n    }\r\n\r\n    /**\r\n     * Convert exception to String\r\n     * @returns {string}\r\n     */\r\n    toString = function () {\r\n        return this.message;\r\n    }\r\n}\r\n","import Exception from \"exceptions/Exception\";\r\n\r\n/**\r\n * OutOfRangeException\r\n * Create custom exception with message\r\n *\r\n * @class OutOfRangeException\r\n * @exports module:exceptions/OutOfRangeException\r\n *\r\n * @constructor\r\n * @extends Exception\r\n * @param {string} message\r\n * @property {string} message\r\n */\r\nexport default class OutOfRangeException extends Exception {\r\n    constructor(message) {\r\n        super(message)\r\n    }\r\n\r\n    /**\r\n     * Convert exception to String\r\n     * @returns {string}\r\n     */\r\n    toString = function () {\r\n        return this.message;\r\n    }\r\n}\r\n","import Exception from \"exceptions/Exception\";\r\n\r\n/**\r\n * OutOfBoundsException\r\n * Create custom exception with message\r\n *\r\n * @class OutOfBoundsException\r\n * @exports module:exceptions/OutOfBoundsException\r\n *\r\n * @constructor\r\n * @extends Exception\r\n * @param {string} message\r\n * @property {string} message\r\n */\r\nexport default class OutOfBoundsException extends Exception {\r\n    constructor(message) {\r\n        super(message)\r\n    }\r\n\r\n    /**\r\n     * Convert exception to String\r\n     * @returns {string}\r\n     */\r\n    toString = function () {\r\n        return this.message;\r\n    }\r\n}\r\n","import Exception from \"exceptions/Exception\";\r\n\r\n/**\r\n * LogicException\r\n * Create custom exception with message\r\n *\r\n * @class LogicException\r\n * @exports module:exceptions/LogicException\r\n *\r\n * @constructor\r\n * @extends Exception\r\n * @param {string} message\r\n * @property {string} message\r\n */\r\nexport default class LogicException extends Exception {\r\n    constructor(message) {\r\n        super(message)\r\n    }\r\n\r\n    /**\r\n     * Convert exception to String\r\n     * @returns {string}\r\n     */\r\n    toString = function () {\r\n        return this.message;\r\n    }\r\n}\r\n","import Exception from \"exceptions/Exception\";\r\n\r\n/**\r\n * LengthException\r\n * Create custom exception with message\r\n *\r\n * @class LengthException\r\n * @exports module:exceptions/LengthException\r\n *\r\n * @constructor\r\n * @extends Exception\r\n * @param {string} message\r\n * @property {string} message\r\n */\r\nexport default class LengthException extends Exception {\r\n    constructor(message) {\r\n        super(message)\r\n    }\r\n\r\n    /**\r\n     * Convert exception to String\r\n     * @returns {string}\r\n     */\r\n    toString = function () {\r\n        return this.message;\r\n    }\r\n}\r\n","/**\r\n * Default Exception\r\n * Create custom exception with message\r\n *\r\n * @class Exception\r\n * @exports module:exceptions/Exception\r\n *\r\n * @constructor\r\n * @extends Error\r\n * @param {string} message\r\n * @property {string} message\r\n */\r\nexport default class Exception extends Error {\r\n    constructor(message) {\r\n        super(message);\r\n        this.message = message;\r\n\r\n        /**\r\n         * Convert exception to String\r\n         * @returns {string}\r\n         */\r\n        this.toString = function () {\r\n            return this.message;\r\n        }\r\n    }\r\n}\r\n","import Exception from \"exceptions/Exception\";\r\n\r\n/**\r\n * BadMethodCallException\r\n * Create custom exception with message\r\n *\r\n * @class BadMethodCallException\r\n * @exports module:exceptions/BadMethodCallException\r\n *\r\n * @constructor\r\n * @extends Exception\r\n * @param {string} message\r\n * @property {string} message\r\n */\r\nexport default class BadMethodCallException extends Exception {\r\n    constructor(message) {\r\n        super(message)\r\n    }\r\n\r\n    /**\r\n     * Convert exception to String\r\n     * @returns {string}\r\n     */\r\n    toString = function () {\r\n        return this.message;\r\n    }\r\n}\r\n","import Exception from \"exceptions/Exception\";\r\n\r\n/**\r\n * BadFunctionCallException\r\n * Create custom exception with message\r\n *\r\n * @class BadFunctionCallException\r\n * @exports module:exceptions/BadFunctionCallException\r\n *\r\n * @constructor\r\n * @extends Exception\r\n * @param {string} message\r\n * @property {string} message\r\n */\r\nexport default class BadFunctionCallException extends Exception {\r\n    constructor(message) {\r\n        super(message)\r\n    }\r\n\r\n    /**\r\n     * Convert exception to String\r\n     * @returns {string}\r\n     */\r\n    toString = function () {\r\n        return this.message;\r\n    }\r\n}\r\n","import ArrayMap from \"utils/ArrayMap\";\r\nimport CameraNode from \"nodes/CameraNode\";\r\nimport Vector2d from \"utils/Vector2d\";\r\n\r\n/**\r\n * @param {{x: number, y: number, offsetX: number, offsetY: number}} screen\r\n * @param {{offset: {x: number, y: number}, size: {x: number, y: number}, scale: number, angle: number}} viewport\r\n * @returns {{offset: {x: number, y: number}, size: {x: number, y: number}, scale: number, angle: number}}\r\n */\r\nvar calculateScale = function (screen, viewport) {\r\n    var data = {\r\n        offset: {x: 0, y: 0},\r\n        size: {x: 0, y: 0},\r\n        scale: 1.0,\r\n        angle: viewport.angle\r\n    };\r\n\r\n    data.offset.x = screen.offsetX + viewport.offset.x;\r\n    data.offset.y = screen.offsetY + viewport.offset.y;\r\n\r\n    data.size.x = (screen.x < viewport.size.x) ? screen.x : viewport.size.x;\r\n    data.size.y = (screen.y < viewport.size.y) ? screen.y : viewport.size.y;\r\n\r\n    data.scale = viewport.scale * (((screen.x / viewport.size.x) + (screen.y / viewport.size.y)) / 2);\r\n    return data;\r\n};\r\n\r\n/**\r\n * @class ViewportManager\r\n * @exports module:core/ViewportManager\r\n *\r\n * @constructor\r\n *\r\n * @property {ArrayMap.<CameraNode>|CameraNode[]} cameras\r\n * @property {string} camera\r\n * @property {{x: number, y: number, offsetX: number, offsetY: number}} screen\r\n * @property {boolean} init\r\n * @property {{offset: {x: number, y: number}, size: {x: number, y: number}, scale: number, angle: number}} data\r\n */\r\nexport default class ViewportManager {\r\n    constructor() {\r\n        /** @type ArrayMap.<CameraNode>|CameraNode[] */\r\n        this.cameras = new ArrayMap();\r\n\r\n        /** @type string */\r\n        this.camera = 'No active cameras';\r\n\r\n        /** @type {{x: number, y: number, offsetX: number, offsetY: number}} */\r\n        this.screen = {\r\n            x: 0,\r\n            y: 0,\r\n            offsetX: 0,\r\n            offsetY: 0\r\n        };\r\n\r\n        this.init = false;\r\n\r\n        this.data = {\r\n            offset: {x: 0.0, y: 0.0},\r\n            size: {x: 0.0, y: 0.0},\r\n            scale: 1.0,\r\n            angle: 0.0\r\n        };\r\n    }\r\n\r\n    /**\r\n     * @param {{x: number|undefined, y: number|undefined}|Array<number>} data\r\n     * @returns {ViewportManager}\r\n     */\r\n    setScreen(data) {\r\n        if (typeof data == 'object') {\r\n            if (data instanceof Array && data.length == 2) {\r\n                this.screen = {\r\n                    x: data[0],\r\n                    y: data[1],\r\n                    offsetX: this.screen.offsetX,\r\n                    offsetY: this.screen.offsetY\r\n                };\r\n                return this;\r\n            }\r\n            if (data.x !== undefined && data.y !== undefined) {\r\n                this.screen = {\r\n                    x: data.x,\r\n                    y: data.y,\r\n                    offsetX: this.screen.offsetX,\r\n                    offsetY: this.screen.offsetY\r\n                };\r\n            }\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {{x: number|undefined, y: number|undefined}|Array<number>} data\r\n     * @returns {ViewportManager}\r\n     */\r\n    setOffset(data) {\r\n        if (typeof data == 'object') {\r\n            if (data instanceof Array && data.length == 2) {\r\n                this.screen = {\r\n                    x: this.screen.x,\r\n                    y: this.screen.y,\r\n                    offsetX: data[0],\r\n                    offsetY: data[1]\r\n                };\r\n                return this;\r\n            }\r\n            if (data.x !== undefined && data.y !== undefined) {\r\n                this.screen = {\r\n                    x: this.screen.x,\r\n                    y: this.screen.y,\r\n                    offsetX: data.x,\r\n                    offsetY: data.y\r\n                };\r\n            }\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {string} key\r\n     * @param {CameraNode} node\r\n     * @returns {ViewportManager}\r\n     */\r\n    addCamera(key, node) {\r\n        if (node instanceof CameraNode) {\r\n            this.cameras.add(key, node);\r\n            return this;\r\n        }\r\n        // throw new InvalidArgumentException('Unknown camera node type');\r\n    }\r\n\r\n    /**\r\n     * @param {string} key\r\n     * @returns {ViewportManager}\r\n     */\r\n    removeCamera(key) {\r\n        this.cameras.remove(key);\r\n        if (this.camera == key) {\r\n            this.camera = 'No active cameras';\r\n            this.data = {\r\n                offset: {x: 0.0, y: 0.0},\r\n                size: {x: 0.0, y: 0.0},\r\n                scale: 1.0,\r\n                angle: 0.0\r\n            }\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {string} key\r\n     * @returns {ViewportManager}\r\n     */\r\n    updateViewport(key) {\r\n        if (this.cameras[key] !== undefined && this.cameras[key] instanceof CameraNode) {\r\n            this.data = this.cameras[key].getCameraViewport(this.screen, calculateScale);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @deprecated Please use CameraNode\r\n     *\r\n     * @param {Vector2d|null} [offset]\r\n     * @param {Vector2d|null} [size]\r\n     * @returns {ViewportManager}\r\n     */\r\n    setViewport(offset, size) {\r\n        if (offset !== undefined && typeof offset == 'object') {\r\n            if (offset instanceof Vector2d) {\r\n                this.data.offset = offset.getVector();\r\n            }\r\n        }\r\n\r\n        if (size !== undefined && typeof size == 'object') {\r\n            if (size instanceof Vector2d) {\r\n                this.data.size = size.getVector();\r\n            }\r\n        }\r\n\r\n        this.data = calculateScale(this.screen, this.data);\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {{offset: {x: number, y: number}, size: {x: number, y: number}, scale: number, angle: number}} viewport\r\n     * @returns {ViewportManager}\r\n     */\r\n    setDefaultViewport(viewport) {\r\n        if (!this.init) {\r\n            this.data = viewport;\r\n            this.init = true;\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @returns {{offset: {x: number, y: number}, size: {x: number, y: number}, scale: number, angle: number}}\r\n     */\r\n    getViewport() {\r\n        return this.data;\r\n    }\r\n}\r\n","import ObjectUtil from \"utils/ObjectUtil\";\r\nimport Vector2d from \"utils/Vector2d\";\r\nimport FrameManager from \"core/FrameManager\";\r\nimport LayersManager from \"core/LayersManager\";\r\nimport ViewportManager from \"core/ViewportManager\";\r\nimport GameStatesManager from \"core/GameStatesManager\";\r\n\r\n/**\r\n * @class SceneManager\r\n * @exports module:core/SceneManager\r\n *\r\n * @param {EngineJ2D} j2d\r\n * @constructor\r\n *\r\n * @property {SceneManager.defaults} data\r\n *\r\n * @property {string} backgroundColor\r\n * @property {number} opacity\r\n * @property {boolean} visible\r\n * @property {number} zIndex\r\n * @property {{x:number, y:number}} viewport\r\n */\r\nexport default class SceneManager {\r\n    static defaults = {\r\n        width: 0,\r\n        height: 0,\r\n\r\n        originalWidth: 0,\r\n        originalHeight: 0,\r\n        originalMargin: 0,\r\n\r\n        visible: true,\r\n        position: 'absolute',\r\n        top: 0,\r\n        left: 0,\r\n        zIndex: 1000,\r\n        opacity: 1.0,\r\n        backgroundColor: false,\r\n\r\n        frameLimit: 60,\r\n\r\n        enableFullScreen: false,\r\n\r\n        viewport: {x: 0, y: 0}\r\n    };\r\n\r\n    constructor(j2d) {\r\n        this.setGameCallback = this.setGameCallback.bind(this);\r\n        this.start = this.start.bind(this);\r\n\r\n        /** @type EngineJ2D */\r\n        this.j2d = j2d;\r\n\r\n        /** @type {HTMLCanvasElement} */\r\n        this.canvas = null;\r\n\r\n        /** @type {CanvasRenderingContext2D} */\r\n        this.context = null;\r\n\r\n        /** @type {FrameManager} */\r\n        this.frameManager = FrameManager.Init();\r\n\r\n        /** @type {LayersManager} */\r\n        this.layersManager = new LayersManager();\r\n\r\n        /** @type {ViewportManager} */\r\n        this.viewportManager = new ViewportManager();\r\n\r\n        /** @type {GameStatesManager} */\r\n        this.gameStatesManager = new GameStatesManager({}, this.setGameCallback);\r\n\r\n        this.initLayers();\r\n    }\r\n\r\n    get backgroundColor() {\r\n        return this.data.backgroundColor;\r\n    }\r\n\r\n    set backgroundColor(value) {\r\n        this.data.backgroundColor = value;\r\n        this.context.fillStyle = value;\r\n        this.context.fillRect(0, 0, this.data.width, this.data.height);\r\n    }\r\n\r\n    get opacity() {\r\n        return this.data.opacity;\r\n    }\r\n\r\n    set opacity(value) {\r\n        this.data.opacity = value;\r\n        this.canvas.style.opacity = value;\r\n    }\r\n\r\n    get visible() {\r\n        return this.data.visible;\r\n    }\r\n\r\n    set visible(value) {\r\n        this.data.visible = !!value;\r\n        this.canvas.style.display = (!!value) ? 'block' : 'none';\r\n    }\r\n\r\n    get zIndex() {\r\n        return 1000 - this.data.zIndex;\r\n    }\r\n\r\n    set zIndex(value) {\r\n        this.data.zIndex = 1000 + value;\r\n        this.canvas.style.zIndex = 1000 + value;\r\n    }\r\n\r\n    get viewport() {\r\n        return this.data.viewport;\r\n    }\r\n\r\n    /**\r\n     * @param {BaseGameState} state\r\n     * @returns {Function}\r\n     */\r\n    patchGameStateRender(state) {\r\n        var sceneManager = this;\r\n        var constructor = state.constructor;\r\n        if (typeof constructor === 'function' && constructor.prototype.render === undefined) {\r\n            constructor.prototype.render = function (timestamp, data) {\r\n                sceneManager.clear().fillBackground().render(data);\r\n                return true;\r\n            };\r\n        }\r\n        return constructor;\r\n    };\r\n\r\n    /**\r\n     * @param {SceneManager.defaults|Object|undefined} options\r\n     * @returns {SceneManager}\r\n     */\r\n    init(options) {\r\n        this.data = ObjectUtil.extend(true, {}, SceneManager.defaults, options);\r\n\r\n        this.j2d.trigger('beforeInit');\r\n\r\n        this.data.originalWidth = this.data.width;\r\n        this.data.originalHeight = this.data.height;\r\n        this.data.originalMargin = getComputedStyle(this.j2d.element)['margin'];\r\n\r\n        this.j2d.element.style.width = this.data.width + 'px';\r\n        this.j2d.element.style.height = this.data.height + 'px';\r\n\r\n        this.initCanvas();\r\n\r\n        this.viewportManager.setScreen({\r\n            x: this.data.width,\r\n            y: this.data.height\r\n        }).setDefaultViewport({\r\n            offset: {\r\n                x: 0.0,\r\n                y: 0.0\r\n            },\r\n            size: {\r\n                x: this.data.width,\r\n                y: this.data.height\r\n            },\r\n            scale: 1.0,\r\n            angle: 0.0\r\n        });\r\n\r\n        this.j2d.trigger('afterInit');\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @returns {SceneManager}\r\n     */\r\n    initLayers() {\r\n        if (!this.layersManager.getLayer('scene')) {\r\n            this.layersManager.addLayer('scene', 0);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @returns {SceneManager}\r\n     */\r\n    initCanvas() {\r\n        if (document.querySelectorAll('.j2d[guid=\"' + this.j2d.data.id + '\"] canvas').length === 0) {\r\n            this.canvas = document.createElement('canvas');\r\n\r\n            this.canvas.width = this.data.width;\r\n            this.canvas.height = this.data.height;\r\n            this.canvas.style.zIndex = this.data.zIndex;\r\n            this.canvas.style.position = this.data.position;\r\n\r\n            this.canvas.style.left = this.data.left;\r\n            this.canvas.style.top = this.data.top;\r\n\r\n            if (this.j2d.data.webGL) {\r\n                //WebGL2D.enable(this.canvas);\r\n                this.context = this.canvas.getContext('WebGL-2d');\r\n            } else {\r\n                this.context = this.canvas.getContext('2d');\r\n            }\r\n\r\n            if (!this.j2d.data.smoothing) {\r\n                this.j2d.util.disableSmoothing(this.context);\r\n            }\r\n\r\n            this.context.shadowColor = 'rgba(0,0,0,0)';\r\n            if (this.data.backgroundColor) this.backgroundColor = this.data.backgroundColor;\r\n            if (this.data.opacity) this.opacity = this.data.opacity;\r\n            if (this.data.visible) this.visible = this.data.visible;\r\n            if (this.data.zIndex) this.zIndex = 1000 - this.data.zIndex;\r\n\r\n            this.j2d.element.appendChild(this.canvas);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {{x:number, y:number}|Vector2d} [pos]\r\n     * @param {{x:number, y:number}|Vector2d} [size]\r\n     * @returns {SceneManager}\r\n     */\r\n    clear(pos, size) {\r\n        if (pos !== undefined && size !== undefined) {\r\n            this.context.clearRect(pos.x - this.viewport.x, pos.y - this.viewport.y, size.x, size.y);\r\n        } else {\r\n            this.context.clearRect(0, 0, this.data.width, this.data.height);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {number} width\r\n     * @param {number} height\r\n     * @returns {SceneManager}\r\n     */\r\n    resize(width, height) {\r\n        this.canvas.width = this.data.width = width;\r\n        this.canvas.height = this.data.height = height;\r\n\r\n        if (this.data.backgroundColor) {\r\n            this.context.save();\r\n\r\n            this.clear();\r\n            this.backgroundColor = this.data.backgroundColor;\r\n\r\n            this.context.restore();\r\n        }\r\n        if (!this.j2d.data.smoothing) {\r\n            this.j2d.util.disableSmoothing(this.context);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * TODO:: refactor this\r\n     * @param {string} gameState\r\n     * @returns {SceneManager}\r\n     */\r\n    setGameCallback(gameState) {\r\n        var sceneManager = this;\r\n        sceneManager.data.gameState = gameState || 'init_j2d';\r\n        sceneManager.frameManager.stop(sceneManager.j2d.data.id);\r\n\r\n        var gameConstructor = sceneManager.patchGameStateRender(\r\n            sceneManager.gameStatesManager.getState(gameState)\r\n        );\r\n\r\n        var newGameState = new gameConstructor(sceneManager.gameStatesManager, {});\r\n        newGameState.init({\r\n            callback: function () {\r\n                newGameState.load({\r\n                    callback: function () {\r\n                        sceneManager.frameManager.start(sceneManager.j2d.data.id, newGameState, {\r\n                            j2d: sceneManager.j2d,\r\n                            frameLimit: FrameHandler.frameLimit\r\n                        });\r\n\r\n                        sceneManager.j2d.trigger('changedGameState');\r\n\r\n                        // TODO:: async unload?\r\n                        sceneManager.gameStatesManager.getPreviousState().unload();\r\n                    }\r\n                });\r\n            }\r\n        });\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {Function|callback} callback\r\n     * @param {*} data\r\n     * @returns {SceneManager}\r\n     */\r\n    async(callback, data) {\r\n        setTimeout(callback.call(callback, data), 0);\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @returns {SceneManager}\r\n     */\r\n    start() {\r\n        var sceneManager = this;\r\n        if (sceneManager.j2d.data.io) {\r\n            sceneManager.j2d.data.io.init();\r\n        }\r\n        sceneManager.j2d.trigger('beforeStart');\r\n\r\n        sceneManager.frameManager.stop(sceneManager.j2d.data.id);\r\n\r\n        var gameConstructor = sceneManager.patchGameStateRender(\r\n            sceneManager.gameStatesManager.getCurrent()\r\n        );\r\n\r\n        var newGameState = new gameConstructor(sceneManager.gameStatesManager, {});\r\n        newGameState.init({\r\n            callback: function () {\r\n                newGameState.load({\r\n                    callback: function () {\r\n                        sceneManager.frameManager.start(sceneManager.j2d.data.id, newGameState, {\r\n                            j2d: sceneManager.j2d,\r\n                            frameLimit: FrameHandler.frameLimit\r\n                        });\r\n\r\n                        sceneManager.j2d.trigger('afterStart');\r\n                    }\r\n                });\r\n            }\r\n        });\r\n\r\n        return sceneManager;\r\n    }\r\n\r\n    /**\r\n     * @returns {SceneManager}\r\n     */\r\n    stop() {\r\n        this.frameManager.stop(this.j2d.data.id);\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {boolean} [fullscreen]\r\n     * @returns {SceneManager}\r\n     */\r\n    fullScreen(fullscreen) {\r\n        var element = document.getElementById(this.j2d.element.attr('id'));\r\n\r\n        if (undefined === element.requestFullscreen) {\r\n            //noinspection JSUnresolvedVariable\r\n            element.requestFullscreen = element.webkitRequestFullscreen\r\n                || element.webkitRequestFullScreen\r\n                || element.mozRequestFullScreen\r\n                || element.msRequestFullscreen;\r\n        }\r\n\r\n        if (undefined === document.exitFullscreen) {\r\n            //noinspection JSUnresolvedVariable\r\n            document.exitFullscreen = document.webkitExitFullscreen\r\n                || document.webkitCancelFullScreen\r\n                || document.mozCancelFullScreen\r\n                || document.msExitFullscreen;\r\n        }\r\n        if (fullscreen) {\r\n            element.requestFullscreen();\r\n        } else {\r\n            document.exitFullscreen();\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {boolean} [fullscreen]\r\n     * @returns {SceneManager}\r\n     */\r\n    resizeToFullPage(fullscreen) {\r\n        var j2d = this.j2d;\r\n        var sceneManager = this;\r\n\r\n        if (fullscreen) {\r\n            sceneManager.data.originalWidth = sceneManager.data.width;\r\n            sceneManager.data.originalHeight = sceneManager.data.height;\r\n\r\n            sceneManager.resize(j2d.device.width, j2d.device.height);\r\n            sceneManager.data.enableFullscreen = true;\r\n\r\n            j2d.element.style.width = j2d.device.width + 'px';\r\n            j2d.element.style.height = j2d.device.height + 'px';\r\n            j2d.element.style.margin = 0;\r\n\r\n            sceneManager.viewportManager.setScreen({\r\n                x: j2d.device.width,\r\n                y: j2d.device.height\r\n            }).setOffset({\r\n                x: -(j2d.device.width - sceneManager.data.originalWidth) / 2,\r\n                y: -(j2d.device.height - sceneManager.data.originalHeight) / 2\r\n            });\r\n        } else {\r\n            sceneManager.resize(sceneManager.data.originalWidth, sceneManager.data.originalHeight);\r\n            sceneManager.data.enableFullscreen = false;\r\n\r\n            j2d.element.style.width = sceneManager.data.originalWidth + 'px';\r\n            j2d.element.style.height = sceneManager.data.originalHeight + 'px';\r\n            j2d.element.style.margin = sceneManager.data.originalMargin;\r\n\r\n            sceneManager.viewportManager.setScreen({\r\n                x: sceneManager.data.originalWidth,\r\n                y: sceneManager.data.originalHeight\r\n            }).setOffset({\r\n                x: 0,\r\n                y: 0\r\n            });\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {EngineJ2D} j2d\r\n     * @param {{fullscreen: boolean}} data\r\n     * @returns {SceneManager}\r\n     */\r\n    toggleFullScreen(j2d, data) {\r\n        if (data === undefined) {\r\n            data = {fullscreen: false};\r\n        }\r\n        if (!j2d.scene.enableFullscreen || data.fullscreen) {\r\n            j2d.scene.fullScreen(true);\r\n        } else {\r\n            j2d.scene.fullScreen(false);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @returns {CollectionNode|null}\r\n     */\r\n    getSceneLayer() {\r\n        return this.layersManager.getLayer('scene');\r\n    }\r\n\r\n    /**\r\n     * @returns {SceneManager}\r\n     */\r\n    fillBackground() {\r\n        if (this.data.backgroundColor) {\r\n            this.backgroundColor = this.data.backgroundColor;\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {Object} data\r\n     * @returns {SceneManager}\r\n     */\r\n    render(data) {\r\n        var sceneManager = this;\r\n        sceneManager.layersManager.layers.forEach(function (value, index) {\r\n            sceneManager.layersManager.layers[index].render(\r\n                sceneManager.context,\r\n                sceneManager.viewportManager.getViewport(),\r\n                sceneManager.layersManager.globalCollection,\r\n                data || {}\r\n            );\r\n        });\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {BaseNode} node\r\n     * @param {string} [key]\r\n     * @returns {SceneManager}\r\n     */\r\n    add(node, key) {\r\n        if (this.layersManager.globalCollection.has('scene')) {\r\n            this.layersManager.globalCollection.get('scene').add(node, key);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {BaseNode} [node]\r\n     * @param {string} [key]\r\n     * @returns {SceneManager}\r\n     */\r\n    remove(node, key) {\r\n        if (this.layersManager.globalCollection.has('scene')) {\r\n            this.layersManager.globalCollection.get('scene').remove(node, key);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {CameraNode} node\r\n     * @returns {SceneManager}\r\n     */\r\n    registerCamera(node) {\r\n        this.viewportManager.addCamera(node.data.id, node);\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Hack to mode without Cameras\r\n     * @returns {SceneManager}\r\n     */\r\n    _updateNoCamerasViewport(scene) {\r\n        // This hack use deprecated method, i known.\r\n        scene.viewportManager.setViewport(\r\n            new Vector2d(0, 0),\r\n            new Vector2d(scene.data.width, scene.data.height)\r\n        );\r\n\r\n        return scene;\r\n    }\r\n\r\n    /**\r\n     * @param {CameraNode} [node]\r\n     * @returns {SceneManager}\r\n     */\r\n    updateViewport(node) {\r\n        if (node === undefined) return this._updateNoCamerasViewport(this);\r\n        this.viewportManager.updateViewport(node.data.id);\r\n        return this;\r\n    }\r\n\r\n\r\n    // static util = {\r\n    //     /**\r\n    //      * @param {CanvasRenderingContext2D} context\r\n    //      */\r\n    //     disableSmoothing: (context) => {\r\n    //         let chrome = window.navigator.userAgent.match(/Chrom(e|ium)\\/([0-9]+)\\./);\r\n    //         let version = chrome ? parseInt(chrome[2], 10) : false;\r\n    //\r\n    //         context['imageSmoothingEnabled'] = false;\r\n    //         context['mozImageSmoothingEnabled'] = false;\r\n    //         context['oImageSmoothingEnabled'] = false;\r\n    //         if (version && version <= 29) {\r\n    //             context['webkitImageSmoothingEnabled'] = false;\r\n    //         }\r\n    //         context['msImageSmoothingEnabled'] = false;\r\n    //     }\r\n    // };\r\n\r\n    // /** Utils **/\r\n    //util = EngineJ2D.util;\r\n}\r\n","import CollectionNode from \"nodes/CollectionNode\";\r\nimport UUID from \"utils/UUID\";\r\n\r\n/**\r\n * @class LayersManager\r\n * @exports module:core/LayersManager\r\n *\r\n * @constructor\r\n */\r\nexport default class LayersManager {\r\n    constructor() {\r\n        /** @type CollectionNode */\r\n        this.globalCollection = new CollectionNode({id: 'GlobalLayer'});\r\n\r\n        /** @type Array.<CollectionNode>|CollectionNode[] */\r\n        this.layers = [];\r\n\r\n        /** @type number */\r\n        this.index = 1000;\r\n    }\r\n\r\n    /**\r\n     * @param {string} name\r\n     * @param {number} [zIndex]\r\n     * @param {CollectionNode|undefined} [node]\r\n     * @returns {LayersManager}\r\n     */\r\n    addLayer(name, zIndex, node) {\r\n        name = name || UUID.generate();\r\n\r\n        if (node === undefined || node instanceof CollectionNode) {\r\n            if (zIndex === undefined) {\r\n                zIndex = this.index;\r\n                this.index++;\r\n            } else {\r\n                zIndex += 1000;\r\n            }\r\n\r\n            node = node || new CollectionNode({id: name, zIndex: zIndex});\r\n\r\n            this.globalCollection.add(node, name);\r\n            this.layers[zIndex] = node;\r\n\r\n            return this;\r\n        }\r\n        // throw new InvalidArgumentException('Unknown node type to add as layers');\r\n    }\r\n\r\n    /**\r\n     * @param {string} name\r\n     * @returns {LayersManager}\r\n     */\r\n    removeLayer(name) {\r\n        delete this.layers[this.globalCollection.get(name).zIndex];\r\n        this.globalCollection.remove(null, name);\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {string} name\r\n     * @returns {CollectionNode|null}\r\n     */\r\n    getLayer(name) {\r\n        if (this.globalCollection.has(name)) {\r\n            return this.globalCollection.get(name);\r\n        }\r\n        return null;\r\n    }\r\n\r\n    /**\r\n     * @param {string} name\r\n     * @param {number} zIndex\r\n     * @returns {LayersManager}\r\n     */\r\n    setZIndex(name, zIndex) {\r\n        if (this.globalCollection.has(name)) {\r\n            delete this.layers[this.globalCollection.get(name).zIndex];\r\n            this.globalCollection.get(name).zIndex = zIndex;\r\n            this.layers[zIndex] = this.globalCollection.get(name);\r\n        }\r\n        return this;\r\n    }\r\n}\r\n","import ArrayMap from \"utils/ArrayMap\";\r\nimport ObjectUtil from \"utils/ObjectUtil\";\r\nimport DefaultGameState from \"states/DefaultGameState\";\r\nimport BaseGameState from \"states/BaseGameState\";\r\n\r\n/**\r\n * Game states Manager\r\n *\r\n * @class GameStatesManager\r\n * @abstract\r\n * @constructor\r\n *\r\n * @param {GameStatesManager.defaults|Object} data\r\n * @param {function} sceneCallback\r\n * @property {GameStatesManager.defaults|Object} data\r\n * @property {number} state\r\n */\r\nexport default class GameStatesManager {\r\n    /**\r\n     * @type {{previousState: null, currentState: number, states: ArrayMap}}\r\n     */\r\n    static defaults = {\r\n        previousState: null,\r\n        currentState: 0,\r\n        states: new ArrayMap()\r\n    };\r\n\r\n    constructor(data, sceneCallback) {\r\n        this.data = ObjectUtil.extend(true, {}, GameStatesManager.defaults, data);\r\n        this.add(new DefaultGameState());\r\n        this.sceneCallback = sceneCallback;\r\n    }\r\n\r\n    get state() {\r\n        return this.data.currentState;\r\n    }\r\n\r\n    set state(value) {\r\n        this.data.currentState = value;\r\n    }\r\n\r\n    /**\r\n     * @param {string} [id]\r\n     * @returns {BaseGameState|null}\r\n     */\r\n    getState(id) {\r\n        if (id === undefined) return this.getCurrent();\r\n        if (this.data.states.contains(id)) {\r\n            return this.data.states[id];\r\n        }\r\n        return null\r\n    }\r\n\r\n    getPreviousState() {\r\n        return this.data.states.get(this.data.states[this.data.previousState]);\r\n    }\r\n\r\n    getNextState() {\r\n        if (this.data.states[this.state + 1] !== undefined) {\r\n            return this.data.states.get(this.data.states[this.state + 1]);\r\n        }\r\n        return null;\r\n    }\r\n\r\n    getCurrent() {\r\n        return this.data.states.get(this.data.states[this.data.currentState]);\r\n    }\r\n\r\n    /**\r\n     * @param {string} id\r\n     */\r\n    setState(id) {\r\n        if (this.data.states.contains(id)) {\r\n            this.data.previousState = this.data.currentState;\r\n            this.data.currentState = this.data.states.indexOf(id);\r\n            this.sceneCallback(id);\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    setNextState() {\r\n        if (this.data.states[this.state + 1] !== undefined) {\r\n            this.data.previousState = this.data.currentState;\r\n            this.data.currentState = this.state + 1;\r\n            this.sceneCallback(this.data.states[this.state]);\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    setPreviousState() {\r\n        if (this.data.states[this.data.previousState] !== undefined) {\r\n            var state = this.data.previousState;\r\n            this.data.previousState = this.data.currentState;\r\n            this.data.currentState = state;\r\n            this.sceneCallback(this.data.states[state]);\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {BaseGameState} state\r\n     * @param {string} [id]\r\n     */\r\n    add(state, id) {\r\n        if (id === undefined) id = state.data.id;\r\n        if (!this.data.states.contains(id) && state instanceof BaseGameState) {\r\n            this.data.states.add(id, state);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {string} id\r\n     */\r\n    remove(id) {\r\n        if (this.data.states.contains(id)) {\r\n            this.data.states.remove(id);\r\n        }\r\n        return this;\r\n    }\r\n}\r\n","import PrototypeInterface from \"api/PrototypeInterface\";\r\nimport Device from \"utils/Device\";\r\n\r\n/**\r\n * PrototypeObject\r\n * @constructor\r\n */\r\nexport default class PrototypeObject {\r\n    static interfaces = [];\r\n\r\n    constructor() {\r\n        if (this.constructor.interfaces === undefined) this.constructor.interfaces = [];\r\n\r\n        let scope = [];\r\n\r\n        // Disable fault exception IE < 11\r\n        if (Device.browser === 'MSIE' && Device.version < 11) {\r\n            this.__proto__ = Object.assign({}, this.prototype);\r\n        }\r\n\r\n        /**\r\n         TODO:: Object.getPrototypeOf(obj),\r\n         @link https://developer.mozilla.org/ru/docs/Web/JavaScript/Reference/Global_Objects/Object/getPrototypeOf\r\n         */\r\n        let implement = (object) => {\r\n            // Disable fault exception IE < 11\r\n            if (Device.browser === 'MSIE' && Device.version < 11) {\r\n                object.__proto__ = Object.assign({}, object.prototype || {});\r\n            }\r\n\r\n            if (object.__proto__.constructor.name === 'Object'\r\n                || object.__proto__.constructor === undefined\r\n                || object.__proto__.constructor.interfaces.length < 1\r\n            ) return;\r\n\r\n            for (let i = 0; i < object.__proto__.constructor.interfaces.length; i++) {\r\n                if (!(scope.indexOf(object.__proto__.constructor.interfaces[i].name) !== -1)) {\r\n                    scope.push(object.__proto__.constructor.interfaces[i].name);\r\n                    this.constructor.interfaces.push(object.__proto__.constructor.interfaces[i]);\r\n                }\r\n            }\r\n\r\n            implement(object.__proto__);\r\n        };\r\n\r\n        implement(this.__proto__);\r\n    }\r\n\r\n    instanceOf(interfaces) {\r\n        let i = 0;\r\n        if (typeof interfaces === 'object' && interfaces instanceof Array) {\r\n            for (i = 0; i < interfaces.length; i++) {\r\n                if (typeof interfaces[i] === 'function' && new (interfaces[i]) instanceof PrototypeInterface) {\r\n                    if (this.constructor.interfaces.indexOf(interfaces[i]) === -1) return false;\r\n                } else if (typeof interfaces[i] === 'function') {\r\n                    if (!(this instanceof interfaces[i])) return false;\r\n                } else throw new Error('Error. \"' + interfaces[i].constructor.name + '\" is not interface!');\r\n            }\r\n        } else if (typeof interfaces === 'function' && new (interfaces) instanceof PrototypeInterface) {\r\n            return this.constructor.interfaces.indexOf(interfaces) !== -1;\r\n        } else if (typeof interfaces === 'function') {\r\n            if (!(this instanceof interfaces)) return false;\r\n        } else {\r\n            throw new Error('Error. \"' + interfaces.constructor.name + '\" is not interface!');\r\n        }\r\n        return true;\r\n    }\r\n\r\n    toString() {\r\n        return this.__proto__.constructor.name;\r\n    }\r\n}\r\n","/**\r\n * PrototypeInterface\r\n * @constructor\r\n */\r\nexport default class PrototypeInterface {\r\n    static interfaces = [PrototypeInterface];\r\n\r\n    instanceOf(interfaces) {\r\n        let i = 0, j = 0;\r\n        if (typeof interfaces === 'object' && interfaces instanceof Array) {\r\n            for (i = 0; i < interfaces.length; i++) {\r\n                if (typeof interfaces[i] === 'function' && new (interfaces[i]) instanceof PrototypeInterface) {\r\n                    for (j = 0; j < this.constructor.interfaces.length; j++) {\r\n                        if (!(new (this.constructor.interfaces[j]) instanceof interfaces[i])) return false;\r\n                    }\r\n                } else throw new Error('Error. \"' + interfaces[i].constructor.name + '\" is not interface!');\r\n            }\r\n        } else if (typeof interfaces === 'function' && new (interfaces) instanceof PrototypeInterface) {\r\n            for (i = 0; i < this.constructor.interfaces.length; i++) {\r\n                if (!(new (this.constructor.interfaces[i]) instanceof interfaces)) return false;\r\n            }\r\n        } else {\r\n            throw new Error('Error. \"' + interfaces.constructor.name + '\" is not interface!');\r\n        }\r\n        return true;\r\n    }\r\n}\r\n","import PrototypeObject from \"api/PrototypeObject\";\r\nimport IHandler from \"api/interfaces/IHandler\";\r\n\r\n/**\r\n * Handler\r\n * @constructor\r\n */\r\nexport default class Handler extends PrototypeObject {\r\n    static interfaces = [IHandler];\r\n\r\n    _isEnabled = false;\r\n\r\n    events = null;\r\n\r\n    constructor() {\r\n        super();\r\n    }\r\n\r\n    init(eventHandler) {\r\n        if (eventHandler !== undefined) {\r\n            this.events = eventHandler;\r\n        }\r\n        return this;\r\n    };\r\n\r\n    get isEnabled() {\r\n        return this._isEnabled;\r\n    }\r\n\r\n    enable() {\r\n        this._isEnabled = true;\r\n        return this;\r\n    };\r\n\r\n    disable() {\r\n        this._isEnabled = false;\r\n        return this;\r\n    };\r\n\r\n    toggle(status) {\r\n        if (status === undefined) status = !this.isEnabled;\r\n        if (status) {\r\n            this.enable();\r\n        } else {\r\n            this.disable();\r\n        }\r\n        return this;\r\n    };\r\n}\r\n","import Handler from \"api/Handler\";\r\nimport IEngineComponent from \"api/interfaces/IEngineComponent\";\r\n\r\n/**\r\n * EngineComponent\r\n * @constructor\r\n *\r\n * @interface IEngineComponent\r\n */\r\nexport default class EngineComponent extends Handler {\r\n    static interfaces = [IEngineComponent];\r\n\r\n    constructor() {\r\n        super();\r\n    }\r\n};\r\n\r\n","/**\r\n * Device\r\n * @constructor\r\n */\r\nexport default class Device {\r\n    input = undefined;\r\n\r\n    constructor(input) {\r\n        if (input !== undefined) this.input = input;\r\n    }\r\n\r\n    enable() {\r\n        return true;\r\n    };\r\n\r\n    disable() {\r\n        return true;\r\n    };\r\n\r\n    init(input) {\r\n        if (input !== undefined && this.input === undefined) this.input = input;\r\n        return false;\r\n    };\r\n\r\n    update() {\r\n        return true;\r\n    };\r\n\r\n    clear() {\r\n        return true;\r\n    };\r\n\r\n    toString() {\r\n        return function (device) {\r\n            return (device[0].toLowerCase() + device.slice(1))\r\n        }(this.constructor.DeviceName || this.constructor.name);\r\n    };\r\n};\r\n","import InvalidArgumentException from \"exceptions/InvalidArgumentException\";\r\n\r\n/**\r\n * @exports module:objects/Mutable\r\n */\r\nexport default class Mutable extends Object {\r\n    __$MutableOptions;\r\n\r\n    constructor(object, options) {\r\n        if (object !== undefined && typeof object !== 'object') {\r\n            throw new InvalidArgumentException('Attribute object type must be instance of Object.');\r\n        }\r\n\r\n        if (options === undefined) options = {};\r\n        if (object === undefined) object = {};\r\n\r\n        super(object);\r\n\r\n        this.__$MutableOptions = options;\r\n    }\r\n\r\n    extend(...args) {\r\n        Mutable.extend(true, typeof this === Array ? [] : {}, this, ...args);\r\n    }\r\n\r\n    static extend(...args) {\r\n        let deepness = false;\r\n        if (typeof args[0] === 'boolean') {\r\n            deepness = args[0];\r\n            args.splice(0, 1);\r\n        }\r\n\r\n        let out = args[0] || function () {\r\n                if (args[1] !== undefined && args[1] !== null && typeof args[1] === 'object') {\r\n                    return Object.create(args[1])\r\n                }\r\n                return {};\r\n            }();\r\n\r\n        for (let i = 1; i < args.length; i++) {\r\n            /** @type {Object} */\r\n            let object = args[i];\r\n\r\n            if (!object) continue;\r\n\r\n            for (let key in object) {\r\n                if (object.hasOwnProperty(key)) {\r\n                    if (typeof object[key] === 'object' && object[key] !== null) {\r\n                        out[key] = deepness ? Mutable.extend(deepness, out[key], object[key]) : object[key];\r\n                    } else {\r\n                        out[key] = object[key];\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        return out;\r\n    }\r\n}\r\n","import EngineComponent from \"api/EngineComponent\";\r\n\r\nexport default class ViewportHandler extends EngineComponent {\r\n    get viewport() {\r\n        return {x: 0, y: 0, z: 0}\r\n    }\r\n}\r\n","import EngineComponent from \"api/EngineComponent\";\r\nimport Layer from \"layers/Layer\";\r\nimport BaseNode from \"nodes/BaseNode\";\r\nimport Mutable from \"objects/Mutable\";\r\n\r\nexport default class LayersHandler extends EngineComponent {\r\n    /**\r\n     * @type {{}}\r\n     */\r\n    static defaults = {};\r\n\r\n    /**\r\n     * @type {LayersHandler.defaults|{}}\r\n     */\r\n    _data;\r\n\r\n    /** @type {Layer} */\r\n    _layers = new Layer('global');\r\n\r\n    constructor() {\r\n        super();\r\n        this.add(new Layer('main'));\r\n    }\r\n\r\n    init(eventHandler, options) {\r\n        super.init(eventHandler);\r\n        this._data = Mutable.extend(true, {}, LayersHandler.defaults, options);\r\n    }\r\n\r\n    get layers() {\r\n        return this._layers;\r\n    }\r\n\r\n    get(key) {\r\n        this._layers.get(key);\r\n    }\r\n\r\n    has(key) {\r\n        this._layers.has(key);\r\n    }\r\n\r\n    add(node, index) {\r\n        if (node.instanceOf(BaseNode)) {\r\n            this._layers.add(node, index);\r\n        }\r\n    }\r\n\r\n    remove(node) {\r\n        if (node.instanceOf(BaseNode)) {\r\n            this._layers.remove(node);\r\n        }\r\n    }\r\n}\r\n","export default class SystemConsole {\r\n    css = (color) => {\r\n        return 'background: ' + color + ';' +\r\n            'background-repeat: no-repeat;' +\r\n            'color: #1df9a8;' +\r\n            'line-height: 16px;' +\r\n            'padding: 1px 0;' +\r\n            'margin: 0;' +\r\n            'user-select: none;' +\r\n            '-webkit-user-select: none;' +\r\n            '-moz-user-select: none;';\r\n    };\r\n\r\n    link = (color) => {\r\n        return 'background: ' + color + ';' +\r\n            'background-repeat: no-repeat;' +\r\n            'font-size: 12px;' +\r\n            'color: #446d96;' +\r\n            'line-height: 14px';\r\n    };\r\n\r\n    logSystem(message, link) {\r\n        if (navigator.userAgent.toLowerCase().indexOf('chrome') > -1\r\n            || navigator.userAgent.toLowerCase().indexOf('firefox') > -1\r\n        ) {\r\n            return console.log(\"%c %c %c %s %c %c %c %c%s\",\r\n                this.css('#5C6166'), this.css('#4F5357'),\r\n                this.css('#313335'), message,\r\n                this.css('#4F5357'), this.css('#5C6166'),\r\n                this.link('none'), this.link('none'), link\r\n            );\r\n        } else return console.log(message, link);\r\n    }\r\n\r\n    log(message, level) {\r\n        let css = '';\r\n        if (typeof level === 'string') level = level.toLowerCase();\r\n        switch (level) {\r\n            case 'info':\r\n                level = 'INFO';\r\n                css = 'background: #308AE4; color: #fff; padding: 1px 4px';\r\n                break;\r\n            case 'warn':\r\n            case 'warning':\r\n                level = 'WARNING';\r\n                css = 'background: #f7a148; color: #fff; padding: 1px 4px';\r\n                break;\r\n            case 'error':\r\n                level = 'ERROR';\r\n                css = 'background: #DB5252; color: #fff; padding: 1px 4px';\r\n                break;\r\n            case 'network':\r\n                level = 'NETWORK';\r\n                css = 'background: #7D2998; color: #fff; padding: 1px 4px';\r\n                break;\r\n            case 'debug':\r\n            case undefined:\r\n            default:\r\n                level = 'DEBUG';\r\n                css = 'background: #ADADAD; color: #fff; padding: 1px 4px';\r\n        }\r\n\r\n        if (navigator.userAgent.toLowerCase().indexOf('chrome') > -1\r\n            || navigator.userAgent.toLowerCase().indexOf('firefox') > -1\r\n        ) {\r\n            return window.console.log(\"%c%s\", css, level, message);\r\n        } else return window.console.log(message);\r\n    };\r\n}\r\n\r\n","import Vector2d from \"utils/Vector2d\";\r\n/**\r\n * Class utility for get system browser window size\r\n *\r\n * @class Device\r\n * @exports module:utils/Device\r\n *\r\n * @constructor\r\n */\r\nexport default class Device {\r\n    static _browser;\r\n    static _version;\r\n\r\n    static get browser() {\r\n        if (!Device._browser) Device.getVersion();\r\n        return Device._browser;\r\n    };\r\n\r\n    static get version() {\r\n        if (!Device._version) Device.getVersion();\r\n        return Device._version;\r\n    };\r\n\r\n    constructor() {\r\n        let documentWidth = parseInt(Math.max(\r\n            document.documentElement['clientWidth'],\r\n            document.body['scrollWidth'],\r\n            document.documentElement['scrollWidth'],\r\n            document.body['offsetWidth'],\r\n            document.documentElement['offsetWidth']\r\n        ));\r\n\r\n        let documentHeight = parseInt(Math.max(\r\n            document.documentElement['clientHeight'],\r\n            document.body['scrollHeight'],\r\n            document.documentElement['scrollHeight'],\r\n            document.body['offsetHeight'],\r\n            document.documentElement['offsetHeight']\r\n        ));\r\n\r\n        this.width = documentWidth < parseInt(screen.width) ? documentWidth : parseInt(screen.width);\r\n        this.height = documentHeight < parseInt(screen.height) ? documentHeight : parseInt(screen.height);\r\n    }\r\n\r\n    /**\r\n     * @returns {Device}\r\n     */\r\n    onResize() {\r\n        this.width = window.innerWidth;\r\n        this.height = window.innerHeight;\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @returns {number}\r\n     */\r\n    getWidth() {\r\n        return this.width;\r\n    }\r\n\r\n    /**\r\n     * @returns {number}\r\n     */\r\n    getHeight() {\r\n        return this.height;\r\n    }\r\n\r\n    /**\r\n     * @returns {Vector2d}\r\n     */\r\n    getSize() {\r\n        return new Vector2d(this.width, this.height);\r\n    }\r\n\r\n    static getVersion = () => {\r\n        let userAgent = navigator.userAgent, temp,\r\n            match = userAgent.match(/(vivaldi|opera|chrome|safari|firefox|msie|edge(?=\\/)|trident(?=\\/))\\/?\\s*(\\d+)/i)\r\n                || [];\r\n        if (/trident/i.test(match[1]) || /edge/i.test(match[1])) {\r\n            temp = /\\brv[ :]+(\\d+)/g.exec(userAgent) || [];\r\n\r\n            Device._browser = 'IE';\r\n            Device._version = parseFloat(temp[1] || '');\r\n            return ['IE', temp[1] || ''];\r\n        }\r\n\r\n        if (match[1] === 'Chrome') {\r\n            temp = userAgent.match(/\\b(OPR|Edge|Vivaldi)\\/(\\d+(\\.\\d+))/);\r\n            if (temp !== null) {\r\n                Device._browser = temp[1].replace('OPR', 'Opera');\r\n                Device._version = parseFloat(temp[2]);\r\n                return [temp[1].replace('OPR', 'Opera'), temp[2]];\r\n            }\r\n        }\r\n        match = match[2] ? [match[1], match[2]] : [navigator.appName, navigator.appVersion, '-?'];\r\n        if ((temp = userAgent.match(/version\\/(\\d+)/i)) !== null) match.splice(1, 1, temp[1]);\r\n\r\n        Device._browser = match[0];\r\n        Device._version = parseFloat(match[1]);\r\n\r\n        return [match[0], match[1]];\r\n    };\r\n}\r\n","import EngineComponent from \"api/EngineComponent\";\r\nimport InvalidArgumentException from \"exceptions/InvalidArgumentException\";\r\nimport IEngineComponent from \"api/interfaces/IEngineComponent\";\r\nimport Mutable from \"objects/Mutable\";\r\nimport RuntimeException from \"exceptions/RuntimeException\";\r\n\r\nexport default class SceneHandler extends EngineComponent {\r\n    /**\r\n     * @type {{\r\n        * width: number|string,\r\n        * height: number|string,\r\n        * visible: boolean|string,\r\n        * position: string,\r\n        * top: number|string,\r\n        * bottom: number|string,\r\n        * left: number|string,\r\n        * right: number|string,\r\n        * zIndex: number|string,\r\n        * opacity: number|string,\r\n        * backgroundColor: null|string,\r\n        * smoothing: boolean\r\n        * }}\r\n     */\r\n    static defaults = {\r\n        width: 0,\r\n        height: 0,\r\n\r\n        visible: true,\r\n        position: 'absolute',\r\n        top: 0,\r\n        bottom: 'auto',\r\n        left: 0,\r\n        right: 'auto',\r\n        zIndex: 1000,\r\n        opacity: 1.0,\r\n        backgroundColor: null,\r\n\r\n        smoothing: false\r\n    };\r\n\r\n    /** @type {SceneHandler.defaults|{render:string, components: {\r\n        * LayersHandler: IEngineComponent|EngineComponent|LayersHandler|boolean|null,\r\n        * ViewportHandler: IEngineComponent|EngineComponent|ViewportHandler|boolean|null\r\n        * }}}\r\n     */\r\n    _data = {\r\n        render: 'auto',\r\n        // render: 'canvas2d',\r\n        isLostContext: false,\r\n        components: {\r\n            LayersHandler: true,\r\n            ViewportHandler: true\r\n        }\r\n    };\r\n\r\n    _engine;\r\n\r\n    /** @type {HTMLCanvasElement} */\r\n    _element;\r\n\r\n    /** @type {CanvasRenderingContext2D|WebGLRenderingContext} */\r\n    _context;\r\n\r\n    _shaders = {\r\n        vertex: [],\r\n        fragment: []\r\n    };\r\n\r\n    constructor() {\r\n        super();\r\n    }\r\n\r\n    get layers() {\r\n        return this.LayersHandler.layers;\r\n    }\r\n\r\n    /**\r\n     * @return {IEngineComponent|EngineComponent|LayersHandler|boolean|null}\r\n     */\r\n    get LayersHandler() {\r\n        if (typeof this._data.components.LayersHandler === 'boolean') {\r\n            return null;\r\n        } else return this._data.components.LayersHandler;\r\n    }\r\n\r\n    /**\r\n     * @param {IEngineComponent|EngineComponent|LayersHandler|boolean|null} handler\r\n     */\r\n    set LayersHandler(handler) {\r\n        if ((typeof handler === 'boolean' && handler === false) || handler === null) {\r\n            this._data.components.LayersHandler = false;\r\n            return;\r\n        } else if (typeof handler === 'object' && !handler.instanceOf(IEngineComponent)) {\r\n            throw new InvalidArgumentException('Handler not implements IEngineComponent');\r\n        }\r\n\r\n        this._data.components.LayersHandler = handler;\r\n    }\r\n\r\n    get viewport() {\r\n        return this.ViewportHandler.viewport;\r\n    }\r\n\r\n    /**\r\n     * @return {IEngineComponent|EngineComponent|ViewportHandler|boolean|null}\r\n     */\r\n    get ViewportHandler() {\r\n        if (typeof this._data.components.ViewportHandler === 'boolean') {\r\n            return null;\r\n        } else return this._data.components.ViewportHandler;\r\n    }\r\n\r\n    /**\r\n     * @param {IEngineComponent|EngineComponent|ViewportHandler|boolean|null} handler\r\n     */\r\n    set ViewportHandler(handler) {\r\n        if ((typeof handler === 'boolean' && handler === false) || handler === null) {\r\n            this._data.components.ViewportHandler = false;\r\n            return;\r\n        } else if (typeof handler === 'object' && !handler.instanceOf(IEngineComponent)) {\r\n            throw new InvalidArgumentException('Handler not implements IEngineComponent');\r\n        }\r\n\r\n        this._data.components.ViewportHandler = handler;\r\n    }\r\n\r\n    init(eventHandler, engine, options) {\r\n        super.init(eventHandler);\r\n\r\n        if (options && typeof options === 'object') this.options = options;\r\n        options = Mutable.extend(true, {}, SceneHandler.defaults, options);\r\n        if (options.components !== undefined) delete options.components;\r\n\r\n        this._engine = engine;\r\n        this._data = Mutable.extend(true, {}, this._data, options);\r\n\r\n        this.initCanvas();\r\n    }\r\n\r\n    initCanvas() {\r\n        const $ = `.j2d[guid=\"${this._engine.guid}\"]`;\r\n\r\n        /** @type {Element|HTMLCanvasElement} */\r\n        let node = document.querySelector($);\r\n        if (node !== null) {\r\n            if (node.nodeName === 'DIV') {\r\n                let nodes = document.querySelectorAll($ + ' canvas');\r\n                if (nodes.length === 0) {\r\n                    let canvas = window.document.createElement('canvas');\r\n                    node.appendChild(canvas);\r\n                    nodes = [canvas];\r\n                } else if (nodes.length > 1) {\r\n                    for (let i = 0; i < nodes.length; i++) {\r\n                        if (i !== 0) node.removeChild(nodes[i]);\r\n                    }\r\n                }\r\n                node = nodes[0];\r\n            }\r\n\r\n            if (node.nodeName === 'CANVAS') {\r\n                node.width = this._data.width;\r\n                node.height = this._data.height;\r\n                node.style.zIndex = this._data.zIndex;\r\n                node.style.position = this._data.position;\r\n\r\n                node.style.left = this._data.left;\r\n                node.style.right = this._data.right;\r\n                node.style.top = this._data.top;\r\n                node.style.bottom = this._data.bottom;\r\n\r\n                node.style.backgroundColor = this._data.backgroundColor;\r\n\r\n                try {\r\n                    if ((this._data.render === 'auto' || this._data.render === 'webgl2')\r\n                        && (this._context = node.getContext('webgl2') || node.getContext('experimental-webgl2'))\r\n                    ) {\r\n                        this._data.render = 'webgl2';\r\n                    } else if ((this._data.render === 'auto' || this._data.render === 'webgl')\r\n                        && (this._context = node.getContext('webgl') || node.getContext('experimental-webgl'))\r\n                    ) {\r\n                        this._data.render = 'webgl';\r\n                    } else if ((this._data.render === 'auto' || this._data.render === 'canvas2d')\r\n                        && (this._context = node.getContext('2d'))\r\n                    ) {\r\n                        this._data.render = 'canvas2d';\r\n                    } else {\r\n                        //noinspection ExceptionCaughtLocallyJS\r\n                        throw new RuntimeException(`Browser does not support ${(this._data.render === 'auto')\r\n                            ? 'any' : `\"${this._data.render}\"`} render type.`);\r\n                    }\r\n                } catch (error) {\r\n                    this._engine.log(error, 'error');\r\n                    return;\r\n                }\r\n\r\n                if (!this._data.smoothing) {\r\n                    SceneHandler.disableSmoothing(this._context);\r\n                }\r\n\r\n                this._context.shadowColor = 'rgba(0, 0, 0, 0)';\r\n\r\n                if (this._data.render === 'webgl2' || this._data.render === 'webgl') {\r\n                    this.bindWebGLListeners(node);\r\n                    this.onWebGLInit();\r\n                }\r\n\r\n                this._element = node;\r\n\r\n                this._engine.log(`Find scene with GUID \"${this._engine.guid}\" [${this._data.render.toUpperCase()}]`, 'info');\r\n            }\r\n        }\r\n    }\r\n\r\n    onWebGLInit() {\r\n        let gl = this._context;\r\n\r\n        gl.viewport(0, 0, gl.canvas.width, gl.canvas.height);\r\n        gl.enable(gl.CULL_FACE);\r\n        gl.cullFace(gl.FRONT);\r\n        gl.enable(gl.DEPTH_TEST);\r\n        gl.depthFunc(gl.LEQUAL);\r\n        gl.enable(gl.BLEND);\r\n        gl.blendFunc(gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA);\r\n    }\r\n\r\n    onWebGLContextLost = (e) => {\r\n        e.preventDefault();\r\n        this._data.isLostContext = true;\r\n        // cancelRequestAnimationFrame(requestId);\r\n    };\r\n\r\n    onWebGLContextRestored = (e) => {\r\n        e.preventDefault();\r\n        this.onWebGLInit();\r\n        this._data.isLostContext = false;\r\n    };\r\n\r\n    bindWebGLListeners(node) {\r\n        node.addEventListener('webglcontextlost', this.onWebGLContextLost, false);\r\n        node.addEventListener('webglcontextrestored', this.onWebGLContextRestored, false);\r\n    }\r\n\r\n    unBindWebGLListeners(node) {\r\n        node.removeEventListener('webglcontextlost', this.onWebGLContextLost, false);\r\n        node.removeEventListener('webglcontextrestored', this.onWebGLContextRestored, false);\r\n    }\r\n\r\n    destructor() {\r\n        if ((this._data.render === 'webgl2' || this._data.render === 'webgl') && this._context.isContextLost()) {\r\n            this._context.getExtension('WEBGL_lose_context').loseContext();\r\n        }\r\n    }\r\n\r\n    registerNodeShaders(nodePrototype) {\r\n        let gl = this._context;\r\n        if (this._data.render === 'webgl2' || this._data.render === 'webgl') {\r\n            if (nodePrototype.VertexShader && nodePrototype.FragmentShader) {\r\n                nodePrototype._shaderProgram = gl.createProgram();\r\n\r\n                nodePrototype._vertextShader = SceneHandler.compileShader(gl,\r\n                    gl.createShader(gl.VERTEX_SHADER),\r\n                    nodePrototype.VertexShader\r\n                );\r\n                nodePrototype._fragmentShader = SceneHandler.compileShader(gl,\r\n                    gl.createShader(gl.FRAGMENT_SHADER),\r\n                    nodePrototype.FragmentShader\r\n                );\r\n\r\n                gl.attachShader(nodePrototype._shaderProgram, nodePrototype._vertextShader);\r\n                gl.attachShader(nodePrototype._shaderProgram, nodePrototype._fragmentShader);\r\n\r\n                gl.linkProgram(nodePrototype._shaderProgram);\r\n\r\n                if (!gl.getProgramParameter(nodePrototype._shaderProgram, gl.LINK_STATUS)) {\r\n                    console.info('Could not initialise shaders');\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    static compileShader(gl, shader, source) {\r\n        gl.shaderSource(shader, source);\r\n        gl.compileShader(shader);\r\n\r\n        if (!gl.getShaderParameter(shader, gl.COMPILE_STATUS)) {\r\n            console.info(gl.getShaderInfoLog(shader));\r\n            return null;\r\n        }\r\n\r\n        return shader;\r\n    }\r\n\r\n    // +SceneMainLayer Hack\r\n\r\n    get(key) {\r\n        this.layers.get(key);\r\n    }\r\n\r\n    has(key) {\r\n        this.layers.has(key);\r\n    }\r\n\r\n    add(node, index) {\r\n        this.layers.add(node, index);\r\n    }\r\n\r\n    remove(node) {\r\n        this.layers.remove(node);\r\n    }\r\n\r\n    // -SceneMainLayer Hack\r\n\r\n    static disableSmoothing(context) {\r\n        let chrome = window.navigator.userAgent.match(/Chrom(e|ium)\\/([0-9]+)\\./);\r\n        let version = chrome ? parseInt(chrome[2], 10) : false;\r\n\r\n        if (context.hasOwnProperty('imageSmoothingEnabled')) {\r\n            context.imageSmoothingEnabled = false;\r\n        } else {\r\n            context['imageSmoothingEnabled'] = false;\r\n            context['mozImageSmoothingEnabled'] = false;\r\n            context['oImageSmoothingEnabled'] = false;\r\n            if (version && version <= 29) {\r\n                context['webkitImageSmoothingEnabled'] = false;\r\n            }\r\n            context['msImageSmoothingEnabled'] = false;\r\n        }\r\n    }\r\n\r\n    clear() {\r\n        if (this._data.render.startsWith('webgl')) {\r\n            let gl = this._context;\r\n            gl.clearColor(0.0, 0.0, 0.0, 1.0);\r\n            gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);\r\n        } else {\r\n            this._context.clearRect(0, 0, this._element.width, this._element.height);\r\n        }\r\n    }\r\n\r\n    render(data) {\r\n        if (data.components.SceneHandler._data.isLostContext) return;\r\n\r\n        this.clear();\r\n        this.layers.render(this._context, this.viewport, data || {})\r\n    }\r\n}\r\n","import EngineComponent from \"api/EngineComponent\";\r\n\r\n/**\r\n * FrameHandler\r\n * @constructor\r\n */\r\nexport default class FrameHandler extends EngineComponent {\r\n    static instance;\r\n\r\n    static _timestamp = 0;\r\n    static _frameLimit = 60;\r\n\r\n    static _breakAnimationFrame = false;\r\n\r\n    /**\r\n     * @type {Array}\r\n     * @private\r\n     */\r\n    _engineStack = [];\r\n\r\n    /**\r\n     * @private\r\n     * @type {{start: boolean, pause: boolean}}}\r\n     */\r\n    _data = {\r\n        start: false,\r\n        pause: false,\r\n\r\n        now: Date.now(),\r\n        lastTime: Date.now(),\r\n        deltaTime: 0,\r\n        interval: 1000.0 / FrameHandler._frameLimit\r\n    };\r\n\r\n    /** @private */\r\n    _loop;\r\n\r\n    constructor() {\r\n        super();\r\n    }\r\n\r\n    static set frameLimit(value) {\r\n        if (value <= 60 && value > 0) {\r\n            FrameHandler._frameLimit = value\r\n        }\r\n        return FrameHandler._frameLimit || value;\r\n    }\r\n\r\n    get isStarted() {\r\n        return this._data.start;\r\n    }\r\n\r\n    get isPaused() {\r\n        return this._data.pause;\r\n    }\r\n\r\n    loop(timestamp) {\r\n        if (this._loop === undefined) this._loop = (timestamp) => {\r\n            this.loop(timestamp);\r\n        };\r\n\r\n        if (this._engineStack.length <= 0 && this._data.start || this._data.pause) {\r\n            FrameHandler._breakAnimationFrame = true;\r\n            this._data.start = false;\r\n            return CancelAnimationFrame(this._loop);\r\n        }\r\n        this._data.start = true;\r\n\r\n        RequestAnimationFrame(this._loop);\r\n\r\n        for (let i = 0; i < this._engineStack.length; i++) {\r\n            if (!this._engineStack[i].isEnabled) continue;\r\n            let engine = this._engineStack[i];\r\n\r\n            if (!engine._data.pause) {\r\n                if (engine.io) engine.io.update();\r\n\r\n                this._data.now = Date.now();\r\n                this._data.deltaTime = (this._data.now - this._data.lastTime) / 100.0;\r\n\r\n                if ((this._data.deltaTime * 100.0) > this._data.interval) {\r\n                    this._data.lastTime = this._data.now - ((this._data.deltaTime * 100.0) % this._data.interval);\r\n\r\n                    engine._data.timestamp = timestamp;\r\n                    engine._data.deltaTime = this._data.deltaTime;\r\n\r\n                    // TODO:: temporary hack!\r\n                    if (engine.update && typeof engine.update === 'function') {\r\n                        engine.update(this._data.deltaTime, timestamp);\r\n                    }\r\n\r\n                    // TODO:: temporary hack!\r\n                    if (engine.render && typeof engine.render === 'function') {\r\n                        engine.render(this._data.deltaTime, timestamp);\r\n                    }\r\n                }\r\n\r\n                if (engine.io) engine.io.clear();\r\n            }\r\n        }\r\n    }\r\n\r\n    start(engineHandler) {\r\n        if (this._engineStack[engineHandler.guid] === undefined) {\r\n            this._engineStack[engineHandler.guid] = engineHandler;\r\n            this._engineStack.push(engineHandler);\r\n        }\r\n        if (!this._data.start) this.loop(Date.now() - FrameHandler._timestamp);\r\n        return this;\r\n    }\r\n\r\n    stop(engineHandler) {\r\n        if (this._engineStack[engineHandler.guid] !== undefined) {\r\n            delete this._engineStack[engineHandler.guid];\r\n            this._engineStack.splice(this._engineStack.indexOf(engineHandler.guid), 1);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    init(eventHandler) {\r\n        super.init(eventHandler);\r\n        return this;\r\n    }\r\n\r\n    enable() {\r\n        super.enable();\r\n        this._data.pause = false;\r\n        return this;\r\n    }\r\n\r\n    disable() {\r\n        super.disable();\r\n        this._data.pause = true;\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @singleton\r\n     * @returns {FrameHandler}\r\n     */\r\n    static init() {\r\n        return FrameHandler.instance || (FrameHandler.instance = new FrameHandler());\r\n    }\r\n}\r\n\r\nexport const RequestAnimationFrame = (() => {\r\n    return window.requestAnimationFrame ||\r\n        window.webkitRequestAnimationFrame ||\r\n        window.mozRequestAnimationFrame ||\r\n        window.oRequestAnimationFrame ||\r\n        window.msRequestAnimationFrame ||\r\n        ((callback) => {\r\n            if (!FrameHandler._breakAnimationFrame) {\r\n                if (FrameHandler._timestamp >= Number.MAX_SAFE_INTEGER - 1) FrameHandler._timestamp = 0;\r\n                if (FrameHandler._timestamp === 0) FrameHandler._timestamp = window.performance === undefined\r\n                    ? Date.now()\r\n                    : window.performance.now();\r\n\r\n                // The probability of operation of this polyfill is so small that use of .bind() won't affect working\r\n                // capacity, at the same time such approach guarantees correctness of operation of a method.\r\n                window.setTimeout(callback.bind(this, window.performance === undefined\r\n                    ? Date.now() - FrameHandler._timestamp\r\n                    : window.performance.now() - FrameHandler._timestamp\r\n                ), 1000.0 / FrameHandler._frameLimit);\r\n            } else {\r\n                FrameHandler._breakAnimationFrame = false\r\n            }\r\n        });\r\n})();\r\n\r\nexport const CancelAnimationFrame = (() => {\r\n    FrameHandler.timestamp = 0;\r\n    return window.cancelAnimationFrame ||\r\n        window.webkitCancelAnimationFrame ||\r\n        window.mozCancelAnimationFrame ||\r\n        window.oCancelAnimationFrame ||\r\n        window.msCancelAnimationFrame;\r\n})();\r\n","import InputHandlerCodes from \"io/InputHandlerCodes\";\r\nimport Keyboard from \"io/devices/Keyboard\";\r\n// import Joystick from \"io/devices/Joystick\";\r\nimport Mouse from \"io/devices/Mouse\";\r\n// import Touch from \"io/devices/Touch\";\r\nimport Device from \"api/Device\";\r\nimport EngineComponent from \"api/EngineComponent\";\r\n\r\n/**\r\n * InputHandler\r\n * @constructor\r\n * @extends EngineComponent\r\n *\r\n * @interface IEngineComponent\r\n */\r\nexport default class InputHandler extends EngineComponent {\r\n\r\n    static IO = {\r\n        KEYBOARD: 'keyboard',\r\n        // JOYSTICK: 'joystick',\r\n        MOUSE: 'mouse',\r\n        // TOUCH: 'touch'\r\n    };\r\n\r\n    defaultIO = {\r\n        KEYBOARD: Keyboard,\r\n        // JOYSTICK: Joystick,\r\n        MOUSE: Mouse,\r\n        // TOUCH: Touch\r\n    };\r\n\r\n    static KEY = InputHandlerCodes;\r\n    KEY = InputHandler.KEY;\r\n\r\n    static KEYS_HELPER = InputHandler.prototype.KEYS_HELPER = {\r\n        getKeyById: function (index) {\r\n            return InputHandler.KEY[index] || 'KEY_UNKNOWN_' + index;\r\n        },\r\n        getKeyByCode: function (keyCode) {\r\n            return InputHandler.KEY[keyCode] || 0;\r\n        }\r\n    };\r\n\r\n    constructor() {\r\n        super();\r\n\r\n        this.preventDefault = false;\r\n        this.IO = [];\r\n        this.options = {\r\n            cursor: 'none'\r\n        };\r\n\r\n        this.store = {};\r\n\r\n        this.data = {};\r\n\r\n        this.keyCodeMap = {\r\n            DEBUG_INFO: [[InputHandler.KEY.KEY_CTRL, InputHandler.KEY.KEY_F1], 'j2d.scene.debug.toggleScreen', {}],\r\n            FULLSCREEN: [[InputHandler.KEY.KEY_CTRL, InputHandler.KEY.KEY_F11], 'j2d.scene.toggleFullScreen', {}]\r\n        };\r\n    }\r\n\r\n    bindListeners() {\r\n        for (let i = 0; i < this.IO.length; i++) {\r\n            if (this.IO[i].enable() === false) return false;\r\n        }\r\n    };\r\n\r\n    unBindListeners() {\r\n        for (let i = 0; i < this.IO.length; i++) {\r\n            if (this.IO[i].disable() === false) return false;\r\n        }\r\n    };\r\n\r\n    update() {\r\n        if (!this.isEnabled) return false;\r\n        for (let i = 0; i < this.IO.length; i++) {\r\n            if (this.IO[i].update() === false) return false;\r\n        }\r\n        return true;\r\n    };\r\n\r\n    clear() {\r\n        if (!this.isEnabled) return false;\r\n        for (let i = 0; i < this.IO.length; i++) {\r\n            if (this.IO[i].clear() === false) return false;\r\n        }\r\n        return true;\r\n    };\r\n\r\n    load(newKeyCodeMap) {\r\n        let oldKeyCodeMap = JSON.stringify(this.keyCodeMap);\r\n        this.keyCodeMap = JSON.parse(newKeyCodeMap);\r\n        return oldKeyCodeMap;\r\n    };\r\n\r\n    save() {\r\n        return JSON.stringify(this.keyCodeMap);\r\n    };\r\n\r\n    flush() {\r\n    }\r\n\r\n    // TODO:: to refactoring\r\n\r\n    static _getPressData(manager, keyList) {\r\n        return {\r\n            keyList: keyList,\r\n            time: manager.store.keys.pressedTime[keyList[0]]\r\n        };\r\n    }\r\n\r\n    checkPressedKeyList(keyList) {\r\n        if (typeof keyList === 'object' && keyList instanceof Array) {\r\n            if (keyList.length !== this.data.keys.keysDown.length) {\r\n                return false;\r\n                //} else if (this.data.keys.keysDown.equals(keyList)) {\r\n                //    return getPressData(this, keyList);\r\n            }\r\n            return false;\r\n        }\r\n        if (isNaN(keyList)) return false;\r\n        if (-1 !== this.data.keys.keysDown.indexOf(keyList)) {\r\n            return InputHandler._getPressData(this, keyList);\r\n        }\r\n        return false;\r\n    }\r\n\r\n    checkPressedKeyMap(key) {\r\n        if (this.keyCodeMap[key] === undefined) return false;\r\n        return this.checkPressedKeyList(this.keyCodeMap[key][0]);\r\n    }\r\n\r\n    setKeys(mapObject) {\r\n        //this.keyMap = $.extend(true, {}, this.keyMap, mapObject);\r\n        return this;\r\n    }\r\n\r\n    init(eventHandler, io, options) {\r\n        super.init(eventHandler);\r\n        if (options && typeof options === 'object') {\r\n            this.options = options;\r\n        }\r\n        if (io && typeof io === 'object' && io instanceof Array) {\r\n            this.IO = [];\r\n            for (let i = 0; i < io.length; i++) {\r\n                let device = io[i];\r\n\r\n                if (typeof device === 'string' && InputHandler.IO[device.toUpperCase()] !== undefined) {\r\n                    device = new (this.defaultIO[device.toUpperCase()])();\r\n                    this.IO[device.toString()] = device;\r\n                    this.IO.push(device);\r\n                    if (this.IO[device.toString()].init(this) === false) {\r\n                        throw new Error('Error. Device \"' + device + '\" not initialize.');\r\n                    }\r\n                } else if (typeof device === 'object' && device instanceof Device) {\r\n                    this.IO[device.toString()] = device;\r\n                    this.IO.push(device);\r\n                    if (this.IO[device.toString()].init(this) === false) {\r\n                        throw new Error('Error. Device \"' + device + '\" not initialize.');\r\n                    }\r\n                } else {\r\n                    throw new Error('Error. Unknown IO device \"' + device.toString() + '\" is not supported yet.');\r\n                }\r\n            }\r\n        }\r\n        return this;\r\n    }\r\n\r\n    enable() {\r\n        super.enable();\r\n        this.bindListeners();\r\n        return this;\r\n    }\r\n\r\n    disable() {\r\n        super.disable();\r\n        this.unBindListeners();\r\n        return this;\r\n    }\r\n}\r\n","import EngineComponent from \"../api/EngineComponent\";\r\n\r\n/**\r\n * EventHandler\r\n * @constructor\r\n */\r\nexport default class EventHandler extends EngineComponent {\r\n    _events = [];\r\n    _onces = [];\r\n\r\n    /**\r\n     * @param {string} eventName\r\n     * @param {function} callback\r\n     */\r\n    on(eventName, callback) {\r\n        if (this._events[eventName] !== undefined) {\r\n            let stack = this._events[eventName];\r\n            if (stack.indexOf(callback) === -1) {\r\n                stack.push(callback);\r\n            }\r\n        } else {\r\n            this._events[eventName] = [];\r\n            this._events[eventName].push(callback)\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {string} eventName\r\n     * @param {function} callback\r\n     */\r\n    once(eventName, callback) {\r\n        if (this._onces[eventName] !== undefined) {\r\n            let stack = this._onces[eventName];\r\n            if (stack.indexOf(callback) === -1) {\r\n                stack.push(callback);\r\n            }\r\n        } else {\r\n            this._onces[eventName] = [];\r\n            this._onces[eventName].push(callback)\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {string} eventName\r\n     * @param {function} callback\r\n     */\r\n    off(eventName, callback) {\r\n        if (this._events[eventName] !== undefined) {\r\n            let stack = this._events[eventName];\r\n            if (stack.indexOf(callback) !== -1) {\r\n                stack.splice(stack.indexOf(callback));\r\n            }\r\n        }\r\n        if (this._onces[eventName] !== undefined) {\r\n            let stack = this._onces[eventName];\r\n            if (stack.indexOf(callback) !== -1) {\r\n                stack.splice(stack.indexOf(callback));\r\n            }\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {string} eventName\r\n     * @param {Object} [data]\r\n     */\r\n    trigger(eventName, data) {\r\n        let stack, i, result;\r\n\r\n        if (this._onces[eventName] !== undefined) {\r\n            stack = this._onces[eventName];\r\n            for (i = 0; i < stack.length; i++) {\r\n                result = stack[i].call(stack[i], data);\r\n                if (typeof result === 'boolean' && !result) break;\r\n            }\r\n            this._onces[eventName] = [];\r\n            if (typeof result === 'boolean' && !result) return this;\r\n        }\r\n\r\n        if (this._events[eventName] !== undefined) {\r\n            stack = this._events[eventName];\r\n            for (i = 0; i < stack.length; i++) {\r\n                result = stack[i].call(stack[i], data);\r\n                if (typeof result === 'boolean' && !result) break;\r\n            }\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {string} [eventName]\r\n     */\r\n    flush(eventName) {\r\n        if (eventName !== undefined) {\r\n            if (this._events[eventName] !== undefined) {\r\n                this._events[eventName] = [];\r\n            }\r\n            if (this._onces[eventName] !== undefined) {\r\n                this._onces[eventName] = [];\r\n            }\r\n        } else {\r\n            this._onces = [];\r\n            this._events = [];\r\n        }\r\n        return this;\r\n    }\r\n}\r\n","import Exception from \"exceptions/Exception\";\r\n\r\n/**\r\n * InvalidArgumentException\r\n * Create custom exception with message\r\n *\r\n * @class InvalidArgumentException\r\n * @exports module:exceptions/InvalidArgumentException\r\n *\r\n * @constructor\r\n * @extends Exception\r\n * @param {string} message\r\n * @property {string} message\r\n */\r\nexport default class InvalidArgumentException extends Exception {\r\n    constructor(message) {\r\n        super(message)\r\n    }\r\n\r\n    /**\r\n     * Convert exception to String\r\n     * @returns {string}\r\n     */\r\n    toString = function () {\r\n        return this.message;\r\n    }\r\n}\r\n","import PrototypeInterface from \"api/PrototypeInterface\";\r\n\r\n/**\r\n * IEngineComponent\r\n * @constructor\r\n */\r\nexport default class IEngineComponent extends PrototypeInterface {\r\n};\r\n","import PrototypeObject from \"api/PrototypeObject\";\r\nimport IEngine from \"api/interfaces/IEngine\";\r\nimport RuntimeException from \"exceptions/RuntimeException\";\r\n\r\n/**\r\n * Engine\r\n * @constructor\r\n */\r\nexport default class Engine extends PrototypeObject {\r\n    static interfaces = [IEngine];\r\n    static _$classPreInitialize = [];\r\n\r\n    _isEnabled = false;\r\n\r\n    constructor(id) {\r\n        super();\r\n\r\n        if (!(Engine._$classPreInitialize.indexOf(id) !== -1)) {\r\n            throw new RuntimeException(`The constructor is private. Please use static ${this.constructor.name}.init()`);\r\n        } else Engine._$classPreInitialize.splice(Engine._$classPreInitialize.indexOf(id), 1);\r\n    }\r\n\r\n    get isEnabled() {\r\n        return this._isEnabled;\r\n    }\r\n\r\n    enable() {\r\n        this._isEnabled = true;\r\n        return this;\r\n    };\r\n\r\n    disable() {\r\n        this._isEnabled = false;\r\n        return this;\r\n    };\r\n\r\n    toggle(status) {\r\n        if (status === undefined) status = !this.isEnabled;\r\n        if (status) {\r\n            this.enable();\r\n        } else {\r\n            this.disable();\r\n        }\r\n        return this;\r\n    };\r\n};\r\n\r\n","import Engine from \"api/Engine\";\r\nimport IEngineComponent from \"api/interfaces/IEngineComponent\";\r\nimport InvalidArgumentException from \"exceptions/InvalidArgumentException\";\r\nimport EventHandler from \"events/EventHandler\";\r\nimport InputHandler from \"io/InputHandler\";\r\nimport FrameHandler from \"core/FrameHandler\";\r\nimport SceneHandler from \"core/SceneHandler\";\r\nimport Device from \"utils/Device\";\r\nimport SystemConsole from \"utils/SystemConsole\";\r\nimport UUID from \"utils/UUID\";\r\nimport LayersHandler from \"layers/LayersHandler\";\r\nimport ViewportHandler from \"core/ViewportHandler\";\r\nimport Mutable from \"objects/Mutable\";\r\n\r\n/**\r\n * @class EngineJ2D\r\n * @exports module:\"j2d\"\r\n *\r\n * @param {Element|HTMLElement|HTMLInputElement} element\r\n * @param {EngineJ2D.defaults|{}} data\r\n *\r\n * @constructor\r\n */\r\nexport default class EngineJ2D extends Engine {\r\n    /** @type {string} */\r\n    static VERSION = '1.0.0-dev (VeNoM iNjecTioN)';\r\n\r\n    /** @type {boolean} */\r\n    static PluginInit = false;\r\n\r\n    /**\r\n     * Call setter to 'null/false' to disable components, or 'true' to auto load default implementation.\r\n     *\r\n     * @type {{id: string, pause: boolean, deltaTime: number, timestamp: number, components: {\r\n        * EventHandler: IEngineComponent|EngineComponent|EventHandler|boolean|null,\r\n        * FrameHandler: IEngineComponent|EngineComponent|FrameHandler|boolean|null,\r\n        * InputHandler: IEngineComponent|EngineComponent|InputHandler|boolean|null,\r\n        * MediaHandler: IEngineComponent|EngineComponent|boolean|null,\r\n        * TweenHandler: IEngineComponent|EngineComponent|boolean|null,\r\n        * SceneHandler: IEngineComponent|EngineComponent|SceneHandler|boolean|null\r\n        * }}}\r\n     */\r\n    static defaults = {\r\n        id: '',\r\n        pause: false,\r\n        deltaTime: 0,\r\n        timestamp: 0,\r\n        components: {\r\n            EventHandler: true,\r\n            FrameHandler: true,\r\n            InputHandler: false,\r\n            MediaHandler: false,\r\n            TweenHandler: false,\r\n            SceneHandler: true\r\n        }\r\n    };\r\n\r\n    /** @type {Array.<EngineJ2D>|string} */\r\n    static stack = [];\r\n\r\n    /** @type jQuery|function */\r\n    static _jQuery;\r\n\r\n    /** @type boolean */\r\n    _initialized = false;\r\n\r\n    /** @type {Element|HTMLElement|HTMLInputElement} */\r\n    _element = null;\r\n\r\n    /** @type {EngineJ2D.defaults|{}} */\r\n    _data = {};\r\n\r\n    /** @type {function} */ // TODO:: temporary hack!\r\n    update = (deltaTime, timestamp) => {\r\n        // console.info(timestamp);\r\n    };\r\n\r\n    /** @type {function} */ // TODO:: temporary hack!\r\n    render = (deltaTime, timestamp) => {\r\n        if (this._data.components.SceneHandler) {\r\n            this._data.components.SceneHandler.render(this._data);\r\n        }\r\n    };\r\n\r\n    /** @type {Device} */\r\n    device = new Device();\r\n\r\n    /** @type {SystemConsole} */\r\n    logger = new SystemConsole();\r\n\r\n    constructor(element, data) {\r\n        super(data !== undefined ? data.id : null);\r\n\r\n        this._element = element;\r\n        this._data = data;\r\n    }\r\n\r\n    get guid() {\r\n        return this._data.id;\r\n    }\r\n\r\n    /* +Handlers */\r\n\r\n    get events() {\r\n        return this.EventHandler;\r\n    }\r\n\r\n    /**\r\n     * @return {IEngineComponent|EngineComponent|EventHandler|boolean|null}\r\n     */\r\n    get EventHandler() {\r\n        if (typeof this._data.components.EventHandler === 'boolean') {\r\n            return null;\r\n        } else return this._data.components.EventHandler;\r\n    }\r\n\r\n    /**\r\n     * @param {IEngineComponent|EngineComponent|EventHandler|boolean|null} handler\r\n     */\r\n    set EventHandler(handler) {\r\n        if ((typeof handler === 'boolean' && handler === false) || handler === null) {\r\n            this._data.components.EventHandler = false;\r\n            return;\r\n        } else if (typeof handler === 'object' && !handler.instanceOf(IEngineComponent)) {\r\n            throw new InvalidArgumentException('Handler not implements IEngineComponent');\r\n        }\r\n\r\n        this._data.components.EventHandler = handler;\r\n    }\r\n\r\n    get frame() {\r\n        return this.FrameHandler;\r\n    }\r\n\r\n    /**\r\n     * @return {IEngineComponent|EngineComponent|FrameHandler|boolean|null}\r\n     */\r\n    get FrameHandler() {\r\n        if (typeof this._data.components.FrameHandler === 'boolean') {\r\n            return null;\r\n        } else return this._data.components.FrameHandler;\r\n    }\r\n\r\n    /**\r\n     * @param {IEngineComponent|EngineComponent|FrameHandler|boolean|null} handler\r\n     */\r\n    set FrameHandler(handler) {\r\n        if ((typeof handler === 'boolean' && handler === false) || handler === null) {\r\n            this._data.components.FrameHandler = false;\r\n            return;\r\n        } else if (typeof handler === 'object' && !handler.instanceOf(IEngineComponent)) {\r\n            throw new InvalidArgumentException('Handler not implements IEngineComponent');\r\n        }\r\n\r\n        this._data.components.FrameHandler = handler;\r\n    }\r\n\r\n    get io() {\r\n        return this.InputHandler;\r\n    }\r\n\r\n    /**\r\n     * @return {IEngineComponent|EngineComponent|InputHandler|boolean|null}\r\n     */\r\n    get InputHandler() {\r\n        if (typeof this._data.components.InputHandler === 'boolean') {\r\n            return null;\r\n        } else return this._data.components.InputHandler;\r\n    }\r\n\r\n    /**\r\n     * @param {IEngineComponent|EngineComponent|InputHandler|boolean|null} handler\r\n     */\r\n    set InputHandler(handler) {\r\n        if ((typeof handler === 'boolean' && handler === false) || handler === null) {\r\n            this._data.components.InputHandler = false;\r\n            return;\r\n        } else if (typeof handler === 'object' && !handler.instanceOf(IEngineComponent)) {\r\n            throw new InvalidArgumentException('Handler not implements IEngineComponent');\r\n        }\r\n\r\n        this._data.components.InputHandler = handler;\r\n    }\r\n\r\n    get media() {\r\n        return this.MediaHandler;\r\n    }\r\n\r\n    /**\r\n     * @return {IEngineComponent|EngineComponent|MediaHandler|boolean|null}\r\n     */\r\n    get MediaHandler() {\r\n        if (typeof this._data.components.MediaHandler === 'boolean') {\r\n            return null;\r\n        } else return this._data.components.MediaHandler;\r\n    }\r\n\r\n    /**\r\n     * @param {IEngineComponent|EngineComponent|MediaHandler|boolean|null} handler\r\n     */\r\n    set MediaHandler(handler) {\r\n        if ((typeof handler === 'boolean' && handler === false) || handler === null) {\r\n            this._data.components.MediaHandler = false;\r\n            return;\r\n        } else if (typeof handler === 'object' && !handler.instanceOf(IEngineComponent)) {\r\n            throw new InvalidArgumentException('Handler not implements IEngineComponent');\r\n        }\r\n\r\n        this._data.components.MediaHandler = handler;\r\n    }\r\n\r\n    get tweens() {\r\n        return this.TweenHandler;\r\n    }\r\n\r\n    /**\r\n     * @return {IEngineComponent|EngineComponent|TweenHandler|boolean|null}\r\n     */\r\n    get TweenHandler() {\r\n        if (typeof this._data.components.TweenHandler === 'boolean') {\r\n            return null;\r\n        } else return this._data.components.TweenHandler;\r\n    }\r\n\r\n    /**\r\n     * @param {IEngineComponent|EngineComponent|TweenHandler|boolean|null} handler\r\n     */\r\n    set TweenHandler(handler) {\r\n        if ((typeof handler === 'boolean' && handler === false) || handler === null) {\r\n            this._data.components.TweenHandler = false;\r\n            return;\r\n        } else if (typeof handler === 'object' && !handler.instanceOf(IEngineComponent)) {\r\n            throw new InvalidArgumentException('Handler not implements IEngineComponent');\r\n        }\r\n\r\n        this._data.components.TweenHandler = handler;\r\n    }\r\n\r\n    get scene() {\r\n        return this.SceneHandler;\r\n    }\r\n\r\n    /**\r\n     * @return {IEngineComponent|EngineComponent|SceneHandler|boolean|null}\r\n     */\r\n    get SceneHandler() {\r\n        if (typeof this._data.components.SceneHandler === 'boolean') {\r\n            return null;\r\n        } else return this._data.components.SceneHandler;\r\n    }\r\n\r\n    /**\r\n     * @param {IEngineComponent|EngineComponent|SceneHandler|boolean|null} handler\r\n     */\r\n    set SceneHandler(handler) {\r\n        if ((typeof handler === 'boolean' && handler === false) || handler === null) {\r\n            this._data.components.SceneHandler = false;\r\n            return;\r\n        } else if (typeof handler === 'object' && !handler.instanceOf(IEngineComponent)) {\r\n            throw new InvalidArgumentException('Handler not implements IEngineComponent');\r\n        }\r\n\r\n        this._data.components.SceneHandler = handler;\r\n    }\r\n\r\n    /* -Handlers */\r\n\r\n    /* +GameEngine */\r\n    start() {\r\n        if (!this._initialized) this.tryLoadComponents();\r\n        this.enable();\r\n\r\n        this.frame.start(this);\r\n        this.events.trigger('start');\r\n    };\r\n\r\n    stop() {\r\n        if (!this._initialized) this.tryLoadComponents();\r\n        this.disable();\r\n\r\n        this.frame.stop(this);\r\n        this.events.trigger('stop');\r\n    };\r\n\r\n    pause() {\r\n        if (!this._initialized) this.tryLoadComponents();\r\n\r\n        if (this.io) this.io.flush();\r\n        if (this.media) this.media.pause();\r\n        this._data.pause = true;\r\n        this._element.classList.add('pause');\r\n        this.events.trigger('pause');\r\n    };\r\n\r\n    resume() {\r\n        if (!this._initialized) this.tryLoadComponents();\r\n\r\n        this._element.classList.remove('pause');\r\n        this._element.focus();\r\n        this._data.pause = false;\r\n        if (this.io) this.io.flush();\r\n        if (this.media) this.media.resume();\r\n        this.events.trigger('resume');\r\n    };\r\n\r\n    /* -GameEngine **/\r\n\r\n    /* +System **/\r\n\r\n    log(message, level) {\r\n        this.logger.log(message, level);\r\n    };\r\n\r\n    tryLoadComponents() {\r\n        if (this._initialized) return;\r\n\r\n        let COMPONENT = this._data.components;\r\n\r\n        // EventHandler\r\n        if (typeof COMPONENT.EventHandler === 'boolean' && COMPONENT.EventHandler === true) {\r\n            COMPONENT.EventHandler = new EventHandler();\r\n        }\r\n\r\n        if (typeof COMPONENT.EventHandler === 'object' && COMPONENT.EventHandler instanceof IEngineComponent) {\r\n            COMPONENT.EventHandler.enable();\r\n        }\r\n\r\n\r\n        // InputHandler\r\n        if (typeof COMPONENT.InputHandler === 'boolean' && COMPONENT.InputHandler === true) {\r\n            COMPONENT.InputHandler = new InputHandler();\r\n            COMPONENT.InputHandler.init(COMPONENT.EventHandler, [\r\n                InputHandler.IO.KEYBOARD,\r\n                InputHandler.IO.MOUSE\r\n            ], {\r\n                cursor: 'default'\r\n            });\r\n        }\r\n\r\n        if (typeof COMPONENT.InputHandler === 'object' && COMPONENT.InputHandler instanceof IEngineComponent) {\r\n            COMPONENT.InputHandler.enable();\r\n        }\r\n\r\n        // SceneHandler\r\n        if (typeof COMPONENT.SceneHandler === 'boolean' && COMPONENT.SceneHandler === true) {\r\n            COMPONENT.SceneHandler = new SceneHandler();\r\n            COMPONENT.SceneHandler.init(COMPONENT.EventHandler, this, {\r\n                width: 640,\r\n                height: 360,\r\n                backgroundColor: 'black'\r\n            });\r\n\r\n            COMPONENT.SceneHandler.LayersHandler = new LayersHandler();\r\n            COMPONENT.SceneHandler.LayersHandler.init(COMPONENT.EventHandler);\r\n\r\n            COMPONENT.SceneHandler.ViewportHandler = new ViewportHandler();\r\n            COMPONENT.SceneHandler.ViewportHandler.init(COMPONENT.EventHandler);\r\n        }\r\n\r\n        if (typeof COMPONENT.SceneHandler.LayersHandler === 'object'\r\n            && COMPONENT.SceneHandler.LayersHandler instanceof IEngineComponent\r\n        ) {\r\n            COMPONENT.SceneHandler.LayersHandler.enable();\r\n        }\r\n\r\n        if (typeof COMPONENT.SceneHandler.ViewportHandler === 'object'\r\n            && COMPONENT.SceneHandler.ViewportHandler instanceof IEngineComponent\r\n        ) {\r\n            COMPONENT.SceneHandler.ViewportHandler.enable();\r\n        }\r\n\r\n        if (typeof COMPONENT.EventHandler === 'object' && COMPONENT.EventHandler instanceof IEngineComponent) {\r\n            COMPONENT.SceneHandler.enable();\r\n        }\r\n\r\n        // FrameHandler\r\n        if (typeof COMPONENT.FrameHandler === 'boolean' && COMPONENT.FrameHandler === true) {\r\n            COMPONENT.FrameHandler = FrameHandler.init();\r\n            COMPONENT.FrameHandler.init(COMPONENT.EventHandler);\r\n        }\r\n\r\n        if (typeof COMPONENT.FrameHandler === 'object' && COMPONENT.FrameHandler instanceof IEngineComponent) {\r\n            COMPONENT.FrameHandler.enable();\r\n        }\r\n\r\n        this._initialized = true;\r\n    }\r\n\r\n    /* -System **/\r\n\r\n    /**\r\n     * @name EngineJ2D\r\n     * @static\r\n     *\r\n     * @param {string|jQuery} selected\r\n     * @param {EngineJ2D.defaults|Object} [options]\r\n     *\r\n     * @returns {EngineJ2D|EngineJ2D[]|Array.<EngineJ2D>}\r\n     */\r\n    static init(selected, options) {\r\n        if (selected === undefined) selected = '.j2d';\r\n        if (options === undefined) options = {};\r\n\r\n        options = Mutable.extend(true, {}, EngineJ2D.defaults, options);\r\n\r\n        let nodes = [];\r\n        if (typeof selected === 'string') {\r\n            nodes = window.document.querySelectorAll(selected);\r\n        } else if (typeof selected === 'object' && window.jQuery !== undefined && selected instanceof window.jQuery) {\r\n            nodes = selected.get();\r\n        } else return null;\r\n\r\n        let inactiveNodes = [];\r\n\r\n        for (let i = 0; i < nodes.length; i++) {\r\n            if (!nodes[i].hasAttribute('guid')) inactiveNodes.push(nodes[i])\r\n        }\r\n\r\n        for (let i = 0; i < inactiveNodes.length; i++) {\r\n            options.id = UUID.generate();\r\n\r\n            inactiveNodes[i].setAttribute('guid', options.id);\r\n\r\n            let id = inactiveNodes[i].getAttribute('id');\r\n            if (id === undefined || id === null) {\r\n                inactiveNodes[i].setAttribute('guid', options.id);\r\n            }\r\n\r\n            let tabIndex = inactiveNodes[i].getAttribute('tabindex');\r\n            if (tabIndex === undefined || tabIndex === null || tabIndex === false) {\r\n                inactiveNodes[i].setAttribute('tabindex', '-1');\r\n            }\r\n\r\n            if (!inactiveNodes[i].classList.contains('j2d')) {\r\n                inactiveNodes[i].classList.add('j2d');\r\n            }\r\n\r\n            Engine._$classPreInitialize.push(options.id);\r\n            EngineJ2D.stack[options.id] = new EngineJ2D(inactiveNodes[i], options);\r\n            EngineJ2D.stack.push(options.id);\r\n\r\n            inactiveNodes[i].click();\r\n            inactiveNodes[i].focus();\r\n        }\r\n\r\n        let resumeBind = (current) => {\r\n            let nodes, engine;\r\n            nodes = window.document.querySelectorAll('div.canvas[guid]:not(.pause-disable):not(:focus)');\r\n            for (let i = 0; i < nodes.length; i++) {\r\n                if (current !== nodes[i]) {\r\n                    nodes[i].classList.remove('active');\r\n                    engine = EngineJ2D.stack[nodes[i].getAttribute('guid')] || null;\r\n                    if (engine) engine.pause();\r\n                }\r\n            }\r\n\r\n            nodes = window.document.querySelectorAll('div.canvas[guid].active.pause-disable:not(:focus)');\r\n            for (let i = 0; i < nodes.length; i++) {\r\n                if (current !== nodes[i]) {\r\n                    nodes[i].classList.remove('active');\r\n                }\r\n            }\r\n        };\r\n\r\n        function resumeEventListener() {\r\n            let engine;\r\n            if (this.classList.contains('pause')) {\r\n                engine = EngineJ2D.stack[this.getAttribute('guid')] || null;\r\n                if (engine) engine.resume();\r\n                resumeBind(this);\r\n            } else if (!this.classList.contains('resume-by-click') && this.classList.contains(':focus')) {\r\n                this.classList.add('active');\r\n                this.focus();\r\n                engine = EngineJ2D.stack[this.getAttribute('guid')] || null;\r\n                if (engine) engine.resume();\r\n                resumeBind(this);\r\n            }\r\n            return true;\r\n        }\r\n\r\n        let activeNodes = [];\r\n        nodes = window.document.querySelectorAll('.j2d[guid]');\r\n        for (let i = 0; i < nodes.length; i++) {\r\n            activeNodes.push(EngineJ2D.stack[nodes[i].getAttribute('guid')] || null);\r\n            nodes[i].addEventListener('click', resumeEventListener);\r\n            nodes[i].addEventListener('touch', resumeEventListener);\r\n            nodes[i].addEventListener('mouseenter', resumeEventListener);\r\n        }\r\n        return (1 === activeNodes.length) ? activeNodes[0] : activeNodes;\r\n    }\r\n\r\n    static ready(callback) {\r\n        if (EngineJ2D.PluginInit) {\r\n            if (EngineJ2D._jQuery) {\r\n                EngineJ2D._jQuery(document).ready(callback);\r\n            } else callback();\r\n        } else {\r\n            if (EngineJ2D._jQuery) {\r\n                EngineJ2D._jQuery(document).on('j2d-ready', () => {\r\n                    EngineJ2D._jQuery(document).ready(callback);\r\n                });\r\n            } else window.document.addEventListener('j2d-ready', callback);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @param {jQuery} jQuery\r\n     * @return {jQuery}\r\n     */\r\n    static jQuery(jQuery) {\r\n        EngineJ2D._jQuery = jQuery !== undefined ? jQuery : window.jQuery;\r\n\r\n        (function ($) {\r\n            //noinspection JSUnresolvedVariable\r\n            /**\r\n             * @param {EngineJ2D.defaults} [options]\r\n             * @returns {EngineJ2D|Array.<EngineJ2D>}\r\n             */\r\n            $.fn.j2d = function (options) {\r\n                /** @type {jQuery|EngineJ2D._jQuery} */\r\n                let instance = this;\r\n                return EngineJ2D.init(instance, options);\r\n            };\r\n        })(EngineJ2D._jQuery);\r\n\r\n        return EngineJ2D._jQuery;\r\n    }\r\n\r\n    /**\r\n     * @return {boolean}\r\n     */\r\n    static CompatibilityCheck() {\r\n        let check = false;\r\n\r\n        // Disable IE < 11\r\n        if (Device.browser === 'MSIE' && Device.version < 11) {\r\n            let message = 'j2D Error: Please install normal modern browser, IE 11 supported.';\r\n            alert(message);\r\n            console.error(message);\r\n\r\n            check = true;\r\n        }\r\n\r\n        // Fix IE 11\r\n        if (Device.browser === 'IE' && Device.version >= 11) {\r\n            (() => {\r\n                let CustomEvent = (event, params) => {\r\n                    params = params || {bubbles: false, cancelable: false, detail: undefined};\r\n                    /** @type {Event|CustomEvent}*/\r\n                    let customEvent = document.createEvent('CustomEvent');\r\n                    customEvent.initCustomEvent(event, params.bubbles, params.cancelable, params.detail);\r\n                    customEvent.preventDefault = function () {\r\n                        Object.defineProperty(this, 'defaultPrevented', {\r\n                            get: () => {\r\n                                return true;\r\n                            }\r\n                        });\r\n                    };\r\n                    customEvent.preventDefault();\r\n                    return customEvent;\r\n                };\r\n                CustomEvent.prototype = window.Event.prototype;\r\n                window.CustomEvent = CustomEvent;\r\n            })();\r\n        }\r\n\r\n        return check;\r\n    }\r\n}\r\n\r\n/* ------------------------------ Plugin ------------------------------ */\r\n(EngineJ2D.initPlugin = () => {\r\n    if (EngineJ2D.PluginInit || EngineJ2D.CompatibilityCheck()) return true;\r\n\r\n    (new SystemConsole()).logSystem(\r\n        `j2D v.${EngineJ2D.VERSION} | Browser ${Device.browser} v.${Device.version}`, 'https://github.com/fsggs/j2d'\r\n    );\r\n\r\n    let isFullScreen = () => {\r\n        //noinspection JSUnresolvedVariable\r\n        return !!(window.document.webkitFullscreenElement\r\n            || window.document.webkitCurrentFullScreenElement\r\n            || (Device.browser === 'Firefox' && Device.version < 47\r\n                ? window.document.mozFullScreenElement\r\n                : window.document.fullscreenElement)\r\n            || window.document.msFullscreenElement\r\n        );\r\n    };\r\n\r\n    function fullScreenEventListener() {\r\n        let fullScreen = isFullScreen();\r\n        if (!fullScreen) {\r\n            let node, engine;\r\n            node = window.document.querySelector('.j2d[guid].active');\r\n            if (node) engine = EngineJ2D.stack[node.getAttribute('guid')] || null;\r\n            if (engine) engine.scene.resizeToFullPage(fullScreen);\r\n\r\n            node = window.document.querySelector('.j2d[guid]:not(.active)');\r\n            if (node) engine = EngineJ2D.stack[node.getAttribute('guid')] || null;\r\n            if (engine) engine.toggle(!fullScreen);\r\n        }\r\n    }\r\n\r\n    let html = window.document.querySelector('html');\r\n\r\n    if (!html.classList.contains('j2d-engine')) {\r\n        window.document.addEventListener('fullscreenchange', fullScreenEventListener);\r\n        window.document.addEventListener('webkitfullscreenchange', fullScreenEventListener);\r\n        window.document.addEventListener('mozfullscreenchange', fullScreenEventListener);\r\n        window.document.addEventListener('MSFullscreenChange', fullScreenEventListener);\r\n\r\n        window.addEventListener('focus', () => {\r\n            let node, engine;\r\n            node = window.document.querySelector('.j2d[guid].active:not(.resume-by-click)');\r\n            if (node) engine = EngineJ2D.stack[node.getAttribute('guid')] || null;\r\n            if (engine) engine.resume();\r\n        });\r\n\r\n        window.addEventListener('blur', () => {\r\n            let nodes, engine;\r\n            nodes = window.document.querySelectorAll('.j2d[guid]:not(.pause-disable)');\r\n            for (let i = 0; i < nodes.length; i++) {\r\n                if (nodes[i]) engine = EngineJ2D.stack[nodes[i].getAttribute('guid')] || null;\r\n                if (engine) engine.pause();\r\n            }\r\n        });\r\n\r\n        window.addEventListener('resize', () => {\r\n            for (let i = 0; i < EngineJ2D.stack.length; i++) {\r\n                EngineJ2D.stack[EngineJ2D.stack[i]].device.onResize();\r\n            }\r\n\r\n            let fullScreen = isFullScreen();\r\n            if (fullScreen) {\r\n                let node, engine;\r\n                node = window.document.querySelector('.j2d[guid].active');\r\n                if (node) engine = EngineJ2D.stack[node.getAttribute('guid')] || null;\r\n                if (engine) engine.scene.resizeToFullPage(fullScreen);\r\n            }\r\n            return true;\r\n        });\r\n        html.classList.add('j2d-engine');\r\n    }\r\n\r\n    window.document.dispatchEvent((new CustomEvent('j2d-ready')));\r\n\r\n    return EngineJ2D.PluginInit = true;\r\n})();\r\n"]}