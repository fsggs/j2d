{"version":3,"sources":["transitions/utils/Interpolation.es6","transitions/utils/Easing.es6","api/interfaces/IInputHandler.es6","api/interfaces/IHandler.es6","api/interfaces/IEngine.es6","io/devices/Touch.es6","io/devices/Pointer.es6","io/devices/Mouse.es6","io/devices/Keyboard.es6","io/devices/Joystick.es6","core/ViewportManager.es6","core/SceneManager.es6","core/LayersManager.es6","core/GameStatesManager.es6","utils/Vector2dInteger.es6","utils/Vector2d.es6","utils/MathUtil.es6","transitions/Tween.es6","states/DefaultGameState.es6","states/BaseGameState.es6","nodes/RectNode.es6","nodes/CollectionNode.es6","nodes/CameraNode.es6","nodes/BaseNode.es6","nodes/AnimatedNode.es6","media/Video.es6","media/Sound.es6","media/Audio.es6","loaders/AssetsLoader.es6","exceptions/UnexpectedValueException.es6","exceptions/RuntimeException.es6","exceptions/RangeException.es6","exceptions/OutOfRangeException.es6","exceptions/OutOfBoundsException.es6","exceptions/LogicException.es6","exceptions/LengthException.es6","exceptions/Exception.es6","exceptions/BadMethodCallException.es6","exceptions/BadFunctionCallException.es6","utils/Events.es6","utils/ArrayMap.es6","utils/ObjectUtil.es6","io/MediaManager.es6","io/InputManager.es6","io/InputHandlerCodes.es6","api/PrototypeObject.es6","api/PrototypeInterface.es6","api/Handler.es6","api/EngineComponent.es6","api/Device.es6","utils/UUID.es6","utils/SystemConsole.es6","utils/Device.es6","core/FrameHandler.es6","io/InputHandler.es6","events/EventHandler.es6","exceptions/InvalidArgumentException.es6","api/interfaces/IEngineComponent.es6","api/Engine.es6","j2d.es6"],"names":["InterpolationEnum","Interpolation","Linear","v","k","m","length","f","i","Math","floor","fn","Utils","Bezier","b","n","pw","pow","bn","Bernstein","CatmullRom","p0","p1","t","fc","Factorial","a","s","p2","p3","v0","v1","t2","t3","get","interpolation","undefined","register","interpolationFunction","linear","bezier","catmull-rom","EasingEnum","Easing","None","Quadratic","In","Out","InOut","Cubic","Quartic","Quintic","Sinusoidal","cos","PI","sin","Exponential","Circular","sqrt","Elastic","p","asin","Back","Bounce","_Tween2","default","easing","easingFunction","quadratic-in","quadratic-out","quadratic-in-out","cubic-in","cubic-out","cubic-in-out","quartic-in","quartic-out","quartic-in-out","quintic-in","quintic-out","quintic-in-out","sinusoidal-in","sinusoidal-out","sinusoidal-in-out","exponential-in","exponential-out","exponential-in-out","circular-in","circular-out","circular-in-out","elastic-in","elastic-out","elastic-in-out","back-in","back-out","back-in-out","bounce-in","bounce-out","bounce-in-out","IInputHandler","IHandler","IEngine","Touch","input","_classCallCheck","this","_possibleConstructorReturn","__proto__","Object","getPrototypeOf","call","Error","IO","_Pointer3","prototype","constructor","name","Pointer","_this","image","data","pointer","store","options","cursor","window","document","body","style","toggle","x","y","distance","Mouse","defineProperty","enumerable","writable","value","id","e","isEnabled","preventDefault","keyCode","KEYS_HELPER","getKeyById","__fixMouseButtonId","button","keys","keysDown","includes","push","recordMouseDragDistance","tracker","pageX","pageY","recordMouseClickTime","pressedTime","delta","startTime","timeStamp","events","trigger","keysUp","splice","toFixed","wheelDelta","keyMouseDownEventHandler","bind","keyMouseUpEventHandler","keyMouseMoveEventHandler","scrollMouseEventHandler","setPointerImage","addEventListener","removeEventListener","Keyboard","recordKeyPressTime","keyDownEventHandler","keyUpEventHandler","Joystick","calculateScale","screen","viewport","offset","size","scale","angle","offsetX","offsetY","ViewportManager","cameras","_ArrayMap2","camera","init","_typeof","Array","key","node","add","remove","_CameraNode2","getCameraViewport","getVector","SceneManager","j2d","setGameCallback","start","canvas","context","frameManager","_FrameManager2","Init","layersManager","_LayersManager2","viewportManager","_ViewportManager2","gameStatesManager","_GameStatesManager2","initLayers","state","sceneManager","render","timestamp","clear","fillBackground","_ObjectUtil2","extend","defaults","originalWidth","width","originalHeight","height","originalMargin","getComputedStyle","element","initCanvas","setScreen","setDefaultViewport","getLayer","addLayer","querySelectorAll","createElement","zIndex","position","left","top","webGL","getContext","smoothing","util","disableSmoothing","shadowColor","backgroundColor","opacity","visible","appendChild","pos","clearRect","save","restore","gameState","stop","gameConstructor","patchGameStateRender","getState","newGameState","callback","load","frameLimit","getPreviousState","unload","setTimeout","io","getCurrent","fullscreen","getElementById","attr","requestFullscreen","webkitRequestFullscreen","webkitRequestFullScreen","mozRequestFullScreen","msRequestFullscreen","exitFullscreen","webkitExitFullscreen","webkitCancelFullScreen","mozCancelFullScreen","msExitFullscreen","resize","device","enableFullscreen","margin","setOffset","scene","fullScreen","layers","forEach","index","getViewport","globalCollection","has","addCamera","setViewport","_Vector2d2","_updateNoCamerasViewport","updateViewport","fillStyle","fillRect","display","enableFullScreen","LayersManager","_CollectionNode2","_UUID2","generate","GameStatesManager","sceneCallback","_DefaultGameState2","states","contains","previousState","currentState","indexOf","Vector2dInteger","array","Vector2d","vector1","vector2","atan2","MathUtil","number","isFinite","min","max","random","omitZero","degree","radian","tweens","Tween","tweenNode","_Events2","stateDefaults","properties","tween","isStarted","stateData","_tweenStateData","duration","tweenStateStack","time","nextState","currentStateAnimation","previousStatesTime","getStateTimeDuration","elapsed","import","animateTween","_Easing2","chainedTweensStack","result","withPrevious","tweenStateTimings","startState","parsedTweenStateStack","nextStateDelay","nextAllStateDelay","concat","reverseProperties","stateStack","slice","stackLength","j","sIndex","delay","shift","calculateProperties","global","performance","now","isAnimated","cleanProperties","_calculateStackState","_calculateStackStateTimings","delayTime","stopChainedTweens","to","count","event","on","off","once","flush","update","defaultDuration","property","temp","hasOwnProperty","isNaN","Number","parseFloat","toString","startProperties","endProperties","DefaultGameState","gsm","setNextState","BaseGameState","loader","STATE_NOT_LOADED","STATE_INIT","STATE_LOAD","STATE_UPDATE","STATE_RENDER","STATE_UNLOAD","RectNode","color","collection","inViewport","tempOpacity","globalAlpha","translate","getPosition","rotate","_MathUtil2","degree2Radian","lineWidth","draw","type","CollectionNode","collectionNode","each","_BaseNode2","CameraNode","calculate","BaseNode","getSize","getOffset","enabledCache","cache","AnimatedNode","durationAsSpeed","getDistance","getAngle","velocity","Video","createMasterGain","audioContext","masterGain","createGain","createGainNode","gain","connect","destination","Sound","manager","audioNode","getAudioContext","AudioContext","webkitAudioContext","getMasterGain","buffer","_setupAudioNode","iOSAutoEnable","iOSEnable","media","sound","loadBuffer","src","soundNode","disconnect","sprite","loaded","_inactiveNode","timerId","loop","soundId","round","Date","_nodeById","paused","_clearEndTimer","rate","onEndTimer","timer","loopStart","loopEnd","refreshBuffer","playStart","currentTime","volume","bufferSource","noteGrainOn","play","activeNode","noteOff","vol","z","pos3d","panner","setPosition","panningModel","model","readyState","createPanner","_drainPool","newNode","inactive","format","autoPlay","muted","url","loadSound","test","atob","split","dataView","Uint8Array","charCodeAt","decodeAudioData","xhr","XMLHttpRequest","open","responseType","onload","response","onerror","gainNode","send","arraybuffer","error","getOwnPropertyNames","createBufferSource","playbackRate","AudioNode","Audio","audio","console","code","preload","listener","ceil","extension","isSupportAudio","warn","extractFormat","source","exec","toLowerCase","isSupportCodec","_load","nodes","_unload","clearTimeout","audios","navigator","isCocoonJS","playSprite","pause","_activeNode","_pause","_stop","mute","_mute","unMute","_unMute","_volume","_position","zsaz","_pos3d","listenerEvent","AssetsLoader","progress","UnexpectedValueException","message","RuntimeException","RangeException","OutOfRangeException","OutOfBoundsException","LogicException","LengthException","Exception","BadMethodCallException","BadFunctionCallException","Events","eventName","onces","stack","ArrayMap","args","l","equals","object","ObjectUtil","arguments","deepness","out","create","html5Audio","MediaManager","iOSEnabled","codecs","mp3","canPlayType","replace","opus","ogg","wav","aac","m4a","mp4","weba","fileExtension","sounds","webAudio","userAgent","unlock","createBuffer","noteOn","playbackState","PLAYING_STATE","FINISHED_STATE","getKey","filter","checkKeyMap","enableCallback","which","keyMap","$","isArray","eval","keysPressed","onMouseClick","enabled","isPlay","hasClass","DEPRECATED_InputManager","mouse","inArray","enableAdditionalData","startPosition","timePressed","preventAll","previousDistance","onMouseWheel","originalEvent","fixMouseWheel","mouseWheelCancel","onMouseMove","currentPosition","onKeyboardPress","writeMode","char","String","fromCharCode","focus","onTouchTap","touch","touches","changedTouches","onTouchMove","bindEvents","selector","unbindEvents","getPressData","keyList","FULLSCREEN","KEY_CTRL","KEY_F11","j2dPlugin","pluginInit","dX","offsetWidth","dY","offsetHeight","keyPressed","SCROLL_MOUSE_UP","SCROLL_MOUSE_DOWN","newKeyMap","oldKeyMap","JSON","stringify","parse","mapObject","current","previous","checkPressedKeyList","mode","css","enable","KEY_MOUSE_LEFT","KEY_MOUSE_MIDDLE","KEY_MOUSE_RIGHT","KEY_BACKSPACE","KEY_TAB","KEY_ENTER","KEY_SHIFT","KEY_ALT","KEY_PAUSE","KEY_BREAK","KEY_CAPS_LOCK","KEY_ESCAPE","KEY_SPACE_BAR","KEY_PAGE_UP","KEY_PAGE_DOWN","KEY_END","KEY_HOME","KEY_LEFT_ARROW","KEY_UP_ARROW","KEY_RIGHT_ARROW","KEY_DOWN_ARROW","KEY_INSERT","KEY_DELETE","KEY_0","KEY_1","KEY_2","KEY_3","KEY_4","KEY_5","KEY_6","KEY_7","KEY_8","KEY_9","KEY_A","KEY_B","KEY_C","KEY_D","KEY_E","KEY_F","KEY_G","KEY_H","KEY_I","KEY_J","KEY_K","KEY_L","KEY_M","KEY_N","KEY_O","KEY_P","KEY_Q","KEY_R","KEY_S","KEY_T","KEY_U","KEY_V","KEY_W","KEY_X","KEY_Y","KEY_Z","KEY_LEFT_WINDOW_KEY","KEY_RIGHT_WINDOW_KEY","KEY_SELECT_KEY","KEY_NUMPAD_0","KEY_NUMPAD_1","KEY_NUMPAD_2","KEY_NUMPAD_3","KEY_NUMPAD_4","KEY_NUMPAD_5","KEY_NUMPAD_6","KEY_NUMPAD_7","KEY_NUMPAD_8","KEY_NUMPAD_9","KEY_MULTIPLY","KEY_ADD","KEY_SUBTRACT","KEY_DECIMAL_POINT","KEY_DIVIDE","KEY_F1","KEY_F2","KEY_F3","KEY_F4","KEY_F5","KEY_F6","KEY_F7","KEY_F8","KEY_F9","KEY_F10","KEY_F12","KEY_NUM_LOCK","KEY_SCROLL_LOCK","KEY_SEMI_COLON","KEY_EQUAL_SIGN","KEY_COMMA","KEY_DASH","KEY_PERIOD","KEY_FORWARD_SLASH","KEY_GRAVE_ACCENT","KEY_OPEN_BRACKET","KEY_BACK_SLASH","KEY_CLOSE_BRACKET","KEY_SINGLE_QUOTE","KEY_LEFT_COMMAND","KEY_RIGHT_COMMAND","KEY_MOUSE_3","KEY_MOUSE_4","KEY_MOUSE_5","KEY_MOUSE_6","KEY_MOUSE_7","KEY_MOUSE_8","KEY_MOUSE_9","KEY_MOUSE_10","PrototypeObject","interfaces","scope","implement","_PrototypeInterface2","PrototypeInterface","Handler","_isEnabled","eventHandler","status","disable","_IHandler2","EngineComponent","_IEngineComponent2","Device","DeviceName","UUID","c","r","SystemConsole","link","log","level","documentWidth","parseInt","documentElement","documentHeight","innerWidth","innerHeight","_Vector2dInteger2","FrameHandler","_this2","_loop","_engineStack","_data","_breakAnimationFrame","CancelAnimationFrame","RequestAnimationFrame","engine","_state","engineHandler","guid","_Handler2","instance","requestAnimationFrame","webkitRequestAnimationFrame","mozRequestAnimationFrame","oRequestAnimationFrame","msRequestAnimationFrame","MAX_SAFE_INTEGER","cancelAnimationFrame","webkitCancelAnimationFrame","mozCancelAnimationFrame","oCancelAnimationFrame","msCancelAnimationFrame","InputHandler","KEYBOARD","JOYSTICK","MOUSE","TOUCH","KEY","keyCodeMap","newKeyCodeMap","oldKeyCodeMap","_getPressData","map","toUpperCase","defaultIO","bindListeners","unBindListeners","getKeyByCode","EventHandler","InvalidArgumentException","IEngineComponent","Engine","_$classPreInitialize","_RuntimeException2","_IEngine2","EngineJ2D","_Device2","_SystemConsole2","_element","components","_initialized","tryLoadComponents","frame","classList","logger","_EventHandler2","_InputHandler2","_FrameHandler2","handler","instanceOf","_InvalidArgumentException2","MediaHandler","TweenHandler","SceneHandler","selected","resumeEventListener","getAttribute","resume","resumeBind","jQuery","inactiveNodes","hasAttribute","setAttribute","tabIndex","_Engine3","click","activeNodes","initPlugin","fullScreenEventListener","isFullScreen","querySelector","resizeToFullPage","logSystem","VERSION","firefox","match","version","webkitFullscreenElement","webkitCurrentFullScreenElement","mozFullScreenElement","fullscreenElement","msFullscreenElement","html","onResize"],"mappings":"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","file":"j2d.min.js","sourcesContent":["let InterpolationEnum;\r\n\r\n/**\r\n * @class Interpolation\r\n * @exports module:transitions/utils/Interpolation\r\n *\r\n * @type {{Linear: Interpolation.Linear, Bezier: Interpolation.Bezier, CatmullRom: Interpolation.CatmullRom}}\r\n */\r\nlet Interpolation = {\r\n    /**\r\n     * @return {number}\r\n     */\r\n    Linear: function (v, k) {\r\n        var m = v.length - 1;\r\n        var f = m * k;\r\n        var i = Math.floor(f);\r\n        var fn = Interpolation.Utils.Linear;\r\n\r\n        if (k < 0) return fn(v[0], v[1], f);\r\n        if (k > 1) return fn(v[m], v[m - 1], m - f);\r\n\r\n        return fn(v[i], v[i + 1 > m ? m : i + 1], f - i);\r\n    },\r\n\r\n    /**\r\n     * @return {number}\r\n     */\r\n    Bezier: function (v, k) {\r\n        var b = 0;\r\n        var n = v.length - 1;\r\n        var pw = Math.pow;\r\n        var bn = Interpolation.Utils.Bernstein;\r\n\r\n        for (var i = 0; i <= n; i++) {\r\n            b += pw(1 - k, n - i) * pw(k, i) * v[i] * bn(n, i);\r\n        }\r\n\r\n        return b;\r\n    },\r\n\r\n    /**\r\n     * @return {number}\r\n     */\r\n    CatmullRom: function (v, k) {\r\n        var m = v.length - 1;\r\n        var f = m * k;\r\n        var i = Math.floor(f);\r\n        var fn = Interpolation.Utils.CatmullRom;\r\n\r\n        if (v[0] === v[m]) {\r\n            if (k < 0) i = Math.floor(f = m * (1 + k));\r\n\r\n            return fn(v[(i - 1 + m) % m], v[i], v[(i + 1) % m], v[(i + 2) % m], f - i);\r\n        } else {\r\n            if (k < 0) return v[0] - (fn(v[0], v[0], v[1], v[1], -f) - v[0]);\r\n            if (k > 1) return v[m] - (fn(v[m], v[m], v[m - 1], v[m - 1], f - m) - v[m]);\r\n\r\n            return fn(v[i ? i - 1 : 0], v[i], v[m < i + 1 ? m : i + 1], v[m < i + 2 ? m : i + 2], f - i);\r\n        }\r\n    },\r\n\r\n    Utils: {\r\n        /**\r\n         * @return {number}\r\n         */\r\n        Linear: function (p0, p1, t) {\r\n            return (p1 - p0) * t + p0;\r\n        },\r\n\r\n        /**\r\n         * @return {number}\r\n         */\r\n        Bernstein: function (n, i) {\r\n            var fc = Interpolation.Utils.Factorial;\r\n            return fc(n) / fc(i) / fc(n - i);\r\n        },\r\n\r\n        Factorial: (function () {\r\n            var a = [1];\r\n            return function (n) {\r\n                var s = 1;\r\n                if (a[n]) return a[n];\r\n\r\n                for (var i = n; i > 1; i--) {\r\n                    s *= i;\r\n                }\r\n                a[n] = s;\r\n\r\n                return s;\r\n            };\r\n        })(),\r\n\r\n        /**\r\n         * @return {number}\r\n         */\r\n        CatmullRom: function (p0, p1, p2, p3, t) {\r\n            var v0 = (p2 - p0) * 0.5;\r\n            var v1 = (p3 - p1) * 0.5;\r\n            var t2 = t * t;\r\n            var t3 = t * t2;\r\n\r\n            return (2 * p1 - 2 * p2 + v0 + v1) * t3 + (-3 * p1 + 3 * p2 - 2 * v0 - v1) * t2 + v0 * t + p1;\r\n        }\r\n    },\r\n\r\n    get: (interpolation) => {\r\n        if (InterpolationEnum[interpolation] !== undefined) {\r\n            return InterpolationEnum[interpolation];\r\n        }\r\n\r\n        // TODO:: Exceptions\r\n        //throw new InvalidArgumentException('Unknown interpolation: ' + interpolation);\r\n    },\r\n\r\n    register: (interpolation, interpolationFunction) => {\r\n        InterpolationEnum[interpolation] = interpolationFunction;\r\n    }\r\n};\r\n\r\nInterpolationEnum = {\r\n    'linear': Interpolation.Linear,\r\n    'bezier': Interpolation.Bezier,\r\n    'catmull-rom': Interpolation.CatmullRom\r\n};\r\n\r\nexport default Interpolation;\r\n","import Tween from \"transitions/Tween\";\r\n\r\nlet EasingEnum;\r\n\r\n/**\r\n * @class Easing\r\n * @exports module:transitions/utils/Easing\r\n *\r\n * @type {{Linear: {None: Easing.Linear.None}, Quadratic: {In: Easing.Quadratic.In, Out: Easing.Quadratic.Out, InOut: Easing.Quadratic.InOut}, Cubic: {In: Easing.Cubic.In, Out: Easing.Cubic.Out, InOut: Easing.Cubic.InOut}, Quartic: {In: Easing.Quartic.In, Out: Easing.Quartic.Out, InOut: Easing.Quartic.InOut}, Quintic: {In: Easing.Quintic.In, Out: Easing.Quintic.Out, InOut: Easing.Quintic.InOut}, Sinusoidal: {In: Easing.Sinusoidal.In, Out: Easing.Sinusoidal.Out, InOut: Easing.Sinusoidal.InOut}, Exponential: {In: Easing.Exponential.In, Out: Easing.Exponential.Out, InOut: Easing.Exponential.InOut}, Circular: {In: Easing.Circular.In, Out: Easing.Circular.Out, InOut: Easing.Circular.InOut}, Elastic: {In: Easing.Elastic.In, Out: Easing.Elastic.Out, InOut: Easing.Elastic.InOut}, Back: {In: Easing.Back.In, Out: Easing.Back.Out, InOut: Easing.Back.InOut}, Bounce: {In: Easing.Bounce.In, Out: Easing.Bounce.Out, InOut: Easing.Bounce.InOut}}}\r\n */\r\nlet Easing = {\r\n    Linear: {\r\n        /**\r\n         * @return {number}\r\n         */\r\n        None: function (k) {\r\n            return k;\r\n        }\r\n    },\r\n    Quadratic: {\r\n        /**\r\n         * @return {number}\r\n         */\r\n        In: function (k) {\r\n            return k * k;\r\n        },\r\n\r\n        /**\r\n         * @return {number}\r\n         */\r\n        Out: function (k) {\r\n            return k * (2 - k);\r\n        },\r\n\r\n        /**\r\n         * @return {number}\r\n         */\r\n        InOut: function (k) {\r\n            if ((k *= 2) < 1) return 0.5 * k * k;\r\n            return -0.5 * (--k * (k - 2) - 1);\r\n        }\r\n    },\r\n\r\n    Cubic: {\r\n        /**\r\n         * @return {number}\r\n         */\r\n        In: function (k) {\r\n            return k * k * k;\r\n        },\r\n\r\n        /**\r\n         * @return {number}\r\n         */\r\n        Out: function (k) {\r\n            return --k * k * k + 1;\r\n        },\r\n\r\n        /**\r\n         * @return {number}\r\n         */\r\n        InOut: function (k) {\r\n            if ((k *= 2) < 1) return 0.5 * k * k * k;\r\n            return 0.5 * ((k -= 2) * k * k + 2);\r\n        }\r\n    },\r\n\r\n    Quartic: {\r\n        /**\r\n         * @return {number}\r\n         */\r\n        In: function (k) {\r\n            return k * k * k * k;\r\n        },\r\n\r\n        /**\r\n         * @return {number}\r\n         */\r\n        Out: function (k) {\r\n            return 1 - (--k * k * k * k);\r\n        },\r\n\r\n        /**\r\n         * @return {number}\r\n         */\r\n        InOut: function (k) {\r\n            if ((k *= 2) < 1)  return 0.5 * k * k * k * k;\r\n            return -0.5 * ((k -= 2) * k * k * k - 2);\r\n        }\r\n    },\r\n\r\n    Quintic: {\r\n        /**\r\n         * @return {number}\r\n         */\r\n        In: function (k) {\r\n            return k * k * k * k * k;\r\n        },\r\n\r\n        /**\r\n         * @return {number}\r\n         */\r\n        Out: function (k) {\r\n            return --k * k * k * k * k + 1;\r\n        },\r\n\r\n        /**\r\n         * @return {number}\r\n         */\r\n        InOut: function (k) {\r\n            if ((k *= 2) < 1) return 0.5 * k * k * k * k * k;\r\n            return 0.5 * ((k -= 2) * k * k * k * k + 2);\r\n        }\r\n\r\n    },\r\n\r\n    Sinusoidal: {\r\n        /**\r\n         * @return {number}\r\n         */\r\n        In: function (k) {\r\n            return 1 - Math.cos(k * Math.PI / 2);\r\n        },\r\n\r\n        /**\r\n         * @return {number}\r\n         */\r\n        Out: function (k) {\r\n            return Math.sin(k * Math.PI / 2);\r\n        },\r\n\r\n        /**\r\n         * @return {number}\r\n         */\r\n        InOut: function (k) {\r\n            return 0.5 * (1 - Math.cos(Math.PI * k));\r\n        }\r\n    },\r\n\r\n    Exponential: {\r\n        /**\r\n         * @return {number}\r\n         */\r\n        In: function (k) {\r\n            return k === 0 ? 0 : Math.pow(1024, k - 1);\r\n        },\r\n\r\n        /**\r\n         * @return {number}\r\n         */\r\n        Out: function (k) {\r\n            return k === 1 ? 1 : 1 - Math.pow(2, -10 * k);\r\n        },\r\n\r\n        /**\r\n         * @return {number}\r\n         */\r\n        InOut: function (k) {\r\n            if (k === 0) return 0;\r\n            if (k === 1) return 1;\r\n            if ((k *= 2) < 1) return 0.5 * Math.pow(1024, k - 1);\r\n\r\n            return 0.5 * (-Math.pow(2, -10 * (k - 1)) + 2);\r\n        }\r\n    },\r\n\r\n    Circular: {\r\n        /**\r\n         * @return {number}\r\n         */\r\n        In: function (k) {\r\n            return 1 - Math.sqrt(1 - k * k);\r\n        },\r\n\r\n        /**\r\n         * @return {number}\r\n         */\r\n        Out: function (k) {\r\n            return Math.sqrt(1 - (--k * k));\r\n        },\r\n\r\n        /**\r\n         * @return {number}\r\n         */\r\n        InOut: function (k) {\r\n            if ((k *= 2) < 1) return -0.5 * (Math.sqrt(1 - k * k) - 1);\r\n            return 0.5 * (Math.sqrt(1 - (k -= 2) * k) + 1);\r\n        }\r\n    },\r\n\r\n    Elastic: {\r\n        /**\r\n         * @return {number}\r\n         */\r\n        In: function (k) {\r\n            var s;\r\n            var a = 0.1;\r\n            var p = 0.4;\r\n\r\n            if (k === 0) return 0;\r\n            if (k === 1) return 1;\r\n\r\n            if (!a || a < 1) {\r\n                a = 1;\r\n                s = p / 4;\r\n            } else {\r\n                s = p * Math.asin(1 / a) / (2 * Math.PI);\r\n            }\r\n\r\n            return -(a * Math.pow(2, 10 * (k -= 1)) * Math.sin((k - s) * (2 * Math.PI) / p));\r\n        },\r\n\r\n        /**\r\n         * @return {number}\r\n         */\r\n        Out: function (k) {\r\n            var s;\r\n            var a = 0.1;\r\n            var p = 0.4;\r\n\r\n            if (k === 0) return 0;\r\n            if (k === 1) return 1;\r\n\r\n            if (!a || a < 1) {\r\n                a = 1;\r\n                s = p / 4;\r\n            } else {\r\n                s = p * Math.asin(1 / a) / (2 * Math.PI);\r\n            }\r\n\r\n            return (a * Math.pow(2, -10 * k) * Math.sin((k - s) * (2 * Math.PI) / p) + 1);\r\n        },\r\n\r\n        /**\r\n         * @return {number}\r\n         */\r\n        InOut: function (k) {\r\n\r\n            var s;\r\n            var a = 0.1;\r\n            var p = 0.4;\r\n\r\n            if (k === 0) return 0;\r\n            if (k === 1) return 1;\r\n\r\n            if (!a || a < 1) {\r\n                a = 1;\r\n                s = p / 4;\r\n            } else {\r\n                s = p * Math.asin(1 / a) / (2 * Math.PI);\r\n            }\r\n\r\n            if ((k *= 2) < 1) {\r\n                return -0.5 * (a * Math.pow(2, 10 * (k -= 1)) * Math.sin((k - s) * (2 * Math.PI) / p));\r\n            }\r\n\r\n            return a * Math.pow(2, -10 * (k -= 1)) * Math.sin((k - s) * (2 * Math.PI) / p) * 0.5 + 1;\r\n\r\n        }\r\n\r\n    },\r\n\r\n    Back: {\r\n        /**\r\n         * @return {number}\r\n         */\r\n        In: function (k) {\r\n            var s = 1.70158;\r\n\r\n            return k * k * ((s + 1) * k - s);\r\n        },\r\n\r\n        /**\r\n         * @return {number}\r\n         */\r\n        Out: function (k) {\r\n            var s = 1.70158;\r\n\r\n            return --k * k * ((s + 1) * k + s) + 1;\r\n        },\r\n\r\n        /**\r\n         * @return {number}\r\n         */\r\n        InOut: function (k) {\r\n            var s = 1.70158 * 1.525;\r\n            if ((k *= 2) < 1) return 0.5 * (k * k * ((s + 1) * k - s));\r\n\r\n            return 0.5 * ((k -= 2) * k * ((s + 1) * k + s) + 2);\r\n        }\r\n    },\r\n\r\n    Bounce: {\r\n        /**\r\n         * @return {number}\r\n         */\r\n        In: function (k) {\r\n            return 1 - Tween.Easing.Bounce.Out(1 - k);\r\n        },\r\n\r\n        /**\r\n         * @return {number}\r\n         */\r\n        Out: function (k) {\r\n            if (k < (1 / 2.75)) {\r\n                return 7.5625 * k * k;\r\n            } else if (k < (2 / 2.75)) {\r\n                return 7.5625 * (k -= (1.5 / 2.75)) * k + 0.75;\r\n            } else if (k < (2.5 / 2.75)) {\r\n                return 7.5625 * (k -= (2.25 / 2.75)) * k + 0.9375;\r\n            } else {\r\n                return 7.5625 * (k -= (2.625 / 2.75)) * k + 0.984375;\r\n            }\r\n        },\r\n\r\n        /**\r\n         * @return {number}\r\n         */\r\n        InOut: function (k) {\r\n            if (k < 0.5) return Tween.Easing.Bounce.In(k * 2) * 0.5;\r\n            return Tween.Easing.Bounce.Out(k * 2 - 1) * 0.5 + 0.5;\r\n        }\r\n    },\r\n\r\n    get: (easing) => {\r\n        if (EasingEnum[easing] !== undefined) {\r\n            return EasingEnum[easing];\r\n        }\r\n\r\n        // TODO:: Exceptions\r\n        //throw new InvalidArgumentException('Unknown easing: ' + easing);\r\n    },\r\n    register: (easing, easingFunction) => {\r\n        EasingEnum[easing] = easingFunction;\r\n    }\r\n};\r\n\r\nEasingEnum = {\r\n    'linear': Easing.Linear.None,\r\n\r\n    'quadratic-in': Easing.Quadratic.In,\r\n    'quadratic-out': Easing.Quadratic.Out,\r\n    'quadratic-in-out': Easing.Quadratic.InOut,\r\n\r\n    'cubic-in': Easing.Cubic.In,\r\n    'cubic-out': Easing.Cubic.Out,\r\n    'cubic-in-out': Easing.Cubic.InOut,\r\n\r\n    'quartic-in': Easing.Quartic.In,\r\n    'quartic-out': Easing.Quartic.Out,\r\n    'quartic-in-out': Easing.Quartic.InOut,\r\n\r\n    'quintic-in': Easing.Quintic.In,\r\n    'quintic-out': Easing.Quintic.Out,\r\n    'quintic-in-out': Easing.Quintic.InOut,\r\n\r\n    'sinusoidal-in': Easing.Sinusoidal.In,\r\n    'sinusoidal-out': Easing.Sinusoidal.Out,\r\n    'sinusoidal-in-out': Easing.Sinusoidal.InOut,\r\n\r\n    'exponential-in': Easing.Exponential.In,\r\n    'exponential-out': Easing.Exponential.Out,\r\n    'exponential-in-out': Easing.Exponential.InOut,\r\n\r\n    'circular-in': Easing.Circular.In,\r\n    'circular-out': Easing.Circular.Out,\r\n    'circular-in-out': Easing.Circular.InOut,\r\n\r\n    'elastic-in': Easing.Elastic.In,\r\n    'elastic-out': Easing.Elastic.Out,\r\n    'elastic-in-out': Easing.Elastic.InOut,\r\n\r\n    'back-in': Easing.Back.In,\r\n    'back-out': Easing.Back.Out,\r\n    'back-in-out': Easing.Back.InOut,\r\n\r\n    'bounce-in': Easing.Bounce.In,\r\n    'bounce-out': Easing.Bounce.Out,\r\n    'bounce-in-out': Easing.Bounce.InOut\r\n};\r\n\r\nexport default Easing;\r\n","import PrototypeInterface from \"api/PrototypeInterface\";\r\n\r\n/**\r\n * IInputHandler\r\n * @constructor\r\n */\r\nexport default class IInputHandler extends PrototypeInterface {\r\n};\r\n","import PrototypeInterface from \"api/PrototypeInterface\";\r\n\r\n/**\r\n * IHandler\r\n * @constructor\r\n */\r\nexport default class IHandler extends PrototypeInterface {\r\n}\r\n","import PrototypeInterface from \"api/PrototypeInterface\";\r\n\r\n/**\r\n * IEngine\r\n * @constructor\r\n */\r\nexport default class IEngine extends PrototypeInterface {\r\n};\r\n","import Pointer from \"io/devices/Pointer\";\r\n\r\nexport default class Touch extends Pointer {\r\n    static DeviceName = Pointer.prototype.constructor.name; // this fix device name in InputHandler\r\n\r\n    constructor(input) {\r\n        super(input);\r\n    }\r\n\r\n    init(input) {\r\n        if (input !== undefined && this.input === undefined) this.input = input;\r\n        return true;\r\n    };\r\n\r\n    update() {\r\n        return true;\r\n    };\r\n\r\n    clear() {\r\n        return true;\r\n    };\r\n\r\n    enable() {\r\n        throw new Error('Error. IO interface \"' + Touch.IO + '\" exist, but not supported yet.');\r\n        //return true;\r\n    };\r\n\r\n    disable() {\r\n        throw new Error('Error. IO interface \"' + Touch.IO + '\" exist, but not supported yet.');\r\n        //return true;\r\n    };\r\n}\r\n","import Device from \"api/Device\";\r\n\r\nexport default class Pointer extends Device {\r\n    constructor(input) {\r\n        super(input);\r\n        if (this.constructor.name === 'Pointer') {\r\n            throw new Error('Error. Pointer is abstract class.');\r\n        }\r\n    }\r\n\r\n    setPointerImage(image) {\r\n        if (image) {\r\n            switch (image) {\r\n                case 'none':\r\n                case 'default':\r\n                case 'auto':\r\n                case 'crosshair':\r\n                case 'e-resize':\r\n                case 'help':\r\n                case 'move':\r\n                case 'n-resize':\r\n                case 'ne-resize':\r\n                case 'nw-resize':\r\n                case 'pointer':\r\n                case 'progress':\r\n                case 's-resize':\r\n                case 'se-resize':\r\n                case 'sw-resize':\r\n                case 'text':\r\n                case 'w-resize':\r\n                case 'wait':\r\n                case 'inherit':\r\n                    break;\r\n                default:\r\n                    image = 'url(\"' + image + '\"), auto'\r\n            }\r\n        }\r\n        this.input.data.pointer.image = this.input.store.pointer.image = this.input.options.cursor = image;\r\n        window.document.body.style.cursor = this.input.data.pointer.image;\r\n        return this;\r\n    };\r\n\r\n    toggleCursor(toggle) {\r\n        if (this.input.data.image !== 'none' && (toggle === undefined || toggle === false)) {\r\n            this.input.store.pointer.image = window.document.body.style.cursor;\r\n            window.document.body.style.cursor = 'none';\r\n        } else {\r\n            window.document.body.style.cursor = this.input.store.pointer.image;\r\n        }\r\n        return this;\r\n    };\r\n\r\n    isPointerVisible() {\r\n        return this.input.data.pointer.image === 'none';\r\n    };\r\n\r\n    getPointerPosition() {\r\n        if (this.data.pointer === undefined) return [0, 0];\r\n        return [this.data.pointer.x, this.data.pointer.y];\r\n    };\r\n\r\n    getPointerMoveDistance() {\r\n        if (this.data.pointer === undefined) return 0;\r\n        return this.data.pointer.distance;\r\n    };\r\n}\r\n","import Pointer from \"io/devices/Pointer\";\r\n\r\nexport default class Mouse extends Pointer {\r\n    static DeviceName = Pointer.prototype.constructor.name; // this fix device name in InputHandler\r\n\r\n    __fixMouseButtonId = (id) => {\r\n        if (id > 2) {\r\n            return id;\r\n        } else if (id === 0) {\r\n            return 'LEFT';\r\n        } else if (id === 1) {\r\n            return 'MIDDLE';\r\n        } else if (id === 2) {\r\n            return 'RIGHT';\r\n        }\r\n    };\r\n\r\n    keyMouseDownEventHandler = (e) => {\r\n        if (this.input.isEnabled && this.input.preventDefault) e.preventDefault();\r\n\r\n        let keyCode = this.input.KEYS_HELPER.getKeyById('KEY_MOUSE_' + this.__fixMouseButtonId(e.button));\r\n        if (!this.input.data.keys.keysDown.includes(keyCode)) {\r\n            this.input.data.keys.keysDown.push(keyCode);\r\n        }\r\n\r\n        this.input.store.recordMouseDragDistance = true;\r\n        this.input.store.pointer = {\r\n            tracker: {\r\n                x: e.pageX,\r\n                y: e.pageY\r\n            }\r\n        };\r\n\r\n        this.input.store.recordMouseClickTime = true;\r\n        if (this.input.store.keys.pressedTime[keyCode] !== undefined) {\r\n            this.input.store.keys.pressedTime[keyCode].delta = this.input.store.keys.pressedTime[keyCode].startTime - e.timeStamp\r\n        } else {\r\n            this.input.store.keys.pressedTime[keyCode] = {\r\n                startTime: e.timeStamp,\r\n                delta: 0\r\n            };\r\n        }\r\n\r\n        this.input.events.trigger('io.mouseKeyDown', e);\r\n    };\r\n\r\n    keyMouseUpEventHandler = (e) => {\r\n        if (this.input.isEnabled && this.input.preventDefault) e.preventDefault();\r\n\r\n        let keyCode = this.input.KEYS_HELPER.getKeyById('KEY_MOUSE_' + this.__fixMouseButtonId(e.button));\r\n        if (!this.input.data.keys.keysUp.includes(keyCode)) {\r\n            this.input.data.keys.keysUp.push(keyCode);\r\n        }\r\n\r\n        this.input.store.recordMouseDragDistance = false;\r\n        this.input.data.pointer.distance = 0;\r\n        this.input.store.pointer = {\r\n            tracker: {\r\n                x: 0,\r\n                y: 0\r\n            }\r\n        };\r\n\r\n        this.input.store.recordMouseClickTime = false;\r\n        if (this.input.store.keys.pressedTime[keyCode] !== undefined) {\r\n            this.input.store.keys.pressedTime.splice(keyCode, 1)\r\n        }\r\n\r\n        this.input.events.trigger('io.mouseKeyUp', e);\r\n    };\r\n\r\n    keyMouseMoveEventHandler = (e) => {\r\n        if (this.input.isEnabled && this.input.preventDefault) e.preventDefault();\r\n\r\n        this.input.data.pointer = {\r\n            x: e.pageX,\r\n            y: e.pageY,\r\n            distance: (this.input.store.recordMouseDragDistance) ? Math.sqrt(\r\n                Math.pow((e.pageX - this.input.store.pointer.tracker.x), 2)\r\n                + Math.pow((e.pageY - this.input.store.pointer.tracker.y), 2)\r\n            ).toFixed(2) : 0.0,\r\n            image: this.input.data.pointer.image\r\n        };\r\n\r\n        this.input.events.trigger('io.mouseMove', e);\r\n    };\r\n\r\n    scrollMouseEventHandler = (e) => {\r\n        if (this.input.isEnabled && this.input.preventDefault) e.preventDefault();\r\n\r\n        let keyCode = (e.wheelDelta / 120 > 0)\r\n            ? this.input.KEYS_HELPER.getKeyById('SCROLL_MOUSE_UP')\r\n            : this.input.KEYS_HELPER.getKeyById('SCROLL_MOUSE_DOWN');\r\n\r\n        if (!this.input.data.keys.keysUp.includes(keyCode)) {\r\n            this.input.data.keys.keysUp.push(keyCode);\r\n            this.input.data.keys.keysDown.push(keyCode);\r\n        }\r\n\r\n        this.input.events.trigger('io.mouseScroll', e);\r\n    };\r\n\r\n    constructor(input) {\r\n        super(input);\r\n\r\n        this.keyMouseDownEventHandler = this.keyMouseDownEventHandler.bind(this);\r\n        this.keyMouseUpEventHandler = this.keyMouseUpEventHandler.bind(this);\r\n        this.keyMouseMoveEventHandler = this.keyMouseMoveEventHandler.bind(this);\r\n        this.scrollMouseEventHandler = this.scrollMouseEventHandler.bind(this);\r\n    }\r\n\r\n    init(input) {\r\n        if (input !== undefined && this.input === undefined) this.input = input;\r\n        this.input.data.keys = {\r\n            keysUp: [],\r\n            keysDown: []\r\n        };\r\n        this.input.store.keys = {\r\n            pressedTime: []\r\n        };\r\n        this.input.data.pointer = {\r\n            image: this.input.options.cursor || 'none',\r\n            x: 0,\r\n            y: 0,\r\n            distance: 0\r\n        };\r\n        this.input.store.pointer = {\r\n            tracker: {\r\n                x: 0,\r\n                y: 0\r\n            },\r\n            image: this.input.options.cursor || 'none'\r\n        };\r\n        this.input.store.recordMouseDragDistance = false;\r\n        this.input.store.recordMouseClickTime = false;\r\n        this.setPointerImage(this.input.options.cursor || 'none');\r\n    };\r\n\r\n    update() {\r\n        //TODO:: fix pointer by viewport scene\r\n        return true;\r\n    };\r\n\r\n    clear() {\r\n        if (this.input.data.keys !== undefined) {\r\n            this.input.data.keys = {\r\n                keysUp: [],\r\n                keysDown: []\r\n            };\r\n        }\r\n        if (this.input.data.pointer !== undefined) {\r\n            this.input.data.pointer = {\r\n                image: this.input.options.pointer || 'none',\r\n                x: 0,\r\n                y: 0,\r\n                distance: 0\r\n            };\r\n        }\r\n        return true;\r\n    };\r\n\r\n    enable() {\r\n        window.addEventListener('mousedown', this.keyMouseDownEventHandler, false);\r\n        window.addEventListener('mouseup', this.keyMouseUpEventHandler, false);\r\n        window.addEventListener('mousemove', this.keyMouseMoveEventHandler, false);\r\n        window.addEventListener('wheel', this.scrollMouseEventHandler, false);\r\n        return true;\r\n    };\r\n\r\n    disable() {\r\n        window.removeEventListener('mousedown', this.keyMouseDownEventHandler, false);\r\n        window.removeEventListener('mouseup', this.keyMouseUpEventHandler, false);\r\n        window.removeEventListener('mousemove', this.keyMouseMoveEventHandler, false);\r\n        window.removeEventListener('wheel', this.scrollMouseEventHandler, false);\r\n        return true;\r\n    };\r\n}\r\n","import Device from \"api/Device\";\r\n\r\nexport default class Keyboard extends Device {\r\n    keyDownEventHandler = (e) => {\r\n        if (this.input.isEnabled && this.input.preventDefault) e.preventDefault();\r\n        if (!this.input.data.keys.keysDown.includes(e.keyCode)) {\r\n            this.input.data.keys.keysDown.push(e.keyCode);\r\n        }\r\n\r\n        this.input.store.recordKeyPressTime = true;\r\n        if (this.input.store.keys.pressedTime[e.keyCode] !== undefined) {\r\n            this.input.store.keys.pressedTime[e.keyCode].delta = this.input.store.keys.pressedTime[e.keyCode].startTime - e.timeStamp\r\n        } else {\r\n            this.input.store.keys.pressedTime[e.keyCode] = {\r\n                startTime: e.timeStamp,\r\n                delta: 0\r\n            };\r\n        }\r\n\r\n        this.input.events.trigger('io.keyboardKeyDown', e);\r\n    };\r\n\r\n    keyUpEventHandler = (e) => {\r\n        if (this.input.isEnabled && this.input.preventDefault) e.preventDefault();\r\n        if (!this.input.data.keys.keysUp.includes(e.keyCode)) {\r\n            this.input.data.keys.keysUp.push(e.keyCode);\r\n        }\r\n\r\n        this.input.store.recordKeyPressTime = false;\r\n        if (this.input.store.keys.pressedTime[e.keyCode] !== undefined) {\r\n            this.input.store.keys.pressedTime.splice(e.keyCode, 1)\r\n        }\r\n\r\n        this.input.events.trigger('io.keyboardKeyUp', e);\r\n    };\r\n\r\n    constructor(input) {\r\n        super(input);\r\n\r\n        this.keyDownEventHandler = this.keyDownEventHandler.bind(this);\r\n        this.keyUpEventHandler = this.keyUpEventHandler.bind(this);\r\n    }\r\n\r\n    init(input) {\r\n        if (input !== undefined && this.input === undefined) this.input = input;\r\n        this.input.data.keys = {\r\n            keysUp: [],\r\n            keysDown: []\r\n        };\r\n        this.input.store.keys = {\r\n            pressedTime: []\r\n        };\r\n        this.input.store.recordKeyPressTime = false;\r\n    };\r\n\r\n    update() {\r\n        return true;\r\n    };\r\n\r\n    clear() {\r\n        if (this.input.data.keys !== undefined) {\r\n            this.input.data.keys = {\r\n                keysUp: [],\r\n                keysDown: []\r\n            };\r\n        }\r\n        return true;\r\n    };\r\n\r\n    enable() {\r\n        window.addEventListener('keydown', this.keyDownEventHandler, false);\r\n        window.addEventListener('keyup', this.keyUpEventHandler, false);\r\n        return true;\r\n    };\r\n\r\n    disable() {\r\n        window.removeEventListener('keydown', this.keyDownEventHandler, false);\r\n        window.removeEventListener('keyup', this.keyUpEventHandler, false);\r\n        return true;\r\n    };\r\n};\r\n","import Device from \"api/Device\";\r\n\r\nexport default class Joystick extends Device {\r\n    constructor(input) {\r\n        super(input);\r\n    }\r\n\r\n    init(input) {\r\n        if (input !== undefined && this.input === undefined) this.input = input;\r\n        return true;\r\n    };\r\n\r\n    update() {\r\n        return true;\r\n    };\r\n\r\n    clear() {\r\n        return true;\r\n    };\r\n\r\n    enable() {\r\n        throw new Error('Error. IO interface \"' + Joystick.IO + '\" exist, but not supported yet.');\r\n        //return true;\r\n    };\r\n\r\n    disable() {\r\n        throw new Error('Error. IO interface \"' + Joystick.IO + '\" exist, but not supported yet.');\r\n        //return true;\r\n    };\r\n}\r\n\r\n","import ArrayMap from \"utils/ArrayMap\";\r\nimport CameraNode from \"nodes/CameraNode\";\r\nimport Vector2d from \"utils/Vector2d\";\r\n\r\n/**\r\n * @param {{x: number, y: number, offsetX: number, offsetY: number}} screen\r\n * @param {{offset: {x: number, y: number}, size: {x: number, y: number}, scale: number, angle: number}} viewport\r\n * @returns {{offset: {x: number, y: number}, size: {x: number, y: number}, scale: number, angle: number}}\r\n */\r\nvar calculateScale = function (screen, viewport) {\r\n    var data = {\r\n        offset: {x: 0, y: 0},\r\n        size: {x: 0, y: 0},\r\n        scale: 1.0,\r\n        angle: viewport.angle\r\n    };\r\n\r\n    data.offset.x = screen.offsetX + viewport.offset.x;\r\n    data.offset.y = screen.offsetY + viewport.offset.y;\r\n\r\n    data.size.x = (screen.x < viewport.size.x) ? screen.x : viewport.size.x;\r\n    data.size.y = (screen.y < viewport.size.y) ? screen.y : viewport.size.y;\r\n\r\n    data.scale = viewport.scale * (((screen.x / viewport.size.x) + (screen.y / viewport.size.y)) / 2);\r\n    return data;\r\n};\r\n\r\n/**\r\n * @class ViewportManager\r\n * @exports module:core/ViewportManager\r\n *\r\n * @constructor\r\n *\r\n * @property {ArrayMap.<CameraNode>|CameraNode[]} cameras\r\n * @property {string} camera\r\n * @property {{x: number, y: number, offsetX: number, offsetY: number}} screen\r\n * @property {boolean} init\r\n * @property {{offset: {x: number, y: number}, size: {x: number, y: number}, scale: number, angle: number}} data\r\n */\r\nexport default class ViewportManager {\r\n    constructor() {\r\n        /** @type ArrayMap.<CameraNode>|CameraNode[] */\r\n        this.cameras = new ArrayMap();\r\n\r\n        /** @type string */\r\n        this.camera = 'No active cameras';\r\n\r\n        /** @type {{x: number, y: number, offsetX: number, offsetY: number}} */\r\n        this.screen = {\r\n            x: 0,\r\n            y: 0,\r\n            offsetX: 0,\r\n            offsetY: 0\r\n        };\r\n\r\n        this.init = false;\r\n\r\n        this.data = {\r\n            offset: {x: 0.0, y: 0.0},\r\n            size: {x: 0.0, y: 0.0},\r\n            scale: 1.0,\r\n            angle: 0.0\r\n        };\r\n    }\r\n\r\n    /**\r\n     * @param {{x: number|undefined, y: number|undefined}|Array<number>} data\r\n     * @returns {ViewportManager}\r\n     */\r\n    setScreen(data) {\r\n        if (typeof data == 'object') {\r\n            if (data instanceof Array && data.length == 2) {\r\n                this.screen = {\r\n                    x: data[0],\r\n                    y: data[1],\r\n                    offsetX: this.screen.offsetX,\r\n                    offsetY: this.screen.offsetY\r\n                };\r\n                return this;\r\n            }\r\n            if (data.x !== undefined && data.y !== undefined) {\r\n                this.screen = {\r\n                    x: data.x,\r\n                    y: data.y,\r\n                    offsetX: this.screen.offsetX,\r\n                    offsetY: this.screen.offsetY\r\n                };\r\n            }\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {{x: number|undefined, y: number|undefined}|Array<number>} data\r\n     * @returns {ViewportManager}\r\n     */\r\n    setOffset(data) {\r\n        if (typeof data == 'object') {\r\n            if (data instanceof Array && data.length == 2) {\r\n                this.screen = {\r\n                    x: this.screen.x,\r\n                    y: this.screen.y,\r\n                    offsetX: data[0],\r\n                    offsetY: data[1]\r\n                };\r\n                return this;\r\n            }\r\n            if (data.x !== undefined && data.y !== undefined) {\r\n                this.screen = {\r\n                    x: this.screen.x,\r\n                    y: this.screen.y,\r\n                    offsetX: data.x,\r\n                    offsetY: data.y\r\n                };\r\n            }\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {string} key\r\n     * @param {CameraNode} node\r\n     * @returns {ViewportManager}\r\n     */\r\n    addCamera(key, node) {\r\n        if (node instanceof CameraNode) {\r\n            this.cameras.add(key, node);\r\n            return this;\r\n        }\r\n        // throw new InvalidArgumentException('Unknown camera node type');\r\n    }\r\n\r\n    /**\r\n     * @param {string} key\r\n     * @returns {ViewportManager}\r\n     */\r\n    removeCamera(key) {\r\n        this.cameras.remove(key);\r\n        if (this.camera == key) {\r\n            this.camera = 'No active cameras';\r\n            this.data = {\r\n                offset: {x: 0.0, y: 0.0},\r\n                size: {x: 0.0, y: 0.0},\r\n                scale: 1.0,\r\n                angle: 0.0\r\n            }\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {string} key\r\n     * @returns {ViewportManager}\r\n     */\r\n    updateViewport(key) {\r\n        if (this.cameras[key] !== undefined && this.cameras[key] instanceof CameraNode) {\r\n            this.data = this.cameras[key].getCameraViewport(this.screen, calculateScale);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @deprecated Please use CameraNode\r\n     *\r\n     * @param {Vector2d|null} [offset]\r\n     * @param {Vector2d|null} [size]\r\n     * @returns {ViewportManager}\r\n     */\r\n    setViewport(offset, size) {\r\n        if (offset !== undefined && typeof offset == 'object') {\r\n            if (offset instanceof Vector2d) {\r\n                this.data.offset = offset.getVector();\r\n            }\r\n        }\r\n\r\n        if (size !== undefined && typeof size == 'object') {\r\n            if (size instanceof Vector2d) {\r\n                this.data.size = size.getVector();\r\n            }\r\n        }\r\n\r\n        this.data = calculateScale(this.screen, this.data);\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {{offset: {x: number, y: number}, size: {x: number, y: number}, scale: number, angle: number}} viewport\r\n     * @returns {ViewportManager}\r\n     */\r\n    setDefaultViewport(viewport) {\r\n        if (!this.init) {\r\n            this.data = viewport;\r\n            this.init = true;\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @returns {{offset: {x: number, y: number}, size: {x: number, y: number}, scale: number, angle: number}}\r\n     */\r\n    getViewport() {\r\n        return this.data;\r\n    }\r\n}\r\n","import ObjectUtil from \"utils/ObjectUtil\";\r\nimport Vector2d from \"utils/Vector2d\";\r\nimport FrameManager from \"core/FrameManager\";\r\nimport LayersManager from \"core/LayersManager\";\r\nimport ViewportManager from \"core/ViewportManager\";\r\nimport GameStatesManager from \"core/GameStatesManager\";\r\n\r\n/**\r\n * @class SceneManager\r\n * @exports module:core/SceneManager\r\n *\r\n * @param {EngineJ2D} j2d\r\n * @constructor\r\n *\r\n * @property {SceneManager.defaults} data\r\n *\r\n * @property {string} backgroundColor\r\n * @property {number} opacity\r\n * @property {boolean} visible\r\n * @property {number} zIndex\r\n * @property {{x:number, y:number}} viewport\r\n */\r\nexport default class SceneManager {\r\n    static defaults = {\r\n        width: 0,\r\n        height: 0,\r\n\r\n        originalWidth: 0,\r\n        originalHeight: 0,\r\n        originalMargin: 0,\r\n\r\n        visible: true,\r\n        position: 'absolute',\r\n        top: 0,\r\n        left: 0,\r\n        zIndex: 1000,\r\n        opacity: 1.0,\r\n        backgroundColor: false,\r\n\r\n        frameLimit: 60,\r\n\r\n        enableFullScreen: false,\r\n\r\n        viewport: {x: 0, y: 0}\r\n    };\r\n\r\n    constructor(j2d) {\r\n        this.setGameCallback = this.setGameCallback.bind(this);\r\n        this.start = this.start.bind(this);\r\n\r\n        /** @type EngineJ2D */\r\n        this.j2d = j2d;\r\n\r\n        /** @type {HTMLCanvasElement} */\r\n        this.canvas = null;\r\n\r\n        /** @type {CanvasRenderingContext2D} */\r\n        this.context = null;\r\n\r\n        /** @type {FrameManager} */\r\n        this.frameManager = FrameManager.Init();\r\n\r\n        /** @type {LayersManager} */\r\n        this.layersManager = new LayersManager();\r\n\r\n        /** @type {ViewportManager} */\r\n        this.viewportManager = new ViewportManager();\r\n\r\n        /** @type {GameStatesManager} */\r\n        this.gameStatesManager = new GameStatesManager({}, this.setGameCallback);\r\n\r\n        this.initLayers();\r\n    }\r\n\r\n    get backgroundColor() {\r\n        return this.data.backgroundColor;\r\n    }\r\n\r\n    set backgroundColor(value) {\r\n        this.data.backgroundColor = value;\r\n        this.context.fillStyle = value;\r\n        this.context.fillRect(0, 0, this.data.width, this.data.height);\r\n    }\r\n\r\n    get opacity() {\r\n        return this.data.opacity;\r\n    }\r\n\r\n    set opacity(value) {\r\n        this.data.opacity = value;\r\n        this.canvas.style.opacity = value;\r\n    }\r\n\r\n    get visible() {\r\n        return this.data.visible;\r\n    }\r\n\r\n    set visible(value) {\r\n        this.data.visible = !!value;\r\n        this.canvas.style.display = (!!value) ? 'block' : 'none';\r\n    }\r\n\r\n    get zIndex() {\r\n        return 1000 - this.data.zIndex;\r\n    }\r\n\r\n    set zIndex(value) {\r\n        this.data.zIndex = 1000 + value;\r\n        this.canvas.style.zIndex = 1000 + value;\r\n    }\r\n\r\n    get viewport() {\r\n        return this.data.viewport;\r\n    }\r\n\r\n    /**\r\n     * @param {BaseGameState} state\r\n     * @returns {Function}\r\n     */\r\n    patchGameStateRender(state) {\r\n        var sceneManager = this;\r\n        var constructor = state.constructor;\r\n        if (typeof constructor === 'function' && constructor.prototype.render === undefined) {\r\n            constructor.prototype.render = function (timestamp, data) {\r\n                sceneManager.clear().fillBackground().render(data);\r\n                return true;\r\n            };\r\n        }\r\n        return constructor;\r\n    };\r\n\r\n    /**\r\n     * @param {SceneManager.defaults|Object|undefined} options\r\n     * @returns {SceneManager}\r\n     */\r\n    init(options) {\r\n        this.data = ObjectUtil.extend(true, {}, SceneManager.defaults, options);\r\n\r\n        this.j2d.trigger('beforeInit');\r\n\r\n        this.data.originalWidth = this.data.width;\r\n        this.data.originalHeight = this.data.height;\r\n        this.data.originalMargin = getComputedStyle(this.j2d.element)['margin'];\r\n\r\n        this.j2d.element.style.width = this.data.width + 'px';\r\n        this.j2d.element.style.height = this.data.height + 'px';\r\n\r\n        this.initCanvas();\r\n\r\n        this.viewportManager.setScreen({\r\n            x: this.data.width,\r\n            y: this.data.height\r\n        }).setDefaultViewport({\r\n            offset: {\r\n                x: 0.0,\r\n                y: 0.0\r\n            },\r\n            size: {\r\n                x: this.data.width,\r\n                y: this.data.height\r\n            },\r\n            scale: 1.0,\r\n            angle: 0.0\r\n        });\r\n\r\n        this.j2d.trigger('afterInit');\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @returns {SceneManager}\r\n     */\r\n    initLayers() {\r\n        if (!this.layersManager.getLayer('scene')) {\r\n            this.layersManager.addLayer('scene', 0);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @returns {SceneManager}\r\n     */\r\n    initCanvas() {\r\n        if (document.querySelectorAll('.j2d[guid=\"' + this.j2d.data.id + '\"] canvas').length === 0) {\r\n            this.canvas = document.createElement('canvas');\r\n\r\n            this.canvas.width = this.data.width;\r\n            this.canvas.height = this.data.height;\r\n            this.canvas.style.zIndex = this.data.zIndex;\r\n            this.canvas.style.position = this.data.position;\r\n\r\n            this.canvas.style.left = this.data.left;\r\n            this.canvas.style.top = this.data.top;\r\n\r\n            if (this.j2d.data.webGL) {\r\n                //WebGL2D.enable(this.canvas);\r\n                this.context = this.canvas.getContext('WebGL-2d');\r\n            } else {\r\n                this.context = this.canvas.getContext('2d');\r\n            }\r\n\r\n            if (!this.j2d.data.smoothing) {\r\n                this.j2d.util.disableSmoothing(this.context);\r\n            }\r\n\r\n            this.context.shadowColor = 'rgba(0,0,0,0)';\r\n            if (this.data.backgroundColor) this.backgroundColor = this.data.backgroundColor;\r\n            if (this.data.opacity) this.opacity = this.data.opacity;\r\n            if (this.data.visible) this.visible = this.data.visible;\r\n            if (this.data.zIndex) this.zIndex = 1000 - this.data.zIndex;\r\n\r\n            this.j2d.element.appendChild(this.canvas);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {{x:number, y:number}|Vector2d} [pos]\r\n     * @param {{x:number, y:number}|Vector2d} [size]\r\n     * @returns {SceneManager}\r\n     */\r\n    clear(pos, size) {\r\n        if (pos !== undefined && size !== undefined) {\r\n            this.context.clearRect(pos.x - this.viewport.x, pos.y - this.viewport.y, size.x, size.y);\r\n        } else {\r\n            this.context.clearRect(0, 0, this.data.width, this.data.height);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {number} width\r\n     * @param {number} height\r\n     * @returns {SceneManager}\r\n     */\r\n    resize(width, height) {\r\n        this.canvas.width = this.data.width = width;\r\n        this.canvas.height = this.data.height = height;\r\n\r\n        if (this.data.backgroundColor) {\r\n            this.context.save();\r\n\r\n            this.clear();\r\n            this.backgroundColor = this.data.backgroundColor;\r\n\r\n            this.context.restore();\r\n        }\r\n        if (!this.j2d.data.smoothing) {\r\n            this.j2d.util.disableSmoothing(this.context);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * TODO:: refactor this\r\n     * @param {string} gameState\r\n     * @returns {SceneManager}\r\n     */\r\n    setGameCallback(gameState) {\r\n        var sceneManager = this;\r\n        sceneManager.data.gameState = gameState || 'init_j2d';\r\n        sceneManager.frameManager.stop(sceneManager.j2d.data.id);\r\n\r\n        var gameConstructor = sceneManager.patchGameStateRender(\r\n            sceneManager.gameStatesManager.getState(gameState)\r\n        );\r\n\r\n        var newGameState = new gameConstructor(sceneManager.gameStatesManager, {});\r\n        newGameState.init({\r\n            callback: function () {\r\n                newGameState.load({\r\n                    callback: function () {\r\n                        sceneManager.frameManager.start(sceneManager.j2d.data.id, newGameState, {\r\n                            j2d: sceneManager.j2d,\r\n                            frameLimit: sceneManager.data.frameLimit\r\n                        });\r\n\r\n                        sceneManager.j2d.trigger('changedGameState');\r\n\r\n                        // TODO:: async unload?\r\n                        sceneManager.gameStatesManager.getPreviousState().unload();\r\n                    }\r\n                });\r\n            }\r\n        });\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {Function|callback} callback\r\n     * @param {*} data\r\n     * @returns {SceneManager}\r\n     */\r\n    async(callback, data) {\r\n        setTimeout(callback.call(callback, data), 0);\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @returns {SceneManager}\r\n     */\r\n    start() {\r\n        var sceneManager = this;\r\n        if (sceneManager.j2d.data.io) {\r\n            sceneManager.j2d.data.io.init();\r\n        }\r\n        sceneManager.j2d.trigger('beforeStart');\r\n\r\n        sceneManager.frameManager.stop(sceneManager.j2d.data.id);\r\n\r\n        var gameConstructor = sceneManager.patchGameStateRender(\r\n            sceneManager.gameStatesManager.getCurrent()\r\n        );\r\n\r\n        var newGameState = new gameConstructor(sceneManager.gameStatesManager, {});\r\n        newGameState.init({\r\n            callback: function () {\r\n                newGameState.load({\r\n                    callback: function () {\r\n                        sceneManager.frameManager.start(sceneManager.j2d.data.id, newGameState, {\r\n                            j2d: sceneManager.j2d,\r\n                            frameLimit: sceneManager.data.frameLimit\r\n                        });\r\n\r\n                        sceneManager.j2d.trigger('afterStart');\r\n                    }\r\n                });\r\n            }\r\n        });\r\n\r\n        return sceneManager;\r\n    }\r\n\r\n    /**\r\n     * @returns {SceneManager}\r\n     */\r\n    stop() {\r\n        this.frameManager.stop(this.j2d.data.id);\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {boolean} [fullscreen]\r\n     * @returns {SceneManager}\r\n     */\r\n    fullScreen(fullscreen) {\r\n        var element = document.getElementById(this.j2d.element.attr('id'));\r\n\r\n        if (undefined === element.requestFullscreen) {\r\n            //noinspection JSUnresolvedVariable\r\n            element.requestFullscreen = element.webkitRequestFullscreen\r\n                || element.webkitRequestFullScreen\r\n                || element.mozRequestFullScreen\r\n                || element.msRequestFullscreen;\r\n        }\r\n\r\n        if (undefined === document.exitFullscreen) {\r\n            //noinspection JSUnresolvedVariable\r\n            document.exitFullscreen = document.webkitExitFullscreen\r\n                || document.webkitCancelFullScreen\r\n                || document.mozCancelFullScreen\r\n                || document.msExitFullscreen;\r\n        }\r\n        if (fullscreen) {\r\n            element.requestFullscreen();\r\n        } else {\r\n            document.exitFullscreen();\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {boolean} [fullscreen]\r\n     * @returns {SceneManager}\r\n     */\r\n    resizeToFullPage(fullscreen) {\r\n        var j2d = this.j2d;\r\n        var sceneManager = this;\r\n\r\n        if (fullscreen) {\r\n            sceneManager.data.originalWidth = sceneManager.data.width;\r\n            sceneManager.data.originalHeight = sceneManager.data.height;\r\n\r\n            sceneManager.resize(j2d.device.width, j2d.device.height);\r\n            sceneManager.data.enableFullscreen = true;\r\n\r\n            j2d.element.style.width = j2d.device.width + 'px';\r\n            j2d.element.style.height = j2d.device.height + 'px';\r\n            j2d.element.style.margin = 0;\r\n\r\n            sceneManager.viewportManager.setScreen({\r\n                x: j2d.device.width,\r\n                y: j2d.device.height\r\n            }).setOffset({\r\n                x: -(j2d.device.width - sceneManager.data.originalWidth) / 2,\r\n                y: -(j2d.device.height - sceneManager.data.originalHeight) / 2\r\n            });\r\n        } else {\r\n            sceneManager.resize(sceneManager.data.originalWidth, sceneManager.data.originalHeight);\r\n            sceneManager.data.enableFullscreen = false;\r\n\r\n            j2d.element.style.width = sceneManager.data.originalWidth + 'px';\r\n            j2d.element.style.height = sceneManager.data.originalHeight + 'px';\r\n            j2d.element.style.margin = sceneManager.data.originalMargin;\r\n\r\n            sceneManager.viewportManager.setScreen({\r\n                x: sceneManager.data.originalWidth,\r\n                y: sceneManager.data.originalHeight\r\n            }).setOffset({\r\n                x: 0,\r\n                y: 0\r\n            });\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {EngineJ2D} j2d\r\n     * @param {{fullscreen: boolean}} data\r\n     * @returns {SceneManager}\r\n     */\r\n    toggleFullScreen(j2d, data) {\r\n        if (data === undefined) {\r\n            data = {fullscreen: false};\r\n        }\r\n        if (!j2d.scene.enableFullscreen || data.fullscreen) {\r\n            j2d.scene.fullScreen(true);\r\n        } else {\r\n            j2d.scene.fullScreen(false);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @returns {CollectionNode|null}\r\n     */\r\n    getSceneLayer() {\r\n        return this.layersManager.getLayer('scene');\r\n    }\r\n\r\n    /**\r\n     * @returns {SceneManager}\r\n     */\r\n    fillBackground() {\r\n        if (this.data.backgroundColor) {\r\n            this.backgroundColor = this.data.backgroundColor;\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {Object} data\r\n     * @returns {SceneManager}\r\n     */\r\n    render(data) {\r\n        var sceneManager = this;\r\n        sceneManager.layersManager.layers.forEach(function (value, index) {\r\n            sceneManager.layersManager.layers[index].render(\r\n                sceneManager.context,\r\n                sceneManager.viewportManager.getViewport(),\r\n                sceneManager.layersManager.globalCollection,\r\n                data || {}\r\n            );\r\n        });\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {BaseNode} node\r\n     * @param {string} [key]\r\n     * @returns {SceneManager}\r\n     */\r\n    add(node, key) {\r\n        if (this.layersManager.globalCollection.has('scene')) {\r\n            this.layersManager.globalCollection.get('scene').add(node, key);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {BaseNode} [node]\r\n     * @param {string} [key]\r\n     * @returns {SceneManager}\r\n     */\r\n    remove(node, key) {\r\n        if (this.layersManager.globalCollection.has('scene')) {\r\n            this.layersManager.globalCollection.get('scene').remove(node, key);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {CameraNode} node\r\n     * @returns {SceneManager}\r\n     */\r\n    registerCamera(node) {\r\n        this.viewportManager.addCamera(node.data.id, node);\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Hack to mode without Cameras\r\n     * @returns {SceneManager}\r\n     */\r\n    _updateNoCamerasViewport(scene) {\r\n        // This hack use deprecated method, i known.\r\n        scene.viewportManager.setViewport(\r\n            new Vector2d(0, 0),\r\n            new Vector2d(scene.data.width, scene.data.height)\r\n        );\r\n\r\n        return scene;\r\n    }\r\n\r\n    /**\r\n     * @param {CameraNode} [node]\r\n     * @returns {SceneManager}\r\n     */\r\n    updateViewport(node) {\r\n        if (node === undefined) return this._updateNoCamerasViewport(this);\r\n        this.viewportManager.updateViewport(node.data.id);\r\n        return this;\r\n    }\r\n\r\n\r\n    // static util = {\r\n    //     /**\r\n    //      * @param {CanvasRenderingContext2D} context\r\n    //      */\r\n    //     disableSmoothing: (context) => {\r\n    //         let chrome = window.navigator.userAgent.match(/Chrom(e|ium)\\/([0-9]+)\\./);\r\n    //         let version = chrome ? parseInt(chrome[2], 10) : false;\r\n    //\r\n    //         context['imageSmoothingEnabled'] = false;\r\n    //         context['mozImageSmoothingEnabled'] = false;\r\n    //         context['oImageSmoothingEnabled'] = false;\r\n    //         if (version && version <= 29) {\r\n    //             context['webkitImageSmoothingEnabled'] = false;\r\n    //         }\r\n    //         context['msImageSmoothingEnabled'] = false;\r\n    //     }\r\n    // };\r\n\r\n    // /** Utils **/\r\n    //util = EngineJ2D.util;\r\n}\r\n","import CollectionNode from \"nodes/CollectionNode\";\r\nimport UUID from \"utils/UUID\";\r\n\r\n/**\r\n * @class LayersManager\r\n * @exports module:core/LayersManager\r\n *\r\n * @constructor\r\n */\r\nexport default class LayersManager {\r\n    constructor() {\r\n        /** @type CollectionNode */\r\n        this.globalCollection = new CollectionNode({id: 'GlobalLayer'});\r\n\r\n        /** @type Array.<CollectionNode>|CollectionNode[] */\r\n        this.layers = [];\r\n\r\n        /** @type number */\r\n        this.index = 1000;\r\n    }\r\n\r\n    /**\r\n     * @param {string} name\r\n     * @param {number} [zIndex]\r\n     * @param {CollectionNode|undefined} [node]\r\n     * @returns {LayersManager}\r\n     */\r\n    addLayer(name, zIndex, node) {\r\n        name = name || UUID.generate();\r\n\r\n        if (node === undefined || node instanceof CollectionNode) {\r\n            if (zIndex === undefined) {\r\n                zIndex = this.index;\r\n                this.index++;\r\n            } else {\r\n                zIndex += 1000;\r\n            }\r\n\r\n            node = node || new CollectionNode({id: name, zIndex: zIndex});\r\n\r\n            this.globalCollection.add(node, name);\r\n            this.layers[zIndex] = node;\r\n\r\n            return this;\r\n        }\r\n        // throw new InvalidArgumentException('Unknown node type to add as layers');\r\n    }\r\n\r\n    /**\r\n     * @param {string} name\r\n     * @returns {LayersManager}\r\n     */\r\n    removeLayer(name) {\r\n        delete this.layers[this.globalCollection.get(name).zIndex];\r\n        this.globalCollection.remove(null, name);\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {string} name\r\n     * @returns {CollectionNode|null}\r\n     */\r\n    getLayer(name) {\r\n        if (this.globalCollection.has(name)) {\r\n            return this.globalCollection.get(name);\r\n        }\r\n        return null;\r\n    }\r\n\r\n    /**\r\n     * @param {string} name\r\n     * @param {number} zIndex\r\n     * @returns {LayersManager}\r\n     */\r\n    setZIndex(name, zIndex) {\r\n        if (this.globalCollection.has(name)) {\r\n            delete this.layers[this.globalCollection.get(name).zIndex];\r\n            this.globalCollection.get(name).zIndex = zIndex;\r\n            this.layers[zIndex] = this.globalCollection.get(name);\r\n        }\r\n        return this;\r\n    }\r\n}\r\n","import ArrayMap from \"utils/ArrayMap\";\r\nimport ObjectUtil from \"utils/ObjectUtil\";\r\nimport DefaultGameState from \"states/DefaultGameState\";\r\nimport BaseGameState from \"states/BaseGameState\";\r\n\r\n/**\r\n * Game states Manager\r\n *\r\n * @class GameStatesManager\r\n * @abstract\r\n * @constructor\r\n *\r\n * @param {GameStatesManager.defaults|Object} data\r\n * @param {function} sceneCallback\r\n * @property {GameStatesManager.defaults|Object} data\r\n * @property {number} state\r\n */\r\nexport default class GameStatesManager {\r\n    /**\r\n     * @type {{previousState: null, currentState: number, states: ArrayMap}}\r\n     */\r\n    static defaults = {\r\n        previousState: null,\r\n        currentState: 0,\r\n        states: new ArrayMap()\r\n    };\r\n\r\n    constructor(data, sceneCallback) {\r\n        this.data = ObjectUtil.extend(true, {}, GameStatesManager.defaults, data);\r\n        this.add(new DefaultGameState());\r\n        this.sceneCallback = sceneCallback;\r\n    }\r\n\r\n    get state() {\r\n        return this.data.currentState;\r\n    }\r\n\r\n    set state(value) {\r\n        this.data.currentState = value;\r\n    }\r\n\r\n    /**\r\n     * @param {string} [id]\r\n     * @returns {BaseGameState|null}\r\n     */\r\n    getState(id) {\r\n        if (id === undefined) return this.getCurrent();\r\n        if (this.data.states.contains(id)) {\r\n            return this.data.states[id];\r\n        }\r\n        return null\r\n    }\r\n\r\n    getPreviousState() {\r\n        return this.data.states.get(this.data.states[this.data.previousState]);\r\n    }\r\n\r\n    getNextState() {\r\n        if (this.data.states[this.state + 1] !== undefined) {\r\n            return this.data.states.get(this.data.states[this.state + 1]);\r\n        }\r\n        return null;\r\n    }\r\n\r\n    getCurrent() {\r\n        return this.data.states.get(this.data.states[this.data.currentState]);\r\n    }\r\n\r\n    /**\r\n     * @param {string} id\r\n     */\r\n    setState(id) {\r\n        if (this.data.states.contains(id)) {\r\n            this.data.previousState = this.data.currentState;\r\n            this.data.currentState = this.data.states.indexOf(id);\r\n            this.sceneCallback(id);\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    setNextState() {\r\n        if (this.data.states[this.state + 1] !== undefined) {\r\n            this.data.previousState = this.data.currentState;\r\n            this.data.currentState = this.state + 1;\r\n            this.sceneCallback(this.data.states[this.state]);\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    setPreviousState() {\r\n        if (this.data.states[this.data.previousState] !== undefined) {\r\n            var state = this.data.previousState;\r\n            this.data.previousState = this.data.currentState;\r\n            this.data.currentState = state;\r\n            this.sceneCallback(this.data.states[state]);\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {BaseGameState} state\r\n     * @param {string} [id]\r\n     */\r\n    add(state, id) {\r\n        if (id === undefined) id = state.data.id;\r\n        if (!this.data.states.contains(id) && state instanceof BaseGameState) {\r\n            this.data.states.add(id, state);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {string} id\r\n     */\r\n    remove(id) {\r\n        if (this.data.states.contains(id)) {\r\n            this.data.states.remove(id);\r\n        }\r\n        return this;\r\n    }\r\n}\r\n","import Vector2d from \"utils/Vector2d\";\r\n\r\n/**\r\n * @class Vector2dInteger\r\n * @exports module:utils/Vector2dInteger\r\n *\r\n * @constructor\r\n * @extends utils/Vector2d\r\n * @param {number} x\r\n * @param {number} y\r\n */\r\nexport default class Vector2dInteger extends Vector2d {\r\n    constructor(x, y) {\r\n        super(x >> 0, y >> 0);\r\n    }\r\n\r\n    /**\r\n     * @param {Array.<number>} array\r\n     * @returns {Vector2d|Vector2dInteger}\r\n     */\r\n    fromArray(array) {\r\n        this.x = array[0] >> 0;\r\n        this.y = array[1] >> 0;\r\n\r\n        return this;\r\n    }\r\n}\r\n","/**\r\n * @class Vector2d\r\n * @exports module:utils/Vector2d\r\n *\r\n * @constructor\r\n * @param {number} x\r\n * @param {number} y\r\n */\r\nexport default class Vector2d {\r\n    constructor(x, y) {\r\n        this.x = x;\r\n        this.y = y;\r\n    }\r\n\r\n    /**\r\n     * @returns {number}\r\n     */\r\n    getX() {\r\n        return this.x;\r\n    }\r\n\r\n    /**\r\n     * @returns {number}\r\n     */\r\n    getY() {\r\n        return this.y;\r\n    }\r\n\r\n    /**\r\n     * @returns {{x: number, y: number}}\r\n     */\r\n    getVector() {\r\n        return {x: this.x, y: this.y};\r\n    }\r\n\r\n    /**\r\n     * @returns {Array.<number>}\r\n     */\r\n    toArray() {\r\n        return [this.x, this.y];\r\n    }\r\n\r\n    /**\r\n     * @param {Array.<number>} array\r\n     * @returns {Vector2d}\r\n     */\r\n    fromArray(array) {\r\n        this.x = array[0];\r\n        this.y = array[1];\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @returns {string}\r\n     */\r\n    toString() {\r\n        return \"(\" + this.x + \",\" + this.y + \")\";\r\n    }\r\n\r\n    /**\r\n     * @param {Vector2d} vector1\r\n     * @param {Vector2d} vector2\r\n     * @returns {number}\r\n     */\r\n    static getDistance(vector1, vector2) {\r\n        return Math.sqrt(\r\n            Math.pow(vector2.getVector().x - vector1.getVector().x, 2) +\r\n            Math.pow(vector2.getVector().y - vector1.getVector().y, 2)\r\n        );\r\n    }\r\n\r\n    /**\r\n     * @param {Vector2d} vector1\r\n     * @param {Vector2d} vector2\r\n     * @returns {number}\r\n     */\r\n    static getAngle(vector1, vector2) {\r\n        return Math.atan2(\r\n                vector2.getVector().y - vector1.getVector().y,\r\n                vector2.getVector().x - vector1.getVector().x\r\n            ) * (180 / Math.PI);\r\n    }\r\n}\r\n","/**\r\n * @class MathUtil\r\n * @exports module:utils/MathUtil\r\n *\r\n * @constructor\r\n */\r\nexport default class MathUtil {\r\n    /**\r\n     * @param {number} number\r\n     * @returns {number}\r\n     */\r\n    static number2Integer(number) {\r\n        return number >> 0;\r\n    }\r\n\r\n    /**\r\n     * @param {number} number\r\n     * @returns {boolean}\r\n     */\r\n    static isInteger(number) {\r\n        return typeof number === \"number\" && isFinite(number)\r\n            && number > -9007199254740992 && number < 9007199254740992\r\n            && Math.floor(number) === number;\r\n    }\r\n\r\n    /**\r\n     * @param {number} min\r\n     * @param {number} max\r\n     * @param {number} opacity\r\n     * @returns {string}\r\n     */\r\n    static randomColor(min, max, opacity) {\r\n        return 'rgba('\r\n            + MathUtil.random(min, max) + ', '\r\n            + MathUtil.random(min, max) + ', '\r\n            + MathUtil.random(min, max) + ', '\r\n            + opacity + ')';\r\n    }\r\n\r\n    /**\r\n     * @param {number} min\r\n     * @param {number} max\r\n     * @param {boolean} [omitZero]\r\n     * @returns {number}\r\n     */\r\n    static random(min, max, omitZero) {\r\n        var random = (Math.floor(Math.random() * (max - min + 1) + min));\r\n        return (omitZero && random == 0)\r\n            ? MathUtil.random(min, max, omitZero)\r\n            : random;\r\n    }\r\n\r\n    /**\r\n     * @param {number} degree\r\n     * @returns {number}\r\n     */\r\n    static degree2Radian(degree) {\r\n        return degree * (Math.PI / 180);\r\n    }\r\n\r\n    /**\r\n     * @param {number} radian\r\n     * @returns {number}\r\n     */\r\n    static radian2Degree(radian) {\r\n        return radian * (180 / Math.PI);\r\n    }\r\n}\r\n","import ObjectUtil from \"utils/ObjectUtil\";\r\nimport Events from \"utils/Events\";\r\nimport Easing from \"transitions/utils/Easing\";\r\nvar tweens = [];\r\n\r\n/**\r\n * @class Tween\r\n * @exports module:transitions/Tween\r\n *\r\n * @constructor\r\n * @param {BaseNode|{data: object}} tweenNode\r\n * @param {Tween.defaults|Object} [data]\r\n * @property {Tween.defaults} data\r\n */\r\nexport default class Tween {\r\n    static defaults = {\r\n        currentStateAnimation: 0,\r\n        tweenStateStack: [],\r\n        tweenStateTimings: [],\r\n        chainedTweensStack: [],\r\n\r\n        isAnimated: false,\r\n        isStarted: false,\r\n        startTime: null,\r\n\r\n        delayTime: 0,\r\n\r\n        defaultDuration: 1000\r\n    };\r\n\r\n    static stateDefaults = {\r\n        data: null,\r\n        duration: 1000,\r\n        delay: 0,\r\n        easing: 'linear',\r\n        interpolation: 'linear'\r\n    };\r\n\r\n    static Easing = Easing;\r\n\r\n    constructor(tweenNode, data) {\r\n        this.data = ObjectUtil.extend(true, {}, Tween.defaults, data);\r\n        this.node = tweenNode;\r\n        this.events = new Events();\r\n\r\n        this.state = {};\r\n\r\n        // TODO:: Exceptions\r\n        // if (!(node instanceof BaseNode) || typeof node.data !== 'object') {\r\n        //     throw new InvalidArgumentException('Unknown tween node');\r\n        // }\r\n    }\r\n\r\n    /* Methods */\r\n    /**\r\n     * @param {Tween.defaults|Object} data\r\n     * @returns {{data: null, duration: number, delay: number, easing: string, interpolation: string}}\r\n     */\r\n    _tweenStateData(data) {\r\n        return (data !== undefined && typeof data === 'object')\r\n            ? ObjectUtil.extend(true, {}, Tween.stateDefaults, data)\r\n            : Tween.stateDefaults;\r\n    }\r\n\r\n    /**\r\n     * @param {Object} properties\r\n     * @param {Tween.defaults|Object} [data]\r\n     * @returns {Tween}\r\n     */\r\n    to(properties, data) {\r\n        var tween = this;\r\n\r\n        if (!tween.data.isStarted) {\r\n\r\n            if (typeof data === 'number') data = {data: data};\r\n            var stateData = (typeof data !== 'number') ? this._tweenStateData(data) : data;\r\n            if (data !== undefined && typeof data === 'number') stateData.duration = data;\r\n\r\n            tween.data.tweenStateStack.push([properties, stateData]);\r\n\r\n            return tween;\r\n        }\r\n\r\n        // TODO:: Exceptions\r\n        // throw new RuntimeException('You can not add a state after the start of the tween.');\r\n    }\r\n\r\n    /**\r\n     * @param {number} time\r\n     * @returns {boolean}\r\n     */\r\n    update(time) {\r\n        var tween = this;\r\n\r\n        var nextState = tween.data.tweenStateStack[tween.data.currentStateAnimation + 1];\r\n\r\n        if (time < tween.data.startTime || nextState === undefined) return true;\r\n\r\n        if (!tween.data.isStarted) {\r\n            tween.events.trigger('start', [tween.node]);\r\n            tween.data.isStarted = true;\r\n        }\r\n\r\n        var currentState = tween.data.tweenStateStack[tween.data.currentStateAnimation];\r\n\r\n        var previousStatesTime = tween.getStateTimeDuration(tween.data.currentStateAnimation, true);\r\n\r\n        var elapsed = (time - (tween.data.startTime + previousStatesTime)) / nextState[1].duration;\r\n        elapsed = elapsed > 1 ? 1 : elapsed;\r\n\r\n        tween.node.import(\r\n            Tween.util.animateTween(currentState[0], nextState[0], Easing.get(nextState[1].easing)(elapsed))\r\n        );\r\n\r\n        tween.events.trigger('update', [tween.node]);\r\n\r\n        if (elapsed === 1) {\r\n            if (tween.data.currentStateAnimation < tween.data.tweenStateStack.length) {\r\n                tween.data.currentStateAnimation++;\r\n            } else {\r\n                tween.events.trigger('complete', [tween.node]);\r\n\r\n                for (var i = 0; i < tween.data.chainedTweensStack.length; i++) {\r\n                    tween.data.chainedTweensStack[i].start(\r\n                        tween.data.startTime + tween.getStateTimeDuration(tween.data.currentStateAnimation - 1, true)\r\n                    );\r\n                }\r\n                return false;\r\n            }\r\n        }\r\n        return true;\r\n    }\r\n\r\n\r\n    _calculateStackStateTimings(tweenStateStack) {\r\n        var result = [];\r\n\r\n        tweenStateStack.forEach(function (value) {\r\n            result.push(value[1].duration);\r\n        });\r\n\r\n        return result;\r\n    }\r\n\r\n    /**\r\n     * @param {number} [position]\r\n     * @param {boolean} [withPrevious]\r\n     *\r\n     * @returns {number}\r\n     */\r\n    getStateTimeDuration(position, withPrevious) {\r\n        if (position === undefined || position === null) position = this.data.currentStateAnimation;\r\n        if (withPrevious === undefined) withPrevious = false;\r\n\r\n        if (this.data.tweenStateTimings[position] === undefined) return 0;\r\n\r\n        if (withPrevious) {\r\n            var result = 0;\r\n            for (var i = 1; i <= position; i++) {\r\n                result += this.data.tweenStateTimings[i];\r\n            }\r\n            return result;\r\n        } else {\r\n            return this.data.tweenStateTimings[position];\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @param {Array.<Object, Tween.stateDefaults>} startState\r\n     * @param {Array.<Array<Object, Tween.stateDefaults>>} tweenStateStack\r\n     */\r\n    _calculateStackState(startState, tweenStateStack) {\r\n        var result = [startState];\r\n        var index = 1;\r\n\r\n        var parsedTweenStateStack = [startState];\r\n        var nextStateDelay = 0;\r\n        var nextAllStateDelay = 0;\r\n\r\n        tweenStateStack.forEach(function (value) {\r\n            if (typeof value[0] === 'object' && !(value[0] instanceof Array)) {\r\n                if (nextStateDelay !== 0) {\r\n                    value[1].delay = nextStateDelay;\r\n                    nextStateDelay = 0;\r\n                } else if (nextAllStateDelay !== 0) {\r\n                    value[1].delay = nextAllStateDelay;\r\n                }\r\n                parsedTweenStateStack.push([value[0], value[1]]);\r\n                index++;\r\n            } else if (typeof value[0] === 'string') {\r\n                var i = 0;\r\n                switch (value[0]) {\r\n                    case 'delay':\r\n                        nextStateDelay = value[1].data;\r\n                        break;\r\n                    case 'delayAll':\r\n                        nextAllStateDelay = value[1].data;\r\n                        break;\r\n                    case 'repeat':\r\n                        for (i = 0; i < value[1].data; i++) {\r\n                            parsedTweenStateStack.push(parsedTweenStateStack[index]);\r\n                            index++;\r\n                        }\r\n                        break;\r\n                    case 'repeatAll':\r\n                        for (i = 0; i < value[1].data; i++) {\r\n                            parsedTweenStateStack.concat(parsedTweenStateStack);\r\n                            index++;\r\n                        }\r\n                        break;\r\n                    case 'yoyo':\r\n                    case 'reverse':\r\n                        for (i = 0; i < value[1].data; i++) {\r\n                            if (parsedTweenStateStack[index - 1] !== undefined) {\r\n                                parsedTweenStateStack.push([\r\n                                    Tween.util.reverseProperties(parsedTweenStateStack[index - 1][0]),\r\n                                    parsedTweenStateStack[index - 1][1]\r\n                                ]);\r\n                                index++;\r\n                            }\r\n                        }\r\n                        break;\r\n                    case 'yoyoAll':\r\n                    case 'reverseAll':\r\n                        for (i = 0; i < value[1].data; i++) {\r\n                            var stateStack = parsedTweenStateStack.slice(0);\r\n\r\n                            var stackLength = stateStack.length;\r\n                            for (var j = 0; j < stackLength; j++) {\r\n                                var sIndex = stackLength - j - 1;\r\n                                if (stateStack[sIndex] !== undefined) {\r\n                                    parsedTweenStateStack.push([\r\n                                        Tween.util.reverseProperties(stateStack[sIndex][0]),\r\n                                        stateStack[sIndex][1]\r\n                                    ]);\r\n                                    index++;\r\n                                }\r\n                            }\r\n                        }\r\n                        break;\r\n                }\r\n            }\r\n        });\r\n\r\n        // parsedTweenStateStack.forEach(function (value) {\r\n        //     console.info(value[0].position.x);\r\n        // });\r\n\r\n        index = 0;\r\n        parsedTweenStateStack.shift();\r\n        parsedTweenStateStack.forEach(function (value) {\r\n            if (typeof value[0] === 'object' && !(value[0] instanceof Array)) {\r\n                result.push([Tween.util.calculateProperties(result[index][0], ObjectUtil.extend(true, {}, result[index][0], value[0])), value[1]]);\r\n                index++;\r\n            }\r\n        });\r\n\r\n        return result;\r\n    }\r\n\r\n    /**\r\n     * @param {number} [time]\r\n     * @returns {Tween}\r\n     */\r\n    start(time) {\r\n        var tween = this;\r\n        if (time === undefined) time = global.performance.now();\r\n        tween.data.isAnimated = true;\r\n\r\n        if (!tween.data.isStarted) {\r\n            tween.data.isStarted = true;\r\n            tween.state = [Tween.util.cleanProperties(tween.node.data), Tween.stateDefaults];\r\n            tween.data.tweenStateStack = this._calculateStackState(tween.state, tween.data.tweenStateStack);\r\n            tween.data.tweenStateTimings = this._calculateStackStateTimings(tween.data.tweenStateStack);\r\n        }\r\n\r\n        tween.data.startTime = time + tween.data.delayTime;\r\n\r\n        return Tween.add(tween);\r\n    }\r\n\r\n    /**\r\n     * @returns {Tween}\r\n     */\r\n    stop() {\r\n        var tween = this;\r\n        if (!tween.data.isAnimated) return this;\r\n\r\n        tween.data.isAnimated = false;\r\n        tween.events.trigger('stop', [tween.node]);\r\n        tween.stopChainedTweens();\r\n\r\n        return Tween.remove(tween);\r\n    }\r\n\r\n    /**\r\n     * @returns {Tween}\r\n     */\r\n    stopChainedTweens() {\r\n        var tween = this;\r\n        for (var i = 0; i < tween.data.chainedTweensStack.length; i++) {\r\n            tween.data.chainedTweensStack[i].stop();\r\n        }\r\n\r\n        return tween;\r\n    }\r\n\r\n\r\n    /* Extended animation methods */\r\n    /**\r\n     * @param {number} delay\r\n     * @returns {Tween}\r\n     */\r\n    delay(delay) {\r\n        if (delay === undefined) delay = 1000;\r\n        this.to('delay', delay);\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {number} delay\r\n     * @returns {Tween}\r\n     */\r\n    delayAll(delay) {\r\n        if (delay === undefined) delay = 1000;\r\n        this.to('delayAll', delay);\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {number} [count]\r\n     * @returns {Tween}\r\n     */\r\n    repeat(count) {\r\n        if (count === undefined) count = 1;\r\n        this.to('repeat', count);\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {number} [count]\r\n     * @returns {Tween}\r\n     */\r\n    repeatAll(count) {\r\n        if (count === undefined) count = 1;\r\n        this.to('repeatAll', count);\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {number} [count]\r\n     * @returns {Tween}\r\n     */\r\n    yoyo(count) {\r\n        if (count === undefined) count = 1;\r\n        this.to('yoyo', count);\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {number} [count]\r\n     * @returns {Tween}\r\n     */\r\n    reverse(count) {\r\n        if (count === undefined) count = 1;\r\n        this.to('reverse', count);\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {number} [count]\r\n     * @returns {Tween}\r\n     */\r\n    yoyoAll(count) {\r\n        if (count === undefined) count = 1;\r\n        this.to('yoyoAll', count);\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {number} [count]\r\n     * @returns {Tween}\r\n     */\r\n    reverseAll(count) {\r\n        if (count === undefined) count = 1;\r\n        this.to('reverseAll', count);\r\n        return this;\r\n    }\r\n\r\n\r\n    /* Events wrappers */\r\n    /**\r\n     * @param {string} event\r\n     * @param {function} callback\r\n     * @returns {boolean}\r\n     */\r\n    on(event, callback) {\r\n        return this.events.on(event, callback);\r\n    }\r\n\r\n    /**\r\n     * @param {string} event\r\n     * @param {function} callback\r\n     * @returns {boolean}\r\n     */\r\n    off(event, callback) {\r\n        return this.events.off(event, callback);\r\n    }\r\n\r\n    /**\r\n     * @param {string} event\r\n     * @param {function} callback\r\n     * @returns {boolean}\r\n     */\r\n    once(event, callback) {\r\n        return this.events.once(event, callback);\r\n    }\r\n\r\n    /**\r\n     * @param {string} event\r\n     * @returns {boolean}\r\n     */\r\n    flush(event) {\r\n        return this.events.flush(event);\r\n    }\r\n\r\n    /**\r\n     * @param {string} event\r\n     * @param {Array.<*>} data\r\n     * @returns {boolean}\r\n     */\r\n    trigger(event, data) {\r\n        return this.events.trigger(event, data);\r\n    }\r\n\r\n    /* Static Methods */\r\n    /**\r\n     * @param {number} index\r\n     * @returns {Array.<Tween>|Tween}\r\n     */\r\n    static get(index) {\r\n        return (index === undefined) ? tweens : tweens[index];\r\n    }\r\n\r\n    /**\r\n     * @param {Tween} tween\r\n     * @returns {Tween}\r\n     */\r\n    static add(tween) {\r\n        tweens.push(tween);\r\n        return tween;\r\n    }\r\n\r\n    /**\r\n     * @param {Tween} tween\r\n     * @returns {Tween}\r\n     */\r\n    static remove(tween) {\r\n        var i = tweens.indexOf(tween);\r\n        if (i !== -1) tweens.splice(i, 1);\r\n        return tween;\r\n    }\r\n\r\n    /**\r\n     * @returns {void}\r\n     */\r\n    static flush() {\r\n        tweens = [];\r\n    }\r\n\r\n    /**\r\n     * @param {number} time\r\n     * @returns {boolean}\r\n     */\r\n    static update(time) {\r\n        if (tweens.length === 0) return false;\r\n\r\n        var i = 0;\r\n\r\n        while (i < tweens.length) {\r\n            if (tweens[i].update(time)) {\r\n                i++;\r\n            } else {\r\n                tweens.splice(i, 1);\r\n            }\r\n        }\r\n        return true;\r\n    }\r\n\r\n    static util = {\r\n        animateTween: function (currentState, nextState, value) {\r\n            var result = {};\r\n            var property;\r\n            var temp;\r\n\r\n            for (property in nextState) {\r\n                if (nextState.hasOwnProperty(property) && currentState.hasOwnProperty(property)) {\r\n                    temp = null;\r\n\r\n                    if (typeof nextState[property] === 'number') {\r\n                        if (currentState[property] === nextState[property]) {\r\n                            temp = currentState[property];\r\n                        } else {\r\n                            temp = currentState[property] + (nextState[property] - currentState[property]) * value;\r\n                        }\r\n                    } else if (typeof nextState[property] === 'object') {\r\n                        temp = this.animateTween(currentState[property], nextState[property], value);\r\n                    }\r\n                    if (temp !== null) result[property] = temp;\r\n                }\r\n            }\r\n\r\n            return Object.keys(result).length > 0 ? result : null;\r\n        },\r\n\r\n        cleanProperties: function (properties) {\r\n            var result = {};\r\n            var property;\r\n            var temp;\r\n\r\n            for (property in properties) {\r\n                if (properties.hasOwnProperty(property) && property !== 'id') {\r\n                    temp = null;\r\n                    if ((typeof properties[property] === 'string' && !isNaN(properties[property]))\r\n                        || typeof properties[property] === 'number'\r\n                    ) {\r\n                        temp = properties[property];\r\n                    } else if (typeof properties[property] === 'object') {\r\n                        temp = this.cleanProperties(properties[property]);\r\n                    }\r\n                    if (temp !== null) result[property] = temp;\r\n                }\r\n            }\r\n\r\n            return Object.keys(result).length > 0 ? result : null;\r\n        },\r\n\r\n        reverseProperties: function (properties) {\r\n            var result = {};\r\n            var property;\r\n            var temp;\r\n\r\n            for (property in properties) {\r\n                if (properties.hasOwnProperty(property) && property !== 'id') {\r\n                    temp = null;\r\n                    if (typeof properties[property] === 'string' && !isNaN(properties[property])) {\r\n                        temp = Number(parseFloat(properties[property]) * -1).toString();\r\n                    } else if (typeof properties[property] === 'number') {\r\n                        temp = properties[property];\r\n                    } else if (typeof properties[property] === 'object') {\r\n                        temp = this.reverseProperties(properties[property]);\r\n                    }\r\n                    if (temp !== null) result[property] = temp;\r\n                }\r\n            }\r\n\r\n            return Object.keys(result).length > 0 ? result : null;\r\n        },\r\n\r\n        calculateProperties: function (startProperties, endProperties) {\r\n            var result = {};\r\n            var property;\r\n            var temp;\r\n\r\n            for (property in endProperties) {\r\n                if (endProperties.hasOwnProperty(property) && startProperties.hasOwnProperty(property) && property !== 'id') {\r\n                    temp = null;\r\n\r\n                    if (typeof endProperties[property] === 'string' && !isNaN(endProperties[property]) && typeof startProperties[property] === 'number') {\r\n                        temp = startProperties[property] + parseFloat(endProperties[property]);\r\n                    } else if (typeof endProperties[property] === 'number' && typeof startProperties[property] === 'string' && !isNaN(startProperties[property])) {\r\n                        temp = endProperties[property] - parseFloat(startProperties[property]);\r\n                    } else if (typeof endProperties[property] === 'number' && typeof startProperties[property] === 'number') {\r\n                        temp = endProperties[property];\r\n                    } else if (typeof endProperties[property] === 'object') {\r\n                        temp = this.calculateProperties(startProperties[property], endProperties[property]);\r\n                    }\r\n\r\n                    if (temp !== null) result[property] = temp;\r\n                }\r\n            }\r\n            return Object.keys(result).length > 0 ? result : null;\r\n        }\r\n    }\r\n}\r\n","import BaseGameState from \"states/BaseGameState\";\r\n\r\n/**\r\n * Default game state\r\n *\r\n * @class DefaultGameState\r\n * @abstract\r\n * @constructor\r\n *\r\n * @param {GameStatesManager} gsm\r\n * @param {DefaultGameState.defaults|BaseGameState.defaults|Object} [data]\r\n * @property {DefaultGameState.defaults|BaseGameState.defaults|Object} data\r\n */\r\nexport default class DefaultGameState extends BaseGameState {\r\n    constructor(gsm, data) {\r\n        if (data === undefined) data = {};\r\n        data.id = 'init_j2d';\r\n        super(gsm, data);\r\n    }\r\n\r\n    // init(data) {\r\n    //     return BaseGameState.prototype.init.call(this, data);\r\n    // }\r\n    //\r\n    // load(data) {\r\n    //     return BaseGameState.prototype.load.call(this, data);\r\n    // }\r\n\r\n    update(timestamp, data) {\r\n        setTimeout(function () {\r\n            this.gsm.setNextState();\r\n        }.bind(this), 1000);\r\n        return true;\r\n    }\r\n\r\n    // render(timestamp, data) {\r\n    //     return true;\r\n    // }\r\n    //\r\n    // unload(data) {\r\n    //     return BaseGameState.prototype.unload.call(this, data);\r\n    // }\r\n}\r\n","import ObjectUtil from \"utils/ObjectUtil\";\r\nimport UUID from \"utils/UUID\";\r\nimport Events from \"utils/Events\";\r\n/**\r\n * Base class of state\r\n *\r\n * @class BaseGameState\r\n * @abstract\r\n * @constructor\r\n *\r\n * @param {GameStatesManager} gsm\r\n * @param {BaseGameState.defaults|Object} [data]\r\n * @property {BaseGameState.defaults|Object} data\r\n * @property {string} id\r\n */\r\nexport default class BaseGameState {\r\n    static defaults = {\r\n        id: 'BaseState',\r\n        currentState: 0\r\n    };\r\n\r\n    static STATE = {\r\n        STATE_NOT_LOADED: 0,\r\n        STATE_INIT: 1,\r\n        STATE_LOAD: 2,\r\n        STATE_UPDATE: 3,\r\n        STATE_RENDER: 4,\r\n        STATE_UNLOAD: 5\r\n    };\r\n\r\n    constructor(gsm, data) {\r\n        if (data === undefined) data = {};\r\n        if (data === undefined) data = {};\r\n        data.currentState = 0;\r\n        if (data.id === undefined || data.id === null) {\r\n            data.id = UUID.generate();\r\n        }\r\n        this.data = ObjectUtil.extend(true, {}, BaseGameState.defaults, data);\r\n\r\n        this.gsm = gsm;\r\n        this.loader = null;\r\n        this.events = new Events();\r\n    }\r\n\r\n    get id() {\r\n        return this.data.id;\r\n    }\r\n\r\n    set id(value) {\r\n        this.data.id = value;\r\n    }\r\n\r\n    init(data) {\r\n        if (typeof data === 'object' && data.callback !== undefined) {\r\n            data.callback();\r\n        }\r\n        return true;\r\n    }\r\n\r\n    load(data) {\r\n        if (typeof data === 'object' && data.callback !== undefined) data.callback();\r\n        return true;\r\n    }\r\n\r\n    update(timestamp, data) {\r\n        return true;\r\n    }\r\n\r\n    render(timestamp, data) {\r\n        return true;\r\n    }\r\n\r\n    unload(data) {\r\n        if (typeof data === 'object' && data.callback !== undefined) data.callback();\r\n        return true;\r\n    }\r\n\r\n    /* Events wrappers */\r\n    /**\r\n     * @param {string} event\r\n     * @param {function} callback\r\n     * @returns {boolean}\r\n     */\r\n    on(event, callback) {\r\n        return this.events.on(event, callback);\r\n    }\r\n\r\n    /**\r\n     * @param {string} event\r\n     * @param {function} callback\r\n     * @returns {boolean}\r\n     */\r\n    off(event, callback) {\r\n        return this.events.off(event, callback);\r\n    }\r\n\r\n    /**\r\n     * @param {string} event\r\n     * @param {function} callback\r\n     * @returns {boolean}\r\n     */\r\n    once(event, callback) {\r\n        return this.events.once(event, callback);\r\n    }\r\n\r\n    /**\r\n     * @param {string} event\r\n     * @returns {boolean}\r\n     */\r\n    flush(event) {\r\n        return this.events.flush(event);\r\n    }\r\n\r\n    /**\r\n     * @param {string} event\r\n     * @param {Array.<*>} data\r\n     * @returns {boolean}\r\n     */\r\n    trigger(event, data) {\r\n        return this.events.trigger(event, data);\r\n    }\r\n}\r\n","import ObjectUtil from \"utils/ObjectUtil\";\r\nimport AnimatedNode from \"nodes/AnimatedNode\";\r\nimport MathUtil from \"utils/MathUtil\";\r\n\r\n/**\r\n * @class RectNode\r\n * @exports module:nodes/RectNode\r\n *\r\n * @constructor\r\n * @extends nodes/AnimatedNode\r\n * @param {BaseNode.defaults|AnimatedNode.defaults|RectNode.defaults|Object} [data]\r\n * @property {BaseNode.defaults|AnimatedNode.defaults|RectNode.defaults} data\r\n */\r\nexport default class RectNode extends AnimatedNode {\r\n    static defaults = {\r\n        type: 'RectNode',\r\n        color: '#000000'\r\n    };\r\n\r\n    constructor(data) {\r\n        super(ObjectUtil.extend(true, {}, RectNode.defaults, data));\r\n    }\r\n\r\n    /**\r\n     * @returns {string}\r\n     */\r\n    getColor() {\r\n        return this.data.color;\r\n    }\r\n\r\n    /**\r\n     * @param {string} color\r\n     * @returns {RectNode}\r\n     */\r\n    setColor(color) {\r\n        this.data.color = color;\r\n        return this;\r\n    }\r\n\r\n    /* ------------------------------ Draw ------------------------------ */\r\n\r\n    /**\r\n     * @param {CanvasRenderingContext2D} context\r\n     * @param {{offset: {x: number, y: number}, size: {x: number, y: number}, scale: number, angle: number}} viewport\r\n     * @param {CollectionNode} collection\r\n     * @param {object} data\r\n     * @returns {null}\r\n     */\r\n    draw(context, viewport, collection, data) {\r\n        if (this.data.visible && this.inViewport(viewport)) {\r\n            //console.log(this.inViewport(viewport));\r\n            if (this.data.opacity !== 1.0) {\r\n                var tempOpacity = context.globalAlpha;\r\n                context.globalAlpha = this.data.opacity;\r\n            }\r\n\r\n            if (this.data.angle || viewport.angle !== 0.0) {\r\n                context.save();\r\n\r\n                context.translate(\r\n                    this.getPosition().x - viewport.offset.x,\r\n                    this.getPosition().y - viewport.offset.y);\r\n                context.rotate(MathUtil.degree2Radian(this.data.angle + viewport.angle));\r\n                context.translate(\r\n                    -(this.getPosition().x - viewport.offset.x),\r\n                    -(this.getPosition().y - viewport.offset.y));\r\n            }\r\n\r\n            context.fillStyle = this.data.color;\r\n            context.lineWidth = 0;\r\n\r\n            context.fillRect(\r\n                this.data.position.x - viewport.offset.x,\r\n                this.data.position.y - viewport.offset.y,\r\n                this.data.size.x * this.data.scale * viewport.scale,\r\n                this.data.size.y * this.data.scale * viewport.scale\r\n            );\r\n\r\n            if (this.data.angle || viewport.angle !== 0.0) {\r\n                context.restore();\r\n            }\r\n\r\n            if (this.data.opacity !== 1.0) {\r\n                context.globalAlpha = tempOpacity;\r\n            }\r\n        }\r\n        return null;\r\n    }\r\n\r\n    /* ------------------------------ Render ------------------------------ */\r\n\r\n    /**\r\n     * @override\r\n     *\r\n     * @param {CanvasRenderingContext2D} context\r\n     * @param {{offset: {x: number, y: number}, size: {x: number, y: number}, scale: number, angle: number}} viewport\r\n     * @param {CollectionNode} collection\r\n     * @param {object} data\r\n     * @returns {BaseNode|AnimatedNode|RectNode}\r\n     */\r\n    render(context, viewport, collection, data) {\r\n        this.draw(context, viewport, collection, data);\r\n        return this;\r\n    }\r\n}\r\n","import ObjectUtil from \"utils/ObjectUtil\";\r\nimport AnimatedNode from \"nodes/AnimatedNode\";\r\nimport ArrayMap from \"utils/ArrayMap\";\r\nimport BaseNode from \"nodes/BaseNode\";\r\n\r\n/**\r\n * @class CollectionNode\r\n * @exports module:nodes/CollectionNode\r\n *\r\n * @constructor\r\n * @extends nodes/AnimatedNode\r\n * @param {BaseNode.defaults|AnimatedNode.defaults|CollectionNode.defaults|Object} [data]\r\n * @property {BaseNode.defaults|AnimatedNode.defaults|CollectionNode.defaults} data\r\n */\r\nexport default class CollectionNode extends AnimatedNode {\r\n    static defaults = {\r\n        type: 'CollectionNode',\r\n        /** @type {ArrayMap|null} */\r\n        collection: null,\r\n        zIndex: 1000\r\n    };\r\n\r\n    constructor(data) {\r\n        super(ObjectUtil.extend(true, {}, CollectionNode.defaults, data));\r\n\r\n        if (this.data.collection === null) {\r\n            this.data.collection = new ArrayMap();\r\n        }\r\n    }\r\n\r\n    get zIndex() {\r\n        return 1000 - this.data.zIndex;\r\n    }\r\n\r\n    set zIndex(value) {\r\n        this.data.zIndex = 1000 + value;\r\n    }\r\n\r\n    /**\r\n     * @param {BaseNode|CollectionNode} node\r\n     * @param {string} key\r\n     * @returns {CollectionNode}\r\n     */\r\n    add(node, key) {\r\n        if (node instanceof BaseNode) {\r\n            key = key || node.data.id;\r\n            this.data.collection.add(key, node);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {BaseNode|CollectionNode|null} node\r\n     * @param {string} key\r\n     * @returns {CollectionNode}\r\n     */\r\n    remove(node, key) {\r\n        if (node instanceof BaseNode) {\r\n            this.data.collection.remove(this.data.collection[node.data.id]);\r\n        }\r\n        if (typeof key === 'string' && node === null) {\r\n            this.data.collection.remove(key);\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {string} key\r\n     * @returns {boolean}\r\n     */\r\n    has(key) {\r\n        return this.data.collection[key] !== undefined;\r\n    }\r\n\r\n    /**\r\n     * @param {string} key\r\n     * @returns {BaseNode|CollectionNode|boolean}\r\n     */\r\n    get(key) {\r\n        if (this.data.collection[key] !== undefined) {\r\n            return this.data.collection[key];\r\n        }\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * @returns {CollectionNode}\r\n     */\r\n    flush() {\r\n        this.data.collection.length = 0;\r\n        return this;\r\n    }\r\n\r\n    /* ------------------------------ Render ------------------------------ */\r\n\r\n    /**\r\n     * @override\r\n     *\r\n     * @param {CanvasRenderingContext2D} context\r\n     * @param {{offset: {x: number, y: number}, size: {x: number, y: number}, scale: number, angle: number}} viewport\r\n     * @param {CollectionNode} collection\r\n     * @param {object} data\r\n     * @returns {BaseNode|CollectionNode}\r\n     */\r\n    render(context, viewport, collection, data) {\r\n        var collectionNode = this;\r\n\r\n        if (this.data.collection.length !== 0) {\r\n            this.data.collection.each(function (index) {\r\n                if (collectionNode.data.collection.hasOwnProperty(index)\r\n                    && collectionNode.data.collection[index] instanceof BaseNode) {\r\n                    collectionNode.data.collection[index].render(context, viewport, collection, data);\r\n                }\r\n            });\r\n        }\r\n        return this;\r\n    }\r\n}\r\n","import ObjectUtil from \"utils/ObjectUtil\";\r\nimport AnimatedNode from \"nodes/AnimatedNode\";\r\n\r\n/**\r\n * @class CameraNode\r\n * @exports module:nodes/CameraNode\r\n *\r\n * @constructor\r\n * @extends nodes/AnimatedNode\r\n * @param {BaseNode.defaults|AnimatedNode.defaults|CameraNode.defaults|Object} [data]\r\n * @property {BaseNode.defaults|AnimatedNode.defaults|CameraNode.defaults} data\r\n */\r\nexport default class CameraNode extends AnimatedNode {\r\n    static defaults = {\r\n        type: 'CameraNode'\r\n    };\r\n\r\n    constructor(data) {\r\n        super(ObjectUtil.extend(true, {}, CameraNode.defaults, data));\r\n    }\r\n\r\n    /**\r\n     * @param {{x: number, y: number, offsetX: number, offsetY: number}} screen\r\n     * @param {Function|callback} calculate\r\n     * @returns {{offset: {x: number, y: number}, size: {x: number, y: number}, scale: number, angle: number}}\r\n     */\r\n    getCameraViewport(screen, calculate) {\r\n        return calculate(screen, {\r\n            offset: this.data.position,\r\n            size: this.data.size,\r\n            angle: this.data.angle,\r\n            scale: this.data.scale\r\n        });\r\n    };\r\n\r\n    /* ------------------------------ Render ------------------------------ */\r\n\r\n    /**\r\n     * @override\r\n     *\r\n     * @param {CanvasRenderingContext2D} context\r\n     * @param {{offset: {x: number, y: number}, size: {x: number, y: number}, scale: number, angle: number}} viewport\r\n     * @param {CollectionNode} collection\r\n     * @param {object} data\r\n     * @returns {BaseNode|AnimatedNode|CameraNode}\r\n     */\r\n    render(context, viewport, collection, data) {\r\n        return this;\r\n    }\r\n}\r\n","import ObjectUtil from \"utils/ObjectUtil\";\r\nimport UUID from \"utils/UUID\";\r\nimport Vector2d from \"utils/Vector2d\";\r\n\r\n/**\r\n * @class BaseNode\r\n * @exports module:nodes/BaseNode\r\n *\r\n * @abstract\r\n * @constructor\r\n * @param {BaseNode.defaults|Object} [data]\r\n * @property {BaseNode.defaults} data\r\n */\r\n\r\nexport default class BaseNode {\r\n    static defaults = {\r\n        /** @type {string|null} */\r\n        id: null,\r\n        type: 'BaseNode',\r\n\r\n        position: {\r\n            x: 0.0,\r\n            y: 0.0\r\n        },\r\n        size: {\r\n            x: 0.0,\r\n            y: 0.0\r\n        },\r\n        offset: {\r\n            x: 0.0,\r\n            y: 0.0\r\n        },\r\n\r\n        visible: true,\r\n        angle: 0.0,\r\n        scale: 1.0,\r\n        opacity: 1.0,\r\n\r\n        cache: null,\r\n        enabledCache: false // TODO:: Collections & AnimatedPrimitiveNode\r\n    };\r\n\r\n    constructor(data) {\r\n        this.data = ObjectUtil.extend(true, {}, BaseNode.defaults, data);\r\n\r\n        if (this.data.id === null) {\r\n            this.data.id = UUID.generate();\r\n        }\r\n    }\r\n\r\n    get opacity() {\r\n        return this.data.opacity;\r\n    }\r\n\r\n    set opacity(value) {\r\n        this.data.opacity = value;\r\n    }\r\n\r\n    get visible() {\r\n        return this.data.visible;\r\n    }\r\n\r\n    set visible(value) {\r\n        this.data.visible = !!value;\r\n    }\r\n\r\n    get angle() {\r\n        return this.data.angle;\r\n    }\r\n\r\n    set angle(value) {\r\n        this.data.angle = value % 360;\r\n    }\r\n\r\n    get scale() {\r\n        return this.data.scale;\r\n    }\r\n\r\n    set scale(value) {\r\n        this.data.scale = value;\r\n    }\r\n\r\n    get cache() {\r\n        return this.data.enabledCache;\r\n    }\r\n\r\n    set cache(value) {\r\n        this.data.enabledCache = !!value;\r\n    }\r\n\r\n    /**\r\n     * @param {BaseNode.defaults|Object} data\r\n     */\r\n    load(data) {\r\n        this.data = ObjectUtil.extend(true, {}, this.data, data);\r\n    }\r\n\r\n    /**\r\n     * @returns {BaseNode.defaults}\r\n     */\r\n    save() {\r\n        return this.data;\r\n    }\r\n\r\n    /**\r\n     * @returns {Vector2d}\r\n     */\r\n    getPosition() {\r\n        return new Vector2d(this.data.position.x, this.data.position.y);\r\n    }\r\n\r\n    /**\r\n     * @param {Vector2d|BaseNode} position\r\n     * @returns {BaseNode}\r\n     */\r\n    setPosition(position) {\r\n        if (position !== undefined) {\r\n            if (position instanceof Vector2d) {\r\n                this.data.position = position.getVector();\r\n            } else if (position instanceof BaseNode) {\r\n                this.data.position = position.getPosition().getVector();\r\n            }\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @returns {Vector2d}\r\n     */\r\n    getSize() {\r\n        return new Vector2d(this.data.size.x, this.data.size.y);\r\n    }\r\n\r\n    /**\r\n     * @param {Vector2d|BaseNode} size\r\n     * @returns {BaseNode}\r\n     */\r\n    setSize(size) {\r\n        if (size !== undefined) {\r\n            if (size instanceof Vector2d) {\r\n                this.data.size = size.getVector();\r\n            } else if (size instanceof BaseNode) {\r\n                this.data.size = size.getSize().getVector();\r\n            }\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @returns {Vector2d}\r\n     */\r\n    getOffset() {\r\n        return new Vector2d(this.data.offset.x, this.data.offset.y);\r\n    }\r\n\r\n    /**\r\n     * @param {Vector2d|BaseNode} offset\r\n     * @returns {BaseNode}\r\n     */\r\n    setOffset(offset) {\r\n        if (offset !== undefined) {\r\n            if (offset instanceof Vector2d) {\r\n                this.data.offset = offset.getVector();\r\n            } else if (offset instanceof BaseNode) {\r\n                this.data.offset = offset.getOffset().getVector();\r\n            }\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /* ------------------------------ Render ------------------------------ */\r\n\r\n    /**\r\n     * Must be override this in child!\r\n     *\r\n     * @deprecated\r\n     * @overridable\r\n     *\r\n     * @param {CanvasRenderingContext2D} context\r\n     * @param {{offset: {x: number, y: number}, size: {x: number, y: number}, scale: number, angle: number}} viewport\r\n     * @param {CollectionNode} collection\r\n     * @param {object} data\r\n     * @returns {BaseNode}\r\n     */\r\n    render(context, viewport, collection, data) {\r\n        // throw new Exception('Trying to render base node.'); // TODO:: exceptions\r\n        return this;\r\n    }\r\n\r\n    //TODO:: Fix on fullscreen\r\n    /**\r\n     * @param {{offset: {x: number, y: number}, size: {x: number, y: number}, scale: number, angle: number}} viewport\r\n     * @returns {boolean}\r\n     */\r\n    inViewport(viewport) {\r\n        return !((this.data.position.x > viewport.offset.x + viewport.size.x\r\n        || this.data.position.x + viewport.size.x < viewport.offset.x)\r\n        || (this.data.position.y > viewport.offset.y + viewport.size.y\r\n        || this.data.position.y + viewport.size.y < viewport.offset.y));\r\n    }\r\n}\r\n\r\n\r\n\r\n\r\n","import ObjectUtil from \"utils/ObjectUtil\";\r\nimport BaseNode from \"nodes/BaseNode\";\r\nimport Vector2d from \"utils/Vector2d\";\r\nimport Tween from \"transitions/Tween\";\r\n\r\n// TODO:: move(+v.x, +v.y)\r\n\r\n/**\r\n * @class AnimatedNode\r\n * @exports module:nodes/AnimatedNode\r\n *\r\n * @abstract\r\n * @constructor\r\n * @extends nodes/BaseNode\r\n * @param {BaseNode.defaults|AnimatedNode.defaults|Object} [data]\r\n * @property {BaseNode.defaults|AnimatedNode.defaults} data\r\n */\r\nexport default class AnimatedNode extends BaseNode {\r\n    static defaults = {\r\n        type: 'AnimatedNode'\r\n    };\r\n\r\n    constructor(data) {\r\n        super(ObjectUtil.extend(true, {}, AnimatedNode.defaults, data));\r\n    }\r\n\r\n    /**\r\n     * @param {Vector2d|BaseNode} position\r\n     * @param {number} [duration]\r\n     * @param {boolean} [durationAsSpeed]\r\n     */\r\n    moveTo(position, duration, durationAsSpeed) {\r\n        if (duration === undefined || typeof duration !== 'number') duration = 1000.0;\r\n\r\n        if (typeof position === 'object') {\r\n            var tween = new Tween(this);\r\n\r\n            if (position instanceof Vector2d) {\r\n                if (durationAsSpeed) duration = Vector2d.getDistance(this.getPosition(), position) / duration;\r\n                tween.to({\r\n                    position: {\r\n                        x: position.getVector().x,\r\n                        y: position.getVector().y\r\n                    }\r\n                }, duration);\r\n            } else if (position instanceof BaseNode) {\r\n                if (durationAsSpeed) duration = Vector2d.getDistance(this.getPosition(), position.getPosition()) / duration;\r\n                tween.to({\r\n                    position: {\r\n                        x: position.getPosition().getVector().x,\r\n                        y: position.getPosition().getVector().y\r\n                    }\r\n                }, duration);\r\n            }\r\n\r\n            tween.start();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @param {Vector2d|BaseNode} size\r\n     * @param {number} [duration]\r\n     * @param {boolean} [durationAsSpeed]\r\n     */\r\n    resizeTo(size, duration, durationAsSpeed) {\r\n        if (duration === undefined || typeof duration !== 'number') duration = 1000.0;\r\n        if (typeof position === 'object') {\r\n            var tween = new Tween(this);\r\n\r\n            if (size instanceof Vector2d) {\r\n                if (durationAsSpeed) duration = Vector2d.getDistance(this.getSize(), size) / duration;\r\n                tween.to({\r\n                    size: {\r\n                        x: size.getVector().x,\r\n                        y: size.getVector().y\r\n                    }\r\n                }, duration);\r\n            } else if (size instanceof BaseNode) {\r\n                if (durationAsSpeed) duration = Vector2d.getDistance(this.getSize(), size.getSize()) / duration;\r\n                tween.to({\r\n                    size: {\r\n                        x: size.getSize().getVector().x,\r\n                        y: size.getSize().getVector().y\r\n                    }\r\n                }, duration);\r\n            }\r\n\r\n            tween.start();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @param {number|BaseNode} angle\r\n     * @param {number} [duration]\r\n     */\r\n    rotateTo(angle, duration) {\r\n        if (duration === undefined || typeof duration !== 'number') duration = 1000.0;\r\n        var tween = new Tween(this);\r\n\r\n        if (typeof angle === 'number') {\r\n            tween.to({angle: angle % 360}, duration);\r\n        } else if (typeof angle === 'object' && angle instanceof BaseNode) {\r\n            tween.to({\r\n                angle: Vector2d.getAngle(angle.getPosition(), this.getPosition())\r\n            }, duration);\r\n        }\r\n\r\n        tween.start();\r\n    }\r\n\r\n    /**\r\n     * @param {number} [velocity]\r\n     */\r\n    turn(velocity) {\r\n        if (velocity === undefined || typeof velocity !== 'number') velocity = 1.0;\r\n        this.angle += velocity;\r\n    }\r\n}\r\n","/**\r\n * @class Video\r\n * @exports module:media/Video\r\n *\r\n * @constructor\r\n */\r\nexport default class Video {\r\n}\r\n","import ObjectUtil from \"utils/ObjectUtil\";\r\nimport UUID from \"utils/UUID\";\r\nimport Events from \"utils/Events\";\r\nimport Audio from \"media/Audio\";\r\n\r\nvar cache = {};\r\nvar audioContext;\r\nvar masterGain;\r\n\r\nfunction createMasterGain() {\r\n    if (audioContext) {\r\n        masterGain = (audioContext.createGain === undefined)\r\n            ? audioContext.createGainNode()\r\n            : audioContext.createGain();\r\n        masterGain.gain.value = 1;\r\n        masterGain.connect(audioContext.destination);\r\n        return masterGain;\r\n    }\r\n    return null;\r\n}\r\n\r\n/**\r\n * @class Sound\r\n * @exports module:media/Sound\r\n *\r\n * @constructor\r\n * @extends media/Audio\r\n * @param {Audio.defaults|Object} [data]\r\n * @param {MediaManager} [manager]\r\n */\r\nexport default class Sound extends Audio {\r\n    static defaults = {\r\n        id: null,\r\n        src: [],\r\n        format: null,\r\n        autoPlay: false,\r\n\r\n        duration: 0,\r\n        loop: false,\r\n        sprite: {},\r\n        volume: 1,\r\n        muted: false,\r\n        pos3d: [0, 0, -0.5],\r\n        rate: 1,\r\n\r\n        loaded: false,\r\n        buffer: false,\r\n        model: null,\r\n        onEndTimer: []\r\n    };\r\n\r\n    constructor(data, manager) {\r\n        super(data, manager);\r\n\r\n        this.manager = manager;\r\n        this.events = !!this.manager ? this.manager.events : new Events();\r\n        this.data = ObjectUtil.extend(true, {}, Sound.defaults, data);\r\n        this.audioNode = [];\r\n        audioContext = manager\r\n            ? manager.getAudioContext()\r\n            : new (window.AudioContext || window.webkitAudioContext);\r\n\r\n        masterGain = manager\r\n            ? manager.getMasterGain()\r\n            : createMasterGain();\r\n\r\n        if (this.data.id === null) {\r\n            this.data.id = UUID.generate();\r\n        }\r\n\r\n        if (audioContext && this.data.buffer) {\r\n            this._setupAudioNode(this);\r\n        }\r\n\r\n        if (this.manager && audioContext && this.manager.data.iOSAutoEnable) {\r\n            this.manager.iOSEnable = true;\r\n        }\r\n\r\n        if (this.manager) this.manager.media.get('sounds').add(this.data.id, this);\r\n\r\n        this.load();\r\n    }\r\n\r\n    _load(sound) {\r\n        loadBuffer(sound, sound.data.src);\r\n        return sound;\r\n    }\r\n\r\n    _unload(soundNode) {\r\n        soundNode.disconnect(0);\r\n    }\r\n\r\n    play(sprite, callback) {\r\n        var sound = this;\r\n\r\n        if (typeof sprite === 'function')  callback = sprite;\r\n\r\n        if (!sprite || typeof sprite === 'function') sprite = 'default';\r\n\r\n        if (!sound.data.loaded) {\r\n            sound.events.on('load', function () {\r\n                sound.play(sprite, callback);\r\n            });\r\n\r\n            return sound;\r\n        }\r\n\r\n        if (!sound.data.sprite[sprite]) {\r\n            if (typeof callback === 'function') callback();\r\n            return sound;\r\n        }\r\n\r\n        sound._inactiveNode(sound, function (node) {\r\n            node.sprite = sprite;\r\n\r\n            var pos = (node.pos > 0) ? node.pos : sound.data.sprite[sprite][0] / 1000;\r\n            var duration = sound.data.sprite[sprite][1] / 1000 - node.pos;\r\n            if (node.pos > 0) pos = sound.data.sprite[sprite][0] / 1000 + pos;\r\n            var loop = !!(sound.data.loop || sound.data.sprite[sprite][2]);\r\n\r\n            var soundId = (typeof callback === 'string')\r\n                ? callback\r\n                : Math.round(Date.now() * Math.random()) + '', timerId;\r\n\r\n            (function () {\r\n                var data = {\r\n                    id: soundId,\r\n                    sprite: sprite,\r\n                    loop: loop\r\n                };\r\n\r\n                timerId = setTimeout(function () {\r\n                    if (audioContext && !loop) {\r\n                        sound._nodeById(sound, data.id).paused = true;\r\n                        sound._nodeById(sound, data.id).pos = 0;\r\n                        sound._clearEndTimer(sound, data.id);\r\n                    }\r\n                    sound.events.trigger('unload', soundId);\r\n                }, (duration / sound.data.rate) * 1000);\r\n\r\n                sound.data.onEndTimer.push({timer: timerId, id: data.id});\r\n            })();\r\n\r\n            var loopStart = sound.data.sprite[sprite][0] / 1000,\r\n                loopEnd = sound.data.sprite[sprite][1] / 1000;\r\n\r\n            node.id = soundId;\r\n            node.paused = false;\r\n            refreshBuffer(sound, [loop, loopStart, loopEnd], soundId);\r\n            sound.data.playStart = audioContext.currentTime;\r\n            node.gain.value = sound.data.volume;\r\n\r\n            if (typeof node.bufferSource.start === 'undefined') {\r\n                loop ? node.bufferSource.noteGrainOn(0, pos, 86400) : node.bufferSource.noteGrainOn(0, pos, duration);\r\n            } else {\r\n                loop ? node.bufferSource.start(0, pos, 86400) : node.bufferSource.start(0, pos, duration);\r\n            }\r\n\r\n            sound.events.trigger('play');\r\n            if (typeof callback === 'function') callback(soundId);\r\n\r\n            return sound;\r\n        });\r\n\r\n        return sound;\r\n    }\r\n\r\n    _pause(activeNode) {\r\n        if (!activeNode.bufferSource || activeNode.paused) {\r\n            return true;\r\n        }\r\n\r\n        activeNode.paused = true;\r\n        if (activeNode.bufferSource.stop == undefined) {\r\n            activeNode.bufferSource.noteOff(0);\r\n        } else {\r\n            activeNode.bufferSource.stop(0);\r\n        }\r\n        return false;\r\n    }\r\n\r\n    _stop(activeNode) {\r\n        if (!activeNode.bufferSource || activeNode.paused) {\r\n            return true;\r\n        }\r\n\r\n        activeNode.paused = true;\r\n\r\n        if (typeof activeNode.bufferSource.stop === 'undefined') {\r\n            activeNode.bufferSource.noteOff(0);\r\n        } else {\r\n            activeNode.bufferSource.stop(0);\r\n        }\r\n        return false;\r\n    }\r\n\r\n    _mute(activeNode) {\r\n        activeNode.gain.value = 0;\r\n    }\r\n\r\n    _unMute(activeNode) {\r\n        activeNode.gain.value = this.data.volume;\r\n    }\r\n\r\n    _volume(activeNode, vol) {\r\n        activeNode.gain.value = vol;\r\n    }\r\n\r\n    _position(activeNode, v) {\r\n        if (v !== undefined && v == true) return activeNode.pos;\r\n        return activeNode.pos + (audioContext.currentTime - this.data.playStart);\r\n    }\r\n\r\n    _pos3d(activeNode, x, y, z) {\r\n        if (activeNode) {\r\n            this.data.pos3d = [x, y, z];\r\n            activeNode.panner.setPosition(x, y, z);\r\n            activeNode.panner.panningModel = this.data.model || 'HRTF';\r\n        }\r\n    }\r\n\r\n    _setupAudioNode() {\r\n        var sound = this,\r\n            node = sound.audioNode,\r\n            index = sound.audioNode.length;\r\n\r\n        node[index] = (audioContext.createGain === undefined)\r\n            ? audioContext.createGainNode()\r\n            : audioContext.createGain();\r\n\r\n        node[index].gain.value = sound.data.volume;\r\n        node[index].paused = true;\r\n        node[index].pos = 0;\r\n        node[index].readyState = 4;\r\n        node[index].connect(masterGain);\r\n\r\n        node[index].panner = audioContext.createPanner();\r\n        node[index].panner.panningModel = sound.data.model || 'equalpower';\r\n        node[index].panner.setPosition(sound.data.pos3d[0], sound.data.pos3d[1], sound.data.pos3d[2]);\r\n        node[index].panner.connect(node[index]);\r\n\r\n        return node[index];\r\n    }\r\n\r\n    /* Private */\r\n    _inactiveNode(sound, callback) {\r\n        var node = null;\r\n\r\n        for (var i = 0; i < sound.audioNode.length; i++) {\r\n            if (sound.audioNode[i].paused && sound.audioNode[i].readyState === 4) {\r\n                callback(sound.audioNode[i]);\r\n                node = true;\r\n                break;\r\n            }\r\n        }\r\n\r\n        sound._drainPool(sound);\r\n\r\n        if (node) return;\r\n\r\n        var newNode = sound._setupAudioNode();\r\n        callback(newNode);\r\n    }\r\n\r\n    _drainPool(sound) {\r\n        var inactive = 0;\r\n\r\n        for (var i = 0; i < sound.audioNode.length; i++) {\r\n            if (sound.audioNode[i].paused) inactive++;\r\n        }\r\n\r\n        for (i = sound.audioNode.length - 1; i >= 0; i--) {\r\n            if (inactive <= 5) break;\r\n\r\n            if (sound.audioNode[i].paused) {\r\n                if (audioContext) sound.audioNode[i].disconnect(0);\r\n                sound.audioNode.splice(i, 1);\r\n                inactive--;\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n\r\n/* WebAudioAPI Helpers */\r\n/**\r\n * Buffer a sound from URL (or from cache) and decode to audio source (Web Audio API).\r\n * @param  {Object} sound The Sound object for the sound to load.\r\n * @param  {String} url The path to the sound file.\r\n */\r\nvar loadBuffer = function (sound, url) {\r\n    if (url in cache) {\r\n        sound.data.duration = cache[url].duration;\r\n\r\n        loadSound(sound);\r\n        return;\r\n    }\r\n\r\n    if (/^data:[^;]+;base64,/.test(url)) {\r\n        var data = atob(url.split(',')[1]);\r\n        var dataView = new Uint8Array(data.length);\r\n        for (var i = 0; i < data.length; ++i) {\r\n            dataView[i] = data.charCodeAt(i);\r\n        }\r\n\r\n        decodeAudioData(dataView.buffer, sound, url);\r\n    } else {\r\n        var xhr = new XMLHttpRequest();\r\n        xhr.open('GET', url, true);\r\n        xhr.responseType = 'arraybuffer';\r\n        xhr.onload = function () {\r\n            decodeAudioData(xhr.response, sound, url);\r\n        };\r\n        xhr.onerror = function () {\r\n            if (audioContext) {\r\n                sound.data.buffer = true;\r\n                sound.audioNode = [];\r\n                delete sound.gainNode;\r\n                delete cache[url];\r\n                sound.load();\r\n            }\r\n        };\r\n        try {\r\n            xhr.send();\r\n        } catch (e) {\r\n            xhr.onerror();\r\n        }\r\n    }\r\n};\r\n\r\n/**\r\n * Decode audio data from an array buffer.\r\n * @param  {ArrayBuffer} arraybuffer The audio data.\r\n * @param  {Object} sound The Sound object for the sound to load.\r\n * @param  {String} url The path to the sound file.\r\n */\r\nvar decodeAudioData = function (arraybuffer, sound, url) {\r\n    audioContext.decodeAudioData(\r\n        arraybuffer,\r\n        function (buffer) {\r\n            if (buffer) {\r\n                cache[url] = buffer;\r\n                loadSound(sound, buffer);\r\n            }\r\n        },\r\n        function (error) {\r\n            sound.events.trigger('loaderror', error);\r\n        }\r\n    );\r\n};\r\n\r\n/**\r\n * Finishes loading the Web Audio API sound and fires the loaded event\r\n * @param  {Object}  sound    The Sound object for the sound to load.\r\n * @param  {Object} [buffer] The decoded buffer sound source.\r\n */\r\nvar loadSound = function (sound, buffer) {\r\n    sound.data.duration = (buffer) ? buffer.duration : sound.data.duration;\r\n\r\n    if (Object.getOwnPropertyNames(sound.data.sprite).length === 0) {\r\n        sound.data.sprite = {default: [0, sound.data.duration * 1000]};\r\n    }\r\n\r\n    if (!sound.data.loaded) {\r\n        sound.data.loaded = true;\r\n        sound.events.trigger('load');\r\n    }\r\n\r\n    if (sound.data.autoPlay) {\r\n        sound.play();\r\n    }\r\n};\r\n\r\n/**\r\n * Load the sound back into the buffer source.\r\n * @param  {Object} sound   The sound to load.\r\n * @param  {Array}  loop  Loop boolean, pos, and duration.\r\n * @param  {String} id    (optional) The play instance ID.\r\n */\r\nvar refreshBuffer = function (sound, loop, id) {\r\n    var node = sound._nodeById(sound, id);\r\n\r\n    node.bufferSource = audioContext.createBufferSource();\r\n    node.bufferSource.buffer = cache[sound.data.src];\r\n    node.bufferSource.connect(node.panner);\r\n    node.bufferSource.loop = loop[0];\r\n    if (loop[0]) {\r\n        node.bufferSource.loopStart = loop[1];\r\n        node.bufferSource.loopEnd = loop[1] + loop[2];\r\n    }\r\n    //noinspection JSPrimitiveTypeWrapperUsage\r\n    node.bufferSource.playbackRate.value = sound.data.rate;\r\n};\r\n","import ObjectUtil from \"utils/ObjectUtil\";\r\nimport UUID from \"utils/UUID\";\r\nimport Events from \"utils/Events\";\r\n\r\nvar cache = {};\r\nvar AudioNode = window.Audio;\r\n\r\n/**\r\n * @class Audio\r\n * @exports module:media/Audio\r\n *\r\n * @constructor\r\n * @param {Audio.defaults|Object} [data]\r\n * @param {MediaManager} [manager]\r\n */\r\nexport default class Audio {\r\n    static defaults = {\r\n        id: null,\r\n        src: [],\r\n        format: null,\r\n        autoPlay: false,\r\n\r\n        duration: 0,\r\n        loop: false,\r\n        sprite: {},\r\n        volume: 1,\r\n        muted: false,\r\n        pos3d: [0, 0, -0.5],\r\n\r\n        loaded: false,\r\n        onEndTimer: []\r\n    };\r\n\r\n    constructor(data, manager) {\r\n        var audio = this;\r\n        audio.manager = manager !== undefined ? manager : null;\r\n        audio.events = !!audio.manager ? audio.manager.events : new Events();\r\n        audio.data = ObjectUtil.extend(true, {}, Audio.defaults, data);\r\n\r\n        audio.audioNode = [];\r\n\r\n        if (audio.data.id === null) {\r\n            audio.data.id = UUID.generate();\r\n        }\r\n\r\n        if (audio.manager) audio.manager.media.get('audios').add(audio.data.id, audio);\r\n\r\n        audio.load();\r\n    }\r\n\r\n\r\n    _load(audio) {\r\n        var audioNode = new AudioNode();\r\n\r\n        audioNode.addEventListener('error', function () {\r\n            console.error({type: audioNode.error ? audioNode.error.code : 0});\r\n        }, false);\r\n\r\n        audio.audioNode.push(audioNode);\r\n\r\n        audioNode.src = audio.data.src;\r\n        audioNode.pos = 0;\r\n        audioNode.preload = 'auto';\r\n        audioNode.volume = (!!audio.manager)\r\n            ? (audio.manager.muted) ? 0 : audio.data.volume * (audio.manager.volume / 100)\r\n            : (audio.data.muted) ? 0 : audio.data.volume;\r\n\r\n        var listener = function () {\r\n            audio.data.duration = Math.ceil(audioNode.duration * 10) / 10;\r\n\r\n            if (Object.getOwnPropertyNames(audio.data.sprite).length === 0) {\r\n                audio.data.sprite = {default: [0, audio.data.duration * 1000]};\r\n            }\r\n\r\n            if (!audio.data.loaded) {\r\n                audio.data.loaded = true;\r\n                audio.events.trigger('load');\r\n            }\r\n\r\n            if (audio.data.autoPlay) {\r\n                audio.play();\r\n            }\r\n\r\n            audioNode.removeEventListener('canplaythrough', listener, false);\r\n        };\r\n        audioNode.addEventListener('canplaythrough', listener, false);\r\n        audioNode.load();\r\n\r\n        return audio;\r\n    }\r\n\r\n    load() {\r\n        var audio = this;\r\n        var url = '', extension = '';\r\n\r\n        if (audio.manager && (!!audio.manager.isSupportAudio)) {\r\n            console.warn('No audio support.');\r\n            return false;\r\n        }\r\n\r\n        var extractFormat = function (source, format) {\r\n            if (format) return format;\r\n\r\n            var extension = /^data:audio\\/([^;,]+);/i.exec(source);\r\n            if (!extension) {\r\n                extension = /\\.([^.]+)$/.exec(source.split('?', 1)[0]);\r\n            }\r\n\r\n            if (extension) {\r\n                return extension[1].toLowerCase();\r\n            } else {\r\n                console.warn('Could not extract format from passed URLs, please add format');\r\n            }\r\n            return null;\r\n        };\r\n\r\n        if (audio.data.src instanceof Array) {\r\n            for (var i = 0; i < audio.data.src.length; i++) {\r\n                url = audio.data.src[i];\r\n                extension = extractFormat(audio.data.src[i], audio.data.format);\r\n                if (null !== extension) break;\r\n            }\r\n            audio.data.src = url;\r\n        } else if (typeof audio.data.src === 'string') {\r\n            extension = extractFormat(audio.data.src, audio.data.format);\r\n        } else {\r\n            console.warn('Unknown audio source');\r\n            return false;\r\n        }\r\n\r\n        if (audio.manager && audio.manager.isSupportCodec[extension]) {\r\n            console.warn('Codec not support');\r\n            return false;\r\n        }\r\n\r\n        return audio._load(audio);\r\n    }\r\n\r\n    _unload(audioNode) {\r\n        audioNode.src = '';\r\n    }\r\n\r\n    unload() {\r\n        var audio = this;\r\n\r\n        var nodes = audio.audioNode;\r\n        for (var i = 0; i < audio.audioNode.length; i++) {\r\n            if (!nodes[i].paused) {\r\n                audio.stop(nodes[i].id);\r\n                audio.events.trigger('unload', nodes[i].id);\r\n            }\r\n            audio._unload(nodes[i]);\r\n        }\r\n\r\n        for (i = 0; i < audio.data.onEndTimer.length; i++) {\r\n            clearTimeout(audio.data.onEndTimer[i].timer);\r\n        }\r\n\r\n        if (audio.manager) {\r\n            var audios = this.manager.get('audios');\r\n            var index = audios.indexOf(audio);\r\n            if (index !== null && index >= 0) {\r\n                audios.splice(index, 1);\r\n            }\r\n        }\r\n\r\n        delete cache[audio.data.src];\r\n        audio = null;\r\n    };\r\n\r\n    src(source) {\r\n        var audio = this;\r\n\r\n        if (source) {\r\n            audio.stop();\r\n            audio.data.src = source;\r\n            audio.data.loaded = false;\r\n            audio.load();\r\n        } //TODO:: else throw\r\n\r\n        return null;\r\n    }\r\n\r\n    play(sprite, callback) {\r\n        var audio = this;\r\n\r\n        if (typeof sprite === 'function') callback = sprite;\r\n        if (!sprite || typeof sprite === 'function') sprite = 'default';\r\n\r\n        if (!audio.data.loaded) {\r\n            audio.events.on('load', function () {\r\n                audio.play(sprite, callback);\r\n            });\r\n\r\n            return audio;\r\n        }\r\n\r\n        if (!audio.data.sprite[sprite]) {\r\n            if (typeof callback === 'function') callback();\r\n            return audio;\r\n        }\r\n\r\n        audio._inactiveNode(audio, function (node) {\r\n            node.sprite = sprite;\r\n\r\n            var pos = (node.pos > 0) ? node.pos : audio.data.sprite[sprite][0] / 1000;\r\n            var duration = audio.data.sprite[sprite][1] / 1000 - (pos - audio.data.sprite[sprite][0] / 1000);\r\n            var loop = !!(audio.data.loop || audio.data.sprite[sprite][2]);\r\n\r\n            var soundId = (typeof callback === 'string')\r\n                ? callback\r\n                : Math.round(Date.now() * Math.random()) + '', timerId;\r\n\r\n            (function () {\r\n                var data = {\r\n                    id: soundId,\r\n                    sprite: sprite,\r\n                    loop: loop\r\n                };\r\n\r\n                timerId = setTimeout(function () {\r\n                    if (loop) {\r\n                        audio.stop(data.id).play(sprite, data.id);\r\n                    } else {\r\n                        audio.stop(data.id);\r\n                    }\r\n\r\n                    audio.events.trigger('unload', soundId);\r\n                }, (duration / audio.data.rate) * 1000);\r\n\r\n                audio.data.onEndTimer.push({timer: timerId, id: data.id});\r\n            })();\r\n\r\n\r\n            if (node.readyState === 4 || !node.readyState && navigator.isCocoonJS) {\r\n                node.id = soundId;\r\n                node.currentTime = pos;\r\n\r\n                node.muted = audio.manager\r\n                    ? (audio.manager.muted || node.muted)\r\n                    : (audio.data.muted || node.muted);\r\n\r\n                node.volume = audio.manager\r\n                    ? audio.data.volume * (audio.manager.volume / 100)\r\n                    : audio.data.volume;\r\n\r\n                setTimeout(function () {\r\n                    node.play();\r\n                }, 0);\r\n            } else {\r\n                audio._clearEndTimer(soundId);\r\n\r\n                (function () {\r\n                    var audio = audio,\r\n                        playSprite = sprite,\r\n                        fn = callback,\r\n                        newNode = node;\r\n\r\n                    var listener = function () {\r\n                        audio.play(playSprite, fn);\r\n                        newNode.removeEventListener('canplaythrough', listener, false);\r\n                    };\r\n\r\n                    newNode.addEventListener('canplaythrough', listener, false);\r\n                })();\r\n\r\n                return audio;\r\n            }\r\n\r\n            audio.events.trigger('play');\r\n            if (typeof callback === 'function') callback(soundId);\r\n\r\n            return audio;\r\n        });\r\n\r\n        return audio;\r\n    }\r\n\r\n    _pause(activeNode) {\r\n        activeNode.pause();\r\n        return false;\r\n    }\r\n\r\n    pause(id) {\r\n        var audio = this;\r\n\r\n        if (!audio.data.loaded) {\r\n            audio.events.on('play', function () {\r\n                audio.pause(id);\r\n            });\r\n            return audio;\r\n        }\r\n\r\n        audio._clearEndTimer(audio, id);\r\n\r\n        var activeNode = (id) ? audio._nodeById(id) : audio._activeNode(audio);\r\n        if (activeNode) {\r\n            activeNode.pos = audio.pos(null, id);\r\n            var result = audio._pause(activeNode);\r\n            if (result) return audio;\r\n        }\r\n\r\n        audio.events.trigger('pause');\r\n\r\n        return audio;\r\n    }\r\n\r\n    _stop(activeNode) {\r\n        if (!isNaN(activeNode.duration)) {\r\n            activeNode.pause();\r\n            activeNode.currentTime = 0;\r\n        }\r\n        return false;\r\n    }\r\n\r\n    stop(id) {\r\n        var audio = this;\r\n\r\n        if (!audio.data.loaded) {\r\n            audio.events.on('play', function () {\r\n                audio.stop(id);\r\n            });\r\n\r\n            return audio;\r\n        }\r\n\r\n        audio._clearEndTimer(audio, id);\r\n\r\n        var activeNode = (id) ? audio._nodeById(audio, id) : audio._activeNode(audio);\r\n        if (activeNode) {\r\n            activeNode.pos = 0;\r\n            var result = audio._stop(activeNode);\r\n            if (result) return audio;\r\n        }\r\n\r\n        return audio;\r\n    }\r\n\r\n    _mute(activeNode) {\r\n        activeNode.muted = true;\r\n    }\r\n\r\n    mute(id) {\r\n        var audio = this;\r\n\r\n        if (!audio.data.loaded) {\r\n            audio.events.on('play', function () {\r\n                audio.mute(id);\r\n            });\r\n            return audio;\r\n        }\r\n\r\n        var activeNode = (id) ? audio._nodeById(id) : audio._activeNode(audio);\r\n        if (activeNode) audio._mute();\r\n\r\n        return audio;\r\n    }\r\n\r\n    _unMute(activeNode) {\r\n        activeNode.muted = false;\r\n    }\r\n\r\n    unMute(id) {\r\n        var audio = this;\r\n\r\n        if (!audio.data.loaded) {\r\n            audio.events.on('play', function () {\r\n                audio.unMute(id);\r\n            });\r\n            return audio;\r\n        }\r\n\r\n        var activeNode = (id) ? audio._nodeById(id) : audio._activeNode(audio);\r\n        if (activeNode) audio._unMute();\r\n\r\n        return audio;\r\n    }\r\n\r\n    _volume(activeNode, vol) {\r\n        activeNode.volume = vol;\r\n    }\r\n\r\n    volume(vol, id) {\r\n        var audio = this;\r\n\r\n        vol = parseFloat(vol);\r\n\r\n        if (vol >= 0 && vol <= 1) {\r\n            audio.data.volume = vol;\r\n\r\n            if (!audio.data.loaded) {\r\n                audio.events.on('play', function () {\r\n                    audio.volume(vol, id);\r\n                });\r\n                return audio;\r\n            }\r\n\r\n            var activeNode = (id) ? audio._nodeById(id) : audio._activeNode(audio);\r\n            if (activeNode) {\r\n                vol = audio.manager\r\n                    ? vol * (audio.manager.volume / 100)\r\n                    : audio.data.volume;\r\n                audio._volume(vol);\r\n            }\r\n\r\n            return audio;\r\n        }\r\n        return audio.data.volume;\r\n    }\r\n\r\n    loop(loop) {\r\n        var audio = this;\r\n\r\n        if (typeof loop === 'boolean') {\r\n            audio.data.loop = loop;\r\n            return audio;\r\n        }\r\n        return audio.data.loop;\r\n    }\r\n\r\n    sprite(sprite) {\r\n        var audio = this;\r\n\r\n        if (typeof sprite === 'object') {\r\n            audio.data.sprite = sprite;\r\n            return audio;\r\n        }\r\n        return audio.data.sprite;\r\n    }\r\n\r\n    _position(activeNode, v) {\r\n        return activeNode.currentTime;\r\n    }\r\n\r\n    pos(pos, id) {\r\n        var audio = this;\r\n\r\n        if (!audio.data.loaded) {\r\n            audio.events.on('load', function () {\r\n                audio.pos(pos);\r\n            });\r\n            return typeof pos === 'number' ? audio : audio.data.pos || 0;\r\n        }\r\n\r\n        pos = parseFloat(pos);\r\n\r\n        var activeNode = (id) ? audio._nodeById(id) : audio._activeNode(audio);\r\n        if (activeNode) {\r\n            if (pos >= 0) {\r\n                audio.pause(id);\r\n                activeNode.pos = pos;\r\n                audio.play(activeNode.sprite, id);\r\n                return audio;\r\n            } else {\r\n                return audio._position(activeNode, false);\r\n            }\r\n        } else if (pos >= 0) {\r\n            return audio;\r\n        } else {\r\n            for (var i = 0; i < audio.audioNode.length; i++) {\r\n                if (audio.audioNode[i].paused && audio.audioNode[i].readyState === 4) {\r\n                    return audio._position(audio.audioNode[i], true);\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    _pos3d(activeNode, x, y, zsaz) {\r\n        return null;\r\n    }\r\n\r\n    pos3d(x, y, z, id) {\r\n        var audio = this;\r\n\r\n        y = (typeof y === 'undefined' || !y) ? 0 : y;\r\n        z = (typeof z === 'undefined' || !z) ? -0.5 : z;\r\n\r\n        if (!audio.data.loaded) {\r\n            audio.events.on('play', function () {\r\n                audio.pos3d(x, y, z, id);\r\n            });\r\n            return audio;\r\n        }\r\n\r\n        if (x >= 0 || x < 0) {\r\n            var activeNode = (id) ? audio._nodeById(id) : audio._activeNode(audio);\r\n            audio._pos3d(activeNode, x, y, z);\r\n        } else {\r\n            return audio.data.pos3d;\r\n        }\r\n\r\n        return audio;\r\n    }\r\n\r\n    /* Private */\r\n    _nodeById(audio, id) {\r\n        var node = audio.audioNode[0];\r\n\r\n        for (var i = 0; i < audio.audioNode.length; i++) {\r\n            if (audio.audioNode[i].id === id) {\r\n                node = audio.audioNode[i];\r\n                break;\r\n            }\r\n        }\r\n\r\n        return node;\r\n    }\r\n\r\n    _clearEndTimer(audio, id) {\r\n        var index = -1;\r\n\r\n        for (var i = 0; i < audio.data.onEndTimer.length; i++) {\r\n            if (audio.data.onEndTimer[i].id === id) {\r\n                index = i;\r\n                break;\r\n            }\r\n        }\r\n\r\n        var timer = audio.data.onEndTimer[index];\r\n        if (timer) {\r\n            clearTimeout(timer.timer);\r\n            audio.data.onEndTimer.splice(index, 1);\r\n        }\r\n    }\r\n\r\n    _activeNode(audio) {\r\n        var node = null;\r\n\r\n        for (var i = 0; i < audio.audioNode.length; i++) {\r\n            if (!audio.audioNode[i].paused) {\r\n                node = audio.audioNode[i];\r\n                break;\r\n            }\r\n        }\r\n\r\n        audio._drainPool(audio);\r\n\r\n        return node;\r\n    }\r\n\r\n    _inactiveNode(audio, callback) {\r\n        var node = null;\r\n\r\n        for (var i = 0; i < audio.audioNode.length; i++) {\r\n            if (audio.audioNode[i].paused && audio.audioNode[i].readyState === 4) {\r\n                callback(audio.audioNode[i]);\r\n                node = true;\r\n                break;\r\n            }\r\n        }\r\n\r\n        audio._drainPool(audio);\r\n\r\n        if (node) return;\r\n\r\n        audio.load();\r\n        var newNode = audio.audioNode[audio.audioNode.length - 1];\r\n        var listenerEvent = navigator.isCocoonJS ? 'canplaythrough' : 'loadedmetadata';\r\n        var listener = function () {\r\n            newNode.removeEventListener(listenerEvent, listener, false);\r\n            callback(newNode);\r\n        };\r\n        newNode.addEventListener(listenerEvent, listener, false);\r\n    }\r\n\r\n    _drainPool(audio) {\r\n        var inactive = 0;\r\n\r\n        for (var i = 0; i < audio.audioNode.length; i++) {\r\n            if (audio.audioNode[i].paused) inactive++;\r\n        }\r\n\r\n        for (i = audio.audioNode.length - 1; i >= 0; i--) {\r\n            if (inactive <= 5) break;\r\n\r\n            if (audio.audioNode[i].paused) {\r\n                audio.audioNode.splice(i, 1);\r\n                inactive--;\r\n            }\r\n        }\r\n    }\r\n}\r\n","/**\r\n * Assets Loader\r\n *\r\n * @class AssetsLoader\r\n * @exports module:loaders/AssetsLoader\r\n *\r\n * @constructor\r\n */\r\nexport default class AssetsLoader {\r\n    progress = 0;\r\n\r\n    getProgress() {\r\n        return this.progress;\r\n    }\r\n\r\n    load() {\r\n    }\r\n\r\n    isLoaded(index) {\r\n    }\r\n\r\n    dispose(index) {\r\n    }\r\n}\r\n","import Exception from \"exceptions/Exception\";\r\n\r\n/**\r\n * UnexpectedValueException\r\n * Create custom exception with message\r\n *\r\n * @class UnexpectedValueException\r\n * @exports module:exceptions/UnexpectedValueException\r\n *\r\n * @constructor\r\n * @extends Exception\r\n * @param {string} message\r\n * @property {string} message\r\n */\r\nexport default class UnexpectedValueException extends Exception {\r\n    constructor(message) {\r\n        super(message)\r\n    }\r\n\r\n    /**\r\n     * Convert exception to String\r\n     * @returns {string}\r\n     */\r\n    toString = function () {\r\n        return this.message;\r\n    }\r\n}\r\n","import Exception from \"exceptions/Exception\";\r\n\r\n/**\r\n * RuntimeException\r\n * Create custom exception with message\r\n *\r\n * @class RuntimeException\r\n * @exports module:exceptions/RuntimeException\r\n *\r\n * @constructor\r\n * @extends Exception\r\n * @param {string} message\r\n * @property {string} message\r\n */\r\nexport default class RuntimeException extends Exception {\r\n    constructor(message) {\r\n        super(message)\r\n    }\r\n\r\n    /**\r\n     * Convert exception to String\r\n     * @returns {string}\r\n     */\r\n    toString = function () {\r\n        return this.message;\r\n    }\r\n}\r\n","import Exception from \"exceptions/Exception\";\r\n\r\n/**\r\n * RangeException\r\n * Create custom exception with message\r\n *\r\n * @class RangeException\r\n * @exports module:exceptions/RangeException\r\n *\r\n * @constructor\r\n * @extends Exception\r\n * @param {string} message\r\n * @property {string} message\r\n */\r\nexport default class RangeException extends Exception {\r\n    constructor(message) {\r\n        super(message)\r\n    }\r\n\r\n    /**\r\n     * Convert exception to String\r\n     * @returns {string}\r\n     */\r\n    toString = function () {\r\n        return this.message;\r\n    }\r\n}\r\n","import Exception from \"exceptions/Exception\";\r\n\r\n/**\r\n * OutOfRangeException\r\n * Create custom exception with message\r\n *\r\n * @class OutOfRangeException\r\n * @exports module:exceptions/OutOfRangeException\r\n *\r\n * @constructor\r\n * @extends Exception\r\n * @param {string} message\r\n * @property {string} message\r\n */\r\nexport default class OutOfRangeException extends Exception {\r\n    constructor(message) {\r\n        super(message)\r\n    }\r\n\r\n    /**\r\n     * Convert exception to String\r\n     * @returns {string}\r\n     */\r\n    toString = function () {\r\n        return this.message;\r\n    }\r\n}\r\n","import Exception from \"exceptions/Exception\";\r\n\r\n/**\r\n * OutOfBoundsException\r\n * Create custom exception with message\r\n *\r\n * @class OutOfBoundsException\r\n * @exports module:exceptions/OutOfBoundsException\r\n *\r\n * @constructor\r\n * @extends Exception\r\n * @param {string} message\r\n * @property {string} message\r\n */\r\nexport default class OutOfBoundsException extends Exception {\r\n    constructor(message) {\r\n        super(message)\r\n    }\r\n\r\n    /**\r\n     * Convert exception to String\r\n     * @returns {string}\r\n     */\r\n    toString = function () {\r\n        return this.message;\r\n    }\r\n}\r\n","import Exception from \"exceptions/Exception\";\r\n\r\n/**\r\n * LogicException\r\n * Create custom exception with message\r\n *\r\n * @class LogicException\r\n * @exports module:exceptions/LogicException\r\n *\r\n * @constructor\r\n * @extends Exception\r\n * @param {string} message\r\n * @property {string} message\r\n */\r\nexport default class LogicException extends Exception {\r\n    constructor(message) {\r\n        super(message)\r\n    }\r\n\r\n    /**\r\n     * Convert exception to String\r\n     * @returns {string}\r\n     */\r\n    toString = function () {\r\n        return this.message;\r\n    }\r\n}\r\n","import Exception from \"exceptions/Exception\";\r\n\r\n/**\r\n * LengthException\r\n * Create custom exception with message\r\n *\r\n * @class LengthException\r\n * @exports module:exceptions/LengthException\r\n *\r\n * @constructor\r\n * @extends Exception\r\n * @param {string} message\r\n * @property {string} message\r\n */\r\nexport default class LengthException extends Exception {\r\n    constructor(message) {\r\n        super(message)\r\n    }\r\n\r\n    /**\r\n     * Convert exception to String\r\n     * @returns {string}\r\n     */\r\n    toString = function () {\r\n        return this.message;\r\n    }\r\n}\r\n","/**\r\n * Default Exception\r\n * Create custom exception with message\r\n *\r\n * @class Exception\r\n * @exports module:exceptions/Exception\r\n *\r\n * @constructor\r\n * @extends Error\r\n * @param {string} message\r\n * @property {string} message\r\n */\r\nexport default class Exception extends Error {\r\n    constructor(message) {\r\n        super(message);\r\n        this.message = message;\r\n\r\n        /**\r\n         * Convert exception to String\r\n         * @returns {string}\r\n         */\r\n        this.toString = function () {\r\n            return this.message;\r\n        }\r\n    }\r\n}\r\n","import Exception from \"exceptions/Exception\";\r\n\r\n/**\r\n * BadMethodCallException\r\n * Create custom exception with message\r\n *\r\n * @class BadMethodCallException\r\n * @exports module:exceptions/BadMethodCallException\r\n *\r\n * @constructor\r\n * @extends Exception\r\n * @param {string} message\r\n * @property {string} message\r\n */\r\nexport default class BadMethodCallException extends Exception {\r\n    constructor(message) {\r\n        super(message)\r\n    }\r\n\r\n    /**\r\n     * Convert exception to String\r\n     * @returns {string}\r\n     */\r\n    toString = function () {\r\n        return this.message;\r\n    }\r\n}\r\n","import Exception from \"exceptions/Exception\";\r\n\r\n/**\r\n * BadFunctionCallException\r\n * Create custom exception with message\r\n *\r\n * @class BadFunctionCallException\r\n * @exports module:exceptions/BadFunctionCallException\r\n *\r\n * @constructor\r\n * @extends Exception\r\n * @param {string} message\r\n * @property {string} message\r\n */\r\nexport default class BadFunctionCallException extends Exception {\r\n    constructor(message) {\r\n        super(message)\r\n    }\r\n\r\n    /**\r\n     * Convert exception to String\r\n     * @returns {string}\r\n     */\r\n    toString = function () {\r\n        return this.message;\r\n    }\r\n}\r\n","/**\r\n * @class Events\r\n * @exports module:utils/Events\r\n *\r\n * @constructor\r\n */\r\nexport default class Events {\r\n    events = [];\r\n    onces = [];\r\n\r\n    constructor() {\r\n        this.flush();\r\n    }\r\n\r\n    /**\r\n     * @param {string} [eventName]\r\n     */\r\n    flush(eventName) {\r\n        if (eventName !== undefined) {\r\n            if (this.events[eventName] !== undefined) {\r\n                this.events[eventName] = [];\r\n            }\r\n            if (this.onces[eventName] !== undefined) {\r\n                this.onces[eventName] = [];\r\n            }\r\n        } else {\r\n            this.onces = [];\r\n            this.events = [];\r\n        }\r\n    }\r\n\r\n\r\n    /**\r\n     * @param {string} eventName\r\n     * @param {function} callback\r\n     */\r\n    on(eventName, callback) {\r\n        if (this.events[eventName] !== undefined) {\r\n            var stack = this.events[eventName];\r\n            if (stack.indexOf(callback) === -1) {\r\n                stack.push(callback);\r\n            }\r\n        } else {\r\n            this.events[eventName] = [];\r\n            this.events[eventName].push(callback)\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @param {string} eventName\r\n     * @param {function} callback\r\n     */\r\n    once(eventName, callback) {\r\n        if (this.onces[eventName] !== undefined) {\r\n            var stack = this.onces[eventName];\r\n            if (stack.indexOf(callback) === -1) {\r\n                stack.push(callback);\r\n            }\r\n        } else {\r\n            this.onces[eventName] = [];\r\n            this.onces[eventName].push(callback)\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @param {string} eventName\r\n     * @param {function} callback\r\n     */\r\n    off(eventName, callback) {\r\n        if (this.onces[eventName] !== undefined) {\r\n            var stack = this.events[eventName];\r\n            if (stack.indexOf(callback) !== -1) {\r\n                stack.splice(stack.indexOf(callback));\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @param {string} eventName\r\n     * @param {Object} [data]\r\n     */\r\n    trigger(eventName, data) {\r\n        var stack, i;\r\n\r\n        if (this.events[eventName] !== undefined) {\r\n            stack = this.events[eventName];\r\n            for (i = 0; i < stack.length; i++) {\r\n                stack[i].call(stack[i], data);\r\n            }\r\n        }\r\n\r\n        if (this.onces[eventName] !== undefined) {\r\n            stack = this.onces[eventName];\r\n            for (i = 0; i < stack.length; i++) {\r\n                stack[i].call(stack[i], data);\r\n            }\r\n            this.flush(eventName);\r\n        }\r\n    };\r\n}\r\n","/**\r\n * @class ArrayMap\r\n * @exports module:utils/ArrayMap\r\n *\r\n * @constructor\r\n * @extends Array\r\n * @param args\r\n */\r\nexport default class ArrayMap extends Array {\r\n    last = () => {\r\n        return this[this.length - 1];\r\n    };\r\n\r\n    constructor(args) {\r\n        super(args);\r\n    }\r\n\r\n    /**\r\n     * @param {ArrayMap.<T>} array\r\n     * @returns {boolean}\r\n     */\r\n    equals(array) {\r\n        if (!array)\r\n            return false;\r\n\r\n        if (this.length != array.length)\r\n            return false;\r\n\r\n        for (var i = 0, l = this.length; i < l; i++) {\r\n            if (this[i] instanceof Array && array[i] instanceof Array) {\r\n                if (!this[i].equals(array[i]))\r\n                    return false;\r\n            }\r\n            else if (this[i] != array[i]) {\r\n                return false;\r\n            }\r\n        }\r\n        return true;\r\n    }\r\n\r\n    /**\r\n     * @param {string|Object} object\r\n     * @returns {boolean}\r\n     */\r\n    contains(object) {\r\n        var i = this.length;\r\n        while (i--) {\r\n            if (this[i] === object) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * @param {Function} callback\r\n     * @returns {boolean}\r\n     */\r\n    each(callback) {\r\n        if (!callback) return false;\r\n        var result = false;\r\n        for (var i = 0; i < this.length; i++) {\r\n            if ((result = callback(this[i], i)) == false) {\r\n                return result;\r\n            }\r\n        }\r\n        return result;\r\n    }\r\n\r\n    /**\r\n     * @param {string|Object} key\r\n     * @param {*} value\r\n     * @returns {ArrayMap.<T>}\r\n     */\r\n    add(key, value) {\r\n        if (this.contains(key))\r\n            this[key] = value;\r\n        else {\r\n            this.push(key);\r\n            this[key] = value;\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {string|Object} key\r\n     * @returns {*}\r\n     */\r\n    get(key) {\r\n        return this.contains(key) ? this[key] : null;\r\n    }\r\n\r\n    /**\r\n     * @param {string|Object} key\r\n     * @returns {ArrayMap.<T>}\r\n     */\r\n    remove(key) {\r\n        for (var i = 0; i < this.length; ++i) {\r\n            if (this[i] == key) {\r\n                this.splice(i, 1);\r\n                delete this[key];\r\n                return this;\r\n            }\r\n        }\r\n        return this;\r\n    }\r\n}\r\n","/**\r\n * @class ObjectUtil\r\n * @exports module:utils/ObjectUtil\r\n *\r\n * @constructor\r\n */\r\nexport default class ObjectUtil {\r\n    static extend() {\r\n        var args = Array.prototype.slice.call(arguments);\r\n        var deepness = false;\r\n        if (typeof args[0] === 'boolean') {\r\n            deepness = args[0];\r\n            args.splice(0, 1);\r\n        }\r\n\r\n        var out = args[0] || function () {\r\n                if (args[1] !== undefined && args[1] !== null && typeof args[1] === 'object') {\r\n                    return Object.create(args[1])\r\n                }\r\n                return {};\r\n            }();\r\n\r\n        for (var i = 1; i < args.length; i++) {\r\n            var object = args[i];\r\n\r\n            if (!object) continue;\r\n\r\n            for (var key in object) {\r\n                //noinspection JSUnresolvedFunction\r\n                if (object.hasOwnProperty(key)) {\r\n                    if (typeof object[key] === 'object' && object[key] !== null) {\r\n                        out[key] = deepness ? ObjectUtil.extend(deepness, out[key], object[key]) : object[key];\r\n                    } else {\r\n                        out[key] = object[key];\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        return out;\r\n    }\r\n}\r\n","import ObjectUtil from \"../utils/ObjectUtil\";\r\nimport Events from \"../utils/Events\";\r\nimport ArrayMap from \"../utils/ArrayMap\";\r\n/**\r\n * j2D (JavaScript 2D Engine)\r\n *\r\n * @authors DeVinterX, James Simpson of GoldFire Studios(howler.js)\r\n * @original_source https://github.com/goldfire/howler.js/blob/master/howler.js\r\n * @license BSD, MIT(howler.js)\r\n * @version 0.2.0-dev\r\n */\r\n\r\nvar AudioNode = window.Audio;\r\nvar audioContext = false;\r\nvar html5Audio = false;\r\n\r\ntry {\r\n    //noinspection JSUnresolvedVariable\r\n    var AudioContext = window.AudioContext || window.webkitAudioContext;\r\n    audioContext = new AudioContext();\r\n} catch (e) {\r\n    console.warn('Web Audio API is not supported in your browser');\r\n}\r\n\r\ntry {\r\n    //noinspection JSUnresolvedFunction\r\n    html5Audio = !!new AudioNode();\r\n} catch (e) {\r\n    console.warn('HTML5 Audio is not supported in your browser');\r\n}\r\n\r\nif (audioContext) {\r\n    var masterGain = (audioContext.createGain === undefined)\r\n        ? audioContext.createGainNode()\r\n        : audioContext.createGain();\r\n    masterGain.gain.value = 1;\r\n    masterGain.connect(audioContext.destination);\r\n}\r\n\r\n/* MediaManager */\r\n\r\n/**\r\n * @class MediaManager\r\n * @exports module:io/MediaManager\r\n *\r\n * @param {EngineJ2D} j2d\r\n * @param {MediaManager.defaults|Object|undefined} [data]\r\n * @constructor\r\n */\r\nexport default class MediaManager {\r\n    static defaults = {\r\n        volume: 1,\r\n        muted: false,\r\n        codecs: {},\r\n        iOSAutoEnable: true\r\n    };\r\n\r\n    constructor(j2d, data) {\r\n        if (data === undefined) data = {};\r\n        this.j2d = j2d;\r\n        this.data = ObjectUtil.extend(true, {}, MediaManager.defaults, data);\r\n        this.events = new Events();\r\n        this.media = new ArrayMap();\r\n\r\n        this.media.add('sounds', new ArrayMap());\r\n        this.media.add('audios', new ArrayMap());\r\n        this.media.add('videos', new ArrayMap());\r\n\r\n        this.volume = this.data.volume * 100;\r\n        this.iOSEnabled = false;\r\n\r\n        if (audioContext || html5Audio) {\r\n            var test = new AudioNode();\r\n            this.data.codecs = {\r\n                mp3: !!test.canPlayType('audio/mpeg;').replace(/^no$/, ''),\r\n                opus: !!test.canPlayType('audio/ogg; codecs=\"opus\"').replace(/^no$/, ''),\r\n                ogg: !!test.canPlayType('audio/ogg; codecs=\"vorbis\"').replace(/^no$/, ''),\r\n                wav: !!test.canPlayType('audio/wav; codecs=\"1\"').replace(/^no$/, ''),\r\n                aac: !!test.canPlayType('audio/aac;').replace(/^no$/, ''),\r\n                m4a: !!(test.canPlayType('audio/x-m4a;') || test.canPlayType('audio/m4a;') || test.canPlayType('audio/aac;')).replace(/^no$/, ''),\r\n                mp4: !!(test.canPlayType('audio/x-mp4;') || test.canPlayType('audio/mp4;') || test.canPlayType('audio/aac;')).replace(/^no$/, ''),\r\n                weba: !!test.canPlayType('audio/webm; codecs=\"vorbis\"').replace(/^no$/, '')\r\n            };\r\n            test = null;\r\n        }\r\n    }\r\n\r\n    get volume() {\r\n        return this.data.volume * 100;\r\n    }\r\n\r\n    set volume(value) {\r\n        this.data.volume = parseFloat(value / 100);\r\n\r\n        if (value >= 0 && value <= 1) {\r\n            if (audioContext) {\r\n                masterGain.gain.value = this.data.volume;\r\n            } else {\r\n                var sounds = this.media.get('sounds');\r\n                for (var key in sounds) {\r\n                    if (sounds.hasOwnProperty(key) && !sounds[key].webAudio) {\r\n                        for (var i = 0; i < sounds[key].audioNode.length; i++) {\r\n                            sounds[key].audioNode[i].volume = sounds[key].volume * this.data.volume;\r\n                        }\r\n                    }\r\n                }\r\n                sounds = null;\r\n            }\r\n        }\r\n    }\r\n\r\n    get muted() {\r\n        return !!this.data.muted;\r\n    }\r\n\r\n    set muted(value) {\r\n        this.data.muted = !!value;\r\n\r\n        if (audioContext) {\r\n            masterGain.gain.value = this.data.muted ? 0 : this.data.volume;\r\n        } else {\r\n            var sounds = this.media.get('sounds');\r\n            for (var key in sounds) {\r\n                if (sounds.hasOwnProperty(key) && sounds[key].webAudio === false) {\r\n                    for (var i = 0; i < sounds[key].audioNode.length; i++) {\r\n                        sounds[key].audioNode[i].muted = this.data.muted;\r\n                    }\r\n                }\r\n            }\r\n            sounds = null;\r\n        }\r\n    }\r\n\r\n    get iOSEnable() {\r\n        return !!this.data.iOSAutoEnable;\r\n    }\r\n\r\n    set iOSEnable(value) {\r\n        if (audioContext && (this.iOSEnabled || !/iPhone|iPad|iPod/i.test(navigator.userAgent))) {\r\n            return value;\r\n        }\r\n        this.iOSEnabled = false;\r\n\r\n        var unlock = function () {\r\n            var buffer = audioContext.createBuffer(1, 1, 22050);\r\n            var source = audioContext.createBufferSource();\r\n            source.buffer = buffer;\r\n            source.connect(audioContext.destination);\r\n\r\n            if (source.start === undefined) {\r\n                source.noteOn(0);\r\n            } else {\r\n                source.start(0);\r\n            }\r\n\r\n            setTimeout(function () {\r\n                if ((source.playbackState === source.PLAYING_STATE\r\n                    || source.playbackState === source.FINISHED_STATE)) {\r\n                    this.iOSEnabled = true;\r\n                    this.data.iOSAutoEnable = false;\r\n\r\n                    window.removeEventListener('touchend', unlock, false);\r\n                }\r\n            }, 0);\r\n        };\r\n        window.addEventListener('touchend', unlock, false);\r\n    }\r\n\r\n    get isSupportAudio() {\r\n        return !audioContext && !html5Audio;\r\n    }\r\n\r\n\r\n    getAudioContext() {\r\n        return audioContext;\r\n    }\r\n\r\n    getMasterGain() {\r\n        return masterGain;\r\n    }\r\n\r\n    mute() {\r\n        this.muted = true;\r\n        return this;\r\n    }\r\n\r\n    unMute() {\r\n        this.muted = false;\r\n        return this;\r\n    }\r\n\r\n    isSupportCodec(fileExtension) {\r\n        return !!this.data.codecs[fileExtension];\r\n    }\r\n\r\n    addSound(data) {\r\n        new Sound(data, this);\r\n        return this;\r\n    }\r\n\r\n    addAudio(data) {\r\n        new Audio(data, this);\r\n        return this;\r\n    }\r\n\r\n    addVideo(data) {\r\n        //new Video(this, data);\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {string} id\r\n     * @returns {Sound}\r\n     */\r\n    sound(id) {\r\n        return this.media.get('sounds').get(id);\r\n    }\r\n\r\n    audio(id) {\r\n        return this.media.get('audios').get(id);\r\n    }\r\n\r\n    video(id) {\r\n        return this.media.get('videos').get(id);\r\n    }\r\n\r\n    removeSound(id) {\r\n        if (this.media.get('sounds').contains(id)) {\r\n            this.media.get('sounds').get(id).stop();\r\n            this.media.get('sounds').remove(id);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    removeAudio(id) {\r\n        if (this.media.get('audios').contains(id)) {\r\n            this.media.get('audios').get(id).stop();\r\n            this.media.get('audios').remove(id);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    removeVideo(id) {\r\n        if (this.media.get('videos').contains(id)) {\r\n            this.media.get('videos').get(id).stop();\r\n            this.media.get('videos').remove(id);\r\n        }\r\n        return this;\r\n    }\r\n}\r\n","import ArrayMap from \"utils/ArrayMap\";\r\nimport Vector2d from \"utils/Vector2d\";\r\n\r\n/**\r\n * @param e\r\n * @param {boolean} [enableCallback]\r\n * @returns {boolean}\r\n */\r\nvar checkKeyMap = function (e, enableCallback) {\r\n    if (enableCallback === undefined) enableCallback = true;\r\n\r\n    var j2d = e.data.manager.j2d,\r\n        manager = e.data.manager,\r\n        keyCode = e.which,\r\n        keyMap = e.data.manager.keyMap;\r\n\r\n    for (var index in keyMap) {\r\n        if (keyMap.hasOwnProperty(index)) {\r\n            var value = keyMap[index];\r\n            if (!$.isArray(value[0]) && value[0] === keyCode && !!value[1]) {\r\n                if (typeof value[1] === 'string') {\r\n                    value[1] = eval('(' + value[1] + ')');\r\n                }\r\n                if ((typeof value[1] === 'function') && enableCallback) {\r\n                    value[1](j2d, value[2]);\r\n                }\r\n                return true;\r\n            } else if ($.isArray(value[0])\r\n                && manager.data.keysPressed.equals(value[0]) && !!value[1]\r\n            ) {\r\n                if (typeof value[1] === 'string') {\r\n                    value[1] = eval('(' + value[1] + ')');\r\n                }\r\n                if (typeof value[1] === 'function' && enableCallback) {\r\n                    value[1](j2d, value[2]);\r\n                }\r\n                return true\r\n            }\r\n        }\r\n    }\r\n    return false\r\n};\r\nvar events = {\r\n    onMouseClick: function (e) {\r\n        var manager = e.data.manager;\r\n        if (!manager.data.enabled || !manager.j2d.isPlay || !manager.j2d.element.hasClass('active')) return true;\r\n        var keysPressed = manager.data.keysPressed;\r\n        var keyCode = getKey(DEPRECATED_InputManager.key, e.which) || 'KEY_UNKNOWN_' + e.which;\r\n        var mouse = manager.data.mouse;\r\n\r\n        if (e.data.event !== 2) {\r\n            if (e.data.event === 0) {\r\n                if (-1 === $.inArray(DEPRECATED_InputManager.key[keyCode], keysPressed)) {\r\n                    keysPressed.push(DEPRECATED_InputManager.key[keyCode]);\r\n\r\n                    if (manager.data.enableAdditionalData) {\r\n                        mouse.startPosition.x = e.pageX;\r\n                        mouse.startPosition.y = e.pageY;\r\n                        mouse.distance = 0;\r\n\r\n                        manager.data.timePressed = e.timeStamp;\r\n                    }\r\n                }\r\n                if (checkKeyMap(e, false) || manager.data.preventAll) {\r\n                    e.preventDefault();\r\n                }\r\n            } else {\r\n                if (checkKeyMap(e) || manager.data.preventAll) {\r\n                    e.preventDefault();\r\n                }\r\n                if (manager.data.enableAdditionalData) {\r\n                    mouse.previousDistance = mouse.distance;\r\n                    mouse.startPosition.x = 0;\r\n                    mouse.startPosition.y = 0;\r\n                }\r\n\r\n                keysPressed.splice(\r\n                    keysPressed.indexOf(DEPRECATED_InputManager.key[keyCode]), 1\r\n                );\r\n            }\r\n            manager.element.trigger(e.data.event === 0 ?\r\n                'mouseKeyDown' : 'mouseKeyUp', {keyCode: keyCode}\r\n            );\r\n        } else {\r\n            if (checkKeyMap(e, false)) {\r\n                e.preventDefault();\r\n            }\r\n        }\r\n    },\r\n\r\n    onMouseWheel: function (e) {\r\n        var manager = e.data.manager;\r\n        if (!manager.data.enabled || !manager.j2d.isPlay || !manager.j2d.element.hasClass('active')) return true;\r\n        var keysPressed = manager.data.keysPressed;\r\n        var keyCode = (e.originalEvent.wheelDelta / 120 > 0) ?\r\n            getKey(DEPRECATED_InputManager.key, 4) : getKey(DEPRECATED_InputManager.key, 5);\r\n\r\n        e.which = (e.originalEvent.wheelDelta / 120 > 0) ? 4 : 5;\r\n\r\n        if (-1 === $.inArray(DEPRECATED_InputManager.key[keyCode], keysPressed)) {\r\n            keysPressed.push(DEPRECATED_InputManager.key[keyCode]);\r\n        }\r\n\r\n        if (checkKeyMap(e) || manager.data.preventAll) {\r\n            e.preventDefault();\r\n            manager.fixMouseWheel();\r\n        }\r\n\r\n        manager.element.trigger('mouseWheel', {keyCode: keyCode});\r\n    },\r\n\r\n    mouseWheelCancel: function (keysPressed, keyCode) {\r\n        keysPressed.splice(\r\n            keysPressed.indexOf(DEPRECATED_InputManager.key[keyCode]), 1\r\n        );\r\n    },\r\n\r\n    onMouseMove: function (e) {\r\n        var manager = e.data.manager;\r\n        var mouse = e.data.manager.data.mouse;\r\n\r\n        manager.data.mouse.currentPosition.x = e.pageX;\r\n        manager.data.mouse.currentPosition.y = e.pageY;\r\n\r\n        if (e.data.manager.data.enableAdditionalData) {\r\n            mouse.distance = Math.sqrt(\r\n                Math.pow((mouse.currentPosition.x - mouse.startPosition.x), 2)\r\n                + Math.pow((mouse.currentPosition.y - mouse.startPosition.y), 2)\r\n            ).toFixed(1);\r\n        }\r\n    },\r\n\r\n    onKeyboardPress: function (e) {\r\n        var manager = e.data.manager;\r\n        if (!manager.data.enabled || !manager.j2d.isPlay || !manager.element.hasClass('active')) return true;\r\n        var keysPressed = manager.data.keysPressed;\r\n        var keyCode = getKey(DEPRECATED_InputManager.key, e.which) || 'KEY_UNKNOWN_' + e.which;\r\n        if (e.data.event === 2 && true === manager.data.writeMode) {\r\n            var char = String.fromCharCode(e.which || e.keyCode);\r\n            e.preventDefault();\r\n            manager.element.focus().trigger('keyboardCharPress', {\r\n                key: e.which || e.keyCode,\r\n                keyCode: keyCode,\r\n                char: char\r\n            });\r\n        }\r\n\r\n        if (e.data.event !== 2 && false === manager.data.writeMode) {\r\n            if (e.data.event === 0) {\r\n                if (-1 === $.inArray(DEPRECATED_InputManager.key[keyCode], keysPressed)) {\r\n                    keysPressed.push(DEPRECATED_InputManager.key[keyCode]);\r\n                    if (manager.data.enableAdditionalData) {\r\n                        manager.data.timePressed = e.timeStamp;\r\n                    }\r\n                }\r\n                if (checkKeyMap(e, false) || manager.data.preventAll) {\r\n                    e.preventDefault();\r\n                }\r\n            } else {\r\n                if (checkKeyMap(e) || manager.data.preventAll) {\r\n                    e.preventDefault();\r\n                }\r\n\r\n                keysPressed.splice(\r\n                    keysPressed.indexOf(DEPRECATED_InputManager.key[keyCode]), 1\r\n                );\r\n            }\r\n\r\n            manager.element.trigger(e.data.event === 0 ?\r\n                'keyboardKeyDown' : 'keyboardKeyUp', {keyCode: keyCode, key: e.which || e.keyCode}\r\n            );\r\n        }\r\n\r\n        if (e.data.event !== 2 && true === manager.data.writeMode) {\r\n            manager.element.trigger(e.data.event === 0 ?\r\n                'keyboardKeyDown' : 'keyboardKeyUp', {keyCode: keyCode, key: e.which || e.keyCode}\r\n            );\r\n        }\r\n    },\r\n\r\n    onTouchTap: function (e) {\r\n        var manager = e.data.manager;\r\n        if (!manager.data.enabled || !manager.j2d.isPlay || !manager.j2d.element.hasClass('active')) return true;\r\n        var keysPressed = manager.data.keysPressed;\r\n        var keyCode = getKey(DEPRECATED_InputManager.key, e.which + 1) || 'KEY_UNKNOWN_' + e.which;\r\n        var touch = e.originalEvent.touches[0] || e.originalEvent.changedTouches[0];\r\n        var mouse = manager.data.mouse;\r\n\r\n        if (e.data.event === 0) {\r\n            if (-1 === $.inArray(DEPRECATED_InputManager.key[keyCode], keysPressed)) {\r\n                keysPressed.push(DEPRECATED_InputManager.key[keyCode]);\r\n                if (manager.data.enableAdditionalData) {\r\n                    mouse.startPosition.x = touch.pageX;\r\n                    mouse.startPosition.y = touch.pageY;\r\n                    mouse.distance = 0;\r\n\r\n                    manager.data.timePressed = e.timeStamp;\r\n                }\r\n            }\r\n            if (checkKeyMap(e, false) || manager.data.preventAll) {\r\n                e.preventDefault();\r\n            }\r\n        } else {\r\n            if (checkKeyMap(e) || manager.data.preventAll) {\r\n                e.preventDefault();\r\n            }\r\n\r\n            if (manager.data.enableAdditionalData) {\r\n                mouse.previousDistance = mouse.distance;\r\n                mouse.startPosition.x = 0;\r\n                mouse.startPosition.y = 0;\r\n            }\r\n\r\n            keysPressed.splice(\r\n                keysPressed.indexOf(DEPRECATED_InputManager.key[keyCode]), 1\r\n            );\r\n        }\r\n\r\n        manager.element.trigger(e.data.event === 0 ?\r\n            'mouseKeyDown' : 'mouseKeyUp', {keyCode: keyCode}\r\n        );\r\n    },\r\n\r\n    onTouchMove: function (e) {\r\n        var touch = e.originalEvent.touches[0] || e.originalEvent.changedTouches[0];\r\n        var mouse = e.data.manager.data.mouse;\r\n\r\n        mouse.currentPosition.x = touch.pageX.toFixed(0);\r\n        mouse.currentPosition.y = touch.pageY.toFixed(0);\r\n\r\n        if (e.data.manager.data.enableAdditionalData) {\r\n            mouse.distance = Math.sqrt(\r\n                Math.pow((mouse.currentPosition.x - mouse.startPosition.x), 2)\r\n                + Math.pow((mouse.currentPosition.y - mouse.startPosition.y), 2)\r\n            ).toFixed(1);\r\n        }\r\n    }\r\n};\r\n\r\n/**\r\n * @param {DEPRECATED_InputManager} manager\r\n */\r\nvar bindEvents = function (manager) {\r\n    var selector = '[guid=' + manager.id + ']';\r\n\r\n    $(document).on('contextmenu', selector, {manager: manager, event: 2}, events.onMouseClick);\r\n    $(document).on('mousedown', selector, {manager: manager, event: 0}, events.onMouseClick);\r\n    $(document).on('mouseup', selector, {manager: manager, event: 1}, events.onMouseClick);\r\n    $(document).on('mousewheel', selector, {manager: manager}, events.onMouseWheel);\r\n    $(document).on('mousemove', selector, {manager: manager}, events.onMouseMove);\r\n\r\n    $(document).on('keydown', null, {manager: manager, event: 0}, events.onKeyboardPress);\r\n    $(document).on('keyup', null, {manager: manager, event: 1}, events.onKeyboardPress);\r\n    $(document).on('keypress', null, {manager: manager, event: 2}, events.onKeyboardPress);\r\n\r\n    $(document).on('touchstart', selector, {manager: manager, event: 0}, events.onTouchTap);\r\n    $(document).on('touchend', selector, {manager: manager, event: 1}, events.onTouchTap);\r\n    $(document).on('touchmove ', selector, {manager: manager}, events.onTouchMove);\r\n};\r\n\r\n/**\r\n * @param {DEPRECATED_InputManager} manager\r\n */\r\nvar unbindEvents = function (manager) {\r\n    var selector = '[guid=' + manager.id + ']';\r\n\r\n    $(document).off('contextmenu', selector, {manager: manager, event: 1}, events.onMouseClick);\r\n    $(document).off('mousedown', selector, {manager: manager, event: 0}, events.onMouseClick);\r\n    $(document).off('mouseup', selector, {manager: manager, event: 1}, events.onMouseClick);\r\n    $(document).off('mousewheel', selector, {manager: manager}, events.onMouseWheel);\r\n    $(document).off('mousemove', selector, {manager: manager}, events.onMouseMove);\r\n\r\n    $(document).off('keydown', null, {manager: manager, event: 0}, events.onKeyboardPress);\r\n    $(document).off('keyup', null, {manager: manager, event: 1}, events.onKeyboardPress);\r\n    $(document).off('keypress', null, {manager: manager, event: 2}, events.onKeyboardPress);\r\n\r\n    $(document).off('touchstart', selector, {manager: manager, event: 0}, events.onTouchTap);\r\n    $(document).off('touchend', selector, {manager: manager, event: 1}, events.onTouchTap);\r\n    $(document).off('touchmove ', selector, {manager: manager}, events.onTouchMove);\r\n};\r\n\r\n/**\r\n * @param {DEPRECATED_InputManager} manager\r\n * @param {Array.<number>|number[]} keyList\r\n * @returns {{keyList: Array.<number>|number[]|number, time: number}|boolean}\r\n */\r\nvar getPressData = function (manager, keyList) {\r\n    if (!manager.data.enableAdditionalData) return true;\r\n    return {\r\n        keyList: keyList,\r\n        time: Date.now() - manager.data.timePressed\r\n    };\r\n};\r\n\r\n/**\r\n * @param {Object} object\r\n * @param {number} value\r\n * @returns {T}\r\n */\r\nfunction getKey(object, value) {\r\n    return Object.keys(object).filter(function (key) {\r\n        return object[key] === value\r\n    })[0];\r\n}\r\n\r\n/**\r\n * @class DEPRECATED_InputManager\r\n * @exports module:io/DEPRECATED_InputManager\r\n *\r\n * @param {EngineJ2D} j2d\r\n * @constructor\r\n *\r\n * @type {DEPRECATED_InputManager.key} key\r\n */\r\nexport default class DEPRECATED_InputManager {\r\n    constructor(j2d) {\r\n        this.j2d = j2d;\r\n\r\n        /** @type string */\r\n        this.id = j2d.data.id;\r\n\r\n        /** @type Element|jQuery */\r\n        this.element = j2d.element;\r\n\r\n        this.data = {\r\n            mouse: {\r\n                startPosition: {\r\n                    x: 0,\r\n                    y: 0\r\n                },\r\n                currentPosition: {\r\n                    x: 0,\r\n                    y: 0\r\n                },\r\n                previousDistance: 0,\r\n                distance: 0\r\n            },\r\n            viewport: {\r\n                position: {\r\n                    x: 0,\r\n                    y: 0\r\n                }\r\n            },\r\n            enabled: false,\r\n            enableAdditionalData: false,\r\n            keysPressed: new ArrayMap(),\r\n            writeMode: false,\r\n            timePressed: 0,\r\n            preventAll: false,\r\n\r\n            cursor: {\r\n                enabled: false,\r\n                image: 'auto'\r\n            }\r\n        };\r\n\r\n        this.keyMap = {\r\n            //DEBUG_INFO: [[DEPRECATED_InputManager.key.KEY_CTRL, DEPRECATED_InputManager.key.KEY_F1], 'j2d.debug.toggleScreen', {}],\r\n            FULLSCREEN: [[DEPRECATED_InputManager.key.KEY_CTRL, DEPRECATED_InputManager.key.KEY_F11], 'j2d.scene.toggleFullScreen', {}]\r\n        };\r\n    }\r\n\r\n    /**\r\n     * @returns {DEPRECATED_InputManager}\r\n     */\r\n    init() {\r\n        if (!this.data.enabled && window.j2dPlugin.pluginInit) {\r\n            bindEvents(this);\r\n\r\n            this.data.enabled = true;\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @returns {boolean}\r\n     */\r\n    update() {\r\n        if (!this.data.enabled) return false;\r\n\r\n        var dX = this.j2d.scene.canvas.offsetWidth / this.j2d.scene.data.width,\r\n            dY = this.j2d.scene.canvas.offsetHeight / this.j2d.scene.data.height,\r\n            x = this.data.mouse.currentPosition.x / dX,\r\n            y = this.data.mouse.currentPosition.y / dY;\r\n\r\n        var offset = this.element.offset();\r\n\r\n        this.data.viewport.x = this.j2d.scene.viewport.x + x - offset.left;\r\n        this.data.viewport.y = this.j2d.scene.viewport.y + y - offset.top;\r\n        return true;\r\n    }\r\n\r\n    /**\r\n     * @returns {DEPRECATED_InputManager}\r\n     */\r\n    flush() {\r\n        this.data.keysPressed.length = 0;\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @returns {DEPRECATED_InputManager}\r\n     */\r\n    clear() {\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @returns {DEPRECATED_InputManager}\r\n     */\r\n    fixMouseWheel() {\r\n        var keyPressed = this.data.keysPressed;\r\n        if (-1 !== $.inArray(DEPRECATED_InputManager.key.SCROLL_MOUSE_UP, keyPressed)) {\r\n            events.mouseWheelCancel(keyPressed, DEPRECATED_InputManager.key.SCROLL_MOUSE_UP);\r\n        } else if (-1 !== $.inArray(DEPRECATED_InputManager.key.SCROLL_MOUSE_DOWN, keyPressed)) {\r\n            events.mouseWheelCancel(keyPressed, DEPRECATED_InputManager.key.SCROLL_MOUSE_DOWN);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @returns {DEPRECATED_InputManager}\r\n     */\r\n    enable() {\r\n        if (!this.data.enabled) {\r\n            //bindEvents(this);\r\n            this.data.enabled = false;\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @returns {DEPRECATED_InputManager}\r\n     */\r\n    disable() {\r\n        if (this.data.enabled) {\r\n            //unbindEvents(this);\r\n            this.data.enabled = false;\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {string} newKeyMap\r\n     * @returns {string}\r\n     */\r\n    load(newKeyMap) {\r\n        var oldKeyMap = JSON.stringify(this.keyMap);\r\n        this.keyMap = JSON.parse(newKeyMap);\r\n        return oldKeyMap;\r\n    }\r\n\r\n    /**\r\n     * @returns {string}\r\n     */\r\n    save() {\r\n        return JSON.stringify(this.keyMap);\r\n    }\r\n\r\n    /**\r\n     * KeyMap Manager\r\n     *\r\n     * @param mapObject\r\n     * @returns {DEPRECATED_InputManager}\r\n     */\r\n    setKeys(mapObject) {\r\n        this.keyMap = $.extend(true, {}, this.keyMap, mapObject);\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @returns {{current: number, previous: number}}\r\n     */\r\n    getMouseMoveDistance() {\r\n        if (!this.data.enableAdditionalData) return 0;\r\n        return {current: this.data.mouse.distance, previous: this.data.mouse.previousDistance};\r\n    }\r\n\r\n    /* +Input Checkers **/\r\n    /**\r\n     * @param {Array.<number>|number[]|number} keyList\r\n     * @returns {boolean}\r\n     */\r\n    checkPressedKeyList(keyList) {\r\n        if ($.isArray(keyList)) {\r\n            if (keyList.length !== this.data.keysPressed.length) {\r\n                return false;\r\n            } else if (this.data.keysPressed.equals(keyList)) {\r\n                this.fixMouseWheel();\r\n                return getPressData(this, keyList);\r\n            }\r\n            this.fixMouseWheel();\r\n            return false;\r\n        }\r\n        //if (!this.data.keysPressed.equals([])) console.log(this.data.keysPressed);\r\n        if (isNaN(keyList)) return false;\r\n        if (-1 !== this.data.keysPressed.indexOf(keyList)) {\r\n            this.fixMouseWheel();\r\n            return getPressData(this, keyList);\r\n        }\r\n        this.fixMouseWheel();\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * @param {string} key\r\n     * @returns {boolean}\r\n     */\r\n    checkPressedKeyMap(key) {\r\n        if (this.keyMap[key] === undefined) return false;\r\n        var keyList = this.keyMap[key][0];\r\n\r\n        return this.checkPressedKeyList(keyList);\r\n    }\r\n\r\n    getPosition() {\r\n        return new Vector2d(this.data.viewport.x + 0.5, this.data.viewport.y + 0.3);\r\n    }\r\n\r\n//onNode (id) {\r\n//    if (!id.layer.visible) return false;\r\n//    return (this.data.viewport.x > id.options.position.x && this.data.viewport.x < id.options.position.x + id.options.size.x) &&\r\n//        (this.data.viewport.y > id.options.position.y && this.data.viewport.y < id.options.position.y + id.options.size.y);\r\n//}\r\n    /* -Input Checkers **/\r\n\r\n    /* +Input Write Mode **/\r\n    /**\r\n     * @param {boolean} mode\r\n     * @returns {DEPRECATED_InputManager}\r\n     */\r\n    setWriteMode(mode) {\r\n        this.data.writeMode = !!mode;\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @returns {boolean}\r\n     */\r\n    isWriteMode() {\r\n        return !!this.data.writeMode;\r\n    }\r\n\r\n    /* -Input Write Mode **/\r\n\r\n    /**\r\n     * @param {string} image\r\n     * @returns {DEPRECATED_InputManager}\r\n     */\r\n    setCursorImage(image) {\r\n        this.data.cursor.image = 'url(\"' + image + '\"), auto';\r\n        $(this.element).css('cursor', this.data.cursor.image);\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {boolean} enable\r\n     * @returns {DEPRECATED_InputManager}\r\n     */\r\n    toggleCursor(enable) {\r\n        if (enable !== undefined) {\r\n            this.data.cursor.enable = !!enable;\r\n        } else {\r\n            this.data.cursor.enable = !this.data.cursor.enable;\r\n        }\r\n\r\n        if (!this.data.cursor.enable) {\r\n            this.data.cursor.image = $(this.j2d.element).css('cursor');\r\n            $(this.element).css('cursor', 'none');\r\n        } else {\r\n            $(this.element).css('cursor', this.data.cursor.image);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @returns {boolean}\r\n     */\r\n    isCursorVisible() {\r\n        return !!this.data.cursor.enable;\r\n    }\r\n\r\n    /** -Cursor **/\r\n\r\n    /**\r\n     * Static keys arrayList\r\n     *\r\n     * @readonly\r\n     * @enum {number}\r\n     */\r\n    static key = {\r\n        KEY_MOUSE_LEFT: 1,\r\n        KEY_MOUSE_MIDDLE: 2,\r\n        KEY_MOUSE_RIGHT: 3,\r\n\r\n        SCROLL_MOUSE_UP: 4,\r\n        SCROLL_MOUSE_DOWN: 5,\r\n\r\n        KEY_BACKSPACE: 8,\r\n        KEY_TAB: 9,\r\n        KEY_ENTER: 13,\r\n        KEY_SHIFT: 16,\r\n        KEY_CTRL: 17,\r\n        KEY_ALT: 18,\r\n        KEY_PAUSE: 19,\r\n        KEY_BREAK: 19,\r\n        KEY_CAPS_LOCK: 20,\r\n        KEY_ESCAPE: 27,\r\n        KEY_SPACE_BAR: 32,\r\n        KEY_PAGE_UP: 33,\r\n        KEY_PAGE_DOWN: 34,\r\n        KEY_END: 35,\r\n        KEY_HOME: 36,\r\n        KEY_LEFT_ARROW: 37,\r\n        KEY_UP_ARROW: 38,\r\n        KEY_RIGHT_ARROW: 39,\r\n        KEY_DOWN_ARROW: 40,\r\n        KEY_INSERT: 45,\r\n        KEY_DELETE: 46,\r\n        KEY_0: 48,\r\n        KEY_1: 49,\r\n        KEY_2: 50,\r\n        KEY_3: 51,\r\n        KEY_4: 52,\r\n        KEY_5: 53,\r\n        KEY_6: 54,\r\n        KEY_7: 55,\r\n        KEY_8: 56,\r\n        KEY_9: 57,\r\n        KEY_A: 65,\r\n        KEY_B: 66,\r\n        KEY_C: 67,\r\n        KEY_D: 68,\r\n        KEY_E: 69,\r\n        KEY_F: 70,\r\n        KEY_G: 71,\r\n        KEY_H: 72,\r\n        KEY_I: 73,\r\n        KEY_J: 74,\r\n        KEY_K: 75,\r\n        KEY_L: 76,\r\n        KEY_M: 77,\r\n        KEY_N: 78,\r\n        KEY_O: 79,\r\n        KEY_P: 80,\r\n        KEY_Q: 81,\r\n        KEY_R: 82,\r\n        KEY_S: 83,\r\n        KEY_T: 84,\r\n        KEY_U: 85,\r\n        KEY_V: 86,\r\n        KEY_W: 87,\r\n        KEY_X: 88,\r\n        KEY_Y: 89,\r\n        KEY_Z: 90,\r\n        KEY_LEFT_WINDOW_KEY: 91,\r\n        KEY_RIGHT_WINDOW_KEY: 92,\r\n        KEY_SELECT_KEY: 93,\r\n        KEY_NUMPAD_0: 96,\r\n        KEY_NUMPAD_1: 97,\r\n        KEY_NUMPAD_2: 98,\r\n        KEY_NUMPAD_3: 99,\r\n        KEY_NUMPAD_4: 100,\r\n        KEY_NUMPAD_5: 101,\r\n        KEY_NUMPAD_6: 102,\r\n        KEY_NUMPAD_7: 103,\r\n        KEY_NUMPAD_8: 104,\r\n        KEY_NUMPAD_9: 105,\r\n        KEY_MULTIPLY: 106,\r\n        KEY_ADD: 107,\r\n        KEY_SUBTRACT: 109,\r\n        KEY_DECIMAL_POINT: 110,\r\n        KEY_DIVIDE: 111,\r\n        KEY_F1: 112,\r\n        KEY_F2: 113,\r\n        KEY_F3: 114,\r\n        KEY_F4: 115,\r\n        KEY_F5: 116,\r\n        KEY_F6: 117,\r\n        KEY_F7: 118,\r\n        KEY_F8: 119,\r\n        KEY_F9: 120,\r\n        KEY_F10: 121,\r\n        KEY_F11: 122,\r\n        KEY_F12: 123,\r\n        KEY_NUM_LOCK: 144,\r\n        KEY_SCROLL_LOCK: 145,\r\n        KEY_SEMI_COLON: 186,\r\n        KEY_EQUAL_SIGN: 187,\r\n        KEY_COMMA: 188,\r\n        KEY_DASH: 189,\r\n        KEY_PERIOD: 190,\r\n        KEY_FORWARD_SLASH: 191,\r\n        KEY_GRAVE_ACCENT: 192,\r\n        KEY_OPEN_BRACKET: 219,\r\n        KEY_BACK_SLASH: 220,\r\n        KEY_CLOSE_BRACKET: 221,\r\n        KEY_SINGLE_QUOTE: 222,\r\n        KEY_LEFT_COMMAND: 224,\r\n        KEY_RIGHT_COMMAND: 224\r\n    };\r\n}\r\n","export default {\r\n    KEY_MOUSE_LEFT: 1,\r\n    KEY_MOUSE_MIDDLE: 2,\r\n    KEY_MOUSE_RIGHT: 3,\r\n\r\n    SCROLL_MOUSE_UP: 4,\r\n    SCROLL_MOUSE_DOWN: 5,\r\n\r\n    KEY_BACKSPACE: 8,\r\n    KEY_TAB: 9,\r\n    KEY_ENTER: 13,\r\n    KEY_SHIFT: 16,\r\n    KEY_CTRL: 17,\r\n    KEY_ALT: 18,\r\n    KEY_PAUSE: 19,\r\n    KEY_BREAK: 19,\r\n    KEY_CAPS_LOCK: 20,\r\n    KEY_ESCAPE: 27,\r\n    KEY_SPACE_BAR: 32,\r\n    KEY_PAGE_UP: 33,\r\n    KEY_PAGE_DOWN: 34,\r\n    KEY_END: 35,\r\n    KEY_HOME: 36,\r\n    KEY_LEFT_ARROW: 37,\r\n    KEY_UP_ARROW: 38,\r\n    KEY_RIGHT_ARROW: 39,\r\n    KEY_DOWN_ARROW: 40,\r\n    KEY_INSERT: 45,\r\n    KEY_DELETE: 46,\r\n    KEY_0: 48,\r\n    KEY_1: 49,\r\n    KEY_2: 50,\r\n    KEY_3: 51,\r\n    KEY_4: 52,\r\n    KEY_5: 53,\r\n    KEY_6: 54,\r\n    KEY_7: 55,\r\n    KEY_8: 56,\r\n    KEY_9: 57,\r\n    KEY_A: 65,\r\n    KEY_B: 66,\r\n    KEY_C: 67,\r\n    KEY_D: 68,\r\n    KEY_E: 69,\r\n    KEY_F: 70,\r\n    KEY_G: 71,\r\n    KEY_H: 72,\r\n    KEY_I: 73,\r\n    KEY_J: 74,\r\n    KEY_K: 75,\r\n    KEY_L: 76,\r\n    KEY_M: 77,\r\n    KEY_N: 78,\r\n    KEY_O: 79,\r\n    KEY_P: 80,\r\n    KEY_Q: 81,\r\n    KEY_R: 82,\r\n    KEY_S: 83,\r\n    KEY_T: 84,\r\n    KEY_U: 85,\r\n    KEY_V: 86,\r\n    KEY_W: 87,\r\n    KEY_X: 88,\r\n    KEY_Y: 89,\r\n    KEY_Z: 90,\r\n    KEY_LEFT_WINDOW_KEY: 91,\r\n    KEY_RIGHT_WINDOW_KEY: 92,\r\n    KEY_SELECT_KEY: 93,\r\n    KEY_NUMPAD_0: 96,\r\n    KEY_NUMPAD_1: 97,\r\n    KEY_NUMPAD_2: 98,\r\n    KEY_NUMPAD_3: 99,\r\n    KEY_NUMPAD_4: 100,\r\n    KEY_NUMPAD_5: 101,\r\n    KEY_NUMPAD_6: 102,\r\n    KEY_NUMPAD_7: 103,\r\n    KEY_NUMPAD_8: 104,\r\n    KEY_NUMPAD_9: 105,\r\n    KEY_MULTIPLY: 106,\r\n    KEY_ADD: 107,\r\n    KEY_SUBTRACT: 109,\r\n    KEY_DECIMAL_POINT: 110,\r\n    KEY_DIVIDE: 111,\r\n    KEY_F1: 112,\r\n    KEY_F2: 113,\r\n    KEY_F3: 114,\r\n    KEY_F4: 115,\r\n    KEY_F5: 116,\r\n    KEY_F6: 117,\r\n    KEY_F7: 118,\r\n    KEY_F8: 119,\r\n    KEY_F9: 120,\r\n    KEY_F10: 121,\r\n    KEY_F11: 122,\r\n    KEY_F12: 123,\r\n    KEY_NUM_LOCK: 144,\r\n    KEY_SCROLL_LOCK: 145,\r\n    KEY_SEMI_COLON: 186,\r\n    KEY_EQUAL_SIGN: 187,\r\n    KEY_COMMA: 188,\r\n    KEY_DASH: 189,\r\n    KEY_PERIOD: 190,\r\n    KEY_FORWARD_SLASH: 191,\r\n    KEY_GRAVE_ACCENT: 192,\r\n    KEY_OPEN_BRACKET: 219,\r\n    KEY_BACK_SLASH: 220,\r\n    KEY_CLOSE_BRACKET: 221,\r\n    KEY_SINGLE_QUOTE: 222,\r\n    KEY_LEFT_COMMAND: 224,\r\n    KEY_RIGHT_COMMAND: 224,\r\n\r\n    //fix mouse with extra buttons\r\n    KEY_MOUSE_3: 403,\r\n    KEY_MOUSE_4: 404,\r\n    KEY_MOUSE_5: 405,\r\n    KEY_MOUSE_6: 406,\r\n    KEY_MOUSE_7: 407,\r\n    KEY_MOUSE_8: 408,\r\n    KEY_MOUSE_9: 409,\r\n    KEY_MOUSE_10: 410\r\n};\r\n","import PrototypeInterface from \"api/PrototypeInterface\";\r\n\r\n/**\r\n * PrototypeObject\r\n * @constructor\r\n */\r\nexport default class PrototypeObject {\r\n    static interfaces = [];\r\n\r\n    constructor() {\r\n        if (this.constructor.interfaces === undefined) this.constructor.interfaces = [];\r\n\r\n        let scope = [];\r\n\r\n        /**\r\n         TODO:: Object.getPrototypeOf(obj),\r\n         @link https://developer.mozilla.org/ru/docs/Web/JavaScript/Reference/Global_Objects/Object/getPrototypeOf\r\n         */\r\n        let implement = function (object) {\r\n            if (object.__proto__.constructor.name === 'Object'\r\n                || object.__proto__.constructor === undefined\r\n                || object.__proto__.constructor.interfaces.length < 1\r\n            ) return;\r\n\r\n            for (let i = 0; i < object.__proto__.constructor.interfaces.length; i++) {\r\n                if (!scope.includes(object.__proto__.constructor.interfaces[i].name)) {\r\n                    scope.push(object.__proto__.constructor.interfaces[i].name);\r\n                    this.constructor.interfaces.push(object.__proto__.constructor.interfaces[i]);\r\n                }\r\n            }\r\n\r\n            implement(object.__proto__);\r\n        }.bind(this);\r\n\r\n        implement(this.__proto__);\r\n    }\r\n\r\n    instanceOf(interfaces) {\r\n        let i = 0;\r\n        if (typeof interfaces === 'object' && interfaces instanceof Array) {\r\n            for (i = 0; i < interfaces.length; i++) {\r\n                if (typeof interfaces[i] === 'function' && new (interfaces[i]) instanceof PrototypeInterface) {\r\n                    if (this.constructor.interfaces.includes(interfaces[i]) === false) return false;\r\n                } else if (typeof interfaces[i] === 'function') {\r\n                    if (!(this instanceof interfaces[i])) return false;\r\n                } else throw new Error('Error. \"' + interfaces[i].constructor.name + '\" is not interface!');\r\n            }\r\n        } else if (typeof interfaces === 'function' && new (interfaces) instanceof PrototypeInterface) {\r\n            return this.constructor.interfaces.includes(interfaces);\r\n        } else if (typeof interfaces === 'function') {\r\n            if (!(this instanceof interfaces)) return false;\r\n        } else {\r\n            throw new Error('Error. \"' + interfaces.constructor.name + '\" is not interface!');\r\n        }\r\n        return true;\r\n    }\r\n\r\n    toString() {\r\n        return this.__proto__.constructor.name;\r\n    }\r\n}\r\n","/**\r\n * PrototypeInterface\r\n * @constructor\r\n */\r\nexport default class PrototypeInterface {\r\n    static interfaces = [PrototypeInterface];\r\n\r\n    instanceOf(interfaces) {\r\n        let i = 0, j = 0;\r\n        if (typeof interfaces === 'object' && interfaces instanceof Array) {\r\n            for (i = 0; i < interfaces.length; i++) {\r\n                if (typeof interfaces[i] === 'function' && new (interfaces[i]) instanceof PrototypeInterface) {\r\n                    for (j = 0; j < this.constructor.interfaces.length; j++) {\r\n                        if (!(new (this.constructor.interfaces[j]) instanceof interfaces[i])) return false;\r\n                    }\r\n                } else throw new Error('Error. \"' + interfaces[i].constructor.name + '\" is not interface!');\r\n            }\r\n        } else if (typeof interfaces === 'function' && new (interfaces) instanceof PrototypeInterface) {\r\n            for (i = 0; i < this.constructor.interfaces.length; i++) {\r\n                if (!(new (this.constructor.interfaces[i]) instanceof interfaces)) return false;\r\n            }\r\n        } else {\r\n            throw new Error('Error. \"' + interfaces.constructor.name + '\" is not interface!');\r\n        }\r\n        return true;\r\n    }\r\n}\r\n","import PrototypeObject from \"api/PrototypeObject\";\r\nimport IHandler from \"api/interfaces/IHandler\";\r\n\r\n/**\r\n * Handler\r\n * @constructor\r\n */\r\nexport default class Handler extends PrototypeObject {\r\n    static interfaces = [IHandler];\r\n\r\n    _isEnabled = false;\r\n\r\n    constructor() {\r\n        super();\r\n\r\n        this.events = null;\r\n        this._isEnabled = false;\r\n    }\r\n\r\n    init(eventHandler) {\r\n        if (eventHandler !== undefined) {\r\n            this.events = eventHandler;\r\n        }\r\n        return this;\r\n    };\r\n\r\n    get isEnabled() {\r\n        return this._isEnabled;\r\n    }\r\n\r\n    enable() {\r\n        this._isEnabled = true;\r\n        return this;\r\n    };\r\n\r\n    disable() {\r\n        this._isEnabled = false;\r\n        return this;\r\n    };\r\n\r\n    toggle(status) {\r\n        if (status === undefined) status = !this.isEnabled;\r\n        if (status) {\r\n            this.enable();\r\n        } else {\r\n            this.disable();\r\n        }\r\n        return this;\r\n    };\r\n}\r\n","import Handler from \"api/Handler\";\r\nimport IEngineComponent from \"api/interfaces/IEngineComponent\";\r\n\r\n/**\r\n * EngineComponent\r\n * @constructor\r\n *\r\n * @interface IEngineComponent\r\n */\r\nexport default class EngineComponent extends Handler {\r\n    static interfaces = [IEngineComponent];\r\n\r\n    constructor() {\r\n        super();\r\n    }\r\n};\r\n\r\n","/**\r\n * Device\r\n * @constructor\r\n */\r\nexport default class Device {\r\n    input = undefined;\r\n\r\n    constructor(input) {\r\n        if (input !== undefined) this.input = input;\r\n    }\r\n\r\n    enable() {\r\n        return true;\r\n    };\r\n\r\n    disable() {\r\n        return true;\r\n    };\r\n\r\n    init(input) {\r\n        if (input !== undefined && this.input === undefined) this.input = input;\r\n        return false;\r\n    };\r\n\r\n    update() {\r\n        return true;\r\n    };\r\n\r\n    clear() {\r\n        return true;\r\n    };\r\n\r\n    toString() {\r\n        return function (device) {\r\n            return (device[0].toLowerCase() + device.slice(1))\r\n        }(this.constructor.DeviceName || this.constructor.name);\r\n    };\r\n};\r\n","/**\r\n * Class for generate uuid\r\n *\r\n * @class UUID\r\n * @exports module:utils/UUID\r\n *\r\n * @constructor\r\n */\r\nexport default class UUID {\r\n    static generate = function () {\r\n        return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {\r\n            var r = Math.random() * 16 | 0, v = c == 'x' ? r : (r & 0x3 | 0x8);\r\n            return v.toString(16);\r\n        });\r\n    }\r\n}\r\n","export default class SystemConsole {\r\n    css = (color) => {\r\n        return 'background: ' + color + ';' +\r\n            'background-repeat: no-repeat;' +\r\n            'color: #1df9a8;' +\r\n            'line-height: 16px;' +\r\n            'padding: 1px 0;' +\r\n            'margin: 0;' +\r\n            'user-select: none;' +\r\n            '-webkit-user-select: none;' +\r\n            '-moz-user-select: none;';\r\n    };\r\n\r\n    link = (color) => {\r\n        return 'background: ' + color + ';' +\r\n            'background-repeat: no-repeat;' +\r\n            'font-size: 12px;' +\r\n            'color: #446d96;' +\r\n            'line-height: 14px';\r\n    };\r\n\r\n    logSystem(message, link) {\r\n        return console.log(\"%c %c %c %s %c %c %c %c%s\",\r\n            this.css('#5C6166'), this.css('#4F5357'),\r\n            this.css('#313335'), message,\r\n            this.css('#4F5357'), this.css('#5C6166'),\r\n            this.link('none'), this.link('none'), link\r\n        );\r\n    }\r\n\r\n    log(message, level) {\r\n        let css = '';\r\n        if (typeof level === 'string') level = level.toLowerCase();\r\n        switch (level) {\r\n            case 'info':\r\n                level = 'INFO';\r\n                css = 'background: #308AE4; color: #fff; padding: 1px 4px';\r\n                break;\r\n            case 'warn':\r\n            case 'warning':\r\n                level = 'WARNING';\r\n                css = 'background: #f7a148; color: #fff; padding: 1px 4px';\r\n                break;\r\n            case 'error':\r\n                level = 'ERROR';\r\n                css = 'background: #DB5252; color: #fff; padding: 1px 4px';\r\n                break;\r\n            case 'network':\r\n                level = 'NETWORK';\r\n                css = 'background: #7D2998; color: #fff; padding: 1px 4px';\r\n                break;\r\n            case 'debug':\r\n            case undefined:\r\n            default:\r\n                level = 'DEBUG';\r\n                css = 'background: #ADADAD; color: #fff; padding: 1px 4px';\r\n        }\r\n        return console.log(\"%c%s\", css, level, message);\r\n    };\r\n}\r\n\r\n","import Vector2dInteger from \"utils/Vector2dInteger\";\r\n/**\r\n * Class utility for get system browser window size\r\n *\r\n * @class Device\r\n * @exports module:utils/DeviceUtil\r\n *\r\n * @constructor\r\n */\r\nexport default class Device {\r\n    constructor() {\r\n        let documentWidth = parseInt(Math.max(\r\n            document.documentElement['clientWidth'],\r\n            document.body['scrollWidth'],\r\n            document.documentElement['scrollWidth'],\r\n            document.body['offsetWidth'],\r\n            document.documentElement['offsetWidth']\r\n        ));\r\n\r\n        let documentHeight = parseInt(Math.max(\r\n            document.documentElement['clientHeight'],\r\n            document.body['scrollHeight'],\r\n            document.documentElement['scrollHeight'],\r\n            document.body['offsetHeight'],\r\n            document.documentElement['offsetHeight']\r\n        ));\r\n\r\n        this.width = documentWidth < parseInt(screen.width) ? documentWidth : parseInt(screen.width);\r\n        this.height = documentHeight < parseInt(screen.height) ? documentHeight : parseInt(screen.height);\r\n    }\r\n\r\n    /**\r\n     * @returns {Device}\r\n     */\r\n    onResize() {\r\n        this.width = window.innerWidth;\r\n        this.height = window.innerHeight;\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @returns {number}\r\n     */\r\n    getWidth() {\r\n        return this.width;\r\n    }\r\n\r\n    /**\r\n     * @returns {number}\r\n     */\r\n    getHeight() {\r\n        return this.height;\r\n    }\r\n\r\n    /**\r\n     * @returns {Vector2d}\r\n     */\r\n    getSize() {\r\n        return new Vector2dInteger(this.width, this.height);\r\n    }\r\n}\r\n","import Handler from \"api/Handler\";\r\nimport EngineComponent from \"api/EngineComponent\";\r\n\r\n/**\r\n * FrameHandler\r\n * @constructor\r\n */\r\nexport default class FrameHandler extends EngineComponent {\r\n    static instance;\r\n\r\n    static timestamp = 0;\r\n    static frameLimit = 60;\r\n\r\n    static _breakAnimationFrame = false;\r\n\r\n    /**\r\n     * @type {Array}\r\n     * @private\r\n     */\r\n    _engineStack = [];\r\n\r\n    /**\r\n     * @private\r\n     * @type {{start: boolean, pause: boolean}}}\r\n     */\r\n    _data = {\r\n        start: false,\r\n        pause: false\r\n    };\r\n\r\n    /** @private */\r\n    _loop;\r\n\r\n    constructor() {\r\n        super();\r\n    }\r\n\r\n    set frameLimit(value) {\r\n        if (value <= 60 && value > 0) {\r\n            FrameHandler.frameLimit = value\r\n        }\r\n        return FrameHandler.frameLimit || value;\r\n    }\r\n\r\n    get isStarted() {\r\n        return this._data.start;\r\n    }\r\n\r\n    get isPaused() {\r\n        return this._data.pause;\r\n    }\r\n\r\n    loop(timestamp) {\r\n        if (this._loop === undefined) this._loop = (timestamp) => {\r\n            this.loop(timestamp);\r\n        };\r\n\r\n        if (this._engineStack.length <= 0 && this._data.start || this._data.pause) {\r\n            FrameHandler._breakAnimationFrame = true;\r\n            this._data.start = false;\r\n            return CancelAnimationFrame(this._loop);\r\n        }\r\n        this._data.start = true;\r\n\r\n        RequestAnimationFrame(this._loop);\r\n\r\n        for (let i = 0; i < this._engineStack.length; i++) {\r\n            if (!this._engineStack[i].isEnabled) continue;\r\n            let engine = this._engineStack[i];\r\n\r\n            if (!engine._data.pause) {\r\n                if (engine.io) engine.io.update();\r\n\r\n                if (engine._state && typeof engine._state === 'function') engine.update(timestamp);\r\n\r\n                //let data = engine.data.render;\r\n\r\n                //data.now = Date.now();\r\n                //data.deltaTime = (data.now - data.lastTime) / 100.0;\r\n\r\n                // if (engine.update !== undefined && 'function' === typeof engine.update) {\r\n                //     if (engine.data.asyncUpdate) {\r\n                //         setTimeout(engine.update.bind(engine, timestamp, data), 0);\r\n                //         setTimeout(engine.tweens.update.bind(engine, timestamp), 0);\r\n                //     } else {\r\n                //         engine.update(timestamp, data);\r\n                //         engine.tweens.update(timestamp);\r\n                //     }\r\n                // }\r\n\r\n                // if ((data.deltaTime * 100.0) > data.interval) {\r\n                //     data.lastTime = data.now - ((data.deltaTime * 100.0) % data.interval);\r\n                //\r\n                //     if (engine.render !== undefined && 'function' === typeof engine.render) {\r\n                //         if (data.asyncRender) {\r\n                //             setTimeout(engine.render.bind(engine, timestamp, data), 0);\r\n                //         } else {\r\n                //             engine.render(timestamp, data);\r\n                //         }\r\n                //     }\r\n                // }\r\n\r\n                if (engine.io) engine.io.clear();\r\n            }\r\n        }\r\n    }\r\n\r\n    start(engineHandler) {\r\n        if (this._engineStack[engineHandler.guid] === undefined) {\r\n            this._engineStack[engineHandler.guid] = engineHandler;\r\n            this._engineStack.push(engineHandler);\r\n        }\r\n        if (!this._data.start) this.loop(Date.now() - FrameHandler.timestamp);\r\n        return this;\r\n    }\r\n\r\n    stop(engineHandler) {\r\n        if (this._engineStack[engineHandler.guid] !== undefined) {\r\n            delete this._engineStack[engineHandler.guid];\r\n            this._engineStack.splice(this._engineStack.indexOf(engineHandler.guid), 1);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    init(eventHandler) {\r\n        Handler.prototype.init.call(this, eventHandler);\r\n        return this;\r\n    }\r\n\r\n    enable() {\r\n        Handler.prototype.enable.call(this);\r\n        this._data.pause = false;\r\n        return this;\r\n    }\r\n\r\n    disable() {\r\n        Handler.prototype.disable.call(this);\r\n        this._data.pause = true;\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @singleton\r\n     * @returns {FrameHandler}\r\n     */\r\n    static init() {\r\n        return FrameHandler.instance || (FrameHandler.instance = new FrameHandler());\r\n    }\r\n}\r\n\r\nexport const RequestAnimationFrame = (() => {\r\n    return window.requestAnimationFrame ||\r\n        window.webkitRequestAnimationFrame ||\r\n        window.mozRequestAnimationFrame ||\r\n        window.oRequestAnimationFrame ||\r\n        window.msRequestAnimationFrame ||\r\n        ((callback) => {\r\n            if (!FrameHandler._breakAnimationFrame) {\r\n                if (FrameHandler.timestamp >= Number.MAX_SAFE_INTEGER - 1) FrameHandler.timestamp = 0;\r\n                if (FrameHandler.timestamp === 0) FrameHandler.timestamp = window.performance === undefined\r\n                    ? Date.now()\r\n                    : window.performance.now();\r\n                window.setTimeout(callback.bind(this, window.performance === undefined\r\n                    ? Date.now() - FrameHandler.timestamp\r\n                    : window.performance.now() - FrameHandler.timestamp\r\n                ), 1000.0 / FrameHandler.frameLimit);\r\n            } else {\r\n                FrameHandler._breakAnimationFrame = false\r\n            }\r\n        });\r\n})();\r\n\r\nexport const CancelAnimationFrame = (() => {\r\n    FrameHandler.timestamp = 0;\r\n    return window.cancelAnimationFrame ||\r\n        window.webkitCancelAnimationFrame ||\r\n        window.mozCancelAnimationFrame ||\r\n        window.oCancelAnimationFrame ||\r\n        window.msCancelAnimationFrame;\r\n})();\r\n","import Handler from \"api/Handler\";\r\nimport InputHandlerCodes from \"io/InputHandlerCodes\";\r\nimport Keyboard from \"io/devices/Keyboard\";\r\nimport Joystick from \"io/devices/Joystick\";\r\nimport Mouse from \"io/devices/Mouse\";\r\nimport Touch from \"io/devices/Touch\";\r\nimport Device from \"api/Device\";\r\nimport EngineComponent from \"api/EngineComponent\";\r\n\r\n/**\r\n * InputHandler\r\n * @constructor\r\n * @extends EngineComponent\r\n *\r\n * @interface IEngineComponent\r\n */\r\nexport default class InputHandler extends EngineComponent {\r\n\r\n    static IO = {\r\n        KEYBOARD: 'keyboard',\r\n        JOYSTICK: 'joystick',\r\n        MOUSE: 'mouse',\r\n        TOUCH: 'touch'\r\n    };\r\n\r\n    defaultIO = {\r\n        KEYBOARD: Keyboard,\r\n        JOYSTICK: Joystick,\r\n        MOUSE: Mouse,\r\n        TOUCH: Touch\r\n    };\r\n\r\n    static KEY = InputHandlerCodes;\r\n    KEY = InputHandler.KEY;\r\n\r\n    static KEYS_HELPER = InputHandler.prototype.KEYS_HELPER = {\r\n        getKeyById: function (index) {\r\n            return InputHandler.KEY[index] || 'KEY_UNKNOWN_' + index;\r\n        },\r\n        getKeyByCode: function (keyCode) {\r\n            return InputHandler.KEY[keyCode] || 0;\r\n        }\r\n    };\r\n\r\n    constructor() {\r\n        super();\r\n\r\n        this.preventDefault = false;\r\n        this.IO = [];\r\n        this.options = {\r\n            cursor: 'none'\r\n        };\r\n\r\n        this.store = {};\r\n\r\n        this.data = {};\r\n\r\n        this.keyCodeMap = {\r\n            //DEBUG_INFO: [[InputHandler.KEY.KEY_CTRL, InputHandler.KEY.KEY_F1], 'j2d.debug.toggleScreen', {}],\r\n            FULLSCREEN: [[InputHandler.KEY.KEY_CTRL, InputHandler.KEY.KEY_F11], 'j2d.scene.toggleFullScreen', {}]\r\n        };\r\n    }\r\n\r\n    bindListeners() {\r\n        for (let i = 0; i < this.IO.length; i++) {\r\n            if (this.IO[i].enable() === false) return false;\r\n        }\r\n    };\r\n\r\n    unBindListeners() {\r\n        for (let i = 0; i < this.IO.length; i++) {\r\n            if (this.IO[i].disable() === false) return false;\r\n        }\r\n    };\r\n\r\n    update() {\r\n        if (!this.isEnabled) return false;\r\n        for (let i = 0; i < this.IO.length; i++) {\r\n            if (this.IO[i].update() === false) return false;\r\n        }\r\n        return true;\r\n    };\r\n\r\n    clear() {\r\n        if (!this.isEnabled) return false;\r\n        for (let i = 0; i < this.IO.length; i++) {\r\n            if (this.IO[i].clear() === false) return false;\r\n        }\r\n        return true;\r\n    };\r\n\r\n    load(newKeyCodeMap) {\r\n        let oldKeyCodeMap = JSON.stringify(this.keyCodeMap);\r\n        this.keyCodeMap = JSON.parse(newKeyCodeMap);\r\n        return oldKeyCodeMap;\r\n    };\r\n\r\n    save() {\r\n        return JSON.stringify(this.keyCodeMap);\r\n    };\r\n\r\n    flush() {\r\n    }\r\n\r\n    // TODO:: to refactoring\r\n\r\n    static _getPressData(manager, keyList) {\r\n        return {\r\n            keyList: keyList,\r\n            time: manager.store.keys.pressedTime[keyList[0]]\r\n        };\r\n    }\r\n\r\n    checkPressedKeyList(keyList) {\r\n        if (typeof keyList === 'object' && keyList instanceof Array) {\r\n            if (keyList.length !== this.data.keys.keysDown.length) {\r\n                return false;\r\n                //} else if (this.data.keys.keysDown.equals(keyList)) {\r\n                //    return getPressData(this, keyList);\r\n            }\r\n            return false;\r\n        }\r\n        if (isNaN(keyList)) return false;\r\n        if (-1 !== this.data.keys.keysDown.indexOf(keyList)) {\r\n            return InputHandler._getPressData(this, keyList);\r\n        }\r\n        return false;\r\n    }\r\n\r\n    checkPressedKeyMap(key) {\r\n        if (this.keyCodeMap[key] === undefined) return false;\r\n        return this.checkPressedKeyList(this.keyCodeMap[key][0]);\r\n    }\r\n\r\n    setKeys(mapObject) {\r\n        //this.keyMap = $.extend(true, {}, this.keyMap, mapObject);\r\n        return this;\r\n    }\r\n\r\n    init(eventHandler, io, options) {\r\n        Handler.prototype.init.call(this, eventHandler);\r\n        if (options !== undefined && options !== null && typeof options === 'object') {\r\n            this.options = options;\r\n        }\r\n        if (io !== undefined && io !== null && typeof io === 'object' && io instanceof Array) {\r\n            this.IO = [];\r\n            io.map(function (device) {\r\n                if (typeof device === 'string' && InputHandler.IO[device.toUpperCase()] !== undefined) {\r\n                    device = new (this.defaultIO[device.toUpperCase()])();\r\n                    this.IO[device.toString()] = device;\r\n                    this.IO.push(device);\r\n                    if (this.IO[device].init(this) === false) {\r\n                        throw new Error('Error. Device \"' + device + '\" not initialize.');\r\n                    }\r\n                } else if (typeof device === 'object' && device instanceof Device) {\r\n                    this.IO[device.toString()] = device;\r\n                    this.IO.push(device);\r\n                    if (this.IO[device.toString()].init(this) === false) {\r\n                        throw new Error('Error. Device \"' + device + '\" not initialize.');\r\n                    }\r\n                } else {\r\n                    throw new Error('Error. Unknown IO device \"' + device.toString() + '\" is not supported yet.');\r\n                }\r\n            }.bind(this));\r\n        }\r\n        return this;\r\n    }\r\n\r\n    enable() {\r\n        Handler.prototype.enable.call(this);\r\n        this.bindListeners();\r\n        return this;\r\n    }\r\n\r\n    disable() {\r\n        Handler.prototype.disable.call(this);\r\n        this.unBindListeners();\r\n        return this;\r\n    }\r\n\r\n    toggle(status) {\r\n        Handler.prototype.toggle.call(this, status);\r\n        return this;\r\n    }\r\n}\r\n","import Handler from \"api/Handler\";\r\nimport EngineComponent from \"../api/EngineComponent\";\r\n\r\n/**\r\n * EventHandler\r\n * @constructor\r\n */\r\nexport default class EventHandler extends EngineComponent {\r\n\r\n    events = [];\r\n    onces = [];\r\n\r\n    constructor() {\r\n        super();\r\n        this.flush();\r\n    }\r\n\r\n    /**\r\n     * @param {string} eventName\r\n     * @param {function} callback\r\n     */\r\n    on(eventName, callback) {\r\n        if (this.events[eventName] !== undefined) {\r\n            var stack = this.events[eventName];\r\n            if (stack.indexOf(callback) === -1) {\r\n                stack.push(callback);\r\n            }\r\n        } else {\r\n            this.events[eventName] = [];\r\n            this.events[eventName].push(callback)\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {string} eventName\r\n     * @param {function} callback\r\n     */\r\n    once(eventName, callback) {\r\n        if (this.onces[eventName] !== undefined) {\r\n            var stack = this.onces[eventName];\r\n            if (stack.indexOf(callback) === -1) {\r\n                stack.push(callback);\r\n            }\r\n        } else {\r\n            this.onces[eventName] = [];\r\n            this.onces[eventName].push(callback)\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {string} eventName\r\n     * @param {function} callback\r\n     */\r\n    off(eventName, callback) {\r\n        if (this.onces[eventName] !== undefined) {\r\n            var stack = this.events[eventName];\r\n            if (stack.indexOf(callback) !== -1) {\r\n                stack.splice(stack.indexOf(callback));\r\n            }\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {string} eventName\r\n     * @param {Object} [data]\r\n     */\r\n    trigger(eventName, data) {\r\n        var stack, i, result;\r\n\r\n        if (this.onces[eventName] !== undefined) {\r\n            stack = this.onces[eventName];\r\n            for (i = 0; i < stack.length; i++) {\r\n                result = stack[i].call(stack[i], data);\r\n                if (typeof result === 'boolean' && !result) return this;\r\n            }\r\n            this.flush(eventName);\r\n        }\r\n\r\n        if (this.events[eventName] !== undefined) {\r\n            stack = this.events[eventName];\r\n            for (i = 0; i < stack.length; i++) {\r\n                result = stack[i].call(stack[i], data);\r\n                if (typeof result === 'boolean' && !result) return this;\r\n            }\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {string} [eventName]\r\n     */\r\n    flush(eventName) {\r\n        if (eventName !== undefined) {\r\n            if (this.events[eventName] !== undefined) {\r\n                this.events[eventName] = [];\r\n            }\r\n            if (this.onces[eventName] !== undefined) {\r\n                this.onces[eventName] = [];\r\n            }\r\n        } else {\r\n            this.onces = [];\r\n            this.events = [];\r\n        }\r\n        return this;\r\n    }\r\n\r\n    init(eventHandler) {\r\n        Handler.prototype.init.call(this, eventHandler);\r\n        return this;\r\n    }\r\n\r\n    enable() {\r\n        Handler.prototype.enable.call(this);\r\n        return this;\r\n    }\r\n\r\n    disable() {\r\n        Handler.prototype.disable.call(this);\r\n        return this;\r\n    }\r\n\r\n    toggle(status) {\r\n        Handler.prototype.toggle.call(this, status);\r\n        return this;\r\n    }\r\n}\r\n","import Exception from \"exceptions/Exception\";\r\n\r\n/**\r\n * InvalidArgumentException\r\n * Create custom exception with message\r\n *\r\n * @class InvalidArgumentException\r\n * @exports module:exceptions/InvalidArgumentException\r\n *\r\n * @constructor\r\n * @extends Exception\r\n * @param {string} message\r\n * @property {string} message\r\n */\r\nexport default class InvalidArgumentException extends Exception {\r\n    constructor(message) {\r\n        super(message)\r\n    }\r\n\r\n    /**\r\n     * Convert exception to String\r\n     * @returns {string}\r\n     */\r\n    toString = function () {\r\n        return this.message;\r\n    }\r\n}\r\n","import PrototypeInterface from \"api/PrototypeInterface\";\r\n\r\n/**\r\n * IEngineComponent\r\n * @constructor\r\n */\r\nexport default class IEngineComponent extends PrototypeInterface {\r\n};\r\n","import PrototypeObject from \"api/PrototypeObject\";\r\nimport IEngine from \"api/interfaces/IEngine\";\r\nimport RuntimeException from \"exceptions/RuntimeException\";\r\n\r\n/**\r\n * Engine\r\n * @constructor\r\n */\r\nexport default class Engine extends PrototypeObject {\r\n    static interfaces = [IEngine];\r\n    static _$classPreInitialize = [];\r\n\r\n    _isEnabled = false;\r\n\r\n    constructor(id) {\r\n        super();\r\n\r\n        if (!Engine._$classPreInitialize.includes(id)) {\r\n            throw new RuntimeException(`The constructor is private. Please use static ${this.constructor.name}.init()`);\r\n        } else Engine._$classPreInitialize.splice(Engine._$classPreInitialize.indexOf(id), 1);\r\n    }\r\n\r\n    get isEnabled() {\r\n        return this._isEnabled;\r\n    }\r\n\r\n    enable() {\r\n        this._isEnabled = true;\r\n        return this;\r\n    };\r\n\r\n    disable() {\r\n        this._isEnabled = false;\r\n        return this;\r\n    };\r\n\r\n    toggle(status) {\r\n        if (status === undefined) status = !this.isEnabled;\r\n        if (status) {\r\n            this.enable();\r\n        } else {\r\n            this.disable();\r\n        }\r\n        return this;\r\n    };\r\n};\r\n\r\n","import Engine from \"api/Engine\";\r\nimport IEngineComponent from \"api/interfaces/IEngineComponent\";\r\nimport InvalidArgumentException from \"exceptions/InvalidArgumentException\";\r\nimport EventHandler from \"events/EventHandler\";\r\nimport InputHandler from \"io/InputHandler\";\r\nimport FrameHandler from \"core/FrameHandler\";\r\nimport ArrayMap from \"utils/ArrayMap\";\r\nimport Device from \"utils/Device\";\r\nimport ObjectUtil from \"utils/ObjectUtil\";\r\nimport SystemConsole from \"utils/SystemConsole\";\r\nimport UUID from \"utils/UUID\";\r\n\r\n/**\r\n * @class EngineJ2D\r\n * @exports module:\"j2d\"\r\n *\r\n * @param {Element|HTMLElement|HTMLInputElement} element\r\n * @param {EngineJ2D.defaults|{}} data\r\n *\r\n * @constructor\r\n */\r\nexport default class EngineJ2D extends Engine {\r\n    /** @type {string} */\r\n    static VERSION = '1.0.0-dev (VeNoM iNjecTioN)';\r\n\r\n    /** @type {{id: string, pause: boolean, components: {\r\n        * EventHandler: IEngineComponent|EngineComponent|EventHandler,\r\n        * FrameHandler: IEngineComponent|EngineComponent|FrameHandler,\r\n        * InputHandler: IEngineComponent|EngineComponent|InputHandler,\r\n        * MediaHandler: IEngineComponent,\r\n        * TweenHandler: IEngineComponent,\r\n        * SceneHandler: IEngineComponent\r\n        * }}}\r\n     */\r\n    static defaults = {\r\n        id: '',\r\n        pause: false,\r\n        components: {\r\n            EventHandler: null,\r\n            FrameHandler: null,\r\n            InputHandler: null,\r\n            MediaHandler: null,\r\n            TweenHandler: null,\r\n            SceneHandler: null\r\n        }\r\n    };\r\n\r\n    /** @type {Array.<EngineJ2D>|ArrayMap.<EngineJ2D>} */\r\n    static stack = new ArrayMap();\r\n\r\n    /** @type boolean */\r\n    _initialized = false;\r\n\r\n    /** @type {Element|HTMLElement|HTMLInputElement} */\r\n    _element = null;\r\n\r\n    /** @type {EngineJ2D.defaults|{}} */\r\n    _data = {};\r\n\r\n    /** @type {function|null} */\r\n    _state = null;\r\n\r\n    /** @type {Device} */\r\n    device = new Device();\r\n\r\n    /** @type {SystemConsole} */\r\n    logger = new SystemConsole();\r\n\r\n    constructor(element, data) {\r\n        super(data !== undefined ? data.id : null);\r\n\r\n        this._element = element;\r\n        this._data = data;\r\n\r\n        this.log(`Find scene with id \"${this.guid}\"`, 'info');\r\n        this.log(this._data.components);\r\n    }\r\n\r\n    get guid() {\r\n        return this._data.id;\r\n    }\r\n\r\n    set state(state) {\r\n        return this._state = state;\r\n    }\r\n\r\n    /* +Handlers */\r\n\r\n    get events() {\r\n        return this.EventHandler;\r\n    }\r\n\r\n    get EventHandler() {\r\n        return this._data.components.EventHandler;\r\n    }\r\n\r\n    set EventHandler(handler) {\r\n        if (!handler.instanceOf(IEngineComponent))\r\n            throw new InvalidArgumentException('Handler not implements IEngineComponent');\r\n        return this._data.components.EventHandler = handler;\r\n    }\r\n\r\n    get frame() {\r\n        return this.FrameHandler;\r\n    }\r\n\r\n    get FrameHandler() {\r\n        return this._data.components.FrameHandler;\r\n    }\r\n\r\n    set FrameHandler(handler) {\r\n        if (!handler.instanceOf(IEngineComponent))\r\n            throw new InvalidArgumentException('Handler not implements IEngineComponent');\r\n        return this._data.components.FrameHandler = handler;\r\n    }\r\n\r\n    get io() {\r\n        return this.InputHandler;\r\n    }\r\n\r\n    get InputHandler() {\r\n        return this._data.components.InputHandler;\r\n    }\r\n\r\n    set InputHandler(handler) {\r\n        if (!handler.instanceOf(IEngineComponent))\r\n            throw new InvalidArgumentException('Handler not implements IEngineComponent');\r\n        return this._data.components.InputHandler = handler;\r\n    }\r\n\r\n    get media() {\r\n        return this.MediaHandler;\r\n    }\r\n\r\n    get MediaHandler() {\r\n        return this._data.components.MediaHandler;\r\n    }\r\n\r\n    set MediaHandler(handler) {\r\n        if (!handler.instanceOf(IEngineComponent))\r\n            throw new InvalidArgumentException('Handler not implements IEngineComponent');\r\n        return this._data.components.MediaHandler = handler;\r\n    }\r\n\r\n    get tweens() {\r\n        return this.TweenHandler;\r\n    }\r\n\r\n    get TweenHandler() {\r\n        return this._data.components.TweenHandler;\r\n    }\r\n\r\n    set TweenHandler(handler) {\r\n        if (!handler.instanceOf(IEngineComponent))\r\n            throw new InvalidArgumentException('Handler not implements IEngineComponent');\r\n        return this._data.components.TweenHandler = handler;\r\n    }\r\n\r\n    get scene() {\r\n        return this.SceneHandler;\r\n    }\r\n\r\n    get SceneHandler() {\r\n        return this._data.components.SceneHandler;\r\n    }\r\n\r\n    set SceneHandler(handler) {\r\n        if (!handler.instanceOf(IEngineComponent))\r\n            throw new InvalidArgumentException('Handler not implements IEngineComponent');\r\n        return this._data.components.SceneHandler = handler;\r\n    }\r\n\r\n    /* -Handlers */\r\n\r\n    /* +GameEngine */\r\n\r\n    start() {\r\n        if (!this._initialized) this.tryLoadComponents();\r\n        this.enable();\r\n\r\n        this.frame.start(this);\r\n        this.events.trigger('start');\r\n    };\r\n\r\n    stop() {\r\n        if (!this._initialized) this.tryLoadComponents();\r\n        this.disable();\r\n\r\n        this.frame.stop(this);\r\n        this.events.trigger('stop');\r\n    };\r\n\r\n    // TODO:: add MediaManager\r\n    pause() {\r\n        if (!this._initialized) this.tryLoadComponents();\r\n\r\n        if (this.io) this.io.flush();\r\n        this._data.pause = true;\r\n        this._element.classList.add('pause');\r\n        this.events.trigger('pause');\r\n    };\r\n\r\n    // TODO:: add MediaManager\r\n    resume() {\r\n        if (!this._initialized) this.tryLoadComponents();\r\n\r\n        this._element.classList.remove('pause');\r\n        this._element.focus();\r\n        this._data.pause = false;\r\n        if (this.io) this.io.flush();\r\n        this.events.trigger('resume');\r\n    };\r\n\r\n    update(timestamp) {\r\n        if (this._state) this._state.bind(this, timestamp)();\r\n    }\r\n\r\n    /* -GameEngine **/\r\n\r\n    /* +System **/\r\n\r\n    log(message, level) {\r\n        this.logger.log(message, level);\r\n    };\r\n\r\n    tryLoadComponents() {\r\n        if (this._initialized) return;\r\n        // EventHandler\r\n        if (this.EventHandler === null) {\r\n            this.EventHandler = new EventHandler();\r\n        }\r\n        this.EventHandler.enable();\r\n\r\n        // InputHandler\r\n        if (this.InputHandler === null) {\r\n            this.InputHandler = new InputHandler();\r\n            this.InputHandler.init(this.EventHandler, [\r\n                InputHandler.IO.KEYBOARD,\r\n                InputHandler.IO.MOUSE\r\n            ], {\r\n                cursor: 'default'\r\n            });\r\n        }\r\n        this.InputHandler.enable();\r\n\r\n        // FrameHandler\r\n        if (this.FrameHandler === null) {\r\n            this.FrameHandler = FrameHandler.init();\r\n            this.FrameHandler.init(this.EventHandler);\r\n        }\r\n        this.FrameHandler.enable();\r\n\r\n        this._initialized = true;\r\n    }\r\n\r\n    /* -System **/\r\n\r\n    /**\r\n     * @name EngineJ2D\r\n     * @static\r\n     *\r\n     * @param {string|window.jQuery} selected\r\n     * @param {EngineJ2D.defaults|Object} options\r\n     *\r\n     * @returns {EngineJ2D|EngineJ2D[]|Array.<EngineJ2D>}\r\n     */\r\n    static init(selected, options) {\r\n        if (selected === undefined) selected = '.j2d';\r\n        if (options === undefined) options = {};\r\n\r\n        options = ObjectUtil.extend(true, {}, EngineJ2D.defaults, options);\r\n\r\n        let nodes = [];\r\n        if (typeof selected === 'string') {\r\n            nodes = window.document.querySelectorAll(selected);\r\n        } else if (typeof selected === 'object' && window.jQuery !== undefined && selected instanceof window.jQuery) {\r\n            nodes = selected.get();\r\n        } else return null;\r\n\r\n        let inactiveNodes = [];\r\n        Array.prototype.forEach.call(nodes, (node) => {\r\n            if (!node.hasAttribute('guid')) inactiveNodes.push(node)\r\n        });\r\n\r\n        inactiveNodes.forEach((element) => {\r\n            options.id = UUID.generate();\r\n\r\n            element.setAttribute('guid', options.id);\r\n\r\n            let id = element.getAttribute('id');\r\n            if (id === undefined || id === null) {\r\n                element.setAttribute('guid', options.id);\r\n            }\r\n\r\n            let tabIndex = element.getAttribute('tabindex');\r\n            if (tabIndex === undefined || tabIndex === null || tabIndex === false) {\r\n                element.setAttribute('tabindex', '-1');\r\n            }\r\n\r\n            if (!element.classList.contains('j2d')) {\r\n                element.classList.add('j2d');\r\n            }\r\n\r\n            Engine._$classPreInitialize.push(options.id);\r\n            EngineJ2D.stack.add(options.id, new EngineJ2D(element, options));\r\n\r\n            element.click();\r\n            element.focus();\r\n        });\r\n\r\n        let resumeBind = (current) => {\r\n            let nodes, engine;\r\n            nodes = window.document.querySelectorAll('div.canvas[guid]:not(.pause-disable):not(:focus)');\r\n            Array.prototype.forEach.call(nodes, (node) => {\r\n                if (current !== node) {\r\n                    node.classList.remove('active');\r\n                    engine = EngineJ2D.stack.get(node.getAttribute('guid'));\r\n                    if (engine) engine.pause();\r\n                }\r\n            });\r\n\r\n            nodes = window.document.querySelectorAll('div.canvas[guid].active.pause-disable:not(:focus)');\r\n            Array.prototype.forEach.call(nodes, (node) => {\r\n                if (current !== node) {\r\n                    node.classList.remove('active');\r\n                }\r\n            });\r\n        };\r\n\r\n        function resumeEventListener() {\r\n            let engine;\r\n            if (this.classList.contains('pause')) {\r\n                engine = EngineJ2D.stack.get(this.getAttribute('guid'));\r\n                if (engine) engine.resume();\r\n                resumeBind(this);\r\n            } else if (!this.classList.contains('resume-by-click') && this.classList.contains(':focus')) {\r\n                this.classList.add('active');\r\n                this.focus();\r\n                engine = EngineJ2D.stack.get(this.getAttribute('guid'));\r\n                if (engine) engine.resume();\r\n                resumeBind(this);\r\n            }\r\n            return true;\r\n        }\r\n\r\n        let activeNodes = [];\r\n        nodes = window.document.querySelectorAll('.j2d[guid]');\r\n        Array.prototype.forEach.call(nodes, (node) => {\r\n            activeNodes.push(EngineJ2D.stack.get(node.getAttribute('guid')));\r\n            node.addEventListener('click', resumeEventListener);\r\n            node.addEventListener('touch', resumeEventListener);\r\n            node.addEventListener('mouseenter', resumeEventListener);\r\n        });\r\n        return (1 === activeNodes.length) ? activeNodes[0] : activeNodes;\r\n    }\r\n}\r\n\r\n/* ------------------------------ Plugin ------------------------------ */\r\n(EngineJ2D.initPlugin = () => {\r\n    if (window.j2dPlugin !== undefined) return null;\r\n    window.j2dPlugin = {pluginInit: true, stack: new ArrayMap()};\r\n\r\n    (new SystemConsole()).logSystem('j2D v.' + EngineJ2D.VERSION, 'https://github.com/fsggs/j2d');\r\n\r\n    if (window.jQuery !== undefined) {\r\n        /**\r\n         * @param {EngineJ2D.defaults} [options]\r\n         * @returns {EngineJ2D|EngineJ2D[]|Array.<EngineJ2D>}\r\n         */\r\n        window.jQuery.fn.j2d = (options) => {\r\n            return EngineJ2D.init(this, options);\r\n        };\r\n    }\r\n\r\n    window.j2dPlugin.init = EngineJ2D.init;\r\n\r\n    let firefox = window.navigator.userAgent.match(/Firefox\\/([0-9]+)\\./);\r\n    let version = firefox ? parseInt(firefox[2], 10) : false;\r\n\r\n    let isFullScreen = () => {\r\n        //noinspection JSUnresolvedVariable\r\n        return !!(window.document.webkitFullscreenElement\r\n            || window.document.webkitCurrentFullScreenElement\r\n            || (version && version < 47) ? window.document.mozFullScreenElement : window.document.fullscreenElement\r\n                || window.document.msFullscreenElement\r\n        );\r\n    };\r\n\r\n    function fullScreenEventListener() {\r\n        let fullScreen = isFullScreen();\r\n        if (!fullScreen) {\r\n            let node, engine;\r\n            node = window.document.querySelector('.j2d[guid].active');\r\n            if (node) engine = EngineJ2D.stack.get(node.getAttribute('guid'));\r\n            if (engine) engine.scene.resizeToFullPage(fullScreen);\r\n\r\n            node = window.document.querySelector('.j2d[guid]:not(.active)');\r\n            if (node) engine = EngineJ2D.stack.get(node.getAttribute('guid'));\r\n            if (engine) engine.toggle(!fullScreen);\r\n        }\r\n    }\r\n\r\n    let html = window.document.querySelector('html');\r\n\r\n    if (!html.classList.contains('j2d-engine')) {\r\n        window.document.addEventListener('fullscreenchange', fullScreenEventListener);\r\n        window.document.addEventListener('webkitfullscreenchange', fullScreenEventListener);\r\n        window.document.addEventListener('mozfullscreenchange', fullScreenEventListener);\r\n        window.document.addEventListener('MSFullscreenChange', fullScreenEventListener);\r\n\r\n        window.addEventListener('focus', () => {\r\n            let node, engine;\r\n            node = window.document.querySelector('.j2d[guid].active:not(.resume-by-click)');\r\n            if (node) engine = EngineJ2D.stack.get(node.getAttribute('guid'));\r\n            if (engine) engine.resume();\r\n        });\r\n\r\n        window.addEventListener('blur', () => {\r\n            let nodes, engine;\r\n            nodes = window.document.querySelectorAll('.j2d[guid]:not(.pause-disable)');\r\n            Array.prototype.forEach.call(nodes, (node) => {\r\n                if (node) engine = EngineJ2D.stack.get(node.getAttribute('guid'));\r\n                if (engine) engine.pause();\r\n            });\r\n        });\r\n\r\n        window.addEventListener('resize', () => {\r\n            EngineJ2D.stack.forEach((guid) => {\r\n                EngineJ2D.stack[guid].device.onResize();\r\n            });\r\n\r\n            let fullScreen = isFullScreen();\r\n            if (fullScreen) {\r\n                let node, engine;\r\n                node = window.document.querySelector('.j2d[guid].active');\r\n                if (node) engine = EngineJ2D.stack.get(node.getAttribute('guid'));\r\n                if (engine) engine.scene.resizeToFullPage(fullScreen);\r\n            }\r\n            return true;\r\n        });\r\n        html.classList.add('j2d-engine');\r\n    }\r\n})();\r\n"]}