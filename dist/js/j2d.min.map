{"version":3,"sources":["transitions/utils/Interpolation.es6","transitions/utils/Easing.es6","utils/MathUtil.es6","utils/ObjectUtil.es6","nodes/_deprecated/_deprecated_RectNode.es6","nodes/BaseNode.es6","nodes/_deprecated/_deprecated_CollectionNode.es6","nodes/_deprecated/_deprecated_CameraNode.es6","utils/Vector2d.es6","utils/UUID.es6","nodes/_deprecated/_deprecated_BaseNode.es6","nodes/_deprecated/_deprecated_AnimatedNode.es6","io/devices/Touch.es6","io/devices/Pointer.es6","io/devices/Mouse.es6","io/devices/Keyboard.es6","io/devices/Joystick.es6","api/interfaces/IInputHandler.es6","api/interfaces/IHandler.es6","api/interfaces/IEngine.es6","core/_deprecated_ViewportManager.es6","core/_deprecated_SceneManager.es6","core/_deprecated_LayersManager.es6","core/_deprecated_GameStatesManager.es6","utils/_deprecated_Events.es6","utils/_deprecated_ArrayMap.es6","transitions/_deprecated_Tween.es6","stores/BaseStore.es6","states/_deprecated_DefaultGameState.es6","states/_deprecated_BaseGameState.es6","objects/Immutable.es6","nodes/GroupNode.es6","nodes/CameraNode.es6","media/_deprecated_Video.es6","media/_deprecated_Sound.es6","media/_deprecated_Audio.es6","loaders/_deprecated_AssetsLoader.es6","layers/Layer.es6","exceptions/UnexpectedValueException.es6","exceptions/RuntimeException.es6","exceptions/RangeException.es6","exceptions/OutOfRangeException.es6","exceptions/OutOfBoundsException.es6","exceptions/LogicException.es6","exceptions/LengthException.es6","exceptions/Exception.es6","exceptions/BadMethodCallException.es6","exceptions/BadFunctionCallException.es6","io/_deprecated_MediaManager.es6","io/_deprecated_InputManager.es6","io/InputHandlerCodes.es6","api/PrototypeObject.es6","api/PrototypeInterface.es6","api/Handler.es6","api/EngineComponent.es6","api/Device.es6","objects/Mutable.es6","core/ViewportHandler.es6","layers/LayersHandler.es6","utils/SystemConsole.es6","utils/Device.es6","core/SceneHandler.es6","core/FrameHandler.es6","io/InputHandler.es6","events/EventHandler.es6","exceptions/InvalidArgumentException.es6","api/interfaces/IEngineComponent.es6","api/Engine.es6","j2d.es6"],"names":["InterpolationEnum","Interpolation","Linear","v","k","m","length","f","i","Math","floor","fn","Utils","Bezier","b","n","pw","pow","bn","Bernstein","CatmullRom","p0","p1","t","fc","Factorial","a","s","p2","p3","v0","v1","t2","t3","get","interpolation","undefined","register","interpolationFunction","linear","bezier","catmull-rom","EasingEnum","Easing","None","Quadratic","In","Out","InOut","Cubic","Quartic","Quintic","Sinusoidal","cos","PI","sin","Exponential","Circular","sqrt","Elastic","p","asin","Back","Bounce","_Tween2","default","easing","easingFunction","quadratic-in","quadratic-out","quadratic-in-out","cubic-in","cubic-out","cubic-in-out","quartic-in","quartic-out","quartic-in-out","quintic-in","quintic-out","quintic-in-out","sinusoidal-in","sinusoidal-out","sinusoidal-in-out","exponential-in","exponential-out","exponential-in-out","circular-in","circular-out","circular-in-out","elastic-in","elastic-out","elastic-in-out","back-in","back-out","back-in-out","bounce-in","bounce-out","bounce-in-out","MathUtil","number","isFinite","min","max","opacity","random","omitZero","degree","radian","ObjectUtil","args","Array","prototype","slice","call","arguments","deepness","splice","out","_typeof","Object","create","object","key","hasOwnProperty","extend","RectNode","data","_classCallCheck","this","_possibleConstructorReturn","__proto__","getPrototypeOf","_ObjectUtil2","defaults","color","context","viewport","collection","visible","inViewport","tempOpacity","globalAlpha","angle","save","translate","getPosition","x","offset","y","rotate","_MathUtil2","degree2Radian","fillStyle","lineWidth","fillRect","position","size","scale","restore","draw","type","BaseNode","_this","id","_data","_Mutable2","_UUID2","generate","device","toLowerCase","constructor","NodeName","name","isSpecial","CollectionNode","_ArrayMap2","node","add","remove","collectionNode","each","index","_BaseNode2","render","zIndex","value","CameraNode","screen","calculate","Vector2d","array","vector1","vector2","getVector","atan2","UUID","replace","c","r","toString","_Vector2d2","getSize","getOffset","enabledCache","cache","AnimatedNode","duration","durationAsSpeed","tween","getDistance","to","start","getAngle","velocity","Touch","input","Error","IO","_Pointer3","Pointer","image","pointer","store","options","cursor","window","document","body","style","toggle","distance","Mouse","defineProperty","enumerable","writable","e","isEnabled","preventDefault","keyCode","KEYS_HELPER","getKeyById","__fixMouseButtonId","button","keys","keysDown","includes","push","recordMouseDragDistance","tracker","pageX","pageY","recordMouseClickTime","pressedTime","delta","startTime","timeStamp","events","trigger","keysUp","toFixed","wheelDelta","keyMouseDownEventHandler","bind","keyMouseUpEventHandler","keyMouseMoveEventHandler","scrollMouseEventHandler","_get","setPointerImage","addEventListener","removeEventListener","Keyboard","recordKeyPressTime","keyDownEventHandler","keyUpEventHandler","Joystick","IInputHandler","IHandler","IEngine","calculateScale","offsetX","offsetY","ViewportManager","cameras","camera","init","_CameraNode2","getCameraViewport","SceneManager","j2d","setGameCallback","canvas","frameManager","_FrameManager2","Init","layersManager","_LayersManager2","viewportManager","_ViewportManager2","gameStatesManager","_GameStatesManager2","initLayers","state","sceneManager","timestamp","clear","fillBackground","originalWidth","width","originalHeight","height","originalMargin","getComputedStyle","element","initCanvas","setScreen","setDefaultViewport","getLayer","addLayer","querySelectorAll","createElement","left","top","webGL","getContext","smoothing","util","disableSmoothing","shadowColor","backgroundColor","appendChild","pos","clearRect","gameState","stop","gameConstructor","patchGameStateRender","getState","newGameState","callback","load","frameLimit","getPreviousState","unload","setTimeout","io","getCurrent","fullscreen","getElementById","attr","requestFullscreen","webkitRequestFullscreen","webkitRequestFullScreen","mozRequestFullScreen","msRequestFullscreen","exitFullscreen","webkitExitFullscreen","webkitCancelFullScreen","mozCancelFullScreen","msExitFullscreen","resize","enableFullscreen","margin","setOffset","scene","fullScreen","layers","forEach","getViewport","globalCollection","has","addCamera","setViewport","_updateNoCamerasViewport","updateViewport","display","enableFullScreen","LayersManager","_CollectionNode2","GameStatesManager","sceneCallback","_DefaultGameState2","states","contains","previousState","currentState","indexOf","Events","flush","eventName","onces","stack","ArrayMap","l","equals","result","tweens","Tween","tweenNode","_Events2","stateDefaults","properties","isStarted","stateData","_tweenStateData","tweenStateStack","time","nextState","currentStateAnimation","previousStatesTime","getStateTimeDuration","elapsed","import","animateTween","_Easing2","chainedTweensStack","withPrevious","tweenStateTimings","startState","parsedTweenStateStack","nextStateDelay","nextAllStateDelay","concat","reverseProperties","stateStack","stackLength","j","sIndex","delay","shift","calculateProperties","global","performance","now","isAnimated","cleanProperties","_calculateStackState","_calculateStackStateTimings","delayTime","stopChainedTweens","count","event","on","off","once","update","defaultDuration","property","temp","isNaN","Number","parseFloat","startProperties","endProperties","BaseStore","_Immutable2","_isEnabled","_RuntimeException2","oldState","toJS","newState","DefaultGameState","gsm","setNextState","BaseGameState","loader","STATE_NOT_LOADED","STATE_INIT","STATE_LOAD","STATE_UPDATE","STATE_RENDER","STATE_UNLOAD","FREEZE_NODE_METHODS","FREEZE_NODE_ARRAY_METHODS","Immutable","_InvalidArgumentException2","ImmutableArray","assign","unFreeze","JSON","stringify","freeze","__$ImmutableOptions","isFrozen","oldObject","newObject","console","log","getOwnPropertyNames","String","_this2","_get2","_len","_key","apply","_get3","_len2","_key2","fill","_get4","_len3","_key3","_get5","_len4","_key4","pop","reduce","reduceRight","reverse","sort","unshift","GroupNode","guid","_nodes","isSpecialNode","instanceOf","_BaseNode3","Video","createMasterGain","audioContext","masterGain","createGain","createGainNode","gain","connect","destination","Sound","manager","audioNode","getAudioContext","AudioContext","webkitAudioContext","getMasterGain","buffer","_setupAudioNode","iOSAutoEnable","iOSEnable","media","sound","loadBuffer","src","soundNode","disconnect","sprite","loaded","_inactiveNode","timerId","loop","soundId","round","Date","_nodeById","paused","_clearEndTimer","rate","onEndTimer","timer","loopStart","loopEnd","refreshBuffer","playStart","currentTime","volume","bufferSource","noteGrainOn","play","activeNode","noteOff","vol","z","pos3d","panner","setPosition","panningModel","model","readyState","createPanner","_drainPool","newNode","inactive","format","autoPlay","muted","url","loadSound","test","atob","split","dataView","Uint8Array","charCodeAt","decodeAudioData","xhr","XMLHttpRequest","open","responseType","onload","response","onerror","gainNode","send","arraybuffer","error","createBufferSource","playbackRate","AudioNode","Audio","audio","code","preload","listener","ceil","extension","isSupportAudio","warn","extractFormat","source","exec","isSupportCodec","_load","nodes","_unload","clearTimeout","audios","navigator","isCocoonJS","playSprite","pause","_activeNode","_pause","_stop","mute","_mute","unMute","_unMute","_volume","_position","zsaz","_pos3d","listenerEvent","AssetsLoader","progress","LAYER_PREFIX","Layer","_isGlobal","find","_registry","UnexpectedValueException","message","RuntimeException","RangeException","OutOfRangeException","OutOfBoundsException","LogicException","LengthException","Exception","BadMethodCallException","BadFunctionCallException","html5Audio","MediaManager","iOSEnabled","codecs","mp3","canPlayType","opus","ogg","wav","aac","m4a","mp4","weba","fileExtension","sounds","webAudio","userAgent","unlock","createBuffer","noteOn","playbackState","PLAYING_STATE","FINISHED_STATE","getKey","filter","checkKeyMap","enableCallback","which","keyMap","$","isArray","eval","keysPressed","onMouseClick","enabled","isPlay","hasClass","DEPRECATED_InputManager","mouse","inArray","enableAdditionalData","startPosition","timePressed","preventAll","previousDistance","onMouseWheel","originalEvent","fixMouseWheel","mouseWheelCancel","onMouseMove","currentPosition","onKeyboardPress","writeMode","char","fromCharCode","focus","onTouchTap","touch","touches","changedTouches","onTouchMove","bindEvents","selector","unbindEvents","getPressData","keyList","FULLSCREEN","KEY_CTRL","KEY_F11","j2dPlugin","pluginInit","dX","offsetWidth","dY","offsetHeight","keyPressed","SCROLL_MOUSE_UP","SCROLL_MOUSE_DOWN","newKeyMap","oldKeyMap","parse","mapObject","current","previous","checkPressedKeyList","mode","css","enable","KEY_MOUSE_LEFT","KEY_MOUSE_MIDDLE","KEY_MOUSE_RIGHT","KEY_BACKSPACE","KEY_TAB","KEY_ENTER","KEY_SHIFT","KEY_ALT","KEY_PAUSE","KEY_BREAK","KEY_CAPS_LOCK","KEY_ESCAPE","KEY_SPACE_BAR","KEY_PAGE_UP","KEY_PAGE_DOWN","KEY_END","KEY_HOME","KEY_LEFT_ARROW","KEY_UP_ARROW","KEY_RIGHT_ARROW","KEY_DOWN_ARROW","KEY_INSERT","KEY_DELETE","KEY_0","KEY_1","KEY_2","KEY_3","KEY_4","KEY_5","KEY_6","KEY_7","KEY_8","KEY_9","KEY_A","KEY_B","KEY_C","KEY_D","KEY_E","KEY_F","KEY_G","KEY_H","KEY_I","KEY_J","KEY_K","KEY_L","KEY_M","KEY_N","KEY_O","KEY_P","KEY_Q","KEY_R","KEY_S","KEY_T","KEY_U","KEY_V","KEY_W","KEY_X","KEY_Y","KEY_Z","KEY_LEFT_WINDOW_KEY","KEY_RIGHT_WINDOW_KEY","KEY_SELECT_KEY","KEY_NUMPAD_0","KEY_NUMPAD_1","KEY_NUMPAD_2","KEY_NUMPAD_3","KEY_NUMPAD_4","KEY_NUMPAD_5","KEY_NUMPAD_6","KEY_NUMPAD_7","KEY_NUMPAD_8","KEY_NUMPAD_9","KEY_MULTIPLY","KEY_ADD","KEY_SUBTRACT","KEY_DECIMAL_POINT","KEY_DIVIDE","KEY_F1","KEY_F2","KEY_F3","KEY_F4","KEY_F5","KEY_F6","KEY_F7","KEY_F8","KEY_F9","KEY_F10","KEY_F12","KEY_NUM_LOCK","KEY_SCROLL_LOCK","KEY_SEMI_COLON","KEY_EQUAL_SIGN","KEY_COMMA","KEY_DASH","KEY_PERIOD","KEY_FORWARD_SLASH","KEY_GRAVE_ACCENT","KEY_OPEN_BRACKET","KEY_BACK_SLASH","KEY_CLOSE_BRACKET","KEY_SINGLE_QUOTE","KEY_LEFT_COMMAND","KEY_RIGHT_COMMAND","KEY_MOUSE_3","KEY_MOUSE_4","KEY_MOUSE_5","KEY_MOUSE_6","KEY_MOUSE_7","KEY_MOUSE_8","KEY_MOUSE_9","KEY_MOUSE_10","PrototypeObject","interfaces","scope","implement","_PrototypeInterface2","PrototypeInterface","Handler","eventHandler","status","disable","_IHandler2","EngineComponent","_IEngineComponent2","Device","DeviceName","Mutable","__$MutableOptions","ViewportHandler","LayersHandler","_Layer2","_layers","SystemConsole","link","level","documentWidth","parseInt","documentElement","documentHeight","innerWidth","innerHeight","_Vector2dInteger2","SceneHandler","components","engine","_engine","querySelector","nodeName","_node","removeChild","right","bottom","_context","_disableSmoothing","_element","chrome","match","version","layer","handler","FrameHandler","_loop","_engineStack","_breakAnimationFrame","CancelAnimationFrame","RequestAnimationFrame","_state","engineHandler","instance","requestAnimationFrame","webkitRequestAnimationFrame","mozRequestAnimationFrame","oRequestAnimationFrame","msRequestAnimationFrame","MAX_SAFE_INTEGER","cancelAnimationFrame","webkitCancelAnimationFrame","mozCancelAnimationFrame","oCancelAnimationFrame","msCancelAnimationFrame","InputHandler","KEYBOARD","JOYSTICK","MOUSE","TOUCH","KEY","keyCodeMap","newKeyCodeMap","oldKeyCodeMap","_getPressData","map","toUpperCase","defaultIO","bindListeners","unBindListeners","getKeyByCode","EventHandler","InvalidArgumentException","IEngineComponent","Engine","_$classPreInitialize","_IEngine2","EngineJ2D","_Device2","_SystemConsole2","_initialized","tryLoadComponents","frame","classList","resume","logger","_EventHandler2","_InputHandler2","_SceneHandler2","_LayersHandler2","_ViewportHandler2","_FrameHandler2","MediaHandler","TweenHandler","selected","resumeEventListener","getAttribute","resumeBind","jQuery","inactiveNodes","hasAttribute","setAttribute","tabIndex","_Engine3","click","activeNodes","PluginInit","_jQuery","ready","initPlugin","fullScreenEventListener","isFullScreen","resizeToFullPage","logSystem","VERSION","firefox","webkitFullscreenElement","webkitCurrentFullScreenElement","mozFullScreenElement","fullscreenElement","msFullscreenElement","html","onResize","dispatchEvent","CustomEvent"],"mappings":"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","file":"j2d.min.js","sourcesContent":["let InterpolationEnum;\r\n\r\n/**\r\n * @class Interpolation\r\n * @exports module:transitions/utils/Interpolation\r\n *\r\n * @type {{Linear: Interpolation.Linear, Bezier: Interpolation.Bezier, CatmullRom: Interpolation.CatmullRom}}\r\n */\r\nlet Interpolation = {\r\n    /**\r\n     * @return {number}\r\n     */\r\n    Linear: function (v, k) {\r\n        var m = v.length - 1;\r\n        var f = m * k;\r\n        var i = Math.floor(f);\r\n        var fn = Interpolation.Utils.Linear;\r\n\r\n        if (k < 0) return fn(v[0], v[1], f);\r\n        if (k > 1) return fn(v[m], v[m - 1], m - f);\r\n\r\n        return fn(v[i], v[i + 1 > m ? m : i + 1], f - i);\r\n    },\r\n\r\n    /**\r\n     * @return {number}\r\n     */\r\n    Bezier: function (v, k) {\r\n        var b = 0;\r\n        var n = v.length - 1;\r\n        var pw = Math.pow;\r\n        var bn = Interpolation.Utils.Bernstein;\r\n\r\n        for (var i = 0; i <= n; i++) {\r\n            b += pw(1 - k, n - i) * pw(k, i) * v[i] * bn(n, i);\r\n        }\r\n\r\n        return b;\r\n    },\r\n\r\n    /**\r\n     * @return {number}\r\n     */\r\n    CatmullRom: function (v, k) {\r\n        var m = v.length - 1;\r\n        var f = m * k;\r\n        var i = Math.floor(f);\r\n        var fn = Interpolation.Utils.CatmullRom;\r\n\r\n        if (v[0] === v[m]) {\r\n            if (k < 0) i = Math.floor(f = m * (1 + k));\r\n\r\n            return fn(v[(i - 1 + m) % m], v[i], v[(i + 1) % m], v[(i + 2) % m], f - i);\r\n        } else {\r\n            if (k < 0) return v[0] - (fn(v[0], v[0], v[1], v[1], -f) - v[0]);\r\n            if (k > 1) return v[m] - (fn(v[m], v[m], v[m - 1], v[m - 1], f - m) - v[m]);\r\n\r\n            return fn(v[i ? i - 1 : 0], v[i], v[m < i + 1 ? m : i + 1], v[m < i + 2 ? m : i + 2], f - i);\r\n        }\r\n    },\r\n\r\n    Utils: {\r\n        /**\r\n         * @return {number}\r\n         */\r\n        Linear: function (p0, p1, t) {\r\n            return (p1 - p0) * t + p0;\r\n        },\r\n\r\n        /**\r\n         * @return {number}\r\n         */\r\n        Bernstein: function (n, i) {\r\n            var fc = Interpolation.Utils.Factorial;\r\n            return fc(n) / fc(i) / fc(n - i);\r\n        },\r\n\r\n        Factorial: (function () {\r\n            var a = [1];\r\n            return function (n) {\r\n                var s = 1;\r\n                if (a[n]) return a[n];\r\n\r\n                for (var i = n; i > 1; i--) {\r\n                    s *= i;\r\n                }\r\n                a[n] = s;\r\n\r\n                return s;\r\n            };\r\n        })(),\r\n\r\n        /**\r\n         * @return {number}\r\n         */\r\n        CatmullRom: function (p0, p1, p2, p3, t) {\r\n            var v0 = (p2 - p0) * 0.5;\r\n            var v1 = (p3 - p1) * 0.5;\r\n            var t2 = t * t;\r\n            var t3 = t * t2;\r\n\r\n            return (2 * p1 - 2 * p2 + v0 + v1) * t3 + (-3 * p1 + 3 * p2 - 2 * v0 - v1) * t2 + v0 * t + p1;\r\n        }\r\n    },\r\n\r\n    get: (interpolation) => {\r\n        if (InterpolationEnum[interpolation] !== undefined) {\r\n            return InterpolationEnum[interpolation];\r\n        }\r\n\r\n        // TODO:: Exceptions\r\n        //throw new InvalidArgumentException('Unknown interpolation: ' + interpolation);\r\n    },\r\n\r\n    register: (interpolation, interpolationFunction) => {\r\n        InterpolationEnum[interpolation] = interpolationFunction;\r\n    }\r\n};\r\n\r\nInterpolationEnum = {\r\n    'linear': Interpolation.Linear,\r\n    'bezier': Interpolation.Bezier,\r\n    'catmull-rom': Interpolation.CatmullRom\r\n};\r\n\r\nexport default Interpolation;\r\n","import Tween from \"transitions/Tween\";\r\n\r\nlet EasingEnum;\r\n\r\n/**\r\n * @class Easing\r\n * @exports module:transitions/utils/Easing\r\n *\r\n * @type {{Linear: {None: Easing.Linear.None}, Quadratic: {In: Easing.Quadratic.In, Out: Easing.Quadratic.Out, InOut: Easing.Quadratic.InOut}, Cubic: {In: Easing.Cubic.In, Out: Easing.Cubic.Out, InOut: Easing.Cubic.InOut}, Quartic: {In: Easing.Quartic.In, Out: Easing.Quartic.Out, InOut: Easing.Quartic.InOut}, Quintic: {In: Easing.Quintic.In, Out: Easing.Quintic.Out, InOut: Easing.Quintic.InOut}, Sinusoidal: {In: Easing.Sinusoidal.In, Out: Easing.Sinusoidal.Out, InOut: Easing.Sinusoidal.InOut}, Exponential: {In: Easing.Exponential.In, Out: Easing.Exponential.Out, InOut: Easing.Exponential.InOut}, Circular: {In: Easing.Circular.In, Out: Easing.Circular.Out, InOut: Easing.Circular.InOut}, Elastic: {In: Easing.Elastic.In, Out: Easing.Elastic.Out, InOut: Easing.Elastic.InOut}, Back: {In: Easing.Back.In, Out: Easing.Back.Out, InOut: Easing.Back.InOut}, Bounce: {In: Easing.Bounce.In, Out: Easing.Bounce.Out, InOut: Easing.Bounce.InOut}}}\r\n */\r\nlet Easing = {\r\n    Linear: {\r\n        /**\r\n         * @return {number}\r\n         */\r\n        None: function (k) {\r\n            return k;\r\n        }\r\n    },\r\n    Quadratic: {\r\n        /**\r\n         * @return {number}\r\n         */\r\n        In: function (k) {\r\n            return k * k;\r\n        },\r\n\r\n        /**\r\n         * @return {number}\r\n         */\r\n        Out: function (k) {\r\n            return k * (2 - k);\r\n        },\r\n\r\n        /**\r\n         * @return {number}\r\n         */\r\n        InOut: function (k) {\r\n            if ((k *= 2) < 1) return 0.5 * k * k;\r\n            return -0.5 * (--k * (k - 2) - 1);\r\n        }\r\n    },\r\n\r\n    Cubic: {\r\n        /**\r\n         * @return {number}\r\n         */\r\n        In: function (k) {\r\n            return k * k * k;\r\n        },\r\n\r\n        /**\r\n         * @return {number}\r\n         */\r\n        Out: function (k) {\r\n            return --k * k * k + 1;\r\n        },\r\n\r\n        /**\r\n         * @return {number}\r\n         */\r\n        InOut: function (k) {\r\n            if ((k *= 2) < 1) return 0.5 * k * k * k;\r\n            return 0.5 * ((k -= 2) * k * k + 2);\r\n        }\r\n    },\r\n\r\n    Quartic: {\r\n        /**\r\n         * @return {number}\r\n         */\r\n        In: function (k) {\r\n            return k * k * k * k;\r\n        },\r\n\r\n        /**\r\n         * @return {number}\r\n         */\r\n        Out: function (k) {\r\n            return 1 - (--k * k * k * k);\r\n        },\r\n\r\n        /**\r\n         * @return {number}\r\n         */\r\n        InOut: function (k) {\r\n            if ((k *= 2) < 1)  return 0.5 * k * k * k * k;\r\n            return -0.5 * ((k -= 2) * k * k * k - 2);\r\n        }\r\n    },\r\n\r\n    Quintic: {\r\n        /**\r\n         * @return {number}\r\n         */\r\n        In: function (k) {\r\n            return k * k * k * k * k;\r\n        },\r\n\r\n        /**\r\n         * @return {number}\r\n         */\r\n        Out: function (k) {\r\n            return --k * k * k * k * k + 1;\r\n        },\r\n\r\n        /**\r\n         * @return {number}\r\n         */\r\n        InOut: function (k) {\r\n            if ((k *= 2) < 1) return 0.5 * k * k * k * k * k;\r\n            return 0.5 * ((k -= 2) * k * k * k * k + 2);\r\n        }\r\n\r\n    },\r\n\r\n    Sinusoidal: {\r\n        /**\r\n         * @return {number}\r\n         */\r\n        In: function (k) {\r\n            return 1 - Math.cos(k * Math.PI / 2);\r\n        },\r\n\r\n        /**\r\n         * @return {number}\r\n         */\r\n        Out: function (k) {\r\n            return Math.sin(k * Math.PI / 2);\r\n        },\r\n\r\n        /**\r\n         * @return {number}\r\n         */\r\n        InOut: function (k) {\r\n            return 0.5 * (1 - Math.cos(Math.PI * k));\r\n        }\r\n    },\r\n\r\n    Exponential: {\r\n        /**\r\n         * @return {number}\r\n         */\r\n        In: function (k) {\r\n            return k === 0 ? 0 : Math.pow(1024, k - 1);\r\n        },\r\n\r\n        /**\r\n         * @return {number}\r\n         */\r\n        Out: function (k) {\r\n            return k === 1 ? 1 : 1 - Math.pow(2, -10 * k);\r\n        },\r\n\r\n        /**\r\n         * @return {number}\r\n         */\r\n        InOut: function (k) {\r\n            if (k === 0) return 0;\r\n            if (k === 1) return 1;\r\n            if ((k *= 2) < 1) return 0.5 * Math.pow(1024, k - 1);\r\n\r\n            return 0.5 * (-Math.pow(2, -10 * (k - 1)) + 2);\r\n        }\r\n    },\r\n\r\n    Circular: {\r\n        /**\r\n         * @return {number}\r\n         */\r\n        In: function (k) {\r\n            return 1 - Math.sqrt(1 - k * k);\r\n        },\r\n\r\n        /**\r\n         * @return {number}\r\n         */\r\n        Out: function (k) {\r\n            return Math.sqrt(1 - (--k * k));\r\n        },\r\n\r\n        /**\r\n         * @return {number}\r\n         */\r\n        InOut: function (k) {\r\n            if ((k *= 2) < 1) return -0.5 * (Math.sqrt(1 - k * k) - 1);\r\n            return 0.5 * (Math.sqrt(1 - (k -= 2) * k) + 1);\r\n        }\r\n    },\r\n\r\n    Elastic: {\r\n        /**\r\n         * @return {number}\r\n         */\r\n        In: function (k) {\r\n            var s;\r\n            var a = 0.1;\r\n            var p = 0.4;\r\n\r\n            if (k === 0) return 0;\r\n            if (k === 1) return 1;\r\n\r\n            if (!a || a < 1) {\r\n                a = 1;\r\n                s = p / 4;\r\n            } else {\r\n                s = p * Math.asin(1 / a) / (2 * Math.PI);\r\n            }\r\n\r\n            return -(a * Math.pow(2, 10 * (k -= 1)) * Math.sin((k - s) * (2 * Math.PI) / p));\r\n        },\r\n\r\n        /**\r\n         * @return {number}\r\n         */\r\n        Out: function (k) {\r\n            var s;\r\n            var a = 0.1;\r\n            var p = 0.4;\r\n\r\n            if (k === 0) return 0;\r\n            if (k === 1) return 1;\r\n\r\n            if (!a || a < 1) {\r\n                a = 1;\r\n                s = p / 4;\r\n            } else {\r\n                s = p * Math.asin(1 / a) / (2 * Math.PI);\r\n            }\r\n\r\n            return (a * Math.pow(2, -10 * k) * Math.sin((k - s) * (2 * Math.PI) / p) + 1);\r\n        },\r\n\r\n        /**\r\n         * @return {number}\r\n         */\r\n        InOut: function (k) {\r\n\r\n            var s;\r\n            var a = 0.1;\r\n            var p = 0.4;\r\n\r\n            if (k === 0) return 0;\r\n            if (k === 1) return 1;\r\n\r\n            if (!a || a < 1) {\r\n                a = 1;\r\n                s = p / 4;\r\n            } else {\r\n                s = p * Math.asin(1 / a) / (2 * Math.PI);\r\n            }\r\n\r\n            if ((k *= 2) < 1) {\r\n                return -0.5 * (a * Math.pow(2, 10 * (k -= 1)) * Math.sin((k - s) * (2 * Math.PI) / p));\r\n            }\r\n\r\n            return a * Math.pow(2, -10 * (k -= 1)) * Math.sin((k - s) * (2 * Math.PI) / p) * 0.5 + 1;\r\n\r\n        }\r\n\r\n    },\r\n\r\n    Back: {\r\n        /**\r\n         * @return {number}\r\n         */\r\n        In: function (k) {\r\n            var s = 1.70158;\r\n\r\n            return k * k * ((s + 1) * k - s);\r\n        },\r\n\r\n        /**\r\n         * @return {number}\r\n         */\r\n        Out: function (k) {\r\n            var s = 1.70158;\r\n\r\n            return --k * k * ((s + 1) * k + s) + 1;\r\n        },\r\n\r\n        /**\r\n         * @return {number}\r\n         */\r\n        InOut: function (k) {\r\n            var s = 1.70158 * 1.525;\r\n            if ((k *= 2) < 1) return 0.5 * (k * k * ((s + 1) * k - s));\r\n\r\n            return 0.5 * ((k -= 2) * k * ((s + 1) * k + s) + 2);\r\n        }\r\n    },\r\n\r\n    Bounce: {\r\n        /**\r\n         * @return {number}\r\n         */\r\n        In: function (k) {\r\n            return 1 - Tween.Easing.Bounce.Out(1 - k);\r\n        },\r\n\r\n        /**\r\n         * @return {number}\r\n         */\r\n        Out: function (k) {\r\n            if (k < (1 / 2.75)) {\r\n                return 7.5625 * k * k;\r\n            } else if (k < (2 / 2.75)) {\r\n                return 7.5625 * (k -= (1.5 / 2.75)) * k + 0.75;\r\n            } else if (k < (2.5 / 2.75)) {\r\n                return 7.5625 * (k -= (2.25 / 2.75)) * k + 0.9375;\r\n            } else {\r\n                return 7.5625 * (k -= (2.625 / 2.75)) * k + 0.984375;\r\n            }\r\n        },\r\n\r\n        /**\r\n         * @return {number}\r\n         */\r\n        InOut: function (k) {\r\n            if (k < 0.5) return Tween.Easing.Bounce.In(k * 2) * 0.5;\r\n            return Tween.Easing.Bounce.Out(k * 2 - 1) * 0.5 + 0.5;\r\n        }\r\n    },\r\n\r\n    get: (easing) => {\r\n        if (EasingEnum[easing] !== undefined) {\r\n            return EasingEnum[easing];\r\n        }\r\n\r\n        // TODO:: Exceptions\r\n        //throw new InvalidArgumentException('Unknown easing: ' + easing);\r\n    },\r\n    register: (easing, easingFunction) => {\r\n        EasingEnum[easing] = easingFunction;\r\n    }\r\n};\r\n\r\nEasingEnum = {\r\n    'linear': Easing.Linear.None,\r\n\r\n    'quadratic-in': Easing.Quadratic.In,\r\n    'quadratic-out': Easing.Quadratic.Out,\r\n    'quadratic-in-out': Easing.Quadratic.InOut,\r\n\r\n    'cubic-in': Easing.Cubic.In,\r\n    'cubic-out': Easing.Cubic.Out,\r\n    'cubic-in-out': Easing.Cubic.InOut,\r\n\r\n    'quartic-in': Easing.Quartic.In,\r\n    'quartic-out': Easing.Quartic.Out,\r\n    'quartic-in-out': Easing.Quartic.InOut,\r\n\r\n    'quintic-in': Easing.Quintic.In,\r\n    'quintic-out': Easing.Quintic.Out,\r\n    'quintic-in-out': Easing.Quintic.InOut,\r\n\r\n    'sinusoidal-in': Easing.Sinusoidal.In,\r\n    'sinusoidal-out': Easing.Sinusoidal.Out,\r\n    'sinusoidal-in-out': Easing.Sinusoidal.InOut,\r\n\r\n    'exponential-in': Easing.Exponential.In,\r\n    'exponential-out': Easing.Exponential.Out,\r\n    'exponential-in-out': Easing.Exponential.InOut,\r\n\r\n    'circular-in': Easing.Circular.In,\r\n    'circular-out': Easing.Circular.Out,\r\n    'circular-in-out': Easing.Circular.InOut,\r\n\r\n    'elastic-in': Easing.Elastic.In,\r\n    'elastic-out': Easing.Elastic.Out,\r\n    'elastic-in-out': Easing.Elastic.InOut,\r\n\r\n    'back-in': Easing.Back.In,\r\n    'back-out': Easing.Back.Out,\r\n    'back-in-out': Easing.Back.InOut,\r\n\r\n    'bounce-in': Easing.Bounce.In,\r\n    'bounce-out': Easing.Bounce.Out,\r\n    'bounce-in-out': Easing.Bounce.InOut\r\n};\r\n\r\nexport default Easing;\r\n","/**\r\n * @class MathUtil\r\n * @exports module:utils/MathUtil\r\n *\r\n * @constructor\r\n */\r\nexport default class MathUtil {\r\n    /**\r\n     * @param {number} number\r\n     * @returns {number}\r\n     */\r\n    static number2Integer(number) {\r\n        return number >> 0;\r\n    }\r\n\r\n    /**\r\n     * @param {number} number\r\n     * @returns {boolean}\r\n     */\r\n    static isInteger(number) {\r\n        return typeof number === \"number\" && isFinite(number)\r\n            && number > -9007199254740992 && number < 9007199254740992\r\n            && Math.floor(number) === number;\r\n    }\r\n\r\n    /**\r\n     * @param {number} min\r\n     * @param {number} max\r\n     * @param {number} opacity\r\n     * @returns {string}\r\n     */\r\n    static randomColor(min, max, opacity) {\r\n        return 'rgba('\r\n            + MathUtil.random(min, max) + ', '\r\n            + MathUtil.random(min, max) + ', '\r\n            + MathUtil.random(min, max) + ', '\r\n            + opacity + ')';\r\n    }\r\n\r\n    /**\r\n     * @param {number} min\r\n     * @param {number} max\r\n     * @param {boolean} [omitZero]\r\n     * @returns {number}\r\n     */\r\n    static random(min, max, omitZero) {\r\n        let random = (Math.floor(Math.random() * (max - min + 1) + min));\r\n        return (omitZero && random == 0)\r\n            ? MathUtil.random(min, max, omitZero)\r\n            : random;\r\n    }\r\n\r\n    /**\r\n     * @param {number} degree\r\n     * @returns {number}\r\n     */\r\n    static degree2Radian(degree) {\r\n        return degree * (Math.PI / 180);\r\n    }\r\n\r\n    /**\r\n     * @param {number} radian\r\n     * @returns {number}\r\n     */\r\n    static radian2Degree(radian) {\r\n        return radian * (180 / Math.PI);\r\n    }\r\n}\r\n","/**\r\n * @class ObjectUtil\r\n * @exports module:utils/ObjectUtil\r\n *\r\n * @constructor\r\n */\r\nexport default class ObjectUtil {\r\n    static extend() {\r\n        let args = Array.prototype.slice.call(arguments);\r\n        let deepness = false;\r\n        if (typeof args[0] === 'boolean') {\r\n            deepness = args[0];\r\n            args.splice(0, 1);\r\n        }\r\n\r\n        let out = args[0] || function () {\r\n                if (args[1] !== undefined && args[1] !== null && typeof args[1] === 'object') {\r\n                    return Object.create(args[1])\r\n                }\r\n                return {};\r\n            }();\r\n\r\n        for (let i = 1; i < args.length; i++) {\r\n            let object = args[i];\r\n\r\n            if (!object) continue;\r\n\r\n            for (let key in object) {\r\n                //noinspection JSUnresolvedFunction\r\n                if (object.hasOwnProperty(key)) {\r\n                    if (typeof object[key] === 'object' && object[key] !== null) {\r\n                        out[key] = deepness ? ObjectUtil.extend(deepness, out[key], object[key]) : object[key];\r\n                    } else {\r\n                        out[key] = object[key];\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        return out;\r\n    }\r\n}\r\n","import ObjectUtil from \"../../utils/ObjectUtil\";\r\nimport AnimatedNode from \"nodes/AnimatedNode\";\r\nimport MathUtil from \"../../utils/MathUtil\";\r\n\r\n/**\r\n * @class RectNode\r\n * @exports module:nodes/RectNode\r\n *\r\n * @constructor\r\n * @extends nodes/AnimatedNode\r\n * @param {BaseNode.defaults|AnimatedNode.defaults|RectNode.defaults|Object} [data]\r\n * @property {BaseNode.defaults|AnimatedNode.defaults|RectNode.defaults} data\r\n */\r\nexport default class RectNode extends AnimatedNode {\r\n    static defaults = {\r\n        type: 'RectNode',\r\n        color: '#000000'\r\n    };\r\n\r\n    constructor(data) {\r\n        super(ObjectUtil.extend(true, {}, RectNode.defaults, data));\r\n    }\r\n\r\n    /**\r\n     * @returns {string}\r\n     */\r\n    getColor() {\r\n        return this.data.color;\r\n    }\r\n\r\n    /**\r\n     * @param {string} color\r\n     * @returns {RectNode}\r\n     */\r\n    setColor(color) {\r\n        this.data.color = color;\r\n        return this;\r\n    }\r\n\r\n    /* ------------------------------ Draw ------------------------------ */\r\n\r\n    /**\r\n     * @param {CanvasRenderingContext2D} context\r\n     * @param {{offset: {x: number, y: number}, size: {x: number, y: number}, scale: number, angle: number}} viewport\r\n     * @param {CollectionNode} collection\r\n     * @param {object} data\r\n     * @returns {null}\r\n     */\r\n    draw(context, viewport, collection, data) {\r\n        if (this.data.visible && this.inViewport(viewport)) {\r\n            //console.log(this.inViewport(viewport));\r\n            if (this.data.opacity !== 1.0) {\r\n                var tempOpacity = context.globalAlpha;\r\n                context.globalAlpha = this.data.opacity;\r\n            }\r\n\r\n            if (this.data.angle || viewport.angle !== 0.0) {\r\n                context.save();\r\n\r\n                context.translate(\r\n                    this.getPosition().x - viewport.offset.x,\r\n                    this.getPosition().y - viewport.offset.y);\r\n                context.rotate(MathUtil.degree2Radian(this.data.angle + viewport.angle));\r\n                context.translate(\r\n                    -(this.getPosition().x - viewport.offset.x),\r\n                    -(this.getPosition().y - viewport.offset.y));\r\n            }\r\n\r\n            context.fillStyle = this.data.color;\r\n            context.lineWidth = 0;\r\n\r\n            context.fillRect(\r\n                this.data.position.x - viewport.offset.x,\r\n                this.data.position.y - viewport.offset.y,\r\n                this.data.size.x * this.data.scale * viewport.scale,\r\n                this.data.size.y * this.data.scale * viewport.scale\r\n            );\r\n\r\n            if (this.data.angle || viewport.angle !== 0.0) {\r\n                context.restore();\r\n            }\r\n\r\n            if (this.data.opacity !== 1.0) {\r\n                context.globalAlpha = tempOpacity;\r\n            }\r\n        }\r\n        return null;\r\n    }\r\n\r\n    /* ------------------------------ Render ------------------------------ */\r\n\r\n    /**\r\n     * @override\r\n     *\r\n     * @param {CanvasRenderingContext2D} context\r\n     * @param {{offset: {x: number, y: number}, size: {x: number, y: number}, scale: number, angle: number}} viewport\r\n     * @param {CollectionNode} collection\r\n     * @param {object} data\r\n     * @returns {BaseNode|AnimatedNode|RectNode}\r\n     */\r\n    render(context, viewport, collection, data) {\r\n        this.draw(context, viewport, collection, data);\r\n        return this;\r\n    }\r\n}\r\n","import PrototypeObject from \"api/PrototypeObject\";\r\nimport UUID from \"utils/UUID\";\r\nimport Mutable from \"objects/Mutable\";\r\n\r\nexport default class BaseNode extends PrototypeObject {\r\n    static NodeName = 'BaseNode';\r\n    static isSpecial = false;\r\n\r\n    /** @type {{id: null|string}} */\r\n    static defaults = {\r\n        id: null\r\n    };\r\n\r\n    /** @type {BaseNode.defaults|{}} */\r\n    _data;\r\n\r\n    constructor(data) {\r\n        super();\r\n        if (typeof data === 'string') data = {id: data};\r\n        this._data = Mutable.extend(true, {}, BaseNode.defaults, data);\r\n        if (this._data.id === null) this._data.id = UUID.generate();\r\n    }\r\n\r\n    get guid() {\r\n        return this._data.id;\r\n    }\r\n\r\n    get isSpecialNode() {\r\n        return this.constructor.isSpecial || false;\r\n    }\r\n\r\n    toString() {\r\n        return function (device) {\r\n            return (device[0].toLowerCase() + device.slice(1))\r\n        }(this.constructor.NodeName || this.constructor.name);\r\n    }\r\n}\r\n","import ObjectUtil from \"../../utils/ObjectUtil\";\r\nimport AnimatedNode from \"nodes/AnimatedNode\";\r\nimport ArrayMap from \"utils/ArrayMap\";\r\nimport BaseNode from \"../BaseNode\";\r\n\r\n/**\r\n * @class CollectionNode\r\n * @exports module:nodes/CollectionNode\r\n *\r\n * @constructor\r\n * @extends nodes/AnimatedNode\r\n * @param {BaseNode.defaults|AnimatedNode.defaults|CollectionNode.defaults|Object} [data]\r\n * @property {BaseNode.defaults|AnimatedNode.defaults|CollectionNode.defaults} data\r\n */\r\nexport default class CollectionNode extends AnimatedNode {\r\n    static defaults = {\r\n        type: 'CollectionNode',\r\n        /** @type {ArrayMap|null} */\r\n        collection: null,\r\n        zIndex: 1000\r\n    };\r\n\r\n    constructor(data) {\r\n        super(ObjectUtil.extend(true, {}, CollectionNode.defaults, data));\r\n\r\n        if (this.data.collection === null) {\r\n            this.data.collection = new ArrayMap();\r\n        }\r\n    }\r\n\r\n    get zIndex() {\r\n        return 1000 - this.data.zIndex;\r\n    }\r\n\r\n    set zIndex(value) {\r\n        this.data.zIndex = 1000 + value;\r\n    }\r\n\r\n    /**\r\n     * @param {BaseNode|CollectionNode} node\r\n     * @param {string} key\r\n     * @returns {CollectionNode}\r\n     */\r\n    add(node, key) {\r\n        if (node instanceof BaseNode) {\r\n            key = key || node.data.id;\r\n            this.data.collection.add(key, node);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {BaseNode|CollectionNode|null} node\r\n     * @param {string} key\r\n     * @returns {CollectionNode}\r\n     */\r\n    remove(node, key) {\r\n        if (node instanceof BaseNode) {\r\n            this.data.collection.remove(this.data.collection[node.data.id]);\r\n        }\r\n        if (typeof key === 'string' && node === null) {\r\n            this.data.collection.remove(key);\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {string} key\r\n     * @returns {boolean}\r\n     */\r\n    has(key) {\r\n        return this.data.collection[key] !== undefined;\r\n    }\r\n\r\n    /**\r\n     * @param {string} key\r\n     * @returns {BaseNode|CollectionNode|boolean}\r\n     */\r\n    get(key) {\r\n        if (this.data.collection[key] !== undefined) {\r\n            return this.data.collection[key];\r\n        }\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * @returns {CollectionNode}\r\n     */\r\n    flush() {\r\n        this.data.collection.length = 0;\r\n        return this;\r\n    }\r\n\r\n    /* ------------------------------ Render ------------------------------ */\r\n\r\n    /**\r\n     * @override\r\n     *\r\n     * @param {CanvasRenderingContext2D} context\r\n     * @param {{offset: {x: number, y: number}, size: {x: number, y: number}, scale: number, angle: number}} viewport\r\n     * @param {CollectionNode} collection\r\n     * @param {object} data\r\n     * @returns {BaseNode|CollectionNode}\r\n     */\r\n    render(context, viewport, collection, data) {\r\n        var collectionNode = this;\r\n\r\n        if (this.data.collection.length !== 0) {\r\n            this.data.collection.each(function (index) {\r\n                if (collectionNode.data.collection.hasOwnProperty(index)\r\n                    && collectionNode.data.collection[index] instanceof BaseNode) {\r\n                    collectionNode.data.collection[index].render(context, viewport, collection, data);\r\n                }\r\n            });\r\n        }\r\n        return this;\r\n    }\r\n}\r\n","import ObjectUtil from \"../../utils/ObjectUtil\";\r\nimport AnimatedNode from \"nodes/AnimatedNode\";\r\n\r\n/**\r\n * @class CameraNode\r\n * @exports module:nodes/CameraNode\r\n *\r\n * @constructor\r\n * @extends nodes/AnimatedNode\r\n * @param {BaseNode.defaults|AnimatedNode.defaults|CameraNode.defaults|Object} [data]\r\n * @property {BaseNode.defaults|AnimatedNode.defaults|CameraNode.defaults} data\r\n */\r\nexport default class CameraNode extends AnimatedNode {\r\n    static defaults = {\r\n        type: 'CameraNode'\r\n    };\r\n\r\n    constructor(data) {\r\n        super(ObjectUtil.extend(true, {}, CameraNode.defaults, data));\r\n    }\r\n\r\n    /**\r\n     * @param {{x: number, y: number, offsetX: number, offsetY: number}} screen\r\n     * @param {Function|callback} calculate\r\n     * @returns {{offset: {x: number, y: number}, size: {x: number, y: number}, scale: number, angle: number}}\r\n     */\r\n    getCameraViewport(screen, calculate) {\r\n        return calculate(screen, {\r\n            offset: this.data.position,\r\n            size: this.data.size,\r\n            angle: this.data.angle,\r\n            scale: this.data.scale\r\n        });\r\n    };\r\n\r\n    /* ------------------------------ Render ------------------------------ */\r\n\r\n    /**\r\n     * @override\r\n     *\r\n     * @param {CanvasRenderingContext2D} context\r\n     * @param {{offset: {x: number, y: number}, size: {x: number, y: number}, scale: number, angle: number}} viewport\r\n     * @param {CollectionNode} collection\r\n     * @param {object} data\r\n     * @returns {BaseNode|AnimatedNode|CameraNode}\r\n     */\r\n    render(context, viewport, collection, data) {\r\n        return this;\r\n    }\r\n}\r\n","/**\r\n * @class Vector2d\r\n * @exports module:utils/Vector2d\r\n *\r\n * @constructor\r\n * @param {number} x\r\n * @param {number} y\r\n */\r\nexport default class Vector2d {\r\n    constructor(x, y) {\r\n        this.x = x;\r\n        this.y = y;\r\n    }\r\n\r\n    /**\r\n     * @returns {number}\r\n     */\r\n    getX() {\r\n        return this.x;\r\n    }\r\n\r\n    /**\r\n     * @returns {number}\r\n     */\r\n    getY() {\r\n        return this.y;\r\n    }\r\n\r\n    /**\r\n     * @returns {{x: number, y: number}}\r\n     */\r\n    getVector() {\r\n        return {x: this.x, y: this.y};\r\n    }\r\n\r\n    /**\r\n     * @returns {Array.<number>}\r\n     */\r\n    toArray() {\r\n        return [this.x, this.y];\r\n    }\r\n\r\n    /**\r\n     * @param {Array.<number>} array\r\n     * @returns {Vector2d}\r\n     */\r\n    fromArray(array) {\r\n        this.x = array[0];\r\n        this.y = array[1];\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @returns {string}\r\n     */\r\n    toString() {\r\n        return \"(\" + this.x + \",\" + this.y + \")\";\r\n    }\r\n\r\n    /**\r\n     * @param {Vector2d} vector1\r\n     * @param {Vector2d} vector2\r\n     * @returns {number}\r\n     */\r\n    static getDistance(vector1, vector2) {\r\n        return Math.sqrt(\r\n            Math.pow(vector2.getVector().x - vector1.getVector().x, 2) +\r\n            Math.pow(vector2.getVector().y - vector1.getVector().y, 2)\r\n        );\r\n    }\r\n\r\n    /**\r\n     * @param {Vector2d} vector1\r\n     * @param {Vector2d} vector2\r\n     * @returns {number}\r\n     */\r\n    static getAngle(vector1, vector2) {\r\n        return Math.atan2(\r\n                vector2.getVector().y - vector1.getVector().y,\r\n                vector2.getVector().x - vector1.getVector().x\r\n            ) * (180 / Math.PI);\r\n    }\r\n}\r\n","/**\r\n * Class for generate uuid\r\n *\r\n * @class UUID\r\n * @exports module:utils/UUID\r\n *\r\n * @constructor\r\n */\r\nexport default class UUID {\r\n    static generate = function () {\r\n        return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {\r\n            let r = Math.random() * 16 | 0, v = c == 'x' ? r : (r & 0x3 | 0x8);\r\n            return v.toString(16);\r\n        });\r\n    }\r\n}\r\n","import ObjectUtil from \"../../utils/ObjectUtil\";\r\nimport UUID from \"../../utils/UUID\";\r\nimport Vector2d from \"../../utils/Vector2d\";\r\n\r\n/**\r\n * @class BaseNode\r\n * @exports module:nodes/BaseNode\r\n *\r\n * @abstract\r\n * @constructor\r\n * @param {BaseNode.defaults|Object} [data]\r\n * @property {BaseNode.defaults} data\r\n */\r\n\r\nexport default class BaseNode {\r\n    static defaults = {\r\n        /** @type {string|null} */\r\n        id: null,\r\n        type: 'BaseNode',\r\n\r\n        position: {\r\n            x: 0.0,\r\n            y: 0.0\r\n        },\r\n        size: {\r\n            x: 0.0,\r\n            y: 0.0\r\n        },\r\n        offset: {\r\n            x: 0.0,\r\n            y: 0.0\r\n        },\r\n\r\n        visible: true,\r\n        angle: 0.0,\r\n        scale: 1.0,\r\n        opacity: 1.0,\r\n\r\n        cache: null,\r\n        enabledCache: false // TODO:: Collections & AnimatedPrimitiveNode\r\n    };\r\n\r\n    constructor(data) {\r\n        this.data = ObjectUtil.extend(true, {}, BaseNode.defaults, data);\r\n\r\n        if (this.data.id === null) {\r\n            this.data.id = UUID.generate();\r\n        }\r\n    }\r\n\r\n    get opacity() {\r\n        return this.data.opacity;\r\n    }\r\n\r\n    set opacity(value) {\r\n        this.data.opacity = value;\r\n    }\r\n\r\n    get visible() {\r\n        return this.data.visible;\r\n    }\r\n\r\n    set visible(value) {\r\n        this.data.visible = !!value;\r\n    }\r\n\r\n    get angle() {\r\n        return this.data.angle;\r\n    }\r\n\r\n    set angle(value) {\r\n        this.data.angle = value % 360;\r\n    }\r\n\r\n    get scale() {\r\n        return this.data.scale;\r\n    }\r\n\r\n    set scale(value) {\r\n        this.data.scale = value;\r\n    }\r\n\r\n    get cache() {\r\n        return this.data.enabledCache;\r\n    }\r\n\r\n    set cache(value) {\r\n        this.data.enabledCache = !!value;\r\n    }\r\n\r\n    /**\r\n     * @param {BaseNode.defaults|Object} data\r\n     */\r\n    load(data) {\r\n        this.data = ObjectUtil.extend(true, {}, this.data, data);\r\n    }\r\n\r\n    /**\r\n     * @returns {BaseNode.defaults}\r\n     */\r\n    save() {\r\n        return this.data;\r\n    }\r\n\r\n    /**\r\n     * @returns {Vector2d}\r\n     */\r\n    getPosition() {\r\n        return new Vector2d(this.data.position.x, this.data.position.y);\r\n    }\r\n\r\n    /**\r\n     * @param {Vector2d|BaseNode} position\r\n     * @returns {BaseNode}\r\n     */\r\n    setPosition(position) {\r\n        if (position !== undefined) {\r\n            if (position instanceof Vector2d) {\r\n                this.data.position = position.getVector();\r\n            } else if (position instanceof BaseNode) {\r\n                this.data.position = position.getPosition().getVector();\r\n            }\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @returns {Vector2d}\r\n     */\r\n    getSize() {\r\n        return new Vector2d(this.data.size.x, this.data.size.y);\r\n    }\r\n\r\n    /**\r\n     * @param {Vector2d|BaseNode} size\r\n     * @returns {BaseNode}\r\n     */\r\n    setSize(size) {\r\n        if (size !== undefined) {\r\n            if (size instanceof Vector2d) {\r\n                this.data.size = size.getVector();\r\n            } else if (size instanceof BaseNode) {\r\n                this.data.size = size.getSize().getVector();\r\n            }\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @returns {Vector2d}\r\n     */\r\n    getOffset() {\r\n        return new Vector2d(this.data.offset.x, this.data.offset.y);\r\n    }\r\n\r\n    /**\r\n     * @param {Vector2d|BaseNode} offset\r\n     * @returns {BaseNode}\r\n     */\r\n    setOffset(offset) {\r\n        if (offset !== undefined) {\r\n            if (offset instanceof Vector2d) {\r\n                this.data.offset = offset.getVector();\r\n            } else if (offset instanceof BaseNode) {\r\n                this.data.offset = offset.getOffset().getVector();\r\n            }\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /* ------------------------------ Render ------------------------------ */\r\n\r\n    /**\r\n     * Must be override this in child!\r\n     *\r\n     * @deprecated\r\n     * @overridable\r\n     *\r\n     * @param {CanvasRenderingContext2D} context\r\n     * @param {{offset: {x: number, y: number}, size: {x: number, y: number}, scale: number, angle: number}} viewport\r\n     * @param {CollectionNode} collection\r\n     * @param {object} data\r\n     * @returns {BaseNode}\r\n     */\r\n    render(context, viewport, collection, data) {\r\n        // throw new Exception('Trying to render base node.'); // TODO:: exceptions\r\n        return this;\r\n    }\r\n\r\n    //TODO:: Fix on fullscreen\r\n    /**\r\n     * @param {{offset: {x: number, y: number}, size: {x: number, y: number}, scale: number, angle: number}} viewport\r\n     * @returns {boolean}\r\n     */\r\n    inViewport(viewport) {\r\n        return !((this.data.position.x > viewport.offset.x + viewport.size.x\r\n        || this.data.position.x + viewport.size.x < viewport.offset.x)\r\n        || (this.data.position.y > viewport.offset.y + viewport.size.y\r\n        || this.data.position.y + viewport.size.y < viewport.offset.y));\r\n    }\r\n}\r\n\r\n\r\n\r\n\r\n","import ObjectUtil from \"../../utils/ObjectUtil\";\r\nimport BaseNode from \"../BaseNode\";\r\nimport Vector2d from \"../../utils/Vector2d\";\r\nimport Tween from \"transitions/Tween\";\r\n\r\n// TODO:: move(+v.x, +v.y)\r\n\r\n/**\r\n * @class AnimatedNode\r\n * @exports module:nodes/AnimatedNode\r\n *\r\n * @abstract\r\n * @constructor\r\n * @extends nodes/BaseNode\r\n * @param {BaseNode.defaults|AnimatedNode.defaults|Object} [data]\r\n * @property {BaseNode.defaults|AnimatedNode.defaults} data\r\n */\r\nexport default class AnimatedNode extends BaseNode {\r\n    static defaults = {\r\n        type: 'AnimatedNode'\r\n    };\r\n\r\n    constructor(data) {\r\n        super(ObjectUtil.extend(true, {}, AnimatedNode.defaults, data));\r\n    }\r\n\r\n    /**\r\n     * @param {Vector2d|BaseNode} position\r\n     * @param {number} [duration]\r\n     * @param {boolean} [durationAsSpeed]\r\n     */\r\n    moveTo(position, duration, durationAsSpeed) {\r\n        if (duration === undefined || typeof duration !== 'number') duration = 1000.0;\r\n\r\n        if (typeof position === 'object') {\r\n            var tween = new Tween(this);\r\n\r\n            if (position instanceof Vector2d) {\r\n                if (durationAsSpeed) duration = Vector2d.getDistance(this.getPosition(), position) / duration;\r\n                tween.to({\r\n                    position: {\r\n                        x: position.getVector().x,\r\n                        y: position.getVector().y\r\n                    }\r\n                }, duration);\r\n            } else if (position instanceof BaseNode) {\r\n                if (durationAsSpeed) duration = Vector2d.getDistance(this.getPosition(), position.getPosition()) / duration;\r\n                tween.to({\r\n                    position: {\r\n                        x: position.getPosition().getVector().x,\r\n                        y: position.getPosition().getVector().y\r\n                    }\r\n                }, duration);\r\n            }\r\n\r\n            tween.start();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @param {Vector2d|BaseNode} size\r\n     * @param {number} [duration]\r\n     * @param {boolean} [durationAsSpeed]\r\n     */\r\n    resizeTo(size, duration, durationAsSpeed) {\r\n        if (duration === undefined || typeof duration !== 'number') duration = 1000.0;\r\n        if (typeof position === 'object') {\r\n            var tween = new Tween(this);\r\n\r\n            if (size instanceof Vector2d) {\r\n                if (durationAsSpeed) duration = Vector2d.getDistance(this.getSize(), size) / duration;\r\n                tween.to({\r\n                    size: {\r\n                        x: size.getVector().x,\r\n                        y: size.getVector().y\r\n                    }\r\n                }, duration);\r\n            } else if (size instanceof BaseNode) {\r\n                if (durationAsSpeed) duration = Vector2d.getDistance(this.getSize(), size.getSize()) / duration;\r\n                tween.to({\r\n                    size: {\r\n                        x: size.getSize().getVector().x,\r\n                        y: size.getSize().getVector().y\r\n                    }\r\n                }, duration);\r\n            }\r\n\r\n            tween.start();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @param {number|BaseNode} angle\r\n     * @param {number} [duration]\r\n     */\r\n    rotateTo(angle, duration) {\r\n        if (duration === undefined || typeof duration !== 'number') duration = 1000.0;\r\n        var tween = new Tween(this);\r\n\r\n        if (typeof angle === 'number') {\r\n            tween.to({angle: angle % 360}, duration);\r\n        } else if (typeof angle === 'object' && angle instanceof BaseNode) {\r\n            tween.to({\r\n                angle: Vector2d.getAngle(angle.getPosition(), this.getPosition())\r\n            }, duration);\r\n        }\r\n\r\n        tween.start();\r\n    }\r\n\r\n    /**\r\n     * @param {number} [velocity]\r\n     */\r\n    turn(velocity) {\r\n        if (velocity === undefined || typeof velocity !== 'number') velocity = 1.0;\r\n        this.angle += velocity;\r\n    }\r\n}\r\n","import Pointer from \"io/devices/Pointer\";\r\n\r\nexport default class Touch extends Pointer {\r\n    static DeviceName = Pointer.prototype.constructor.name; // this fix device name in InputHandler\r\n\r\n    constructor(input) {\r\n        super(input);\r\n    }\r\n\r\n    init(input) {\r\n        if (input !== undefined && this.input === undefined) this.input = input;\r\n        return true;\r\n    };\r\n\r\n    update() {\r\n        return true;\r\n    };\r\n\r\n    clear() {\r\n        return true;\r\n    };\r\n\r\n    enable() {\r\n        throw new Error('Error. IO interface \"' + Touch.IO + '\" exist, but not supported yet.');\r\n        //return true;\r\n    };\r\n\r\n    disable() {\r\n        throw new Error('Error. IO interface \"' + Touch.IO + '\" exist, but not supported yet.');\r\n        //return true;\r\n    };\r\n}\r\n","import Device from \"api/Device\";\r\n\r\nexport default class Pointer extends Device {\r\n    constructor(input) {\r\n        super(input);\r\n        if (this.constructor.name === 'Pointer') {\r\n            throw new Error('Error. Pointer is abstract class.');\r\n        }\r\n    }\r\n\r\n    setPointerImage(image) {\r\n        if (image) {\r\n            switch (image) {\r\n                case 'none':\r\n                case 'default':\r\n                case 'auto':\r\n                case 'crosshair':\r\n                case 'e-resize':\r\n                case 'help':\r\n                case 'move':\r\n                case 'n-resize':\r\n                case 'ne-resize':\r\n                case 'nw-resize':\r\n                case 'pointer':\r\n                case 'progress':\r\n                case 's-resize':\r\n                case 'se-resize':\r\n                case 'sw-resize':\r\n                case 'text':\r\n                case 'w-resize':\r\n                case 'wait':\r\n                case 'inherit':\r\n                    break;\r\n                default:\r\n                    image = 'url(\"' + image + '\"), auto'\r\n            }\r\n        }\r\n        this.input.data.pointer.image = this.input.store.pointer.image = this.input.options.cursor = image;\r\n        window.document.body.style.cursor = this.input.data.pointer.image;\r\n        return this;\r\n    };\r\n\r\n    toggleCursor(toggle) {\r\n        if (this.input.data.image !== 'none' && (toggle === undefined || toggle === false)) {\r\n            this.input.store.pointer.image = window.document.body.style.cursor;\r\n            window.document.body.style.cursor = 'none';\r\n        } else {\r\n            window.document.body.style.cursor = this.input.store.pointer.image;\r\n        }\r\n        return this;\r\n    };\r\n\r\n    isPointerVisible() {\r\n        return this.input.data.pointer.image === 'none';\r\n    };\r\n\r\n    getPointerPosition() {\r\n        if (this.data.pointer === undefined) return [0, 0];\r\n        return [this.data.pointer.x, this.data.pointer.y];\r\n    };\r\n\r\n    getPointerMoveDistance() {\r\n        if (this.data.pointer === undefined) return 0;\r\n        return this.data.pointer.distance;\r\n    };\r\n}\r\n","import Pointer from \"io/devices/Pointer\";\r\n\r\nexport default class Mouse extends Pointer {\r\n    static DeviceName = Pointer.prototype.constructor.name; // this fix device name in InputHandler\r\n\r\n    __fixMouseButtonId = (id) => {\r\n        if (id > 2) {\r\n            return id;\r\n        } else if (id === 0) {\r\n            return 'LEFT';\r\n        } else if (id === 1) {\r\n            return 'MIDDLE';\r\n        } else if (id === 2) {\r\n            return 'RIGHT';\r\n        }\r\n    };\r\n\r\n    keyMouseDownEventHandler = (e) => {\r\n        if (this.input.isEnabled && this.input.preventDefault) e.preventDefault();\r\n\r\n        let keyCode = this.input.KEYS_HELPER.getKeyById('KEY_MOUSE_' + this.__fixMouseButtonId(e.button));\r\n        if (!this.input.data.keys.keysDown.includes(keyCode)) {\r\n            this.input.data.keys.keysDown.push(keyCode);\r\n        }\r\n\r\n        this.input.store.recordMouseDragDistance = true;\r\n        this.input.store.pointer = {\r\n            tracker: {\r\n                x: e.pageX,\r\n                y: e.pageY\r\n            }\r\n        };\r\n\r\n        this.input.store.recordMouseClickTime = true;\r\n        if (this.input.store.keys.pressedTime[keyCode] !== undefined) {\r\n            this.input.store.keys.pressedTime[keyCode].delta = this.input.store.keys.pressedTime[keyCode].startTime - e.timeStamp\r\n        } else {\r\n            this.input.store.keys.pressedTime[keyCode] = {\r\n                startTime: e.timeStamp,\r\n                delta: 0\r\n            };\r\n        }\r\n\r\n        this.input.events.trigger('io.mouseKeyDown', e);\r\n    };\r\n\r\n    keyMouseUpEventHandler = (e) => {\r\n        if (this.input.isEnabled && this.input.preventDefault) e.preventDefault();\r\n\r\n        let keyCode = this.input.KEYS_HELPER.getKeyById('KEY_MOUSE_' + this.__fixMouseButtonId(e.button));\r\n        if (!this.input.data.keys.keysUp.includes(keyCode)) {\r\n            this.input.data.keys.keysUp.push(keyCode);\r\n        }\r\n\r\n        this.input.store.recordMouseDragDistance = false;\r\n        this.input.data.pointer.distance = 0;\r\n        this.input.store.pointer = {\r\n            tracker: {\r\n                x: 0,\r\n                y: 0\r\n            }\r\n        };\r\n\r\n        this.input.store.recordMouseClickTime = false;\r\n        if (this.input.store.keys.pressedTime[keyCode] !== undefined) {\r\n            this.input.store.keys.pressedTime.splice(keyCode, 1)\r\n        }\r\n\r\n        this.input.events.trigger('io.mouseKeyUp', e);\r\n    };\r\n\r\n    keyMouseMoveEventHandler = (e) => {\r\n        if (this.input.isEnabled && this.input.preventDefault) e.preventDefault();\r\n\r\n        this.input.data.pointer = {\r\n            x: e.pageX,\r\n            y: e.pageY,\r\n            distance: (this.input.store.recordMouseDragDistance) ? Math.sqrt(\r\n                Math.pow((e.pageX - this.input.store.pointer.tracker.x), 2)\r\n                + Math.pow((e.pageY - this.input.store.pointer.tracker.y), 2)\r\n            ).toFixed(2) : 0.0,\r\n            image: this.input.data.pointer.image\r\n        };\r\n\r\n        this.input.events.trigger('io.mouseMove', e);\r\n    };\r\n\r\n    scrollMouseEventHandler = (e) => {\r\n        if (this.input.isEnabled && this.input.preventDefault) e.preventDefault();\r\n\r\n        let keyCode = (e.wheelDelta / 120 > 0)\r\n            ? this.input.KEYS_HELPER.getKeyById('SCROLL_MOUSE_UP')\r\n            : this.input.KEYS_HELPER.getKeyById('SCROLL_MOUSE_DOWN');\r\n\r\n        if (!this.input.data.keys.keysUp.includes(keyCode)) {\r\n            this.input.data.keys.keysUp.push(keyCode);\r\n            this.input.data.keys.keysDown.push(keyCode);\r\n        }\r\n\r\n        this.input.events.trigger('io.mouseScroll', e);\r\n    };\r\n\r\n    constructor(input) {\r\n        super(input);\r\n\r\n        this.keyMouseDownEventHandler = this.keyMouseDownEventHandler.bind(this);\r\n        this.keyMouseUpEventHandler = this.keyMouseUpEventHandler.bind(this);\r\n        this.keyMouseMoveEventHandler = this.keyMouseMoveEventHandler.bind(this);\r\n        this.scrollMouseEventHandler = this.scrollMouseEventHandler.bind(this);\r\n    }\r\n\r\n    init(input) {\r\n        super.init(input);\r\n        this.input.data.keys = {\r\n            keysUp: [],\r\n            keysDown: []\r\n        };\r\n        this.input.store.keys = {\r\n            pressedTime: []\r\n        };\r\n        this.input.data.pointer = {\r\n            image: this.input.options.cursor || 'none',\r\n            x: 0,\r\n            y: 0,\r\n            distance: 0\r\n        };\r\n        this.input.store.pointer = {\r\n            tracker: {\r\n                x: 0,\r\n                y: 0\r\n            },\r\n            image: this.input.options.cursor || 'none'\r\n        };\r\n        this.input.store.recordMouseDragDistance = false;\r\n        this.input.store.recordMouseClickTime = false;\r\n        this.setPointerImage(this.input.options.cursor || 'none');\r\n    };\r\n\r\n    update() {\r\n        //TODO:: fix pointer by viewport scene\r\n        return true;\r\n    };\r\n\r\n    clear() {\r\n        if (this.input.data.keys !== undefined) {\r\n            this.input.data.keys = {\r\n                keysUp: [],\r\n                keysDown: []\r\n            };\r\n        }\r\n        if (this.input.data.pointer !== undefined) {\r\n            this.input.data.pointer = {\r\n                image: this.input.options.pointer || 'none',\r\n                x: 0,\r\n                y: 0,\r\n                distance: 0\r\n            };\r\n        }\r\n        return true;\r\n    };\r\n\r\n    enable() {\r\n        window.addEventListener('mousedown', this.keyMouseDownEventHandler, false);\r\n        window.addEventListener('mouseup', this.keyMouseUpEventHandler, false);\r\n        window.addEventListener('mousemove', this.keyMouseMoveEventHandler, false);\r\n        window.addEventListener('wheel', this.scrollMouseEventHandler, false);\r\n        return true;\r\n    };\r\n\r\n    disable() {\r\n        window.removeEventListener('mousedown', this.keyMouseDownEventHandler, false);\r\n        window.removeEventListener('mouseup', this.keyMouseUpEventHandler, false);\r\n        window.removeEventListener('mousemove', this.keyMouseMoveEventHandler, false);\r\n        window.removeEventListener('wheel', this.scrollMouseEventHandler, false);\r\n        return true;\r\n    };\r\n}\r\n","import Device from \"api/Device\";\r\n\r\nexport default class Keyboard extends Device {\r\n    keyDownEventHandler = (e) => {\r\n        if (this.input.isEnabled && this.input.preventDefault) e.preventDefault();\r\n        if (!this.input.data.keys.keysDown.includes(e.keyCode)) {\r\n            this.input.data.keys.keysDown.push(e.keyCode);\r\n        }\r\n\r\n        this.input.store.recordKeyPressTime = true;\r\n        if (this.input.store.keys.pressedTime[e.keyCode] !== undefined) {\r\n            this.input.store.keys.pressedTime[e.keyCode].delta = this.input.store.keys.pressedTime[e.keyCode].startTime - e.timeStamp\r\n        } else {\r\n            this.input.store.keys.pressedTime[e.keyCode] = {\r\n                startTime: e.timeStamp,\r\n                delta: 0\r\n            };\r\n        }\r\n\r\n        this.input.events.trigger('io.keyboardKeyDown', e);\r\n    };\r\n\r\n    keyUpEventHandler = (e) => {\r\n        if (this.input.isEnabled && this.input.preventDefault) e.preventDefault();\r\n        if (!this.input.data.keys.keysUp.includes(e.keyCode)) {\r\n            this.input.data.keys.keysUp.push(e.keyCode);\r\n        }\r\n\r\n        this.input.store.recordKeyPressTime = false;\r\n        if (this.input.store.keys.pressedTime[e.keyCode] !== undefined) {\r\n            this.input.store.keys.pressedTime.splice(e.keyCode, 1)\r\n        }\r\n\r\n        this.input.events.trigger('io.keyboardKeyUp', e);\r\n    };\r\n\r\n    constructor(input) {\r\n        super(input);\r\n\r\n        this.keyDownEventHandler = this.keyDownEventHandler.bind(this);\r\n        this.keyUpEventHandler = this.keyUpEventHandler.bind(this);\r\n    }\r\n\r\n    init(input) {\r\n        super.init(input);\r\n        this.input.data.keys = {\r\n            keysUp: [],\r\n            keysDown: []\r\n        };\r\n        this.input.store.keys = {\r\n            pressedTime: []\r\n        };\r\n        this.input.store.recordKeyPressTime = false;\r\n    };\r\n\r\n    update() {\r\n        return true;\r\n    };\r\n\r\n    clear() {\r\n        if (this.input.data.keys !== undefined) {\r\n            this.input.data.keys = {\r\n                keysUp: [],\r\n                keysDown: []\r\n            };\r\n        }\r\n        return true;\r\n    };\r\n\r\n    enable() {\r\n        window.addEventListener('keydown', this.keyDownEventHandler, false);\r\n        window.addEventListener('keyup', this.keyUpEventHandler, false);\r\n        return true;\r\n    };\r\n\r\n    disable() {\r\n        window.removeEventListener('keydown', this.keyDownEventHandler, false);\r\n        window.removeEventListener('keyup', this.keyUpEventHandler, false);\r\n        return true;\r\n    };\r\n};\r\n","import Device from \"api/Device\";\r\n\r\nexport default class Joystick extends Device {\r\n    constructor(input) {\r\n        super(input);\r\n    }\r\n\r\n    init(input) {\r\n        if (input !== undefined && this.input === undefined) this.input = input;\r\n        return true;\r\n    };\r\n\r\n    update() {\r\n        return true;\r\n    };\r\n\r\n    clear() {\r\n        return true;\r\n    };\r\n\r\n    enable() {\r\n        throw new Error('Error. IO interface \"' + Joystick.IO + '\" exist, but not supported yet.');\r\n        //return true;\r\n    };\r\n\r\n    disable() {\r\n        throw new Error('Error. IO interface \"' + Joystick.IO + '\" exist, but not supported yet.');\r\n        //return true;\r\n    };\r\n}\r\n\r\n","import PrototypeInterface from \"api/PrototypeInterface\";\r\n\r\n/**\r\n * IInputHandler\r\n * @constructor\r\n */\r\nexport default class IInputHandler extends PrototypeInterface {\r\n};\r\n","import PrototypeInterface from \"api/PrototypeInterface\";\r\n\r\n/**\r\n * IHandler\r\n * @constructor\r\n */\r\nexport default class IHandler extends PrototypeInterface {\r\n}\r\n","import PrototypeInterface from \"api/PrototypeInterface\";\r\n\r\n/**\r\n * IEngine\r\n * @constructor\r\n */\r\nexport default class IEngine extends PrototypeInterface {\r\n};\r\n","import ArrayMap from \"utils/ArrayMap\";\r\nimport CameraNode from \"nodes/CameraNode\";\r\nimport Vector2d from \"utils/Vector2d\";\r\n\r\n/**\r\n * @param {{x: number, y: number, offsetX: number, offsetY: number}} screen\r\n * @param {{offset: {x: number, y: number}, size: {x: number, y: number}, scale: number, angle: number}} viewport\r\n * @returns {{offset: {x: number, y: number}, size: {x: number, y: number}, scale: number, angle: number}}\r\n */\r\nvar calculateScale = function (screen, viewport) {\r\n    var data = {\r\n        offset: {x: 0, y: 0},\r\n        size: {x: 0, y: 0},\r\n        scale: 1.0,\r\n        angle: viewport.angle\r\n    };\r\n\r\n    data.offset.x = screen.offsetX + viewport.offset.x;\r\n    data.offset.y = screen.offsetY + viewport.offset.y;\r\n\r\n    data.size.x = (screen.x < viewport.size.x) ? screen.x : viewport.size.x;\r\n    data.size.y = (screen.y < viewport.size.y) ? screen.y : viewport.size.y;\r\n\r\n    data.scale = viewport.scale * (((screen.x / viewport.size.x) + (screen.y / viewport.size.y)) / 2);\r\n    return data;\r\n};\r\n\r\n/**\r\n * @class ViewportManager\r\n * @exports module:core/ViewportManager\r\n *\r\n * @constructor\r\n *\r\n * @property {ArrayMap.<CameraNode>|CameraNode[]} cameras\r\n * @property {string} camera\r\n * @property {{x: number, y: number, offsetX: number, offsetY: number}} screen\r\n * @property {boolean} init\r\n * @property {{offset: {x: number, y: number}, size: {x: number, y: number}, scale: number, angle: number}} data\r\n */\r\nexport default class ViewportManager {\r\n    constructor() {\r\n        /** @type ArrayMap.<CameraNode>|CameraNode[] */\r\n        this.cameras = new ArrayMap();\r\n\r\n        /** @type string */\r\n        this.camera = 'No active cameras';\r\n\r\n        /** @type {{x: number, y: number, offsetX: number, offsetY: number}} */\r\n        this.screen = {\r\n            x: 0,\r\n            y: 0,\r\n            offsetX: 0,\r\n            offsetY: 0\r\n        };\r\n\r\n        this.init = false;\r\n\r\n        this.data = {\r\n            offset: {x: 0.0, y: 0.0},\r\n            size: {x: 0.0, y: 0.0},\r\n            scale: 1.0,\r\n            angle: 0.0\r\n        };\r\n    }\r\n\r\n    /**\r\n     * @param {{x: number|undefined, y: number|undefined}|Array<number>} data\r\n     * @returns {ViewportManager}\r\n     */\r\n    setScreen(data) {\r\n        if (typeof data == 'object') {\r\n            if (data instanceof Array && data.length == 2) {\r\n                this.screen = {\r\n                    x: data[0],\r\n                    y: data[1],\r\n                    offsetX: this.screen.offsetX,\r\n                    offsetY: this.screen.offsetY\r\n                };\r\n                return this;\r\n            }\r\n            if (data.x !== undefined && data.y !== undefined) {\r\n                this.screen = {\r\n                    x: data.x,\r\n                    y: data.y,\r\n                    offsetX: this.screen.offsetX,\r\n                    offsetY: this.screen.offsetY\r\n                };\r\n            }\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {{x: number|undefined, y: number|undefined}|Array<number>} data\r\n     * @returns {ViewportManager}\r\n     */\r\n    setOffset(data) {\r\n        if (typeof data == 'object') {\r\n            if (data instanceof Array && data.length == 2) {\r\n                this.screen = {\r\n                    x: this.screen.x,\r\n                    y: this.screen.y,\r\n                    offsetX: data[0],\r\n                    offsetY: data[1]\r\n                };\r\n                return this;\r\n            }\r\n            if (data.x !== undefined && data.y !== undefined) {\r\n                this.screen = {\r\n                    x: this.screen.x,\r\n                    y: this.screen.y,\r\n                    offsetX: data.x,\r\n                    offsetY: data.y\r\n                };\r\n            }\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {string} key\r\n     * @param {CameraNode} node\r\n     * @returns {ViewportManager}\r\n     */\r\n    addCamera(key, node) {\r\n        if (node instanceof CameraNode) {\r\n            this.cameras.add(key, node);\r\n            return this;\r\n        }\r\n        // throw new InvalidArgumentException('Unknown camera node type');\r\n    }\r\n\r\n    /**\r\n     * @param {string} key\r\n     * @returns {ViewportManager}\r\n     */\r\n    removeCamera(key) {\r\n        this.cameras.remove(key);\r\n        if (this.camera == key) {\r\n            this.camera = 'No active cameras';\r\n            this.data = {\r\n                offset: {x: 0.0, y: 0.0},\r\n                size: {x: 0.0, y: 0.0},\r\n                scale: 1.0,\r\n                angle: 0.0\r\n            }\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {string} key\r\n     * @returns {ViewportManager}\r\n     */\r\n    updateViewport(key) {\r\n        if (this.cameras[key] !== undefined && this.cameras[key] instanceof CameraNode) {\r\n            this.data = this.cameras[key].getCameraViewport(this.screen, calculateScale);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @deprecated Please use CameraNode\r\n     *\r\n     * @param {Vector2d|null} [offset]\r\n     * @param {Vector2d|null} [size]\r\n     * @returns {ViewportManager}\r\n     */\r\n    setViewport(offset, size) {\r\n        if (offset !== undefined && typeof offset == 'object') {\r\n            if (offset instanceof Vector2d) {\r\n                this.data.offset = offset.getVector();\r\n            }\r\n        }\r\n\r\n        if (size !== undefined && typeof size == 'object') {\r\n            if (size instanceof Vector2d) {\r\n                this.data.size = size.getVector();\r\n            }\r\n        }\r\n\r\n        this.data = calculateScale(this.screen, this.data);\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {{offset: {x: number, y: number}, size: {x: number, y: number}, scale: number, angle: number}} viewport\r\n     * @returns {ViewportManager}\r\n     */\r\n    setDefaultViewport(viewport) {\r\n        if (!this.init) {\r\n            this.data = viewport;\r\n            this.init = true;\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @returns {{offset: {x: number, y: number}, size: {x: number, y: number}, scale: number, angle: number}}\r\n     */\r\n    getViewport() {\r\n        return this.data;\r\n    }\r\n}\r\n","import ObjectUtil from \"utils/ObjectUtil\";\r\nimport Vector2d from \"utils/Vector2d\";\r\nimport FrameManager from \"core/FrameManager\";\r\nimport LayersManager from \"core/LayersManager\";\r\nimport ViewportManager from \"core/ViewportManager\";\r\nimport GameStatesManager from \"core/GameStatesManager\";\r\n\r\n/**\r\n * @class SceneManager\r\n * @exports module:core/SceneManager\r\n *\r\n * @param {EngineJ2D} j2d\r\n * @constructor\r\n *\r\n * @property {SceneManager.defaults} data\r\n *\r\n * @property {string} backgroundColor\r\n * @property {number} opacity\r\n * @property {boolean} visible\r\n * @property {number} zIndex\r\n * @property {{x:number, y:number}} viewport\r\n */\r\nexport default class SceneManager {\r\n    static defaults = {\r\n        width: 0,\r\n        height: 0,\r\n\r\n        originalWidth: 0,\r\n        originalHeight: 0,\r\n        originalMargin: 0,\r\n\r\n        visible: true,\r\n        position: 'absolute',\r\n        top: 0,\r\n        left: 0,\r\n        zIndex: 1000,\r\n        opacity: 1.0,\r\n        backgroundColor: false,\r\n\r\n        frameLimit: 60,\r\n\r\n        enableFullScreen: false,\r\n\r\n        viewport: {x: 0, y: 0}\r\n    };\r\n\r\n    constructor(j2d) {\r\n        this.setGameCallback = this.setGameCallback.bind(this);\r\n        this.start = this.start.bind(this);\r\n\r\n        /** @type EngineJ2D */\r\n        this.j2d = j2d;\r\n\r\n        /** @type {HTMLCanvasElement} */\r\n        this.canvas = null;\r\n\r\n        /** @type {CanvasRenderingContext2D} */\r\n        this.context = null;\r\n\r\n        /** @type {FrameManager} */\r\n        this.frameManager = FrameManager.Init();\r\n\r\n        /** @type {LayersManager} */\r\n        this.layersManager = new LayersManager();\r\n\r\n        /** @type {ViewportManager} */\r\n        this.viewportManager = new ViewportManager();\r\n\r\n        /** @type {GameStatesManager} */\r\n        this.gameStatesManager = new GameStatesManager({}, this.setGameCallback);\r\n\r\n        this.initLayers();\r\n    }\r\n\r\n    get backgroundColor() {\r\n        return this.data.backgroundColor;\r\n    }\r\n\r\n    set backgroundColor(value) {\r\n        this.data.backgroundColor = value;\r\n        this.context.fillStyle = value;\r\n        this.context.fillRect(0, 0, this.data.width, this.data.height);\r\n    }\r\n\r\n    get opacity() {\r\n        return this.data.opacity;\r\n    }\r\n\r\n    set opacity(value) {\r\n        this.data.opacity = value;\r\n        this.canvas.style.opacity = value;\r\n    }\r\n\r\n    get visible() {\r\n        return this.data.visible;\r\n    }\r\n\r\n    set visible(value) {\r\n        this.data.visible = !!value;\r\n        this.canvas.style.display = (!!value) ? 'block' : 'none';\r\n    }\r\n\r\n    get zIndex() {\r\n        return 1000 - this.data.zIndex;\r\n    }\r\n\r\n    set zIndex(value) {\r\n        this.data.zIndex = 1000 + value;\r\n        this.canvas.style.zIndex = 1000 + value;\r\n    }\r\n\r\n    get viewport() {\r\n        return this.data.viewport;\r\n    }\r\n\r\n    /**\r\n     * @param {BaseGameState} state\r\n     * @returns {Function}\r\n     */\r\n    patchGameStateRender(state) {\r\n        var sceneManager = this;\r\n        var constructor = state.constructor;\r\n        if (typeof constructor === 'function' && constructor.prototype.render === undefined) {\r\n            constructor.prototype.render = function (timestamp, data) {\r\n                sceneManager.clear().fillBackground().render(data);\r\n                return true;\r\n            };\r\n        }\r\n        return constructor;\r\n    };\r\n\r\n    /**\r\n     * @param {SceneManager.defaults|Object|undefined} options\r\n     * @returns {SceneManager}\r\n     */\r\n    init(options) {\r\n        this.data = ObjectUtil.extend(true, {}, SceneManager.defaults, options);\r\n\r\n        this.j2d.trigger('beforeInit');\r\n\r\n        this.data.originalWidth = this.data.width;\r\n        this.data.originalHeight = this.data.height;\r\n        this.data.originalMargin = getComputedStyle(this.j2d.element)['margin'];\r\n\r\n        this.j2d.element.style.width = this.data.width + 'px';\r\n        this.j2d.element.style.height = this.data.height + 'px';\r\n\r\n        this.initCanvas();\r\n\r\n        this.viewportManager.setScreen({\r\n            x: this.data.width,\r\n            y: this.data.height\r\n        }).setDefaultViewport({\r\n            offset: {\r\n                x: 0.0,\r\n                y: 0.0\r\n            },\r\n            size: {\r\n                x: this.data.width,\r\n                y: this.data.height\r\n            },\r\n            scale: 1.0,\r\n            angle: 0.0\r\n        });\r\n\r\n        this.j2d.trigger('afterInit');\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @returns {SceneManager}\r\n     */\r\n    initLayers() {\r\n        if (!this.layersManager.getLayer('scene')) {\r\n            this.layersManager.addLayer('scene', 0);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @returns {SceneManager}\r\n     */\r\n    initCanvas() {\r\n        if (document.querySelectorAll('.j2d[guid=\"' + this.j2d.data.id + '\"] canvas').length === 0) {\r\n            this.canvas = document.createElement('canvas');\r\n\r\n            this.canvas.width = this.data.width;\r\n            this.canvas.height = this.data.height;\r\n            this.canvas.style.zIndex = this.data.zIndex;\r\n            this.canvas.style.position = this.data.position;\r\n\r\n            this.canvas.style.left = this.data.left;\r\n            this.canvas.style.top = this.data.top;\r\n\r\n            if (this.j2d.data.webGL) {\r\n                //WebGL2D.enable(this.canvas);\r\n                this.context = this.canvas.getContext('WebGL-2d');\r\n            } else {\r\n                this.context = this.canvas.getContext('2d');\r\n            }\r\n\r\n            if (!this.j2d.data.smoothing) {\r\n                this.j2d.util.disableSmoothing(this.context);\r\n            }\r\n\r\n            this.context.shadowColor = 'rgba(0,0,0,0)';\r\n            if (this.data.backgroundColor) this.backgroundColor = this.data.backgroundColor;\r\n            if (this.data.opacity) this.opacity = this.data.opacity;\r\n            if (this.data.visible) this.visible = this.data.visible;\r\n            if (this.data.zIndex) this.zIndex = 1000 - this.data.zIndex;\r\n\r\n            this.j2d.element.appendChild(this.canvas);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {{x:number, y:number}|Vector2d} [pos]\r\n     * @param {{x:number, y:number}|Vector2d} [size]\r\n     * @returns {SceneManager}\r\n     */\r\n    clear(pos, size) {\r\n        if (pos !== undefined && size !== undefined) {\r\n            this.context.clearRect(pos.x - this.viewport.x, pos.y - this.viewport.y, size.x, size.y);\r\n        } else {\r\n            this.context.clearRect(0, 0, this.data.width, this.data.height);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {number} width\r\n     * @param {number} height\r\n     * @returns {SceneManager}\r\n     */\r\n    resize(width, height) {\r\n        this.canvas.width = this.data.width = width;\r\n        this.canvas.height = this.data.height = height;\r\n\r\n        if (this.data.backgroundColor) {\r\n            this.context.save();\r\n\r\n            this.clear();\r\n            this.backgroundColor = this.data.backgroundColor;\r\n\r\n            this.context.restore();\r\n        }\r\n        if (!this.j2d.data.smoothing) {\r\n            this.j2d.util.disableSmoothing(this.context);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * TODO:: refactor this\r\n     * @param {string} gameState\r\n     * @returns {SceneManager}\r\n     */\r\n    setGameCallback(gameState) {\r\n        var sceneManager = this;\r\n        sceneManager.data.gameState = gameState || 'init_j2d';\r\n        sceneManager.frameManager.stop(sceneManager.j2d.data.id);\r\n\r\n        var gameConstructor = sceneManager.patchGameStateRender(\r\n            sceneManager.gameStatesManager.getState(gameState)\r\n        );\r\n\r\n        var newGameState = new gameConstructor(sceneManager.gameStatesManager, {});\r\n        newGameState.init({\r\n            callback: function () {\r\n                newGameState.load({\r\n                    callback: function () {\r\n                        sceneManager.frameManager.start(sceneManager.j2d.data.id, newGameState, {\r\n                            j2d: sceneManager.j2d,\r\n                            frameLimit: sceneManager.data.frameLimit\r\n                        });\r\n\r\n                        sceneManager.j2d.trigger('changedGameState');\r\n\r\n                        // TODO:: async unload?\r\n                        sceneManager.gameStatesManager.getPreviousState().unload();\r\n                    }\r\n                });\r\n            }\r\n        });\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {Function|callback} callback\r\n     * @param {*} data\r\n     * @returns {SceneManager}\r\n     */\r\n    async(callback, data) {\r\n        setTimeout(callback.call(callback, data), 0);\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @returns {SceneManager}\r\n     */\r\n    start() {\r\n        var sceneManager = this;\r\n        if (sceneManager.j2d.data.io) {\r\n            sceneManager.j2d.data.io.init();\r\n        }\r\n        sceneManager.j2d.trigger('beforeStart');\r\n\r\n        sceneManager.frameManager.stop(sceneManager.j2d.data.id);\r\n\r\n        var gameConstructor = sceneManager.patchGameStateRender(\r\n            sceneManager.gameStatesManager.getCurrent()\r\n        );\r\n\r\n        var newGameState = new gameConstructor(sceneManager.gameStatesManager, {});\r\n        newGameState.init({\r\n            callback: function () {\r\n                newGameState.load({\r\n                    callback: function () {\r\n                        sceneManager.frameManager.start(sceneManager.j2d.data.id, newGameState, {\r\n                            j2d: sceneManager.j2d,\r\n                            frameLimit: sceneManager.data.frameLimit\r\n                        });\r\n\r\n                        sceneManager.j2d.trigger('afterStart');\r\n                    }\r\n                });\r\n            }\r\n        });\r\n\r\n        return sceneManager;\r\n    }\r\n\r\n    /**\r\n     * @returns {SceneManager}\r\n     */\r\n    stop() {\r\n        this.frameManager.stop(this.j2d.data.id);\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {boolean} [fullscreen]\r\n     * @returns {SceneManager}\r\n     */\r\n    fullScreen(fullscreen) {\r\n        var element = document.getElementById(this.j2d.element.attr('id'));\r\n\r\n        if (undefined === element.requestFullscreen) {\r\n            //noinspection JSUnresolvedVariable\r\n            element.requestFullscreen = element.webkitRequestFullscreen\r\n                || element.webkitRequestFullScreen\r\n                || element.mozRequestFullScreen\r\n                || element.msRequestFullscreen;\r\n        }\r\n\r\n        if (undefined === document.exitFullscreen) {\r\n            //noinspection JSUnresolvedVariable\r\n            document.exitFullscreen = document.webkitExitFullscreen\r\n                || document.webkitCancelFullScreen\r\n                || document.mozCancelFullScreen\r\n                || document.msExitFullscreen;\r\n        }\r\n        if (fullscreen) {\r\n            element.requestFullscreen();\r\n        } else {\r\n            document.exitFullscreen();\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {boolean} [fullscreen]\r\n     * @returns {SceneManager}\r\n     */\r\n    resizeToFullPage(fullscreen) {\r\n        var j2d = this.j2d;\r\n        var sceneManager = this;\r\n\r\n        if (fullscreen) {\r\n            sceneManager.data.originalWidth = sceneManager.data.width;\r\n            sceneManager.data.originalHeight = sceneManager.data.height;\r\n\r\n            sceneManager.resize(j2d.device.width, j2d.device.height);\r\n            sceneManager.data.enableFullscreen = true;\r\n\r\n            j2d.element.style.width = j2d.device.width + 'px';\r\n            j2d.element.style.height = j2d.device.height + 'px';\r\n            j2d.element.style.margin = 0;\r\n\r\n            sceneManager.viewportManager.setScreen({\r\n                x: j2d.device.width,\r\n                y: j2d.device.height\r\n            }).setOffset({\r\n                x: -(j2d.device.width - sceneManager.data.originalWidth) / 2,\r\n                y: -(j2d.device.height - sceneManager.data.originalHeight) / 2\r\n            });\r\n        } else {\r\n            sceneManager.resize(sceneManager.data.originalWidth, sceneManager.data.originalHeight);\r\n            sceneManager.data.enableFullscreen = false;\r\n\r\n            j2d.element.style.width = sceneManager.data.originalWidth + 'px';\r\n            j2d.element.style.height = sceneManager.data.originalHeight + 'px';\r\n            j2d.element.style.margin = sceneManager.data.originalMargin;\r\n\r\n            sceneManager.viewportManager.setScreen({\r\n                x: sceneManager.data.originalWidth,\r\n                y: sceneManager.data.originalHeight\r\n            }).setOffset({\r\n                x: 0,\r\n                y: 0\r\n            });\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {EngineJ2D} j2d\r\n     * @param {{fullscreen: boolean}} data\r\n     * @returns {SceneManager}\r\n     */\r\n    toggleFullScreen(j2d, data) {\r\n        if (data === undefined) {\r\n            data = {fullscreen: false};\r\n        }\r\n        if (!j2d.scene.enableFullscreen || data.fullscreen) {\r\n            j2d.scene.fullScreen(true);\r\n        } else {\r\n            j2d.scene.fullScreen(false);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @returns {CollectionNode|null}\r\n     */\r\n    getSceneLayer() {\r\n        return this.layersManager.getLayer('scene');\r\n    }\r\n\r\n    /**\r\n     * @returns {SceneManager}\r\n     */\r\n    fillBackground() {\r\n        if (this.data.backgroundColor) {\r\n            this.backgroundColor = this.data.backgroundColor;\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {Object} data\r\n     * @returns {SceneManager}\r\n     */\r\n    render(data) {\r\n        var sceneManager = this;\r\n        sceneManager.layersManager.layers.forEach(function (value, index) {\r\n            sceneManager.layersManager.layers[index].render(\r\n                sceneManager.context,\r\n                sceneManager.viewportManager.getViewport(),\r\n                sceneManager.layersManager.globalCollection,\r\n                data || {}\r\n            );\r\n        });\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {BaseNode} node\r\n     * @param {string} [key]\r\n     * @returns {SceneManager}\r\n     */\r\n    add(node, key) {\r\n        if (this.layersManager.globalCollection.has('scene')) {\r\n            this.layersManager.globalCollection.get('scene').add(node, key);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {BaseNode} [node]\r\n     * @param {string} [key]\r\n     * @returns {SceneManager}\r\n     */\r\n    remove(node, key) {\r\n        if (this.layersManager.globalCollection.has('scene')) {\r\n            this.layersManager.globalCollection.get('scene').remove(node, key);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {CameraNode} node\r\n     * @returns {SceneManager}\r\n     */\r\n    registerCamera(node) {\r\n        this.viewportManager.addCamera(node.data.id, node);\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Hack to mode without Cameras\r\n     * @returns {SceneManager}\r\n     */\r\n    _updateNoCamerasViewport(scene) {\r\n        // This hack use deprecated method, i known.\r\n        scene.viewportManager.setViewport(\r\n            new Vector2d(0, 0),\r\n            new Vector2d(scene.data.width, scene.data.height)\r\n        );\r\n\r\n        return scene;\r\n    }\r\n\r\n    /**\r\n     * @param {CameraNode} [node]\r\n     * @returns {SceneManager}\r\n     */\r\n    updateViewport(node) {\r\n        if (node === undefined) return this._updateNoCamerasViewport(this);\r\n        this.viewportManager.updateViewport(node.data.id);\r\n        return this;\r\n    }\r\n\r\n\r\n    // static util = {\r\n    //     /**\r\n    //      * @param {CanvasRenderingContext2D} context\r\n    //      */\r\n    //     disableSmoothing: (context) => {\r\n    //         let chrome = window.navigator.userAgent.match(/Chrom(e|ium)\\/([0-9]+)\\./);\r\n    //         let version = chrome ? parseInt(chrome[2], 10) : false;\r\n    //\r\n    //         context['imageSmoothingEnabled'] = false;\r\n    //         context['mozImageSmoothingEnabled'] = false;\r\n    //         context['oImageSmoothingEnabled'] = false;\r\n    //         if (version && version <= 29) {\r\n    //             context['webkitImageSmoothingEnabled'] = false;\r\n    //         }\r\n    //         context['msImageSmoothingEnabled'] = false;\r\n    //     }\r\n    // };\r\n\r\n    // /** Utils **/\r\n    //util = EngineJ2D.util;\r\n}\r\n","import CollectionNode from \"nodes/CollectionNode\";\r\nimport UUID from \"utils/UUID\";\r\n\r\n/**\r\n * @class LayersManager\r\n * @exports module:core/LayersManager\r\n *\r\n * @constructor\r\n */\r\nexport default class LayersManager {\r\n    constructor() {\r\n        /** @type CollectionNode */\r\n        this.globalCollection = new CollectionNode({id: 'GlobalLayer'});\r\n\r\n        /** @type Array.<CollectionNode>|CollectionNode[] */\r\n        this.layers = [];\r\n\r\n        /** @type number */\r\n        this.index = 1000;\r\n    }\r\n\r\n    /**\r\n     * @param {string} name\r\n     * @param {number} [zIndex]\r\n     * @param {CollectionNode|undefined} [node]\r\n     * @returns {LayersManager}\r\n     */\r\n    addLayer(name, zIndex, node) {\r\n        name = name || UUID.generate();\r\n\r\n        if (node === undefined || node instanceof CollectionNode) {\r\n            if (zIndex === undefined) {\r\n                zIndex = this.index;\r\n                this.index++;\r\n            } else {\r\n                zIndex += 1000;\r\n            }\r\n\r\n            node = node || new CollectionNode({id: name, zIndex: zIndex});\r\n\r\n            this.globalCollection.add(node, name);\r\n            this.layers[zIndex] = node;\r\n\r\n            return this;\r\n        }\r\n        // throw new InvalidArgumentException('Unknown node type to add as layers');\r\n    }\r\n\r\n    /**\r\n     * @param {string} name\r\n     * @returns {LayersManager}\r\n     */\r\n    removeLayer(name) {\r\n        delete this.layers[this.globalCollection.get(name).zIndex];\r\n        this.globalCollection.remove(null, name);\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {string} name\r\n     * @returns {CollectionNode|null}\r\n     */\r\n    getLayer(name) {\r\n        if (this.globalCollection.has(name)) {\r\n            return this.globalCollection.get(name);\r\n        }\r\n        return null;\r\n    }\r\n\r\n    /**\r\n     * @param {string} name\r\n     * @param {number} zIndex\r\n     * @returns {LayersManager}\r\n     */\r\n    setZIndex(name, zIndex) {\r\n        if (this.globalCollection.has(name)) {\r\n            delete this.layers[this.globalCollection.get(name).zIndex];\r\n            this.globalCollection.get(name).zIndex = zIndex;\r\n            this.layers[zIndex] = this.globalCollection.get(name);\r\n        }\r\n        return this;\r\n    }\r\n}\r\n","import ArrayMap from \"utils/ArrayMap\";\r\nimport ObjectUtil from \"utils/ObjectUtil\";\r\nimport DefaultGameState from \"states/DefaultGameState\";\r\nimport BaseGameState from \"states/BaseGameState\";\r\n\r\n/**\r\n * Game states Manager\r\n *\r\n * @class GameStatesManager\r\n * @abstract\r\n * @constructor\r\n *\r\n * @param {GameStatesManager.defaults|Object} data\r\n * @param {function} sceneCallback\r\n * @property {GameStatesManager.defaults|Object} data\r\n * @property {number} state\r\n */\r\nexport default class GameStatesManager {\r\n    /**\r\n     * @type {{previousState: null, currentState: number, states: ArrayMap}}\r\n     */\r\n    static defaults = {\r\n        previousState: null,\r\n        currentState: 0,\r\n        states: new ArrayMap()\r\n    };\r\n\r\n    constructor(data, sceneCallback) {\r\n        this.data = ObjectUtil.extend(true, {}, GameStatesManager.defaults, data);\r\n        this.add(new DefaultGameState());\r\n        this.sceneCallback = sceneCallback;\r\n    }\r\n\r\n    get state() {\r\n        return this.data.currentState;\r\n    }\r\n\r\n    set state(value) {\r\n        this.data.currentState = value;\r\n    }\r\n\r\n    /**\r\n     * @param {string} [id]\r\n     * @returns {BaseGameState|null}\r\n     */\r\n    getState(id) {\r\n        if (id === undefined) return this.getCurrent();\r\n        if (this.data.states.contains(id)) {\r\n            return this.data.states[id];\r\n        }\r\n        return null\r\n    }\r\n\r\n    getPreviousState() {\r\n        return this.data.states.get(this.data.states[this.data.previousState]);\r\n    }\r\n\r\n    getNextState() {\r\n        if (this.data.states[this.state + 1] !== undefined) {\r\n            return this.data.states.get(this.data.states[this.state + 1]);\r\n        }\r\n        return null;\r\n    }\r\n\r\n    getCurrent() {\r\n        return this.data.states.get(this.data.states[this.data.currentState]);\r\n    }\r\n\r\n    /**\r\n     * @param {string} id\r\n     */\r\n    setState(id) {\r\n        if (this.data.states.contains(id)) {\r\n            this.data.previousState = this.data.currentState;\r\n            this.data.currentState = this.data.states.indexOf(id);\r\n            this.sceneCallback(id);\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    setNextState() {\r\n        if (this.data.states[this.state + 1] !== undefined) {\r\n            this.data.previousState = this.data.currentState;\r\n            this.data.currentState = this.state + 1;\r\n            this.sceneCallback(this.data.states[this.state]);\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    setPreviousState() {\r\n        if (this.data.states[this.data.previousState] !== undefined) {\r\n            var state = this.data.previousState;\r\n            this.data.previousState = this.data.currentState;\r\n            this.data.currentState = state;\r\n            this.sceneCallback(this.data.states[state]);\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {BaseGameState} state\r\n     * @param {string} [id]\r\n     */\r\n    add(state, id) {\r\n        if (id === undefined) id = state.data.id;\r\n        if (!this.data.states.contains(id) && state instanceof BaseGameState) {\r\n            this.data.states.add(id, state);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {string} id\r\n     */\r\n    remove(id) {\r\n        if (this.data.states.contains(id)) {\r\n            this.data.states.remove(id);\r\n        }\r\n        return this;\r\n    }\r\n}\r\n","/**\r\n * @class Events\r\n * @exports module:utils/Events\r\n *\r\n * @constructor\r\n */\r\nexport default class Events {\r\n    events = [];\r\n    onces = [];\r\n\r\n    constructor() {\r\n        this.flush();\r\n    }\r\n\r\n    /**\r\n     * @param {string} [eventName]\r\n     */\r\n    flush(eventName) {\r\n        if (eventName !== undefined) {\r\n            if (this.events[eventName] !== undefined) {\r\n                this.events[eventName] = [];\r\n            }\r\n            if (this.onces[eventName] !== undefined) {\r\n                this.onces[eventName] = [];\r\n            }\r\n        } else {\r\n            this.onces = [];\r\n            this.events = [];\r\n        }\r\n    }\r\n\r\n\r\n    /**\r\n     * @param {string} eventName\r\n     * @param {function} callback\r\n     */\r\n    on(eventName, callback) {\r\n        if (this.events[eventName] !== undefined) {\r\n            var stack = this.events[eventName];\r\n            if (stack.indexOf(callback) === -1) {\r\n                stack.push(callback);\r\n            }\r\n        } else {\r\n            this.events[eventName] = [];\r\n            this.events[eventName].push(callback)\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @param {string} eventName\r\n     * @param {function} callback\r\n     */\r\n    once(eventName, callback) {\r\n        if (this.onces[eventName] !== undefined) {\r\n            var stack = this.onces[eventName];\r\n            if (stack.indexOf(callback) === -1) {\r\n                stack.push(callback);\r\n            }\r\n        } else {\r\n            this.onces[eventName] = [];\r\n            this.onces[eventName].push(callback)\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @param {string} eventName\r\n     * @param {function} callback\r\n     */\r\n    off(eventName, callback) {\r\n        if (this.onces[eventName] !== undefined) {\r\n            var stack = this.events[eventName];\r\n            if (stack.indexOf(callback) !== -1) {\r\n                stack.splice(stack.indexOf(callback));\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @param {string} eventName\r\n     * @param {Object} [data]\r\n     */\r\n    trigger(eventName, data) {\r\n        var stack, i;\r\n\r\n        if (this.events[eventName] !== undefined) {\r\n            stack = this.events[eventName];\r\n            for (i = 0; i < stack.length; i++) {\r\n                stack[i].call(stack[i], data);\r\n            }\r\n        }\r\n\r\n        if (this.onces[eventName] !== undefined) {\r\n            stack = this.onces[eventName];\r\n            for (i = 0; i < stack.length; i++) {\r\n                stack[i].call(stack[i], data);\r\n            }\r\n            this.flush(eventName);\r\n        }\r\n    };\r\n}\r\n","/**\r\n * @class ArrayMap\r\n * @exports module:utils/ArrayMap\r\n *\r\n * @constructor\r\n * @extends Array\r\n * @param args\r\n */\r\nexport default class ArrayMap extends Array {\r\n    last = () => {\r\n        return this[this.length - 1];\r\n    };\r\n\r\n    constructor(args) {\r\n        super(args);\r\n    }\r\n\r\n    /**\r\n     * @param {ArrayMap.<T>} array\r\n     * @returns {boolean}\r\n     */\r\n    equals(array) {\r\n        if (!array)\r\n            return false;\r\n\r\n        if (this.length != array.length)\r\n            return false;\r\n\r\n        for (var i = 0, l = this.length; i < l; i++) {\r\n            if (this[i] instanceof Array && array[i] instanceof Array) {\r\n                if (!this[i].equals(array[i]))\r\n                    return false;\r\n            }\r\n            else if (this[i] != array[i]) {\r\n                return false;\r\n            }\r\n        }\r\n        return true;\r\n    }\r\n\r\n    /**\r\n     * @param {string|Object} object\r\n     * @returns {boolean}\r\n     */\r\n    contains(object) {\r\n        var i = this.length;\r\n        while (i--) {\r\n            if (this[i] === object) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * @param {Function} callback\r\n     * @returns {boolean}\r\n     */\r\n    each(callback) {\r\n        if (!callback) return false;\r\n        var result = false;\r\n        for (var i = 0; i < this.length; i++) {\r\n            if ((result = callback(this[i], i)) == false) {\r\n                return result;\r\n            }\r\n        }\r\n        return result;\r\n    }\r\n\r\n    /**\r\n     * @param {string|Object} key\r\n     * @param {*} value\r\n     * @returns {ArrayMap.<T>}\r\n     */\r\n    add(key, value) {\r\n        if (this.contains(key))\r\n            this[key] = value;\r\n        else {\r\n            this.push(key);\r\n            this[key] = value;\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {string|Object} key\r\n     * @returns {*}\r\n     */\r\n    get(key) {\r\n        return this.contains(key) ? this[key] : null;\r\n    }\r\n\r\n    /**\r\n     * @param {string|Object} key\r\n     * @returns {ArrayMap.<T>}\r\n     */\r\n    remove(key) {\r\n        for (var i = 0; i < this.length; ++i) {\r\n            if (this[i] == key) {\r\n                this.splice(i, 1);\r\n                delete this[key];\r\n                return this;\r\n            }\r\n        }\r\n        return this;\r\n    }\r\n}\r\n","import ObjectUtil from \"utils/ObjectUtil\";\r\nimport Events from \"utils/Events\";\r\nimport Easing from \"transitions/utils/Easing\";\r\nvar tweens = [];\r\n\r\n/**\r\n * @class Tween\r\n * @exports module:transitions/Tween\r\n *\r\n * @constructor\r\n * @param {BaseNode|{data: object}} tweenNode\r\n * @param {Tween.defaults|Object} [data]\r\n * @property {Tween.defaults} data\r\n */\r\nexport default class Tween {\r\n    static defaults = {\r\n        currentStateAnimation: 0,\r\n        tweenStateStack: [],\r\n        tweenStateTimings: [],\r\n        chainedTweensStack: [],\r\n\r\n        isAnimated: false,\r\n        isStarted: false,\r\n        startTime: null,\r\n\r\n        delayTime: 0,\r\n\r\n        defaultDuration: 1000\r\n    };\r\n\r\n    static stateDefaults = {\r\n        data: null,\r\n        duration: 1000,\r\n        delay: 0,\r\n        easing: 'linear',\r\n        interpolation: 'linear'\r\n    };\r\n\r\n    static Easing = Easing;\r\n\r\n    constructor(tweenNode, data) {\r\n        this.data = ObjectUtil.extend(true, {}, Tween.defaults, data);\r\n        this.node = tweenNode;\r\n        this.events = new Events();\r\n\r\n        this.state = {};\r\n\r\n        // TODO:: Exceptions\r\n        // if (!(node instanceof BaseNode) || typeof node.data !== 'object') {\r\n        //     throw new InvalidArgumentException('Unknown tween node');\r\n        // }\r\n    }\r\n\r\n    /* Methods */\r\n    /**\r\n     * @param {Tween.defaults|Object} data\r\n     * @returns {{data: null, duration: number, delay: number, easing: string, interpolation: string}}\r\n     */\r\n    _tweenStateData(data) {\r\n        return (data !== undefined && typeof data === 'object')\r\n            ? ObjectUtil.extend(true, {}, Tween.stateDefaults, data)\r\n            : Tween.stateDefaults;\r\n    }\r\n\r\n    /**\r\n     * @param {Object} properties\r\n     * @param {Tween.defaults|Object} [data]\r\n     * @returns {Tween}\r\n     */\r\n    to(properties, data) {\r\n        var tween = this;\r\n\r\n        if (!tween.data.isStarted) {\r\n\r\n            if (typeof data === 'number') data = {data: data};\r\n            var stateData = (typeof data !== 'number') ? this._tweenStateData(data) : data;\r\n            if (data !== undefined && typeof data === 'number') stateData.duration = data;\r\n\r\n            tween.data.tweenStateStack.push([properties, stateData]);\r\n\r\n            return tween;\r\n        }\r\n\r\n        // TODO:: Exceptions\r\n        // throw new RuntimeException('You can not add a state after the start of the tween.');\r\n    }\r\n\r\n    /**\r\n     * @param {number} time\r\n     * @returns {boolean}\r\n     */\r\n    update(time) {\r\n        var tween = this;\r\n\r\n        var nextState = tween.data.tweenStateStack[tween.data.currentStateAnimation + 1];\r\n\r\n        if (time < tween.data.startTime || nextState === undefined) return true;\r\n\r\n        if (!tween.data.isStarted) {\r\n            tween.events.trigger('start', [tween.node]);\r\n            tween.data.isStarted = true;\r\n        }\r\n\r\n        var currentState = tween.data.tweenStateStack[tween.data.currentStateAnimation];\r\n\r\n        var previousStatesTime = tween.getStateTimeDuration(tween.data.currentStateAnimation, true);\r\n\r\n        var elapsed = (time - (tween.data.startTime + previousStatesTime)) / nextState[1].duration;\r\n        elapsed = elapsed > 1 ? 1 : elapsed;\r\n\r\n        tween.node.import(\r\n            Tween.util.animateTween(currentState[0], nextState[0], Easing.get(nextState[1].easing)(elapsed))\r\n        );\r\n\r\n        tween.events.trigger('update', [tween.node]);\r\n\r\n        if (elapsed === 1) {\r\n            if (tween.data.currentStateAnimation < tween.data.tweenStateStack.length) {\r\n                tween.data.currentStateAnimation++;\r\n            } else {\r\n                tween.events.trigger('complete', [tween.node]);\r\n\r\n                for (var i = 0; i < tween.data.chainedTweensStack.length; i++) {\r\n                    tween.data.chainedTweensStack[i].start(\r\n                        tween.data.startTime + tween.getStateTimeDuration(tween.data.currentStateAnimation - 1, true)\r\n                    );\r\n                }\r\n                return false;\r\n            }\r\n        }\r\n        return true;\r\n    }\r\n\r\n\r\n    _calculateStackStateTimings(tweenStateStack) {\r\n        var result = [];\r\n\r\n        tweenStateStack.forEach(function (value) {\r\n            result.push(value[1].duration);\r\n        });\r\n\r\n        return result;\r\n    }\r\n\r\n    /**\r\n     * @param {number} [position]\r\n     * @param {boolean} [withPrevious]\r\n     *\r\n     * @returns {number}\r\n     */\r\n    getStateTimeDuration(position, withPrevious) {\r\n        if (position === undefined || position === null) position = this.data.currentStateAnimation;\r\n        if (withPrevious === undefined) withPrevious = false;\r\n\r\n        if (this.data.tweenStateTimings[position] === undefined) return 0;\r\n\r\n        if (withPrevious) {\r\n            var result = 0;\r\n            for (var i = 1; i <= position; i++) {\r\n                result += this.data.tweenStateTimings[i];\r\n            }\r\n            return result;\r\n        } else {\r\n            return this.data.tweenStateTimings[position];\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @param {Array.<Object, Tween.stateDefaults>} startState\r\n     * @param {Array.<Array<Object, Tween.stateDefaults>>} tweenStateStack\r\n     */\r\n    _calculateStackState(startState, tweenStateStack) {\r\n        var result = [startState];\r\n        var index = 1;\r\n\r\n        var parsedTweenStateStack = [startState];\r\n        var nextStateDelay = 0;\r\n        var nextAllStateDelay = 0;\r\n\r\n        tweenStateStack.forEach(function (value) {\r\n            if (typeof value[0] === 'object' && !(value[0] instanceof Array)) {\r\n                if (nextStateDelay !== 0) {\r\n                    value[1].delay = nextStateDelay;\r\n                    nextStateDelay = 0;\r\n                } else if (nextAllStateDelay !== 0) {\r\n                    value[1].delay = nextAllStateDelay;\r\n                }\r\n                parsedTweenStateStack.push([value[0], value[1]]);\r\n                index++;\r\n            } else if (typeof value[0] === 'string') {\r\n                var i = 0;\r\n                switch (value[0]) {\r\n                    case 'delay':\r\n                        nextStateDelay = value[1].data;\r\n                        break;\r\n                    case 'delayAll':\r\n                        nextAllStateDelay = value[1].data;\r\n                        break;\r\n                    case 'repeat':\r\n                        for (i = 0; i < value[1].data; i++) {\r\n                            parsedTweenStateStack.push(parsedTweenStateStack[index]);\r\n                            index++;\r\n                        }\r\n                        break;\r\n                    case 'repeatAll':\r\n                        for (i = 0; i < value[1].data; i++) {\r\n                            parsedTweenStateStack.concat(parsedTweenStateStack);\r\n                            index++;\r\n                        }\r\n                        break;\r\n                    case 'yoyo':\r\n                    case 'reverse':\r\n                        for (i = 0; i < value[1].data; i++) {\r\n                            if (parsedTweenStateStack[index - 1] !== undefined) {\r\n                                parsedTweenStateStack.push([\r\n                                    Tween.util.reverseProperties(parsedTweenStateStack[index - 1][0]),\r\n                                    parsedTweenStateStack[index - 1][1]\r\n                                ]);\r\n                                index++;\r\n                            }\r\n                        }\r\n                        break;\r\n                    case 'yoyoAll':\r\n                    case 'reverseAll':\r\n                        for (i = 0; i < value[1].data; i++) {\r\n                            var stateStack = parsedTweenStateStack.slice(0);\r\n\r\n                            var stackLength = stateStack.length;\r\n                            for (var j = 0; j < stackLength; j++) {\r\n                                var sIndex = stackLength - j - 1;\r\n                                if (stateStack[sIndex] !== undefined) {\r\n                                    parsedTweenStateStack.push([\r\n                                        Tween.util.reverseProperties(stateStack[sIndex][0]),\r\n                                        stateStack[sIndex][1]\r\n                                    ]);\r\n                                    index++;\r\n                                }\r\n                            }\r\n                        }\r\n                        break;\r\n                }\r\n            }\r\n        });\r\n\r\n        // parsedTweenStateStack.forEach(function (value) {\r\n        //     console.info(value[0].position.x);\r\n        // });\r\n\r\n        index = 0;\r\n        parsedTweenStateStack.shift();\r\n        parsedTweenStateStack.forEach(function (value) {\r\n            if (typeof value[0] === 'object' && !(value[0] instanceof Array)) {\r\n                result.push([Tween.util.calculateProperties(result[index][0], ObjectUtil.extend(true, {}, result[index][0], value[0])), value[1]]);\r\n                index++;\r\n            }\r\n        });\r\n\r\n        return result;\r\n    }\r\n\r\n    /**\r\n     * @param {number} [time]\r\n     * @returns {Tween}\r\n     */\r\n    start(time) {\r\n        var tween = this;\r\n        if (time === undefined) time = global.performance.now();\r\n        tween.data.isAnimated = true;\r\n\r\n        if (!tween.data.isStarted) {\r\n            tween.data.isStarted = true;\r\n            tween.state = [Tween.util.cleanProperties(tween.node.data), Tween.stateDefaults];\r\n            tween.data.tweenStateStack = this._calculateStackState(tween.state, tween.data.tweenStateStack);\r\n            tween.data.tweenStateTimings = this._calculateStackStateTimings(tween.data.tweenStateStack);\r\n        }\r\n\r\n        tween.data.startTime = time + tween.data.delayTime;\r\n\r\n        return Tween.add(tween);\r\n    }\r\n\r\n    /**\r\n     * @returns {Tween}\r\n     */\r\n    stop() {\r\n        var tween = this;\r\n        if (!tween.data.isAnimated) return this;\r\n\r\n        tween.data.isAnimated = false;\r\n        tween.events.trigger('stop', [tween.node]);\r\n        tween.stopChainedTweens();\r\n\r\n        return Tween.remove(tween);\r\n    }\r\n\r\n    /**\r\n     * @returns {Tween}\r\n     */\r\n    stopChainedTweens() {\r\n        var tween = this;\r\n        for (var i = 0; i < tween.data.chainedTweensStack.length; i++) {\r\n            tween.data.chainedTweensStack[i].stop();\r\n        }\r\n\r\n        return tween;\r\n    }\r\n\r\n\r\n    /* Extended animation methods */\r\n    /**\r\n     * @param {number} delay\r\n     * @returns {Tween}\r\n     */\r\n    delay(delay) {\r\n        if (delay === undefined) delay = 1000;\r\n        this.to('delay', delay);\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {number} delay\r\n     * @returns {Tween}\r\n     */\r\n    delayAll(delay) {\r\n        if (delay === undefined) delay = 1000;\r\n        this.to('delayAll', delay);\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {number} [count]\r\n     * @returns {Tween}\r\n     */\r\n    repeat(count) {\r\n        if (count === undefined) count = 1;\r\n        this.to('repeat', count);\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {number} [count]\r\n     * @returns {Tween}\r\n     */\r\n    repeatAll(count) {\r\n        if (count === undefined) count = 1;\r\n        this.to('repeatAll', count);\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {number} [count]\r\n     * @returns {Tween}\r\n     */\r\n    yoyo(count) {\r\n        if (count === undefined) count = 1;\r\n        this.to('yoyo', count);\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {number} [count]\r\n     * @returns {Tween}\r\n     */\r\n    reverse(count) {\r\n        if (count === undefined) count = 1;\r\n        this.to('reverse', count);\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {number} [count]\r\n     * @returns {Tween}\r\n     */\r\n    yoyoAll(count) {\r\n        if (count === undefined) count = 1;\r\n        this.to('yoyoAll', count);\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {number} [count]\r\n     * @returns {Tween}\r\n     */\r\n    reverseAll(count) {\r\n        if (count === undefined) count = 1;\r\n        this.to('reverseAll', count);\r\n        return this;\r\n    }\r\n\r\n\r\n    /* Events wrappers */\r\n    /**\r\n     * @param {string} event\r\n     * @param {function} callback\r\n     * @returns {boolean}\r\n     */\r\n    on(event, callback) {\r\n        return this.events.on(event, callback);\r\n    }\r\n\r\n    /**\r\n     * @param {string} event\r\n     * @param {function} callback\r\n     * @returns {boolean}\r\n     */\r\n    off(event, callback) {\r\n        return this.events.off(event, callback);\r\n    }\r\n\r\n    /**\r\n     * @param {string} event\r\n     * @param {function} callback\r\n     * @returns {boolean}\r\n     */\r\n    once(event, callback) {\r\n        return this.events.once(event, callback);\r\n    }\r\n\r\n    /**\r\n     * @param {string} event\r\n     * @returns {boolean}\r\n     */\r\n    flush(event) {\r\n        return this.events.flush(event);\r\n    }\r\n\r\n    /**\r\n     * @param {string} event\r\n     * @param {Array.<*>} data\r\n     * @returns {boolean}\r\n     */\r\n    trigger(event, data) {\r\n        return this.events.trigger(event, data);\r\n    }\r\n\r\n    /* Static Methods */\r\n    /**\r\n     * @param {number} index\r\n     * @returns {Array.<Tween>|Tween}\r\n     */\r\n    static get(index) {\r\n        return (index === undefined) ? tweens : tweens[index];\r\n    }\r\n\r\n    /**\r\n     * @param {Tween} tween\r\n     * @returns {Tween}\r\n     */\r\n    static add(tween) {\r\n        tweens.push(tween);\r\n        return tween;\r\n    }\r\n\r\n    /**\r\n     * @param {Tween} tween\r\n     * @returns {Tween}\r\n     */\r\n    static remove(tween) {\r\n        var i = tweens.indexOf(tween);\r\n        if (i !== -1) tweens.splice(i, 1);\r\n        return tween;\r\n    }\r\n\r\n    /**\r\n     * @returns {void}\r\n     */\r\n    static flush() {\r\n        tweens = [];\r\n    }\r\n\r\n    /**\r\n     * @param {number} time\r\n     * @returns {boolean}\r\n     */\r\n    static update(time) {\r\n        if (tweens.length === 0) return false;\r\n\r\n        var i = 0;\r\n\r\n        while (i < tweens.length) {\r\n            if (tweens[i].update(time)) {\r\n                i++;\r\n            } else {\r\n                tweens.splice(i, 1);\r\n            }\r\n        }\r\n        return true;\r\n    }\r\n\r\n    static util = {\r\n        animateTween: function (currentState, nextState, value) {\r\n            var result = {};\r\n            var property;\r\n            var temp;\r\n\r\n            for (property in nextState) {\r\n                if (nextState.hasOwnProperty(property) && currentState.hasOwnProperty(property)) {\r\n                    temp = null;\r\n\r\n                    if (typeof nextState[property] === 'number') {\r\n                        if (currentState[property] === nextState[property]) {\r\n                            temp = currentState[property];\r\n                        } else {\r\n                            temp = currentState[property] + (nextState[property] - currentState[property]) * value;\r\n                        }\r\n                    } else if (typeof nextState[property] === 'object') {\r\n                        temp = this.animateTween(currentState[property], nextState[property], value);\r\n                    }\r\n                    if (temp !== null) result[property] = temp;\r\n                }\r\n            }\r\n\r\n            return Object.keys(result).length > 0 ? result : null;\r\n        },\r\n\r\n        cleanProperties: function (properties) {\r\n            var result = {};\r\n            var property;\r\n            var temp;\r\n\r\n            for (property in properties) {\r\n                if (properties.hasOwnProperty(property) && property !== 'id') {\r\n                    temp = null;\r\n                    if ((typeof properties[property] === 'string' && !isNaN(properties[property]))\r\n                        || typeof properties[property] === 'number'\r\n                    ) {\r\n                        temp = properties[property];\r\n                    } else if (typeof properties[property] === 'object') {\r\n                        temp = this.cleanProperties(properties[property]);\r\n                    }\r\n                    if (temp !== null) result[property] = temp;\r\n                }\r\n            }\r\n\r\n            return Object.keys(result).length > 0 ? result : null;\r\n        },\r\n\r\n        reverseProperties: function (properties) {\r\n            var result = {};\r\n            var property;\r\n            var temp;\r\n\r\n            for (property in properties) {\r\n                if (properties.hasOwnProperty(property) && property !== 'id') {\r\n                    temp = null;\r\n                    if (typeof properties[property] === 'string' && !isNaN(properties[property])) {\r\n                        temp = Number(parseFloat(properties[property]) * -1).toString();\r\n                    } else if (typeof properties[property] === 'number') {\r\n                        temp = properties[property];\r\n                    } else if (typeof properties[property] === 'object') {\r\n                        temp = this.reverseProperties(properties[property]);\r\n                    }\r\n                    if (temp !== null) result[property] = temp;\r\n                }\r\n            }\r\n\r\n            return Object.keys(result).length > 0 ? result : null;\r\n        },\r\n\r\n        calculateProperties: function (startProperties, endProperties) {\r\n            var result = {};\r\n            var property;\r\n            var temp;\r\n\r\n            for (property in endProperties) {\r\n                if (endProperties.hasOwnProperty(property) && startProperties.hasOwnProperty(property) && property !== 'id') {\r\n                    temp = null;\r\n\r\n                    if (typeof endProperties[property] === 'string' && !isNaN(endProperties[property]) && typeof startProperties[property] === 'number') {\r\n                        temp = startProperties[property] + parseFloat(endProperties[property]);\r\n                    } else if (typeof endProperties[property] === 'number' && typeof startProperties[property] === 'string' && !isNaN(startProperties[property])) {\r\n                        temp = endProperties[property] - parseFloat(startProperties[property]);\r\n                    } else if (typeof endProperties[property] === 'number' && typeof startProperties[property] === 'number') {\r\n                        temp = endProperties[property];\r\n                    } else if (typeof endProperties[property] === 'object') {\r\n                        temp = this.calculateProperties(startProperties[property], endProperties[property]);\r\n                    }\r\n\r\n                    if (temp !== null) result[property] = temp;\r\n                }\r\n            }\r\n            return Object.keys(result).length > 0 ? result : null;\r\n        }\r\n    }\r\n}\r\n","import Immutable from \"objects/Immutable\";\r\nimport Mutable from \"objects/Mutable\";\r\nimport Handler from \"api/Handler\";\r\nimport RuntimeException from \"exceptions/RuntimeException\";\r\n\r\nexport default class BaseStore extends Handler {\r\n    /** @type Immutable */\r\n    state;\r\n\r\n    constructor(state) {\r\n        super();\r\n        this.state = new Immutable(state);\r\n    }\r\n\r\n    /**\r\n     * @return {Immutable}\r\n     */\r\n    getState() {\r\n        return this.state;\r\n    }\r\n\r\n    /**\r\n     * @param {Object} state\r\n     * @param {function(Immutable, Immutable)} callback(newState, oldState)\r\n     */\r\n    setState(state, callback) {\r\n        if (!this._isEnabled) throw new RuntimeException('Trying setState() on disabled store.');\r\n\r\n        let oldState = this.state.toJS();\r\n        this.state = new Immutable(Mutable.extend(true, {}, oldState, state));\r\n\r\n\r\n        if (this.events) {\r\n            this.events.trigger('update', {\r\n                newState: this.state,\r\n                oldState\r\n            });\r\n        }\r\n\r\n        if (callback) callback(this.state, oldState);\r\n    }\r\n}\r\n","import BaseGameState from \"states/BaseGameState\";\r\n\r\n/**\r\n * Default game state\r\n *\r\n * @class DefaultGameState\r\n * @abstract\r\n * @constructor\r\n *\r\n * @param {GameStatesManager} gsm\r\n * @param {DefaultGameState.defaults|BaseGameState.defaults|Object} [data]\r\n * @property {DefaultGameState.defaults|BaseGameState.defaults|Object} data\r\n */\r\nexport default class DefaultGameState extends BaseGameState {\r\n    constructor(gsm, data) {\r\n        if (data === undefined) data = {};\r\n        data.id = 'init_j2d';\r\n        super(gsm, data);\r\n    }\r\n\r\n    // init(data) {\r\n    //     return BaseGameState.prototype.init.call(this, data);\r\n    // }\r\n    //\r\n    // load(data) {\r\n    //     return BaseGameState.prototype.load.call(this, data);\r\n    // }\r\n\r\n    update(timestamp, data) {\r\n        setTimeout(function () {\r\n            this.gsm.setNextState();\r\n        }.bind(this), 1000);\r\n        return true;\r\n    }\r\n\r\n    // render(timestamp, data) {\r\n    //     return true;\r\n    // }\r\n    //\r\n    // unload(data) {\r\n    //     return BaseGameState.prototype.unload.call(this, data);\r\n    // }\r\n}\r\n","import ObjectUtil from \"utils/ObjectUtil\";\r\nimport UUID from \"utils/UUID\";\r\nimport Events from \"utils/Events\";\r\n/**\r\n * Base class of state\r\n *\r\n * @class BaseGameState\r\n * @abstract\r\n * @constructor\r\n *\r\n * @param {GameStatesManager} gsm\r\n * @param {BaseGameState.defaults|Object} [data]\r\n * @property {BaseGameState.defaults|Object} data\r\n * @property {string} id\r\n */\r\nexport default class BaseGameState {\r\n    static defaults = {\r\n        id: 'BaseState',\r\n        currentState: 0\r\n    };\r\n\r\n    static STATE = {\r\n        STATE_NOT_LOADED: 0,\r\n        STATE_INIT: 1,\r\n        STATE_LOAD: 2,\r\n        STATE_UPDATE: 3,\r\n        STATE_RENDER: 4,\r\n        STATE_UNLOAD: 5\r\n    };\r\n\r\n    constructor(gsm, data) {\r\n        if (data === undefined) data = {};\r\n        if (data === undefined) data = {};\r\n        data.currentState = 0;\r\n        if (data.id === undefined || data.id === null) {\r\n            data.id = UUID.generate();\r\n        }\r\n        this.data = ObjectUtil.extend(true, {}, BaseGameState.defaults, data);\r\n\r\n        this.gsm = gsm;\r\n        this.loader = null;\r\n        this.events = new Events();\r\n    }\r\n\r\n    get id() {\r\n        return this.data.id;\r\n    }\r\n\r\n    set id(value) {\r\n        this.data.id = value;\r\n    }\r\n\r\n    init(data) {\r\n        if (typeof data === 'object' && data.callback !== undefined) {\r\n            data.callback();\r\n        }\r\n        return true;\r\n    }\r\n\r\n    load(data) {\r\n        if (typeof data === 'object' && data.callback !== undefined) data.callback();\r\n        return true;\r\n    }\r\n\r\n    update(timestamp, data) {\r\n        return true;\r\n    }\r\n\r\n    render(timestamp, data) {\r\n        return true;\r\n    }\r\n\r\n    unload(data) {\r\n        if (typeof data === 'object' && data.callback !== undefined) data.callback();\r\n        return true;\r\n    }\r\n\r\n    /* Events wrappers */\r\n    /**\r\n     * @param {string} event\r\n     * @param {function} callback\r\n     * @returns {boolean}\r\n     */\r\n    on(event, callback) {\r\n        return this.events.on(event, callback);\r\n    }\r\n\r\n    /**\r\n     * @param {string} event\r\n     * @param {function} callback\r\n     * @returns {boolean}\r\n     */\r\n    off(event, callback) {\r\n        return this.events.off(event, callback);\r\n    }\r\n\r\n    /**\r\n     * @param {string} event\r\n     * @param {function} callback\r\n     * @returns {boolean}\r\n     */\r\n    once(event, callback) {\r\n        return this.events.once(event, callback);\r\n    }\r\n\r\n    /**\r\n     * @param {string} event\r\n     * @returns {boolean}\r\n     */\r\n    flush(event) {\r\n        return this.events.flush(event);\r\n    }\r\n\r\n    /**\r\n     * @param {string} event\r\n     * @param {Array.<*>} data\r\n     * @returns {boolean}\r\n     */\r\n    trigger(event, data) {\r\n        return this.events.trigger(event, data);\r\n    }\r\n}\r\n","import InvalidArgumentException from \"exceptions/InvalidArgumentException\";\r\nimport Mutable from \"objects/Mutable\";\r\n\r\nconst FREEZE_NODE_METHODS = ['get', 'set', 'toJS', 'toJSON'];\r\nconst FREEZE_NODE_ARRAY_METHODS = [\r\n    'concat', 'copyWithin', 'fill', 'filter', 'map', 'pop', 'reduce',\r\n    'reduceRight', 'reverse', 'shift', 'slice', 'sort', 'splice', 'unshift',\r\n];\r\n\r\n/**\r\n * @exports module:objects/Immutable\r\n */\r\nexport default class Immutable extends Object {\r\n    __$ImmutableOptions;\r\n\r\n    constructor(object, options) {\r\n        if (object !== undefined && typeof object !== 'object') {\r\n            throw new InvalidArgumentException('Attribute object type must be instance of Object.');\r\n        }\r\n\r\n        if (options === undefined) options = {};\r\n        if (object === undefined) object = {};\r\n\r\n        super(object instanceof Array ? new ImmutableArray(object, options) : Object.assign({}, object));\r\n\r\n        this.__$ImmutableOptions = options;\r\n\r\n        if (!Object.isFrozen(this)) Immutable.freeze(this, options);\r\n    }\r\n\r\n    toJS = () => Immutable.unFreeze(Object.assign(this instanceof Array ? [] : {}, this));\r\n\r\n    toJSON = () => JSON.stringify(\r\n        Immutable.unFreeze(Object.assign(this instanceof Array ? [] : {}, this))\r\n    );\r\n\r\n    get = () => Immutable.freeze(Object.assign(this instanceof Array ? [] : {}, this), this.__$ImmutableOptions);\r\n\r\n    set = (data) => {\r\n        if (data !== undefined && typeof data !== 'object') {\r\n            throw new InvalidArgumentException('Attribute object type must be instance of Object.');\r\n        }\r\n\r\n        if (Object.isFrozen(this)) {\r\n            let oldObject = Immutable.unFreeze(Object.assign(this instanceof Array ? [] : {}, this));\r\n            let newObject = Mutable.extend(true, oldObject instanceof Array ? [] : {}, oldObject, data);\r\n            console.log(oldObject, this, newObject);\r\n\r\n            return Immutable.freeze(newObject, this.__$ImmutableOptions);\r\n        }\r\n\r\n        return null;\r\n    };\r\n\r\n    /**\r\n     * @param {Object} object\r\n     * @param {Object} options\r\n     * @return {Object}\r\n     */\r\n    static freeze(object, options) {\r\n        Object.getOwnPropertyNames(object).forEach((property) => {\r\n            if (object.hasOwnProperty(property)\r\n                && object[property] !== null\r\n                && (typeof object[property] === 'object' || typeof object[property] === 'function')\r\n                && !Object.isFrozen(object[property])\r\n                && !FREEZE_NODE_METHODS.includes(property)\r\n                && !FREEZE_NODE_ARRAY_METHODS.includes(property)\r\n                && property !== '__$ImmutableOptions'\r\n            ) {\r\n                object[property] = new Immutable(object[property], options);\r\n            }\r\n        });\r\n\r\n        Object.freeze(object);\r\n        return object;\r\n    }\r\n\r\n    /**\r\n     * @param {Object} object\r\n     * @return {Object}\r\n     */\r\n    static unFreeze(object) {\r\n        let result = object instanceof Array ? [] : {};\r\n\r\n        if (object instanceof Array) {\r\n            object.forEach((v) => result.push(v));\r\n        } else if (object instanceof String) {\r\n            result = String(object).toString();\r\n        } else if (typeof object == 'object') {\r\n            for (let property in object) {\r\n                if (object.hasOwnProperty(property)\r\n                    && !FREEZE_NODE_METHODS.includes(property)\r\n                    && !FREEZE_NODE_ARRAY_METHODS.includes(property)\r\n                    && property !== '__$ImmutableOptions'\r\n                ) {\r\n                    result[property] = (typeof object[property] === 'object' && Object.isFrozen(object[property]))\r\n                        ? Immutable.unFreeze(object[property])\r\n                        : object[property];\r\n                }\r\n            }\r\n        }\r\n\r\n        return result;\r\n    }\r\n}\r\n\r\nclass ImmutableArray extends Array {\r\n    __$ImmutableOptions;\r\n\r\n    constructor(array, options) {\r\n        if (options === undefined) options = {};\r\n\r\n        super([]);\r\n\r\n        this.__$ImmutableOptions = options;\r\n\r\n        if ((typeof array === 'object' && array instanceof Array)) {\r\n            array.forEach((value, key) => this[key] = value);\r\n        }\r\n    }\r\n\r\n    // Immutable methods\r\n    /**\r\n     * @param args\r\n     * @return {Immutable|ImmutableArray|Object}\r\n     */\r\n    concat(...args) {\r\n        return Immutable.freeze(super.concat(...args), this.__$ImmutableOptions);\r\n    }\r\n\r\n    /**\r\n     * @param args\r\n     * @return {Immutable|ImmutableArray|Object}\r\n     */\r\n    copyWithin(...args) {\r\n        return Immutable.freeze(super.copyWithin(...args), this.__$ImmutableOptions);\r\n    }\r\n\r\n    /**\r\n     * @param args\r\n     * @return {Immutable|ImmutableArray|Object}\r\n     */\r\n    fill(...args) {\r\n        let array = Immutable.unFreeze(Object.assign([], this));\r\n        return Immutable.freeze(array.fill(...args), this.__$ImmutableOptions);\r\n    }\r\n\r\n    /**\r\n     * @param args\r\n     * @return {Immutable|ImmutableArray|Object}\r\n     */\r\n    filter(...args) {\r\n        return Immutable.freeze(super.filter(...args), this.__$ImmutableOptions);\r\n    }\r\n\r\n    /**\r\n     * @param args\r\n     * @return {Immutable|ImmutableArray|Object}\r\n     */\r\n    map(...args) {\r\n        return Immutable.freeze(super.map(...args), this.__$ImmutableOptions);\r\n    }\r\n\r\n    /**\r\n     * @param args\r\n     * @return {Immutable|ImmutableArray|Object}\r\n     */\r\n    pop(...args) {\r\n        let array = Immutable.unFreeze(Object.assign([], this));\r\n        array.pop(...args);\r\n        return Immutable.freeze(array, this.__$ImmutableOptions);\r\n    }\r\n\r\n    /**\r\n     * @param args\r\n     * @return {Immutable|ImmutableArray|Object}\r\n     */\r\n    push(...args) {\r\n        let array = Immutable.unFreeze(Object.assign([], this));\r\n        array.push(...args);\r\n        return Immutable.freeze(array, this.__$ImmutableOptions);\r\n    }\r\n\r\n    /**\r\n     * @param args\r\n     * @return {Immutable|ImmutableArray|Object}\r\n     */\r\n    reduce(...args) {\r\n        let array = Immutable.unFreeze(Object.assign([], this));\r\n        return Immutable.freeze(array.reduce(...args), this.__$ImmutableOptions);\r\n    }\r\n\r\n    /**\r\n     * @param args\r\n     * @return {Immutable|ImmutableArray|Object}\r\n     */\r\n    reduceRight(...args) {\r\n        let array = Immutable.unFreeze(Object.assign([], this));\r\n        return Immutable.freeze(array.reduceRight(...args), this.__$ImmutableOptions);\r\n    }\r\n\r\n    /**\r\n     * @param args\r\n     * @return {Immutable|ImmutableArray|Object}\r\n     */\r\n    reverse(...args) {\r\n        let array = Immutable.unFreeze(Object.assign([], this));\r\n        return Immutable.freeze(array.reverse(...args), this.__$ImmutableOptions);\r\n    }\r\n\r\n    /**\r\n     * @param args\r\n     * @return {Immutable|ImmutableArray|Object}\r\n     */\r\n    shift(...args) {\r\n        let array = Immutable.unFreeze(Object.assign([], this));\r\n        array.shift(...args);\r\n        return Immutable.freeze(array, this.__$ImmutableOptions);\r\n    }\r\n\r\n    /**\r\n     * @param args\r\n     * @return {Immutable|ImmutableArray|Object}\r\n     */\r\n    slice(...args) {\r\n        let array = Immutable.unFreeze(Object.assign([], this));\r\n        return Immutable.freeze(array.slice(...args), this.__$ImmutableOptions);\r\n    }\r\n\r\n    /**\r\n     * @param args\r\n     * @return {Immutable|ImmutableArray|Object}\r\n     */\r\n    sort(...args) {\r\n        let array = Immutable.unFreeze(Object.assign([], this));\r\n        return Immutable.freeze(array.sort(...args), this.__$ImmutableOptions);\r\n    }\r\n\r\n    /**\r\n     * @param args\r\n     * @return {Immutable|ImmutableArray|Object}\r\n     */\r\n    splice(...args) {\r\n        let array = Immutable.unFreeze(Object.assign([], this));\r\n        return Immutable.freeze(array.splice(...args), this.__$ImmutableOptions);\r\n    }\r\n\r\n    /**\r\n     * @param args\r\n     * @return {Immutable|ImmutableArray|Object}\r\n     */\r\n    unshift(...args) {\r\n        let array = Immutable.unFreeze(Object.assign([], this));\r\n        array.unshift(...args);\r\n        return Immutable.freeze(array, this.__$ImmutableOptions);\r\n    }\r\n}\r\n","import BaseNode from \"nodes/BaseNode\";\r\nimport RuntimeException from \"exceptions/RuntimeException\";\r\n\r\nexport default class GroupNode extends BaseNode {\r\n    /** @type {Array.<BaseNode|GroupNode>} */\r\n    _nodes = [];\r\n\r\n    constructor(data) {\r\n        super(data);\r\n    }\r\n\r\n    get(guid) {\r\n        return this._nodes[guid] || null;\r\n    }\r\n\r\n    has(guid) {\r\n        return this._nodes[guid] !== undefined;\r\n    }\r\n\r\n    add(node) {\r\n        if (node.isSpecialNode) {\r\n            throw new RuntimeException(`You try add the ${node.constructor.name} to GroupNode, but this not work.`);\r\n        }\r\n        if (node.instanceOf(BaseNode)) {\r\n            this._nodes[node.guid] = node;\r\n            this._nodes.push(node);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    insert(node, index) {\r\n        if (node.isSpecialNode) {\r\n            throw new RuntimeException(`You try add the ${node.constructor.name} to GroupNode, but this not work.`);\r\n        }\r\n        if (node.instanceOf(BaseNode)) {\r\n            this._nodes[node.guid] = node;\r\n            this._nodes.splice(index, 0, node);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    remove(node) {\r\n        if (node.instanceOf(BaseNode) && this.has(node.guid)) {\r\n            this._nodes.splice(this._nodes.indexOf(node), 1);\r\n            delete this._nodes[node.guid];\r\n        }\r\n        return this;\r\n    }\r\n\r\n    flush() {\r\n        this._nodes = [];\r\n        return this;\r\n    }\r\n\r\n    render(context, viewport, layers, data) {\r\n        if (this._nodes.length !== 0) {\r\n            this._nodes.forEach(node => {\r\n                node.render(context, viewport, layers, data);\r\n            });\r\n        }\r\n    }\r\n}\r\n","import BaseNode from \"nodes/BaseNode\";\r\n\r\nexport default class CameraNode extends BaseNode {\r\n\r\n}\r\n","/**\r\n * @class Video\r\n * @exports module:media/Video\r\n *\r\n * @constructor\r\n */\r\nexport default class Video {\r\n}\r\n","import ObjectUtil from \"utils/ObjectUtil\";\r\nimport UUID from \"utils/UUID\";\r\nimport Events from \"utils/Events\";\r\nimport Audio from \"media/Audio\";\r\n\r\nvar cache = {};\r\nvar audioContext;\r\nvar masterGain;\r\n\r\nfunction createMasterGain() {\r\n    if (audioContext) {\r\n        masterGain = (audioContext.createGain === undefined)\r\n            ? audioContext.createGainNode()\r\n            : audioContext.createGain();\r\n        masterGain.gain.value = 1;\r\n        masterGain.connect(audioContext.destination);\r\n        return masterGain;\r\n    }\r\n    return null;\r\n}\r\n\r\n/**\r\n * @class Sound\r\n * @exports module:media/Sound\r\n *\r\n * @constructor\r\n * @extends media/Audio\r\n * @param {Audio.defaults|Object} [data]\r\n * @param {MediaManager} [manager]\r\n */\r\nexport default class Sound extends Audio {\r\n    static defaults = {\r\n        id: null,\r\n        src: [],\r\n        format: null,\r\n        autoPlay: false,\r\n\r\n        duration: 0,\r\n        loop: false,\r\n        sprite: {},\r\n        volume: 1,\r\n        muted: false,\r\n        pos3d: [0, 0, -0.5],\r\n        rate: 1,\r\n\r\n        loaded: false,\r\n        buffer: false,\r\n        model: null,\r\n        onEndTimer: []\r\n    };\r\n\r\n    constructor(data, manager) {\r\n        super(data, manager);\r\n\r\n        this.manager = manager;\r\n        this.events = !!this.manager ? this.manager.events : new Events();\r\n        this.data = ObjectUtil.extend(true, {}, Sound.defaults, data);\r\n        this.audioNode = [];\r\n        audioContext = manager\r\n            ? manager.getAudioContext()\r\n            : new (window.AudioContext || window.webkitAudioContext);\r\n\r\n        masterGain = manager\r\n            ? manager.getMasterGain()\r\n            : createMasterGain();\r\n\r\n        if (this.data.id === null) {\r\n            this.data.id = UUID.generate();\r\n        }\r\n\r\n        if (audioContext && this.data.buffer) {\r\n            this._setupAudioNode(this);\r\n        }\r\n\r\n        if (this.manager && audioContext && this.manager.data.iOSAutoEnable) {\r\n            this.manager.iOSEnable = true;\r\n        }\r\n\r\n        if (this.manager) this.manager.media.get('sounds').add(this.data.id, this);\r\n\r\n        this.load();\r\n    }\r\n\r\n    _load(sound) {\r\n        loadBuffer(sound, sound.data.src);\r\n        return sound;\r\n    }\r\n\r\n    _unload(soundNode) {\r\n        soundNode.disconnect(0);\r\n    }\r\n\r\n    play(sprite, callback) {\r\n        var sound = this;\r\n\r\n        if (typeof sprite === 'function')  callback = sprite;\r\n\r\n        if (!sprite || typeof sprite === 'function') sprite = 'default';\r\n\r\n        if (!sound.data.loaded) {\r\n            sound.events.on('load', function () {\r\n                sound.play(sprite, callback);\r\n            });\r\n\r\n            return sound;\r\n        }\r\n\r\n        if (!sound.data.sprite[sprite]) {\r\n            if (typeof callback === 'function') callback();\r\n            return sound;\r\n        }\r\n\r\n        sound._inactiveNode(sound, function (node) {\r\n            node.sprite = sprite;\r\n\r\n            var pos = (node.pos > 0) ? node.pos : sound.data.sprite[sprite][0] / 1000;\r\n            var duration = sound.data.sprite[sprite][1] / 1000 - node.pos;\r\n            if (node.pos > 0) pos = sound.data.sprite[sprite][0] / 1000 + pos;\r\n            var loop = !!(sound.data.loop || sound.data.sprite[sprite][2]);\r\n\r\n            var soundId = (typeof callback === 'string')\r\n                ? callback\r\n                : Math.round(Date.now() * Math.random()) + '', timerId;\r\n\r\n            (function () {\r\n                var data = {\r\n                    id: soundId,\r\n                    sprite: sprite,\r\n                    loop: loop\r\n                };\r\n\r\n                timerId = setTimeout(function () {\r\n                    if (audioContext && !loop) {\r\n                        sound._nodeById(sound, data.id).paused = true;\r\n                        sound._nodeById(sound, data.id).pos = 0;\r\n                        sound._clearEndTimer(sound, data.id);\r\n                    }\r\n                    sound.events.trigger('unload', soundId);\r\n                }, (duration / sound.data.rate) * 1000);\r\n\r\n                sound.data.onEndTimer.push({timer: timerId, id: data.id});\r\n            })();\r\n\r\n            var loopStart = sound.data.sprite[sprite][0] / 1000,\r\n                loopEnd = sound.data.sprite[sprite][1] / 1000;\r\n\r\n            node.id = soundId;\r\n            node.paused = false;\r\n            refreshBuffer(sound, [loop, loopStart, loopEnd], soundId);\r\n            sound.data.playStart = audioContext.currentTime;\r\n            node.gain.value = sound.data.volume;\r\n\r\n            if (typeof node.bufferSource.start === 'undefined') {\r\n                loop ? node.bufferSource.noteGrainOn(0, pos, 86400) : node.bufferSource.noteGrainOn(0, pos, duration);\r\n            } else {\r\n                loop ? node.bufferSource.start(0, pos, 86400) : node.bufferSource.start(0, pos, duration);\r\n            }\r\n\r\n            sound.events.trigger('play');\r\n            if (typeof callback === 'function') callback(soundId);\r\n\r\n            return sound;\r\n        });\r\n\r\n        return sound;\r\n    }\r\n\r\n    _pause(activeNode) {\r\n        if (!activeNode.bufferSource || activeNode.paused) {\r\n            return true;\r\n        }\r\n\r\n        activeNode.paused = true;\r\n        if (activeNode.bufferSource.stop == undefined) {\r\n            activeNode.bufferSource.noteOff(0);\r\n        } else {\r\n            activeNode.bufferSource.stop(0);\r\n        }\r\n        return false;\r\n    }\r\n\r\n    _stop(activeNode) {\r\n        if (!activeNode.bufferSource || activeNode.paused) {\r\n            return true;\r\n        }\r\n\r\n        activeNode.paused = true;\r\n\r\n        if (typeof activeNode.bufferSource.stop === 'undefined') {\r\n            activeNode.bufferSource.noteOff(0);\r\n        } else {\r\n            activeNode.bufferSource.stop(0);\r\n        }\r\n        return false;\r\n    }\r\n\r\n    _mute(activeNode) {\r\n        activeNode.gain.value = 0;\r\n    }\r\n\r\n    _unMute(activeNode) {\r\n        activeNode.gain.value = this.data.volume;\r\n    }\r\n\r\n    _volume(activeNode, vol) {\r\n        activeNode.gain.value = vol;\r\n    }\r\n\r\n    _position(activeNode, v) {\r\n        if (v !== undefined && v == true) return activeNode.pos;\r\n        return activeNode.pos + (audioContext.currentTime - this.data.playStart);\r\n    }\r\n\r\n    _pos3d(activeNode, x, y, z) {\r\n        if (activeNode) {\r\n            this.data.pos3d = [x, y, z];\r\n            activeNode.panner.setPosition(x, y, z);\r\n            activeNode.panner.panningModel = this.data.model || 'HRTF';\r\n        }\r\n    }\r\n\r\n    _setupAudioNode() {\r\n        var sound = this,\r\n            node = sound.audioNode,\r\n            index = sound.audioNode.length;\r\n\r\n        node[index] = (audioContext.createGain === undefined)\r\n            ? audioContext.createGainNode()\r\n            : audioContext.createGain();\r\n\r\n        node[index].gain.value = sound.data.volume;\r\n        node[index].paused = true;\r\n        node[index].pos = 0;\r\n        node[index].readyState = 4;\r\n        node[index].connect(masterGain);\r\n\r\n        node[index].panner = audioContext.createPanner();\r\n        node[index].panner.panningModel = sound.data.model || 'equalpower';\r\n        node[index].panner.setPosition(sound.data.pos3d[0], sound.data.pos3d[1], sound.data.pos3d[2]);\r\n        node[index].panner.connect(node[index]);\r\n\r\n        return node[index];\r\n    }\r\n\r\n    /* Private */\r\n    _inactiveNode(sound, callback) {\r\n        var node = null;\r\n\r\n        for (var i = 0; i < sound.audioNode.length; i++) {\r\n            if (sound.audioNode[i].paused && sound.audioNode[i].readyState === 4) {\r\n                callback(sound.audioNode[i]);\r\n                node = true;\r\n                break;\r\n            }\r\n        }\r\n\r\n        sound._drainPool(sound);\r\n\r\n        if (node) return;\r\n\r\n        var newNode = sound._setupAudioNode();\r\n        callback(newNode);\r\n    }\r\n\r\n    _drainPool(sound) {\r\n        var inactive = 0;\r\n\r\n        for (var i = 0; i < sound.audioNode.length; i++) {\r\n            if (sound.audioNode[i].paused) inactive++;\r\n        }\r\n\r\n        for (i = sound.audioNode.length - 1; i >= 0; i--) {\r\n            if (inactive <= 5) break;\r\n\r\n            if (sound.audioNode[i].paused) {\r\n                if (audioContext) sound.audioNode[i].disconnect(0);\r\n                sound.audioNode.splice(i, 1);\r\n                inactive--;\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n\r\n/* WebAudioAPI Helpers */\r\n/**\r\n * Buffer a sound from URL (or from cache) and decode to audio source (Web Audio API).\r\n * @param  {Object} sound The Sound object for the sound to load.\r\n * @param  {String} url The path to the sound file.\r\n */\r\nvar loadBuffer = function (sound, url) {\r\n    if (url in cache) {\r\n        sound.data.duration = cache[url].duration;\r\n\r\n        loadSound(sound);\r\n        return;\r\n    }\r\n\r\n    if (/^data:[^;]+;base64,/.test(url)) {\r\n        var data = atob(url.split(',')[1]);\r\n        var dataView = new Uint8Array(data.length);\r\n        for (var i = 0; i < data.length; ++i) {\r\n            dataView[i] = data.charCodeAt(i);\r\n        }\r\n\r\n        decodeAudioData(dataView.buffer, sound, url);\r\n    } else {\r\n        var xhr = new XMLHttpRequest();\r\n        xhr.open('GET', url, true);\r\n        xhr.responseType = 'arraybuffer';\r\n        xhr.onload = function () {\r\n            decodeAudioData(xhr.response, sound, url);\r\n        };\r\n        xhr.onerror = function () {\r\n            if (audioContext) {\r\n                sound.data.buffer = true;\r\n                sound.audioNode = [];\r\n                delete sound.gainNode;\r\n                delete cache[url];\r\n                sound.load();\r\n            }\r\n        };\r\n        try {\r\n            xhr.send();\r\n        } catch (e) {\r\n            xhr.onerror();\r\n        }\r\n    }\r\n};\r\n\r\n/**\r\n * Decode audio data from an array buffer.\r\n * @param  {ArrayBuffer} arraybuffer The audio data.\r\n * @param  {Object} sound The Sound object for the sound to load.\r\n * @param  {String} url The path to the sound file.\r\n */\r\nvar decodeAudioData = function (arraybuffer, sound, url) {\r\n    audioContext.decodeAudioData(\r\n        arraybuffer,\r\n        function (buffer) {\r\n            if (buffer) {\r\n                cache[url] = buffer;\r\n                loadSound(sound, buffer);\r\n            }\r\n        },\r\n        function (error) {\r\n            sound.events.trigger('loaderror', error);\r\n        }\r\n    );\r\n};\r\n\r\n/**\r\n * Finishes loading the Web Audio API sound and fires the loaded event\r\n * @param  {Object}  sound    The Sound object for the sound to load.\r\n * @param  {Object} [buffer] The decoded buffer sound source.\r\n */\r\nvar loadSound = function (sound, buffer) {\r\n    sound.data.duration = (buffer) ? buffer.duration : sound.data.duration;\r\n\r\n    if (Object.getOwnPropertyNames(sound.data.sprite).length === 0) {\r\n        sound.data.sprite = {default: [0, sound.data.duration * 1000]};\r\n    }\r\n\r\n    if (!sound.data.loaded) {\r\n        sound.data.loaded = true;\r\n        sound.events.trigger('load');\r\n    }\r\n\r\n    if (sound.data.autoPlay) {\r\n        sound.play();\r\n    }\r\n};\r\n\r\n/**\r\n * Load the sound back into the buffer source.\r\n * @param  {Object} sound   The sound to load.\r\n * @param  {Array}  loop  Loop boolean, pos, and duration.\r\n * @param  {String} id    (optional) The play instance ID.\r\n */\r\nvar refreshBuffer = function (sound, loop, id) {\r\n    var node = sound._nodeById(sound, id);\r\n\r\n    node.bufferSource = audioContext.createBufferSource();\r\n    node.bufferSource.buffer = cache[sound.data.src];\r\n    node.bufferSource.connect(node.panner);\r\n    node.bufferSource.loop = loop[0];\r\n    if (loop[0]) {\r\n        node.bufferSource.loopStart = loop[1];\r\n        node.bufferSource.loopEnd = loop[1] + loop[2];\r\n    }\r\n    //noinspection JSPrimitiveTypeWrapperUsage\r\n    node.bufferSource.playbackRate.value = sound.data.rate;\r\n};\r\n","import ObjectUtil from \"utils/ObjectUtil\";\r\nimport UUID from \"utils/UUID\";\r\nimport Events from \"utils/Events\";\r\n\r\nvar cache = {};\r\nvar AudioNode = window.Audio;\r\n\r\n/**\r\n * @class Audio\r\n * @exports module:media/Audio\r\n *\r\n * @constructor\r\n * @param {Audio.defaults|Object} [data]\r\n * @param {MediaManager} [manager]\r\n */\r\nexport default class Audio {\r\n    static defaults = {\r\n        id: null,\r\n        src: [],\r\n        format: null,\r\n        autoPlay: false,\r\n\r\n        duration: 0,\r\n        loop: false,\r\n        sprite: {},\r\n        volume: 1,\r\n        muted: false,\r\n        pos3d: [0, 0, -0.5],\r\n\r\n        loaded: false,\r\n        onEndTimer: []\r\n    };\r\n\r\n    constructor(data, manager) {\r\n        var audio = this;\r\n        audio.manager = manager !== undefined ? manager : null;\r\n        audio.events = !!audio.manager ? audio.manager.events : new Events();\r\n        audio.data = ObjectUtil.extend(true, {}, Audio.defaults, data);\r\n\r\n        audio.audioNode = [];\r\n\r\n        if (audio.data.id === null) {\r\n            audio.data.id = UUID.generate();\r\n        }\r\n\r\n        if (audio.manager) audio.manager.media.get('audios').add(audio.data.id, audio);\r\n\r\n        audio.load();\r\n    }\r\n\r\n\r\n    _load(audio) {\r\n        var audioNode = new AudioNode();\r\n\r\n        audioNode.addEventListener('error', function () {\r\n            console.error({type: audioNode.error ? audioNode.error.code : 0});\r\n        }, false);\r\n\r\n        audio.audioNode.push(audioNode);\r\n\r\n        audioNode.src = audio.data.src;\r\n        audioNode.pos = 0;\r\n        audioNode.preload = 'auto';\r\n        audioNode.volume = (!!audio.manager)\r\n            ? (audio.manager.muted) ? 0 : audio.data.volume * (audio.manager.volume / 100)\r\n            : (audio.data.muted) ? 0 : audio.data.volume;\r\n\r\n        var listener = function () {\r\n            audio.data.duration = Math.ceil(audioNode.duration * 10) / 10;\r\n\r\n            if (Object.getOwnPropertyNames(audio.data.sprite).length === 0) {\r\n                audio.data.sprite = {default: [0, audio.data.duration * 1000]};\r\n            }\r\n\r\n            if (!audio.data.loaded) {\r\n                audio.data.loaded = true;\r\n                audio.events.trigger('load');\r\n            }\r\n\r\n            if (audio.data.autoPlay) {\r\n                audio.play();\r\n            }\r\n\r\n            audioNode.removeEventListener('canplaythrough', listener, false);\r\n        };\r\n        audioNode.addEventListener('canplaythrough', listener, false);\r\n        audioNode.load();\r\n\r\n        return audio;\r\n    }\r\n\r\n    load() {\r\n        var audio = this;\r\n        var url = '', extension = '';\r\n\r\n        if (audio.manager && (!!audio.manager.isSupportAudio)) {\r\n            console.warn('No audio support.');\r\n            return false;\r\n        }\r\n\r\n        var extractFormat = function (source, format) {\r\n            if (format) return format;\r\n\r\n            var extension = /^data:audio\\/([^;,]+);/i.exec(source);\r\n            if (!extension) {\r\n                extension = /\\.([^.]+)$/.exec(source.split('?', 1)[0]);\r\n            }\r\n\r\n            if (extension) {\r\n                return extension[1].toLowerCase();\r\n            } else {\r\n                console.warn('Could not extract format from passed URLs, please add format');\r\n            }\r\n            return null;\r\n        };\r\n\r\n        if (audio.data.src instanceof Array) {\r\n            for (var i = 0; i < audio.data.src.length; i++) {\r\n                url = audio.data.src[i];\r\n                extension = extractFormat(audio.data.src[i], audio.data.format);\r\n                if (null !== extension) break;\r\n            }\r\n            audio.data.src = url;\r\n        } else if (typeof audio.data.src === 'string') {\r\n            extension = extractFormat(audio.data.src, audio.data.format);\r\n        } else {\r\n            console.warn('Unknown audio source');\r\n            return false;\r\n        }\r\n\r\n        if (audio.manager && audio.manager.isSupportCodec[extension]) {\r\n            console.warn('Codec not support');\r\n            return false;\r\n        }\r\n\r\n        return audio._load(audio);\r\n    }\r\n\r\n    _unload(audioNode) {\r\n        audioNode.src = '';\r\n    }\r\n\r\n    unload() {\r\n        var audio = this;\r\n\r\n        var nodes = audio.audioNode;\r\n        for (var i = 0; i < audio.audioNode.length; i++) {\r\n            if (!nodes[i].paused) {\r\n                audio.stop(nodes[i].id);\r\n                audio.events.trigger('unload', nodes[i].id);\r\n            }\r\n            audio._unload(nodes[i]);\r\n        }\r\n\r\n        for (i = 0; i < audio.data.onEndTimer.length; i++) {\r\n            clearTimeout(audio.data.onEndTimer[i].timer);\r\n        }\r\n\r\n        if (audio.manager) {\r\n            var audios = this.manager.get('audios');\r\n            var index = audios.indexOf(audio);\r\n            if (index !== null && index >= 0) {\r\n                audios.splice(index, 1);\r\n            }\r\n        }\r\n\r\n        delete cache[audio.data.src];\r\n        audio = null;\r\n    };\r\n\r\n    src(source) {\r\n        var audio = this;\r\n\r\n        if (source) {\r\n            audio.stop();\r\n            audio.data.src = source;\r\n            audio.data.loaded = false;\r\n            audio.load();\r\n        } //TODO:: else throw\r\n\r\n        return null;\r\n    }\r\n\r\n    play(sprite, callback) {\r\n        var audio = this;\r\n\r\n        if (typeof sprite === 'function') callback = sprite;\r\n        if (!sprite || typeof sprite === 'function') sprite = 'default';\r\n\r\n        if (!audio.data.loaded) {\r\n            audio.events.on('load', function () {\r\n                audio.play(sprite, callback);\r\n            });\r\n\r\n            return audio;\r\n        }\r\n\r\n        if (!audio.data.sprite[sprite]) {\r\n            if (typeof callback === 'function') callback();\r\n            return audio;\r\n        }\r\n\r\n        audio._inactiveNode(audio, function (node) {\r\n            node.sprite = sprite;\r\n\r\n            var pos = (node.pos > 0) ? node.pos : audio.data.sprite[sprite][0] / 1000;\r\n            var duration = audio.data.sprite[sprite][1] / 1000 - (pos - audio.data.sprite[sprite][0] / 1000);\r\n            var loop = !!(audio.data.loop || audio.data.sprite[sprite][2]);\r\n\r\n            var soundId = (typeof callback === 'string')\r\n                ? callback\r\n                : Math.round(Date.now() * Math.random()) + '', timerId;\r\n\r\n            (function () {\r\n                var data = {\r\n                    id: soundId,\r\n                    sprite: sprite,\r\n                    loop: loop\r\n                };\r\n\r\n                timerId = setTimeout(function () {\r\n                    if (loop) {\r\n                        audio.stop(data.id).play(sprite, data.id);\r\n                    } else {\r\n                        audio.stop(data.id);\r\n                    }\r\n\r\n                    audio.events.trigger('unload', soundId);\r\n                }, (duration / audio.data.rate) * 1000);\r\n\r\n                audio.data.onEndTimer.push({timer: timerId, id: data.id});\r\n            })();\r\n\r\n\r\n            if (node.readyState === 4 || !node.readyState && navigator.isCocoonJS) {\r\n                node.id = soundId;\r\n                node.currentTime = pos;\r\n\r\n                node.muted = audio.manager\r\n                    ? (audio.manager.muted || node.muted)\r\n                    : (audio.data.muted || node.muted);\r\n\r\n                node.volume = audio.manager\r\n                    ? audio.data.volume * (audio.manager.volume / 100)\r\n                    : audio.data.volume;\r\n\r\n                setTimeout(function () {\r\n                    node.play();\r\n                }, 0);\r\n            } else {\r\n                audio._clearEndTimer(soundId);\r\n\r\n                (function () {\r\n                    var audio = audio,\r\n                        playSprite = sprite,\r\n                        fn = callback,\r\n                        newNode = node;\r\n\r\n                    var listener = function () {\r\n                        audio.play(playSprite, fn);\r\n                        newNode.removeEventListener('canplaythrough', listener, false);\r\n                    };\r\n\r\n                    newNode.addEventListener('canplaythrough', listener, false);\r\n                })();\r\n\r\n                return audio;\r\n            }\r\n\r\n            audio.events.trigger('play');\r\n            if (typeof callback === 'function') callback(soundId);\r\n\r\n            return audio;\r\n        });\r\n\r\n        return audio;\r\n    }\r\n\r\n    _pause(activeNode) {\r\n        activeNode.pause();\r\n        return false;\r\n    }\r\n\r\n    pause(id) {\r\n        var audio = this;\r\n\r\n        if (!audio.data.loaded) {\r\n            audio.events.on('play', function () {\r\n                audio.pause(id);\r\n            });\r\n            return audio;\r\n        }\r\n\r\n        audio._clearEndTimer(audio, id);\r\n\r\n        var activeNode = (id) ? audio._nodeById(id) : audio._activeNode(audio);\r\n        if (activeNode) {\r\n            activeNode.pos = audio.pos(null, id);\r\n            var result = audio._pause(activeNode);\r\n            if (result) return audio;\r\n        }\r\n\r\n        audio.events.trigger('pause');\r\n\r\n        return audio;\r\n    }\r\n\r\n    _stop(activeNode) {\r\n        if (!isNaN(activeNode.duration)) {\r\n            activeNode.pause();\r\n            activeNode.currentTime = 0;\r\n        }\r\n        return false;\r\n    }\r\n\r\n    stop(id) {\r\n        var audio = this;\r\n\r\n        if (!audio.data.loaded) {\r\n            audio.events.on('play', function () {\r\n                audio.stop(id);\r\n            });\r\n\r\n            return audio;\r\n        }\r\n\r\n        audio._clearEndTimer(audio, id);\r\n\r\n        var activeNode = (id) ? audio._nodeById(audio, id) : audio._activeNode(audio);\r\n        if (activeNode) {\r\n            activeNode.pos = 0;\r\n            var result = audio._stop(activeNode);\r\n            if (result) return audio;\r\n        }\r\n\r\n        return audio;\r\n    }\r\n\r\n    _mute(activeNode) {\r\n        activeNode.muted = true;\r\n    }\r\n\r\n    mute(id) {\r\n        var audio = this;\r\n\r\n        if (!audio.data.loaded) {\r\n            audio.events.on('play', function () {\r\n                audio.mute(id);\r\n            });\r\n            return audio;\r\n        }\r\n\r\n        var activeNode = (id) ? audio._nodeById(id) : audio._activeNode(audio);\r\n        if (activeNode) audio._mute();\r\n\r\n        return audio;\r\n    }\r\n\r\n    _unMute(activeNode) {\r\n        activeNode.muted = false;\r\n    }\r\n\r\n    unMute(id) {\r\n        var audio = this;\r\n\r\n        if (!audio.data.loaded) {\r\n            audio.events.on('play', function () {\r\n                audio.unMute(id);\r\n            });\r\n            return audio;\r\n        }\r\n\r\n        var activeNode = (id) ? audio._nodeById(id) : audio._activeNode(audio);\r\n        if (activeNode) audio._unMute();\r\n\r\n        return audio;\r\n    }\r\n\r\n    _volume(activeNode, vol) {\r\n        activeNode.volume = vol;\r\n    }\r\n\r\n    volume(vol, id) {\r\n        var audio = this;\r\n\r\n        vol = parseFloat(vol);\r\n\r\n        if (vol >= 0 && vol <= 1) {\r\n            audio.data.volume = vol;\r\n\r\n            if (!audio.data.loaded) {\r\n                audio.events.on('play', function () {\r\n                    audio.volume(vol, id);\r\n                });\r\n                return audio;\r\n            }\r\n\r\n            var activeNode = (id) ? audio._nodeById(id) : audio._activeNode(audio);\r\n            if (activeNode) {\r\n                vol = audio.manager\r\n                    ? vol * (audio.manager.volume / 100)\r\n                    : audio.data.volume;\r\n                audio._volume(vol);\r\n            }\r\n\r\n            return audio;\r\n        }\r\n        return audio.data.volume;\r\n    }\r\n\r\n    loop(loop) {\r\n        var audio = this;\r\n\r\n        if (typeof loop === 'boolean') {\r\n            audio.data.loop = loop;\r\n            return audio;\r\n        }\r\n        return audio.data.loop;\r\n    }\r\n\r\n    sprite(sprite) {\r\n        var audio = this;\r\n\r\n        if (typeof sprite === 'object') {\r\n            audio.data.sprite = sprite;\r\n            return audio;\r\n        }\r\n        return audio.data.sprite;\r\n    }\r\n\r\n    _position(activeNode, v) {\r\n        return activeNode.currentTime;\r\n    }\r\n\r\n    pos(pos, id) {\r\n        var audio = this;\r\n\r\n        if (!audio.data.loaded) {\r\n            audio.events.on('load', function () {\r\n                audio.pos(pos);\r\n            });\r\n            return typeof pos === 'number' ? audio : audio.data.pos || 0;\r\n        }\r\n\r\n        pos = parseFloat(pos);\r\n\r\n        var activeNode = (id) ? audio._nodeById(id) : audio._activeNode(audio);\r\n        if (activeNode) {\r\n            if (pos >= 0) {\r\n                audio.pause(id);\r\n                activeNode.pos = pos;\r\n                audio.play(activeNode.sprite, id);\r\n                return audio;\r\n            } else {\r\n                return audio._position(activeNode, false);\r\n            }\r\n        } else if (pos >= 0) {\r\n            return audio;\r\n        } else {\r\n            for (var i = 0; i < audio.audioNode.length; i++) {\r\n                if (audio.audioNode[i].paused && audio.audioNode[i].readyState === 4) {\r\n                    return audio._position(audio.audioNode[i], true);\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    _pos3d(activeNode, x, y, zsaz) {\r\n        return null;\r\n    }\r\n\r\n    pos3d(x, y, z, id) {\r\n        var audio = this;\r\n\r\n        y = (typeof y === 'undefined' || !y) ? 0 : y;\r\n        z = (typeof z === 'undefined' || !z) ? -0.5 : z;\r\n\r\n        if (!audio.data.loaded) {\r\n            audio.events.on('play', function () {\r\n                audio.pos3d(x, y, z, id);\r\n            });\r\n            return audio;\r\n        }\r\n\r\n        if (x >= 0 || x < 0) {\r\n            var activeNode = (id) ? audio._nodeById(id) : audio._activeNode(audio);\r\n            audio._pos3d(activeNode, x, y, z);\r\n        } else {\r\n            return audio.data.pos3d;\r\n        }\r\n\r\n        return audio;\r\n    }\r\n\r\n    /* Private */\r\n    _nodeById(audio, id) {\r\n        var node = audio.audioNode[0];\r\n\r\n        for (var i = 0; i < audio.audioNode.length; i++) {\r\n            if (audio.audioNode[i].id === id) {\r\n                node = audio.audioNode[i];\r\n                break;\r\n            }\r\n        }\r\n\r\n        return node;\r\n    }\r\n\r\n    _clearEndTimer(audio, id) {\r\n        var index = -1;\r\n\r\n        for (var i = 0; i < audio.data.onEndTimer.length; i++) {\r\n            if (audio.data.onEndTimer[i].id === id) {\r\n                index = i;\r\n                break;\r\n            }\r\n        }\r\n\r\n        var timer = audio.data.onEndTimer[index];\r\n        if (timer) {\r\n            clearTimeout(timer.timer);\r\n            audio.data.onEndTimer.splice(index, 1);\r\n        }\r\n    }\r\n\r\n    _activeNode(audio) {\r\n        var node = null;\r\n\r\n        for (var i = 0; i < audio.audioNode.length; i++) {\r\n            if (!audio.audioNode[i].paused) {\r\n                node = audio.audioNode[i];\r\n                break;\r\n            }\r\n        }\r\n\r\n        audio._drainPool(audio);\r\n\r\n        return node;\r\n    }\r\n\r\n    _inactiveNode(audio, callback) {\r\n        var node = null;\r\n\r\n        for (var i = 0; i < audio.audioNode.length; i++) {\r\n            if (audio.audioNode[i].paused && audio.audioNode[i].readyState === 4) {\r\n                callback(audio.audioNode[i]);\r\n                node = true;\r\n                break;\r\n            }\r\n        }\r\n\r\n        audio._drainPool(audio);\r\n\r\n        if (node) return;\r\n\r\n        audio.load();\r\n        var newNode = audio.audioNode[audio.audioNode.length - 1];\r\n        var listenerEvent = navigator.isCocoonJS ? 'canplaythrough' : 'loadedmetadata';\r\n        var listener = function () {\r\n            newNode.removeEventListener(listenerEvent, listener, false);\r\n            callback(newNode);\r\n        };\r\n        newNode.addEventListener(listenerEvent, listener, false);\r\n    }\r\n\r\n    _drainPool(audio) {\r\n        var inactive = 0;\r\n\r\n        for (var i = 0; i < audio.audioNode.length; i++) {\r\n            if (audio.audioNode[i].paused) inactive++;\r\n        }\r\n\r\n        for (i = audio.audioNode.length - 1; i >= 0; i--) {\r\n            if (inactive <= 5) break;\r\n\r\n            if (audio.audioNode[i].paused) {\r\n                audio.audioNode.splice(i, 1);\r\n                inactive--;\r\n            }\r\n        }\r\n    }\r\n}\r\n","/**\r\n * Assets Loader\r\n *\r\n * @class AssetsLoader\r\n * @exports module:loaders/AssetsLoader\r\n *\r\n * @constructor\r\n */\r\nexport default class AssetsLoader {\r\n    progress = 0;\r\n\r\n    getProgress() {\r\n        return this.progress;\r\n    }\r\n\r\n    load() {\r\n    }\r\n\r\n    isLoaded(index) {\r\n    }\r\n\r\n    dispose(index) {\r\n    }\r\n}\r\n","import GroupNode from \"nodes/GroupNode\";\r\nimport BaseNode from \"nodes/BaseNode\";\r\nimport RuntimeException from \"exceptions/RuntimeException\";\r\n\r\nexport const LAYER_PREFIX = '__layer$';\r\n\r\nexport default class Layer extends GroupNode {\r\n    static isSpecial = true; // This fix situation when add Layer in GroupNode.\r\n\r\n    _isGlobal = false;\r\n\r\n    _registry = [];\r\n\r\n    get(key) {\r\n        return this._nodes[`${LAYER_PREFIX}${key}`] || this._nodes[key] || null;\r\n    }\r\n\r\n    has(key) {\r\n        return this._nodes[`${LAYER_PREFIX}${key}`] !== undefined || this._nodes[key] !== undefined;\r\n    }\r\n\r\n    constructor(guid) {\r\n        super({id: `${LAYER_PREFIX}${guid}`});\r\n        if (guid === 'global') this._isGlobal = true;\r\n    }\r\n\r\n    add(node, index) {\r\n        index = index === undefined ? this.count() : this.find('main') + index;\r\n        if (node.instanceOf(Layer) && this._isGlobal) {\r\n            if (this._registry[node.guid] !== undefined) {\r\n                throw new RuntimeException(`Global layer already contain layer with id: \"${node.guid}\"`);\r\n            }\r\n            this._registry[node.guid] = node;\r\n            this._nodes[node.guid] = node;\r\n            this._nodes.splice(index, 0, node);\r\n            //TODO:: registry of layers\r\n        } else if (node.instanceOf(Layer) && !this._isGlobal) {\r\n            throw RuntimeException('Only global layer has another layer as child.');\r\n        } else if (node.instanceOf(BaseNode) && this._isGlobal) {\r\n            this._nodes[this.find('main')].add(node);\r\n        } else if (node.instanceOf(BaseNode) && !this._isGlobal) {\r\n            super.add(node)\r\n        }\r\n        return this;\r\n    }\r\n\r\n    remove(node) {\r\n        if (node.instanceOf(Layer)) {\r\n            delete this._registry[node.guid];\r\n        }\r\n        super.remove(node);\r\n        return this;\r\n    }\r\n\r\n    count() {\r\n        return this._nodes.length;\r\n    }\r\n\r\n    find(key) {\r\n        let node = this._nodes[`${LAYER_PREFIX}${key}`];\r\n        if (!node) return null;\r\n        return this._nodes.indexOf(node);\r\n    }\r\n}\r\n","import Exception from \"exceptions/Exception\";\r\n\r\n/**\r\n * UnexpectedValueException\r\n * Create custom exception with message\r\n *\r\n * @class UnexpectedValueException\r\n * @exports module:exceptions/UnexpectedValueException\r\n *\r\n * @constructor\r\n * @extends Exception\r\n * @param {string} message\r\n * @property {string} message\r\n */\r\nexport default class UnexpectedValueException extends Exception {\r\n    constructor(message) {\r\n        super(message)\r\n    }\r\n\r\n    /**\r\n     * Convert exception to String\r\n     * @returns {string}\r\n     */\r\n    toString = function () {\r\n        return this.message;\r\n    }\r\n}\r\n","import Exception from \"exceptions/Exception\";\r\n\r\n/**\r\n * RuntimeException\r\n * Create custom exception with message\r\n *\r\n * @class RuntimeException\r\n * @exports module:exceptions/RuntimeException\r\n *\r\n * @constructor\r\n * @extends Exception\r\n * @param {string} message\r\n * @property {string} message\r\n */\r\nexport default class RuntimeException extends Exception {\r\n    constructor(message) {\r\n        super(message)\r\n    }\r\n\r\n    /**\r\n     * Convert exception to String\r\n     * @returns {string}\r\n     */\r\n    toString = function () {\r\n        return this.message;\r\n    }\r\n}\r\n","import Exception from \"exceptions/Exception\";\r\n\r\n/**\r\n * RangeException\r\n * Create custom exception with message\r\n *\r\n * @class RangeException\r\n * @exports module:exceptions/RangeException\r\n *\r\n * @constructor\r\n * @extends Exception\r\n * @param {string} message\r\n * @property {string} message\r\n */\r\nexport default class RangeException extends Exception {\r\n    constructor(message) {\r\n        super(message)\r\n    }\r\n\r\n    /**\r\n     * Convert exception to String\r\n     * @returns {string}\r\n     */\r\n    toString = function () {\r\n        return this.message;\r\n    }\r\n}\r\n","import Exception from \"exceptions/Exception\";\r\n\r\n/**\r\n * OutOfRangeException\r\n * Create custom exception with message\r\n *\r\n * @class OutOfRangeException\r\n * @exports module:exceptions/OutOfRangeException\r\n *\r\n * @constructor\r\n * @extends Exception\r\n * @param {string} message\r\n * @property {string} message\r\n */\r\nexport default class OutOfRangeException extends Exception {\r\n    constructor(message) {\r\n        super(message)\r\n    }\r\n\r\n    /**\r\n     * Convert exception to String\r\n     * @returns {string}\r\n     */\r\n    toString = function () {\r\n        return this.message;\r\n    }\r\n}\r\n","import Exception from \"exceptions/Exception\";\r\n\r\n/**\r\n * OutOfBoundsException\r\n * Create custom exception with message\r\n *\r\n * @class OutOfBoundsException\r\n * @exports module:exceptions/OutOfBoundsException\r\n *\r\n * @constructor\r\n * @extends Exception\r\n * @param {string} message\r\n * @property {string} message\r\n */\r\nexport default class OutOfBoundsException extends Exception {\r\n    constructor(message) {\r\n        super(message)\r\n    }\r\n\r\n    /**\r\n     * Convert exception to String\r\n     * @returns {string}\r\n     */\r\n    toString = function () {\r\n        return this.message;\r\n    }\r\n}\r\n","import Exception from \"exceptions/Exception\";\r\n\r\n/**\r\n * LogicException\r\n * Create custom exception with message\r\n *\r\n * @class LogicException\r\n * @exports module:exceptions/LogicException\r\n *\r\n * @constructor\r\n * @extends Exception\r\n * @param {string} message\r\n * @property {string} message\r\n */\r\nexport default class LogicException extends Exception {\r\n    constructor(message) {\r\n        super(message)\r\n    }\r\n\r\n    /**\r\n     * Convert exception to String\r\n     * @returns {string}\r\n     */\r\n    toString = function () {\r\n        return this.message;\r\n    }\r\n}\r\n","import Exception from \"exceptions/Exception\";\r\n\r\n/**\r\n * LengthException\r\n * Create custom exception with message\r\n *\r\n * @class LengthException\r\n * @exports module:exceptions/LengthException\r\n *\r\n * @constructor\r\n * @extends Exception\r\n * @param {string} message\r\n * @property {string} message\r\n */\r\nexport default class LengthException extends Exception {\r\n    constructor(message) {\r\n        super(message)\r\n    }\r\n\r\n    /**\r\n     * Convert exception to String\r\n     * @returns {string}\r\n     */\r\n    toString = function () {\r\n        return this.message;\r\n    }\r\n}\r\n","/**\r\n * Default Exception\r\n * Create custom exception with message\r\n *\r\n * @class Exception\r\n * @exports module:exceptions/Exception\r\n *\r\n * @constructor\r\n * @extends Error\r\n * @param {string} message\r\n * @property {string} message\r\n */\r\nexport default class Exception extends Error {\r\n    constructor(message) {\r\n        super(message);\r\n        this.message = message;\r\n\r\n        /**\r\n         * Convert exception to String\r\n         * @returns {string}\r\n         */\r\n        this.toString = function () {\r\n            return this.message;\r\n        }\r\n    }\r\n}\r\n","import Exception from \"exceptions/Exception\";\r\n\r\n/**\r\n * BadMethodCallException\r\n * Create custom exception with message\r\n *\r\n * @class BadMethodCallException\r\n * @exports module:exceptions/BadMethodCallException\r\n *\r\n * @constructor\r\n * @extends Exception\r\n * @param {string} message\r\n * @property {string} message\r\n */\r\nexport default class BadMethodCallException extends Exception {\r\n    constructor(message) {\r\n        super(message)\r\n    }\r\n\r\n    /**\r\n     * Convert exception to String\r\n     * @returns {string}\r\n     */\r\n    toString = function () {\r\n        return this.message;\r\n    }\r\n}\r\n","import Exception from \"exceptions/Exception\";\r\n\r\n/**\r\n * BadFunctionCallException\r\n * Create custom exception with message\r\n *\r\n * @class BadFunctionCallException\r\n * @exports module:exceptions/BadFunctionCallException\r\n *\r\n * @constructor\r\n * @extends Exception\r\n * @param {string} message\r\n * @property {string} message\r\n */\r\nexport default class BadFunctionCallException extends Exception {\r\n    constructor(message) {\r\n        super(message)\r\n    }\r\n\r\n    /**\r\n     * Convert exception to String\r\n     * @returns {string}\r\n     */\r\n    toString = function () {\r\n        return this.message;\r\n    }\r\n}\r\n","import ObjectUtil from \"../utils/ObjectUtil\";\r\nimport Events from \"../utils/Events\";\r\nimport ArrayMap from \"../utils/ArrayMap\";\r\n/**\r\n * j2D (JavaScript 2D Engine)\r\n *\r\n * @authors DeVinterX, James Simpson of GoldFire Studios(howler.js)\r\n * @original_source https://github.com/goldfire/howler.js/blob/master/howler.js\r\n * @license BSD, MIT(howler.js)\r\n * @version 0.2.0-dev\r\n */\r\n\r\nvar AudioNode = window.Audio;\r\nvar audioContext = false;\r\nvar html5Audio = false;\r\n\r\ntry {\r\n    //noinspection JSUnresolvedVariable\r\n    var AudioContext = window.AudioContext || window.webkitAudioContext;\r\n    audioContext = new AudioContext();\r\n} catch (e) {\r\n    console.warn('Web Audio API is not supported in your browser');\r\n}\r\n\r\ntry {\r\n    //noinspection JSUnresolvedFunction\r\n    html5Audio = !!new AudioNode();\r\n} catch (e) {\r\n    console.warn('HTML5 Audio is not supported in your browser');\r\n}\r\n\r\nif (audioContext) {\r\n    var masterGain = (audioContext.createGain === undefined)\r\n        ? audioContext.createGainNode()\r\n        : audioContext.createGain();\r\n    masterGain.gain.value = 1;\r\n    masterGain.connect(audioContext.destination);\r\n}\r\n\r\n/* MediaManager */\r\n\r\n/**\r\n * @class MediaManager\r\n * @exports module:io/MediaManager\r\n *\r\n * @param {EngineJ2D} j2d\r\n * @param {MediaManager.defaults|Object|undefined} [data]\r\n * @constructor\r\n */\r\nexport default class MediaManager {\r\n    static defaults = {\r\n        volume: 1,\r\n        muted: false,\r\n        codecs: {},\r\n        iOSAutoEnable: true\r\n    };\r\n\r\n    constructor(j2d, data) {\r\n        if (data === undefined) data = {};\r\n        this.j2d = j2d;\r\n        this.data = ObjectUtil.extend(true, {}, MediaManager.defaults, data);\r\n        this.events = new Events();\r\n        this.media = new ArrayMap();\r\n\r\n        this.media.add('sounds', new ArrayMap());\r\n        this.media.add('audios', new ArrayMap());\r\n        this.media.add('videos', new ArrayMap());\r\n\r\n        this.volume = this.data.volume * 100;\r\n        this.iOSEnabled = false;\r\n\r\n        if (audioContext || html5Audio) {\r\n            var test = new AudioNode();\r\n            this.data.codecs = {\r\n                mp3: !!test.canPlayType('audio/mpeg;').replace(/^no$/, ''),\r\n                opus: !!test.canPlayType('audio/ogg; codecs=\"opus\"').replace(/^no$/, ''),\r\n                ogg: !!test.canPlayType('audio/ogg; codecs=\"vorbis\"').replace(/^no$/, ''),\r\n                wav: !!test.canPlayType('audio/wav; codecs=\"1\"').replace(/^no$/, ''),\r\n                aac: !!test.canPlayType('audio/aac;').replace(/^no$/, ''),\r\n                m4a: !!(test.canPlayType('audio/x-m4a;') || test.canPlayType('audio/m4a;') || test.canPlayType('audio/aac;')).replace(/^no$/, ''),\r\n                mp4: !!(test.canPlayType('audio/x-mp4;') || test.canPlayType('audio/mp4;') || test.canPlayType('audio/aac;')).replace(/^no$/, ''),\r\n                weba: !!test.canPlayType('audio/webm; codecs=\"vorbis\"').replace(/^no$/, '')\r\n            };\r\n            test = null;\r\n        }\r\n    }\r\n\r\n    get volume() {\r\n        return this.data.volume * 100;\r\n    }\r\n\r\n    set volume(value) {\r\n        this.data.volume = parseFloat(value / 100);\r\n\r\n        if (value >= 0 && value <= 1) {\r\n            if (audioContext) {\r\n                masterGain.gain.value = this.data.volume;\r\n            } else {\r\n                var sounds = this.media.get('sounds');\r\n                for (var key in sounds) {\r\n                    if (sounds.hasOwnProperty(key) && !sounds[key].webAudio) {\r\n                        for (var i = 0; i < sounds[key].audioNode.length; i++) {\r\n                            sounds[key].audioNode[i].volume = sounds[key].volume * this.data.volume;\r\n                        }\r\n                    }\r\n                }\r\n                sounds = null;\r\n            }\r\n        }\r\n    }\r\n\r\n    get muted() {\r\n        return !!this.data.muted;\r\n    }\r\n\r\n    set muted(value) {\r\n        this.data.muted = !!value;\r\n\r\n        if (audioContext) {\r\n            masterGain.gain.value = this.data.muted ? 0 : this.data.volume;\r\n        } else {\r\n            var sounds = this.media.get('sounds');\r\n            for (var key in sounds) {\r\n                if (sounds.hasOwnProperty(key) && sounds[key].webAudio === false) {\r\n                    for (var i = 0; i < sounds[key].audioNode.length; i++) {\r\n                        sounds[key].audioNode[i].muted = this.data.muted;\r\n                    }\r\n                }\r\n            }\r\n            sounds = null;\r\n        }\r\n    }\r\n\r\n    get iOSEnable() {\r\n        return !!this.data.iOSAutoEnable;\r\n    }\r\n\r\n    set iOSEnable(value) {\r\n        if (audioContext && (this.iOSEnabled || !/iPhone|iPad|iPod/i.test(navigator.userAgent))) {\r\n            return value;\r\n        }\r\n        this.iOSEnabled = false;\r\n\r\n        var unlock = function () {\r\n            var buffer = audioContext.createBuffer(1, 1, 22050);\r\n            var source = audioContext.createBufferSource();\r\n            source.buffer = buffer;\r\n            source.connect(audioContext.destination);\r\n\r\n            if (source.start === undefined) {\r\n                source.noteOn(0);\r\n            } else {\r\n                source.start(0);\r\n            }\r\n\r\n            setTimeout(function () {\r\n                if ((source.playbackState === source.PLAYING_STATE\r\n                    || source.playbackState === source.FINISHED_STATE)) {\r\n                    this.iOSEnabled = true;\r\n                    this.data.iOSAutoEnable = false;\r\n\r\n                    window.removeEventListener('touchend', unlock, false);\r\n                }\r\n            }, 0);\r\n        };\r\n        window.addEventListener('touchend', unlock, false);\r\n    }\r\n\r\n    get isSupportAudio() {\r\n        return !audioContext && !html5Audio;\r\n    }\r\n\r\n\r\n    getAudioContext() {\r\n        return audioContext;\r\n    }\r\n\r\n    getMasterGain() {\r\n        return masterGain;\r\n    }\r\n\r\n    mute() {\r\n        this.muted = true;\r\n        return this;\r\n    }\r\n\r\n    unMute() {\r\n        this.muted = false;\r\n        return this;\r\n    }\r\n\r\n    isSupportCodec(fileExtension) {\r\n        return !!this.data.codecs[fileExtension];\r\n    }\r\n\r\n    addSound(data) {\r\n        new Sound(data, this);\r\n        return this;\r\n    }\r\n\r\n    addAudio(data) {\r\n        new Audio(data, this);\r\n        return this;\r\n    }\r\n\r\n    addVideo(data) {\r\n        //new Video(this, data);\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {string} id\r\n     * @returns {Sound}\r\n     */\r\n    sound(id) {\r\n        return this.media.get('sounds').get(id);\r\n    }\r\n\r\n    audio(id) {\r\n        return this.media.get('audios').get(id);\r\n    }\r\n\r\n    video(id) {\r\n        return this.media.get('videos').get(id);\r\n    }\r\n\r\n    removeSound(id) {\r\n        if (this.media.get('sounds').contains(id)) {\r\n            this.media.get('sounds').get(id).stop();\r\n            this.media.get('sounds').remove(id);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    removeAudio(id) {\r\n        if (this.media.get('audios').contains(id)) {\r\n            this.media.get('audios').get(id).stop();\r\n            this.media.get('audios').remove(id);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    removeVideo(id) {\r\n        if (this.media.get('videos').contains(id)) {\r\n            this.media.get('videos').get(id).stop();\r\n            this.media.get('videos').remove(id);\r\n        }\r\n        return this;\r\n    }\r\n}\r\n","import ArrayMap from \"utils/ArrayMap\";\r\nimport Vector2d from \"utils/Vector2d\";\r\n\r\n/**\r\n * @param e\r\n * @param {boolean} [enableCallback]\r\n * @returns {boolean}\r\n */\r\nvar checkKeyMap = function (e, enableCallback) {\r\n    if (enableCallback === undefined) enableCallback = true;\r\n\r\n    var j2d = e.data.manager.j2d,\r\n        manager = e.data.manager,\r\n        keyCode = e.which,\r\n        keyMap = e.data.manager.keyMap;\r\n\r\n    for (var index in keyMap) {\r\n        if (keyMap.hasOwnProperty(index)) {\r\n            var value = keyMap[index];\r\n            if (!$.isArray(value[0]) && value[0] === keyCode && !!value[1]) {\r\n                if (typeof value[1] === 'string') {\r\n                    value[1] = eval('(' + value[1] + ')');\r\n                }\r\n                if ((typeof value[1] === 'function') && enableCallback) {\r\n                    value[1](j2d, value[2]);\r\n                }\r\n                return true;\r\n            } else if ($.isArray(value[0])\r\n                && manager.data.keysPressed.equals(value[0]) && !!value[1]\r\n            ) {\r\n                if (typeof value[1] === 'string') {\r\n                    value[1] = eval('(' + value[1] + ')');\r\n                }\r\n                if (typeof value[1] === 'function' && enableCallback) {\r\n                    value[1](j2d, value[2]);\r\n                }\r\n                return true\r\n            }\r\n        }\r\n    }\r\n    return false\r\n};\r\nvar events = {\r\n    onMouseClick: function (e) {\r\n        var manager = e.data.manager;\r\n        if (!manager.data.enabled || !manager.j2d.isPlay || !manager.j2d.element.hasClass('active')) return true;\r\n        var keysPressed = manager.data.keysPressed;\r\n        var keyCode = getKey(DEPRECATED_InputManager.key, e.which) || 'KEY_UNKNOWN_' + e.which;\r\n        var mouse = manager.data.mouse;\r\n\r\n        if (e.data.event !== 2) {\r\n            if (e.data.event === 0) {\r\n                if (-1 === $.inArray(DEPRECATED_InputManager.key[keyCode], keysPressed)) {\r\n                    keysPressed.push(DEPRECATED_InputManager.key[keyCode]);\r\n\r\n                    if (manager.data.enableAdditionalData) {\r\n                        mouse.startPosition.x = e.pageX;\r\n                        mouse.startPosition.y = e.pageY;\r\n                        mouse.distance = 0;\r\n\r\n                        manager.data.timePressed = e.timeStamp;\r\n                    }\r\n                }\r\n                if (checkKeyMap(e, false) || manager.data.preventAll) {\r\n                    e.preventDefault();\r\n                }\r\n            } else {\r\n                if (checkKeyMap(e) || manager.data.preventAll) {\r\n                    e.preventDefault();\r\n                }\r\n                if (manager.data.enableAdditionalData) {\r\n                    mouse.previousDistance = mouse.distance;\r\n                    mouse.startPosition.x = 0;\r\n                    mouse.startPosition.y = 0;\r\n                }\r\n\r\n                keysPressed.splice(\r\n                    keysPressed.indexOf(DEPRECATED_InputManager.key[keyCode]), 1\r\n                );\r\n            }\r\n            manager.element.trigger(e.data.event === 0 ?\r\n                'mouseKeyDown' : 'mouseKeyUp', {keyCode: keyCode}\r\n            );\r\n        } else {\r\n            if (checkKeyMap(e, false)) {\r\n                e.preventDefault();\r\n            }\r\n        }\r\n    },\r\n\r\n    onMouseWheel: function (e) {\r\n        var manager = e.data.manager;\r\n        if (!manager.data.enabled || !manager.j2d.isPlay || !manager.j2d.element.hasClass('active')) return true;\r\n        var keysPressed = manager.data.keysPressed;\r\n        var keyCode = (e.originalEvent.wheelDelta / 120 > 0) ?\r\n            getKey(DEPRECATED_InputManager.key, 4) : getKey(DEPRECATED_InputManager.key, 5);\r\n\r\n        e.which = (e.originalEvent.wheelDelta / 120 > 0) ? 4 : 5;\r\n\r\n        if (-1 === $.inArray(DEPRECATED_InputManager.key[keyCode], keysPressed)) {\r\n            keysPressed.push(DEPRECATED_InputManager.key[keyCode]);\r\n        }\r\n\r\n        if (checkKeyMap(e) || manager.data.preventAll) {\r\n            e.preventDefault();\r\n            manager.fixMouseWheel();\r\n        }\r\n\r\n        manager.element.trigger('mouseWheel', {keyCode: keyCode});\r\n    },\r\n\r\n    mouseWheelCancel: function (keysPressed, keyCode) {\r\n        keysPressed.splice(\r\n            keysPressed.indexOf(DEPRECATED_InputManager.key[keyCode]), 1\r\n        );\r\n    },\r\n\r\n    onMouseMove: function (e) {\r\n        var manager = e.data.manager;\r\n        var mouse = e.data.manager.data.mouse;\r\n\r\n        manager.data.mouse.currentPosition.x = e.pageX;\r\n        manager.data.mouse.currentPosition.y = e.pageY;\r\n\r\n        if (e.data.manager.data.enableAdditionalData) {\r\n            mouse.distance = Math.sqrt(\r\n                Math.pow((mouse.currentPosition.x - mouse.startPosition.x), 2)\r\n                + Math.pow((mouse.currentPosition.y - mouse.startPosition.y), 2)\r\n            ).toFixed(1);\r\n        }\r\n    },\r\n\r\n    onKeyboardPress: function (e) {\r\n        var manager = e.data.manager;\r\n        if (!manager.data.enabled || !manager.j2d.isPlay || !manager.element.hasClass('active')) return true;\r\n        var keysPressed = manager.data.keysPressed;\r\n        var keyCode = getKey(DEPRECATED_InputManager.key, e.which) || 'KEY_UNKNOWN_' + e.which;\r\n        if (e.data.event === 2 && true === manager.data.writeMode) {\r\n            var char = String.fromCharCode(e.which || e.keyCode);\r\n            e.preventDefault();\r\n            manager.element.focus().trigger('keyboardCharPress', {\r\n                key: e.which || e.keyCode,\r\n                keyCode: keyCode,\r\n                char: char\r\n            });\r\n        }\r\n\r\n        if (e.data.event !== 2 && false === manager.data.writeMode) {\r\n            if (e.data.event === 0) {\r\n                if (-1 === $.inArray(DEPRECATED_InputManager.key[keyCode], keysPressed)) {\r\n                    keysPressed.push(DEPRECATED_InputManager.key[keyCode]);\r\n                    if (manager.data.enableAdditionalData) {\r\n                        manager.data.timePressed = e.timeStamp;\r\n                    }\r\n                }\r\n                if (checkKeyMap(e, false) || manager.data.preventAll) {\r\n                    e.preventDefault();\r\n                }\r\n            } else {\r\n                if (checkKeyMap(e) || manager.data.preventAll) {\r\n                    e.preventDefault();\r\n                }\r\n\r\n                keysPressed.splice(\r\n                    keysPressed.indexOf(DEPRECATED_InputManager.key[keyCode]), 1\r\n                );\r\n            }\r\n\r\n            manager.element.trigger(e.data.event === 0 ?\r\n                'keyboardKeyDown' : 'keyboardKeyUp', {keyCode: keyCode, key: e.which || e.keyCode}\r\n            );\r\n        }\r\n\r\n        if (e.data.event !== 2 && true === manager.data.writeMode) {\r\n            manager.element.trigger(e.data.event === 0 ?\r\n                'keyboardKeyDown' : 'keyboardKeyUp', {keyCode: keyCode, key: e.which || e.keyCode}\r\n            );\r\n        }\r\n    },\r\n\r\n    onTouchTap: function (e) {\r\n        var manager = e.data.manager;\r\n        if (!manager.data.enabled || !manager.j2d.isPlay || !manager.j2d.element.hasClass('active')) return true;\r\n        var keysPressed = manager.data.keysPressed;\r\n        var keyCode = getKey(DEPRECATED_InputManager.key, e.which + 1) || 'KEY_UNKNOWN_' + e.which;\r\n        var touch = e.originalEvent.touches[0] || e.originalEvent.changedTouches[0];\r\n        var mouse = manager.data.mouse;\r\n\r\n        if (e.data.event === 0) {\r\n            if (-1 === $.inArray(DEPRECATED_InputManager.key[keyCode], keysPressed)) {\r\n                keysPressed.push(DEPRECATED_InputManager.key[keyCode]);\r\n                if (manager.data.enableAdditionalData) {\r\n                    mouse.startPosition.x = touch.pageX;\r\n                    mouse.startPosition.y = touch.pageY;\r\n                    mouse.distance = 0;\r\n\r\n                    manager.data.timePressed = e.timeStamp;\r\n                }\r\n            }\r\n            if (checkKeyMap(e, false) || manager.data.preventAll) {\r\n                e.preventDefault();\r\n            }\r\n        } else {\r\n            if (checkKeyMap(e) || manager.data.preventAll) {\r\n                e.preventDefault();\r\n            }\r\n\r\n            if (manager.data.enableAdditionalData) {\r\n                mouse.previousDistance = mouse.distance;\r\n                mouse.startPosition.x = 0;\r\n                mouse.startPosition.y = 0;\r\n            }\r\n\r\n            keysPressed.splice(\r\n                keysPressed.indexOf(DEPRECATED_InputManager.key[keyCode]), 1\r\n            );\r\n        }\r\n\r\n        manager.element.trigger(e.data.event === 0 ?\r\n            'mouseKeyDown' : 'mouseKeyUp', {keyCode: keyCode}\r\n        );\r\n    },\r\n\r\n    onTouchMove: function (e) {\r\n        var touch = e.originalEvent.touches[0] || e.originalEvent.changedTouches[0];\r\n        var mouse = e.data.manager.data.mouse;\r\n\r\n        mouse.currentPosition.x = touch.pageX.toFixed(0);\r\n        mouse.currentPosition.y = touch.pageY.toFixed(0);\r\n\r\n        if (e.data.manager.data.enableAdditionalData) {\r\n            mouse.distance = Math.sqrt(\r\n                Math.pow((mouse.currentPosition.x - mouse.startPosition.x), 2)\r\n                + Math.pow((mouse.currentPosition.y - mouse.startPosition.y), 2)\r\n            ).toFixed(1);\r\n        }\r\n    }\r\n};\r\n\r\n/**\r\n * @param {DEPRECATED_InputManager} manager\r\n */\r\nvar bindEvents = function (manager) {\r\n    var selector = '[guid=' + manager.id + ']';\r\n\r\n    $(document).on('contextmenu', selector, {manager: manager, event: 2}, events.onMouseClick);\r\n    $(document).on('mousedown', selector, {manager: manager, event: 0}, events.onMouseClick);\r\n    $(document).on('mouseup', selector, {manager: manager, event: 1}, events.onMouseClick);\r\n    $(document).on('mousewheel', selector, {manager: manager}, events.onMouseWheel);\r\n    $(document).on('mousemove', selector, {manager: manager}, events.onMouseMove);\r\n\r\n    $(document).on('keydown', null, {manager: manager, event: 0}, events.onKeyboardPress);\r\n    $(document).on('keyup', null, {manager: manager, event: 1}, events.onKeyboardPress);\r\n    $(document).on('keypress', null, {manager: manager, event: 2}, events.onKeyboardPress);\r\n\r\n    $(document).on('touchstart', selector, {manager: manager, event: 0}, events.onTouchTap);\r\n    $(document).on('touchend', selector, {manager: manager, event: 1}, events.onTouchTap);\r\n    $(document).on('touchmove ', selector, {manager: manager}, events.onTouchMove);\r\n};\r\n\r\n/**\r\n * @param {DEPRECATED_InputManager} manager\r\n */\r\nvar unbindEvents = function (manager) {\r\n    var selector = '[guid=' + manager.id + ']';\r\n\r\n    $(document).off('contextmenu', selector, {manager: manager, event: 1}, events.onMouseClick);\r\n    $(document).off('mousedown', selector, {manager: manager, event: 0}, events.onMouseClick);\r\n    $(document).off('mouseup', selector, {manager: manager, event: 1}, events.onMouseClick);\r\n    $(document).off('mousewheel', selector, {manager: manager}, events.onMouseWheel);\r\n    $(document).off('mousemove', selector, {manager: manager}, events.onMouseMove);\r\n\r\n    $(document).off('keydown', null, {manager: manager, event: 0}, events.onKeyboardPress);\r\n    $(document).off('keyup', null, {manager: manager, event: 1}, events.onKeyboardPress);\r\n    $(document).off('keypress', null, {manager: manager, event: 2}, events.onKeyboardPress);\r\n\r\n    $(document).off('touchstart', selector, {manager: manager, event: 0}, events.onTouchTap);\r\n    $(document).off('touchend', selector, {manager: manager, event: 1}, events.onTouchTap);\r\n    $(document).off('touchmove ', selector, {manager: manager}, events.onTouchMove);\r\n};\r\n\r\n/**\r\n * @param {DEPRECATED_InputManager} manager\r\n * @param {Array.<number>|number[]} keyList\r\n * @returns {{keyList: Array.<number>|number[]|number, time: number}|boolean}\r\n */\r\nvar getPressData = function (manager, keyList) {\r\n    if (!manager.data.enableAdditionalData) return true;\r\n    return {\r\n        keyList: keyList,\r\n        time: Date.now() - manager.data.timePressed\r\n    };\r\n};\r\n\r\n/**\r\n * @param {Object} object\r\n * @param {number} value\r\n * @returns {T}\r\n */\r\nfunction getKey(object, value) {\r\n    return Object.keys(object).filter(function (key) {\r\n        return object[key] === value\r\n    })[0];\r\n}\r\n\r\n/**\r\n * @class DEPRECATED_InputManager\r\n * @exports module:io/DEPRECATED_InputManager\r\n *\r\n * @param {EngineJ2D} j2d\r\n * @constructor\r\n *\r\n * @type {DEPRECATED_InputManager.key} key\r\n */\r\nexport default class DEPRECATED_InputManager {\r\n    constructor(j2d) {\r\n        this.j2d = j2d;\r\n\r\n        /** @type string */\r\n        this.id = j2d.data.id;\r\n\r\n        /** @type Element|jQuery */\r\n        this.element = j2d.element;\r\n\r\n        this.data = {\r\n            mouse: {\r\n                startPosition: {\r\n                    x: 0,\r\n                    y: 0\r\n                },\r\n                currentPosition: {\r\n                    x: 0,\r\n                    y: 0\r\n                },\r\n                previousDistance: 0,\r\n                distance: 0\r\n            },\r\n            viewport: {\r\n                position: {\r\n                    x: 0,\r\n                    y: 0\r\n                }\r\n            },\r\n            enabled: false,\r\n            enableAdditionalData: false,\r\n            keysPressed: new ArrayMap(),\r\n            writeMode: false,\r\n            timePressed: 0,\r\n            preventAll: false,\r\n\r\n            cursor: {\r\n                enabled: false,\r\n                image: 'auto'\r\n            }\r\n        };\r\n\r\n        this.keyMap = {\r\n            //DEBUG_INFO: [[DEPRECATED_InputManager.key.KEY_CTRL, DEPRECATED_InputManager.key.KEY_F1], 'j2d.debug.toggleScreen', {}],\r\n            FULLSCREEN: [[DEPRECATED_InputManager.key.KEY_CTRL, DEPRECATED_InputManager.key.KEY_F11], 'j2d.scene.toggleFullScreen', {}]\r\n        };\r\n    }\r\n\r\n    /**\r\n     * @returns {DEPRECATED_InputManager}\r\n     */\r\n    init() {\r\n        if (!this.data.enabled && window.j2dPlugin.pluginInit) {\r\n            bindEvents(this);\r\n\r\n            this.data.enabled = true;\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @returns {boolean}\r\n     */\r\n    update() {\r\n        if (!this.data.enabled) return false;\r\n\r\n        var dX = this.j2d.scene.canvas.offsetWidth / this.j2d.scene.data.width,\r\n            dY = this.j2d.scene.canvas.offsetHeight / this.j2d.scene.data.height,\r\n            x = this.data.mouse.currentPosition.x / dX,\r\n            y = this.data.mouse.currentPosition.y / dY;\r\n\r\n        var offset = this.element.offset();\r\n\r\n        this.data.viewport.x = this.j2d.scene.viewport.x + x - offset.left;\r\n        this.data.viewport.y = this.j2d.scene.viewport.y + y - offset.top;\r\n        return true;\r\n    }\r\n\r\n    /**\r\n     * @returns {DEPRECATED_InputManager}\r\n     */\r\n    flush() {\r\n        this.data.keysPressed.length = 0;\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @returns {DEPRECATED_InputManager}\r\n     */\r\n    clear() {\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @returns {DEPRECATED_InputManager}\r\n     */\r\n    fixMouseWheel() {\r\n        var keyPressed = this.data.keysPressed;\r\n        if (-1 !== $.inArray(DEPRECATED_InputManager.key.SCROLL_MOUSE_UP, keyPressed)) {\r\n            events.mouseWheelCancel(keyPressed, DEPRECATED_InputManager.key.SCROLL_MOUSE_UP);\r\n        } else if (-1 !== $.inArray(DEPRECATED_InputManager.key.SCROLL_MOUSE_DOWN, keyPressed)) {\r\n            events.mouseWheelCancel(keyPressed, DEPRECATED_InputManager.key.SCROLL_MOUSE_DOWN);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @returns {DEPRECATED_InputManager}\r\n     */\r\n    enable() {\r\n        if (!this.data.enabled) {\r\n            //bindEvents(this);\r\n            this.data.enabled = false;\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @returns {DEPRECATED_InputManager}\r\n     */\r\n    disable() {\r\n        if (this.data.enabled) {\r\n            //unbindEvents(this);\r\n            this.data.enabled = false;\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {string} newKeyMap\r\n     * @returns {string}\r\n     */\r\n    load(newKeyMap) {\r\n        var oldKeyMap = JSON.stringify(this.keyMap);\r\n        this.keyMap = JSON.parse(newKeyMap);\r\n        return oldKeyMap;\r\n    }\r\n\r\n    /**\r\n     * @returns {string}\r\n     */\r\n    save() {\r\n        return JSON.stringify(this.keyMap);\r\n    }\r\n\r\n    /**\r\n     * KeyMap Manager\r\n     *\r\n     * @param mapObject\r\n     * @returns {DEPRECATED_InputManager}\r\n     */\r\n    setKeys(mapObject) {\r\n        this.keyMap = $.extend(true, {}, this.keyMap, mapObject);\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @returns {{current: number, previous: number}}\r\n     */\r\n    getMouseMoveDistance() {\r\n        if (!this.data.enableAdditionalData) return 0;\r\n        return {current: this.data.mouse.distance, previous: this.data.mouse.previousDistance};\r\n    }\r\n\r\n    /* +Input Checkers **/\r\n    /**\r\n     * @param {Array.<number>|number[]|number} keyList\r\n     * @returns {boolean}\r\n     */\r\n    checkPressedKeyList(keyList) {\r\n        if ($.isArray(keyList)) {\r\n            if (keyList.length !== this.data.keysPressed.length) {\r\n                return false;\r\n            } else if (this.data.keysPressed.equals(keyList)) {\r\n                this.fixMouseWheel();\r\n                return getPressData(this, keyList);\r\n            }\r\n            this.fixMouseWheel();\r\n            return false;\r\n        }\r\n        //if (!this.data.keysPressed.equals([])) console.log(this.data.keysPressed);\r\n        if (isNaN(keyList)) return false;\r\n        if (-1 !== this.data.keysPressed.indexOf(keyList)) {\r\n            this.fixMouseWheel();\r\n            return getPressData(this, keyList);\r\n        }\r\n        this.fixMouseWheel();\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * @param {string} key\r\n     * @returns {boolean}\r\n     */\r\n    checkPressedKeyMap(key) {\r\n        if (this.keyMap[key] === undefined) return false;\r\n        var keyList = this.keyMap[key][0];\r\n\r\n        return this.checkPressedKeyList(keyList);\r\n    }\r\n\r\n    getPosition() {\r\n        return new Vector2d(this.data.viewport.x + 0.5, this.data.viewport.y + 0.3);\r\n    }\r\n\r\n//onNode (id) {\r\n//    if (!id.layer.visible) return false;\r\n//    return (this.data.viewport.x > id.options.position.x && this.data.viewport.x < id.options.position.x + id.options.size.x) &&\r\n//        (this.data.viewport.y > id.options.position.y && this.data.viewport.y < id.options.position.y + id.options.size.y);\r\n//}\r\n    /* -Input Checkers **/\r\n\r\n    /* +Input Write Mode **/\r\n    /**\r\n     * @param {boolean} mode\r\n     * @returns {DEPRECATED_InputManager}\r\n     */\r\n    setWriteMode(mode) {\r\n        this.data.writeMode = !!mode;\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @returns {boolean}\r\n     */\r\n    isWriteMode() {\r\n        return !!this.data.writeMode;\r\n    }\r\n\r\n    /* -Input Write Mode **/\r\n\r\n    /**\r\n     * @param {string} image\r\n     * @returns {DEPRECATED_InputManager}\r\n     */\r\n    setCursorImage(image) {\r\n        this.data.cursor.image = 'url(\"' + image + '\"), auto';\r\n        $(this.element).css('cursor', this.data.cursor.image);\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {boolean} enable\r\n     * @returns {DEPRECATED_InputManager}\r\n     */\r\n    toggleCursor(enable) {\r\n        if (enable !== undefined) {\r\n            this.data.cursor.enable = !!enable;\r\n        } else {\r\n            this.data.cursor.enable = !this.data.cursor.enable;\r\n        }\r\n\r\n        if (!this.data.cursor.enable) {\r\n            this.data.cursor.image = $(this.j2d.element).css('cursor');\r\n            $(this.element).css('cursor', 'none');\r\n        } else {\r\n            $(this.element).css('cursor', this.data.cursor.image);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @returns {boolean}\r\n     */\r\n    isCursorVisible() {\r\n        return !!this.data.cursor.enable;\r\n    }\r\n\r\n    /** -Cursor **/\r\n\r\n    /**\r\n     * Static keys arrayList\r\n     *\r\n     * @readonly\r\n     * @enum {number}\r\n     */\r\n    static key = {\r\n        KEY_MOUSE_LEFT: 1,\r\n        KEY_MOUSE_MIDDLE: 2,\r\n        KEY_MOUSE_RIGHT: 3,\r\n\r\n        SCROLL_MOUSE_UP: 4,\r\n        SCROLL_MOUSE_DOWN: 5,\r\n\r\n        KEY_BACKSPACE: 8,\r\n        KEY_TAB: 9,\r\n        KEY_ENTER: 13,\r\n        KEY_SHIFT: 16,\r\n        KEY_CTRL: 17,\r\n        KEY_ALT: 18,\r\n        KEY_PAUSE: 19,\r\n        KEY_BREAK: 19,\r\n        KEY_CAPS_LOCK: 20,\r\n        KEY_ESCAPE: 27,\r\n        KEY_SPACE_BAR: 32,\r\n        KEY_PAGE_UP: 33,\r\n        KEY_PAGE_DOWN: 34,\r\n        KEY_END: 35,\r\n        KEY_HOME: 36,\r\n        KEY_LEFT_ARROW: 37,\r\n        KEY_UP_ARROW: 38,\r\n        KEY_RIGHT_ARROW: 39,\r\n        KEY_DOWN_ARROW: 40,\r\n        KEY_INSERT: 45,\r\n        KEY_DELETE: 46,\r\n        KEY_0: 48,\r\n        KEY_1: 49,\r\n        KEY_2: 50,\r\n        KEY_3: 51,\r\n        KEY_4: 52,\r\n        KEY_5: 53,\r\n        KEY_6: 54,\r\n        KEY_7: 55,\r\n        KEY_8: 56,\r\n        KEY_9: 57,\r\n        KEY_A: 65,\r\n        KEY_B: 66,\r\n        KEY_C: 67,\r\n        KEY_D: 68,\r\n        KEY_E: 69,\r\n        KEY_F: 70,\r\n        KEY_G: 71,\r\n        KEY_H: 72,\r\n        KEY_I: 73,\r\n        KEY_J: 74,\r\n        KEY_K: 75,\r\n        KEY_L: 76,\r\n        KEY_M: 77,\r\n        KEY_N: 78,\r\n        KEY_O: 79,\r\n        KEY_P: 80,\r\n        KEY_Q: 81,\r\n        KEY_R: 82,\r\n        KEY_S: 83,\r\n        KEY_T: 84,\r\n        KEY_U: 85,\r\n        KEY_V: 86,\r\n        KEY_W: 87,\r\n        KEY_X: 88,\r\n        KEY_Y: 89,\r\n        KEY_Z: 90,\r\n        KEY_LEFT_WINDOW_KEY: 91,\r\n        KEY_RIGHT_WINDOW_KEY: 92,\r\n        KEY_SELECT_KEY: 93,\r\n        KEY_NUMPAD_0: 96,\r\n        KEY_NUMPAD_1: 97,\r\n        KEY_NUMPAD_2: 98,\r\n        KEY_NUMPAD_3: 99,\r\n        KEY_NUMPAD_4: 100,\r\n        KEY_NUMPAD_5: 101,\r\n        KEY_NUMPAD_6: 102,\r\n        KEY_NUMPAD_7: 103,\r\n        KEY_NUMPAD_8: 104,\r\n        KEY_NUMPAD_9: 105,\r\n        KEY_MULTIPLY: 106,\r\n        KEY_ADD: 107,\r\n        KEY_SUBTRACT: 109,\r\n        KEY_DECIMAL_POINT: 110,\r\n        KEY_DIVIDE: 111,\r\n        KEY_F1: 112,\r\n        KEY_F2: 113,\r\n        KEY_F3: 114,\r\n        KEY_F4: 115,\r\n        KEY_F5: 116,\r\n        KEY_F6: 117,\r\n        KEY_F7: 118,\r\n        KEY_F8: 119,\r\n        KEY_F9: 120,\r\n        KEY_F10: 121,\r\n        KEY_F11: 122,\r\n        KEY_F12: 123,\r\n        KEY_NUM_LOCK: 144,\r\n        KEY_SCROLL_LOCK: 145,\r\n        KEY_SEMI_COLON: 186,\r\n        KEY_EQUAL_SIGN: 187,\r\n        KEY_COMMA: 188,\r\n        KEY_DASH: 189,\r\n        KEY_PERIOD: 190,\r\n        KEY_FORWARD_SLASH: 191,\r\n        KEY_GRAVE_ACCENT: 192,\r\n        KEY_OPEN_BRACKET: 219,\r\n        KEY_BACK_SLASH: 220,\r\n        KEY_CLOSE_BRACKET: 221,\r\n        KEY_SINGLE_QUOTE: 222,\r\n        KEY_LEFT_COMMAND: 224,\r\n        KEY_RIGHT_COMMAND: 224\r\n    };\r\n}\r\n","export default {\r\n    KEY_MOUSE_LEFT: 1,\r\n    KEY_MOUSE_MIDDLE: 2,\r\n    KEY_MOUSE_RIGHT: 3,\r\n\r\n    SCROLL_MOUSE_UP: 4,\r\n    SCROLL_MOUSE_DOWN: 5,\r\n\r\n    KEY_BACKSPACE: 8,\r\n    KEY_TAB: 9,\r\n    KEY_ENTER: 13,\r\n    KEY_SHIFT: 16,\r\n    KEY_CTRL: 17,\r\n    KEY_ALT: 18,\r\n    KEY_PAUSE: 19,\r\n    KEY_BREAK: 19,\r\n    KEY_CAPS_LOCK: 20,\r\n    KEY_ESCAPE: 27,\r\n    KEY_SPACE_BAR: 32,\r\n    KEY_PAGE_UP: 33,\r\n    KEY_PAGE_DOWN: 34,\r\n    KEY_END: 35,\r\n    KEY_HOME: 36,\r\n    KEY_LEFT_ARROW: 37,\r\n    KEY_UP_ARROW: 38,\r\n    KEY_RIGHT_ARROW: 39,\r\n    KEY_DOWN_ARROW: 40,\r\n    KEY_INSERT: 45,\r\n    KEY_DELETE: 46,\r\n    KEY_0: 48,\r\n    KEY_1: 49,\r\n    KEY_2: 50,\r\n    KEY_3: 51,\r\n    KEY_4: 52,\r\n    KEY_5: 53,\r\n    KEY_6: 54,\r\n    KEY_7: 55,\r\n    KEY_8: 56,\r\n    KEY_9: 57,\r\n    KEY_A: 65,\r\n    KEY_B: 66,\r\n    KEY_C: 67,\r\n    KEY_D: 68,\r\n    KEY_E: 69,\r\n    KEY_F: 70,\r\n    KEY_G: 71,\r\n    KEY_H: 72,\r\n    KEY_I: 73,\r\n    KEY_J: 74,\r\n    KEY_K: 75,\r\n    KEY_L: 76,\r\n    KEY_M: 77,\r\n    KEY_N: 78,\r\n    KEY_O: 79,\r\n    KEY_P: 80,\r\n    KEY_Q: 81,\r\n    KEY_R: 82,\r\n    KEY_S: 83,\r\n    KEY_T: 84,\r\n    KEY_U: 85,\r\n    KEY_V: 86,\r\n    KEY_W: 87,\r\n    KEY_X: 88,\r\n    KEY_Y: 89,\r\n    KEY_Z: 90,\r\n    KEY_LEFT_WINDOW_KEY: 91,\r\n    KEY_RIGHT_WINDOW_KEY: 92,\r\n    KEY_SELECT_KEY: 93,\r\n    KEY_NUMPAD_0: 96,\r\n    KEY_NUMPAD_1: 97,\r\n    KEY_NUMPAD_2: 98,\r\n    KEY_NUMPAD_3: 99,\r\n    KEY_NUMPAD_4: 100,\r\n    KEY_NUMPAD_5: 101,\r\n    KEY_NUMPAD_6: 102,\r\n    KEY_NUMPAD_7: 103,\r\n    KEY_NUMPAD_8: 104,\r\n    KEY_NUMPAD_9: 105,\r\n    KEY_MULTIPLY: 106,\r\n    KEY_ADD: 107,\r\n    KEY_SUBTRACT: 109,\r\n    KEY_DECIMAL_POINT: 110,\r\n    KEY_DIVIDE: 111,\r\n    KEY_F1: 112,\r\n    KEY_F2: 113,\r\n    KEY_F3: 114,\r\n    KEY_F4: 115,\r\n    KEY_F5: 116,\r\n    KEY_F6: 117,\r\n    KEY_F7: 118,\r\n    KEY_F8: 119,\r\n    KEY_F9: 120,\r\n    KEY_F10: 121,\r\n    KEY_F11: 122,\r\n    KEY_F12: 123,\r\n    KEY_NUM_LOCK: 144,\r\n    KEY_SCROLL_LOCK: 145,\r\n    KEY_SEMI_COLON: 186,\r\n    KEY_EQUAL_SIGN: 187,\r\n    KEY_COMMA: 188,\r\n    KEY_DASH: 189,\r\n    KEY_PERIOD: 190,\r\n    KEY_FORWARD_SLASH: 191,\r\n    KEY_GRAVE_ACCENT: 192,\r\n    KEY_OPEN_BRACKET: 219,\r\n    KEY_BACK_SLASH: 220,\r\n    KEY_CLOSE_BRACKET: 221,\r\n    KEY_SINGLE_QUOTE: 222,\r\n    KEY_LEFT_COMMAND: 224,\r\n    KEY_RIGHT_COMMAND: 224,\r\n\r\n    //fix mouse with extra buttons\r\n    KEY_MOUSE_3: 403,\r\n    KEY_MOUSE_4: 404,\r\n    KEY_MOUSE_5: 405,\r\n    KEY_MOUSE_6: 406,\r\n    KEY_MOUSE_7: 407,\r\n    KEY_MOUSE_8: 408,\r\n    KEY_MOUSE_9: 409,\r\n    KEY_MOUSE_10: 410\r\n};\r\n","import PrototypeInterface from \"api/PrototypeInterface\";\r\n\r\n/**\r\n * PrototypeObject\r\n * @constructor\r\n */\r\nexport default class PrototypeObject {\r\n    static interfaces = [];\r\n\r\n    constructor() {\r\n        if (this.constructor.interfaces === undefined) this.constructor.interfaces = [];\r\n\r\n        let scope = [];\r\n\r\n        /**\r\n         TODO:: Object.getPrototypeOf(obj),\r\n         @link https://developer.mozilla.org/ru/docs/Web/JavaScript/Reference/Global_Objects/Object/getPrototypeOf\r\n         */\r\n        let implement = function (object) {\r\n            if (object.__proto__.constructor.name === 'Object'\r\n                || object.__proto__.constructor === undefined\r\n                || object.__proto__.constructor.interfaces.length < 1\r\n            ) return;\r\n\r\n            for (let i = 0; i < object.__proto__.constructor.interfaces.length; i++) {\r\n                if (!scope.includes(object.__proto__.constructor.interfaces[i].name)) {\r\n                    scope.push(object.__proto__.constructor.interfaces[i].name);\r\n                    this.constructor.interfaces.push(object.__proto__.constructor.interfaces[i]);\r\n                }\r\n            }\r\n\r\n            implement(object.__proto__);\r\n        }.bind(this);\r\n\r\n        implement(this.__proto__);\r\n    }\r\n\r\n    instanceOf(interfaces) {\r\n        let i = 0;\r\n        if (typeof interfaces === 'object' && interfaces instanceof Array) {\r\n            for (i = 0; i < interfaces.length; i++) {\r\n                if (typeof interfaces[i] === 'function' && new (interfaces[i]) instanceof PrototypeInterface) {\r\n                    if (this.constructor.interfaces.includes(interfaces[i]) === false) return false;\r\n                } else if (typeof interfaces[i] === 'function') {\r\n                    if (!(this instanceof interfaces[i])) return false;\r\n                } else throw new Error('Error. \"' + interfaces[i].constructor.name + '\" is not interface!');\r\n            }\r\n        } else if (typeof interfaces === 'function' && new (interfaces) instanceof PrototypeInterface) {\r\n            return this.constructor.interfaces.includes(interfaces);\r\n        } else if (typeof interfaces === 'function') {\r\n            if (!(this instanceof interfaces)) return false;\r\n        } else {\r\n            throw new Error('Error. \"' + interfaces.constructor.name + '\" is not interface!');\r\n        }\r\n        return true;\r\n    }\r\n\r\n    toString() {\r\n        return this.__proto__.constructor.name;\r\n    }\r\n}\r\n","/**\r\n * PrototypeInterface\r\n * @constructor\r\n */\r\nexport default class PrototypeInterface {\r\n    static interfaces = [PrototypeInterface];\r\n\r\n    instanceOf(interfaces) {\r\n        let i = 0, j = 0;\r\n        if (typeof interfaces === 'object' && interfaces instanceof Array) {\r\n            for (i = 0; i < interfaces.length; i++) {\r\n                if (typeof interfaces[i] === 'function' && new (interfaces[i]) instanceof PrototypeInterface) {\r\n                    for (j = 0; j < this.constructor.interfaces.length; j++) {\r\n                        if (!(new (this.constructor.interfaces[j]) instanceof interfaces[i])) return false;\r\n                    }\r\n                } else throw new Error('Error. \"' + interfaces[i].constructor.name + '\" is not interface!');\r\n            }\r\n        } else if (typeof interfaces === 'function' && new (interfaces) instanceof PrototypeInterface) {\r\n            for (i = 0; i < this.constructor.interfaces.length; i++) {\r\n                if (!(new (this.constructor.interfaces[i]) instanceof interfaces)) return false;\r\n            }\r\n        } else {\r\n            throw new Error('Error. \"' + interfaces.constructor.name + '\" is not interface!');\r\n        }\r\n        return true;\r\n    }\r\n}\r\n","import PrototypeObject from \"api/PrototypeObject\";\r\nimport IHandler from \"api/interfaces/IHandler\";\r\n\r\n/**\r\n * Handler\r\n * @constructor\r\n */\r\nexport default class Handler extends PrototypeObject {\r\n    static interfaces = [IHandler];\r\n\r\n    _isEnabled = false;\r\n\r\n    events = null;\r\n\r\n    constructor() {\r\n        super();\r\n    }\r\n\r\n    init(eventHandler) {\r\n        if (eventHandler !== undefined) {\r\n            this.events = eventHandler;\r\n        }\r\n        return this;\r\n    };\r\n\r\n    get isEnabled() {\r\n        return this._isEnabled;\r\n    }\r\n\r\n    enable() {\r\n        this._isEnabled = true;\r\n        return this;\r\n    };\r\n\r\n    disable() {\r\n        this._isEnabled = false;\r\n        return this;\r\n    };\r\n\r\n    toggle(status) {\r\n        if (status === undefined) status = !this.isEnabled;\r\n        if (status) {\r\n            this.enable();\r\n        } else {\r\n            this.disable();\r\n        }\r\n        return this;\r\n    };\r\n}\r\n","import Handler from \"api/Handler\";\r\nimport IEngineComponent from \"api/interfaces/IEngineComponent\";\r\n\r\n/**\r\n * EngineComponent\r\n * @constructor\r\n *\r\n * @interface IEngineComponent\r\n */\r\nexport default class EngineComponent extends Handler {\r\n    static interfaces = [IEngineComponent];\r\n\r\n    constructor() {\r\n        super();\r\n    }\r\n};\r\n\r\n","/**\r\n * Device\r\n * @constructor\r\n */\r\nexport default class Device {\r\n    input = undefined;\r\n\r\n    constructor(input) {\r\n        if (input !== undefined) this.input = input;\r\n    }\r\n\r\n    enable() {\r\n        return true;\r\n    };\r\n\r\n    disable() {\r\n        return true;\r\n    };\r\n\r\n    init(input) {\r\n        if (input !== undefined && this.input === undefined) this.input = input;\r\n        return false;\r\n    };\r\n\r\n    update() {\r\n        return true;\r\n    };\r\n\r\n    clear() {\r\n        return true;\r\n    };\r\n\r\n    toString() {\r\n        return function (device) {\r\n            return (device[0].toLowerCase() + device.slice(1))\r\n        }(this.constructor.DeviceName || this.constructor.name);\r\n    };\r\n};\r\n","import InvalidArgumentException from \"exceptions/InvalidArgumentException\";\r\n\r\n/**\r\n * @exports module:objects/Mutable\r\n */\r\nexport default class Mutable extends Object {\r\n    __$MutableOptions;\r\n\r\n    constructor(object, options) {\r\n        if (object !== undefined && typeof object !== 'object') {\r\n            throw new InvalidArgumentException('Attribute object type must be instance of Object.');\r\n        }\r\n\r\n        if (options === undefined) options = {};\r\n        if (object === undefined) object = {};\r\n\r\n        super(object);\r\n\r\n        this.__$MutableOptions = options;\r\n    }\r\n\r\n    extend(...args) {\r\n        Mutable.extend(true, typeof this === Array ? [] : {}, this, ...args);\r\n    }\r\n\r\n    static extend(...args) {\r\n        let deepness = false;\r\n        if (typeof args[0] === 'boolean') {\r\n            deepness = args[0];\r\n            args.splice(0, 1);\r\n        }\r\n\r\n        let out = args[0] || function () {\r\n                if (args[1] !== undefined && args[1] !== null && typeof args[1] === 'object') {\r\n                    return Object.create(args[1])\r\n                }\r\n                return {};\r\n            }();\r\n\r\n        for (let i = 1; i < args.length; i++) {\r\n            /** @type {Object} */\r\n            let object = args[i];\r\n\r\n            if (!object) continue;\r\n\r\n            for (let key in object) {\r\n                if (object.hasOwnProperty(key)) {\r\n                    if (typeof object[key] === 'object' && object[key] !== null) {\r\n                        out[key] = deepness ? Mutable.extend(deepness, out[key], object[key]) : object[key];\r\n                    } else {\r\n                        out[key] = object[key];\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        return out;\r\n    }\r\n}\r\n","import EngineComponent from \"api/EngineComponent\";\r\n\r\nexport default class ViewportHandler extends EngineComponent {\r\n    get viewport() {\r\n        return {x: 0, y: 0, z: 0}\r\n    }\r\n}\r\n","import EngineComponent from \"api/EngineComponent\";\r\nimport Layer from \"layers/Layer\";\r\nimport BaseNode from \"nodes/BaseNode\";\r\nimport Mutable from \"objects/Mutable\";\r\n\r\nexport default class LayersHandler extends EngineComponent {\r\n    /**\r\n     * @type {{}}\r\n     */\r\n    static defaults = {};\r\n\r\n    /**\r\n     * @type {LayersHandler.defaults|{}}\r\n     */\r\n    _data;\r\n\r\n    /** @type {Layer} */\r\n    _layers = new Layer('global');\r\n\r\n    constructor() {\r\n        super();\r\n        this.add(new Layer('main'));\r\n    }\r\n\r\n    init(eventHandler, options) {\r\n        super.init(eventHandler);\r\n        this._data = Mutable.extend(true, {}, LayersHandler.defaults, options);\r\n    }\r\n\r\n    get layers() {\r\n        return this._layers;\r\n    }\r\n\r\n    get(key) {\r\n        this._layers.get(key);\r\n    }\r\n\r\n    has(key) {\r\n        this._layers.has(key);\r\n    }\r\n\r\n    add(node, index) {\r\n        if (node.instanceOf(BaseNode)) {\r\n            this._layers.add(node, index);\r\n        }\r\n    }\r\n\r\n    remove(node) {\r\n        if (node.instanceOf(BaseNode)) {\r\n            this._layers.remove(node);\r\n        }\r\n    }\r\n}\r\n","export default class SystemConsole {\r\n    css = (color) => {\r\n        return 'background: ' + color + ';' +\r\n            'background-repeat: no-repeat;' +\r\n            'color: #1df9a8;' +\r\n            'line-height: 16px;' +\r\n            'padding: 1px 0;' +\r\n            'margin: 0;' +\r\n            'user-select: none;' +\r\n            '-webkit-user-select: none;' +\r\n            '-moz-user-select: none;';\r\n    };\r\n\r\n    link = (color) => {\r\n        return 'background: ' + color + ';' +\r\n            'background-repeat: no-repeat;' +\r\n            'font-size: 12px;' +\r\n            'color: #446d96;' +\r\n            'line-height: 14px';\r\n    };\r\n\r\n    logSystem(message, link) {\r\n        return console.log(\"%c %c %c %s %c %c %c %c%s\",\r\n            this.css('#5C6166'), this.css('#4F5357'),\r\n            this.css('#313335'), message,\r\n            this.css('#4F5357'), this.css('#5C6166'),\r\n            this.link('none'), this.link('none'), link\r\n        );\r\n    }\r\n\r\n    log(message, level) {\r\n        let css = '';\r\n        if (typeof level === 'string') level = level.toLowerCase();\r\n        switch (level) {\r\n            case 'info':\r\n                level = 'INFO';\r\n                css = 'background: #308AE4; color: #fff; padding: 1px 4px';\r\n                break;\r\n            case 'warn':\r\n            case 'warning':\r\n                level = 'WARNING';\r\n                css = 'background: #f7a148; color: #fff; padding: 1px 4px';\r\n                break;\r\n            case 'error':\r\n                level = 'ERROR';\r\n                css = 'background: #DB5252; color: #fff; padding: 1px 4px';\r\n                break;\r\n            case 'network':\r\n                level = 'NETWORK';\r\n                css = 'background: #7D2998; color: #fff; padding: 1px 4px';\r\n                break;\r\n            case 'debug':\r\n            case undefined:\r\n            default:\r\n                level = 'DEBUG';\r\n                css = 'background: #ADADAD; color: #fff; padding: 1px 4px';\r\n        }\r\n        return console.log(\"%c%s\", css, level, message);\r\n    };\r\n}\r\n\r\n","import Vector2dInteger from \"utils/Vector2dInteger\";\r\n/**\r\n * Class utility for get system browser window size\r\n *\r\n * @class Device\r\n * @exports module:utils/Device\r\n *\r\n * @constructor\r\n */\r\nexport default class Device {\r\n    constructor() {\r\n        let documentWidth = parseInt(Math.max(\r\n            document.documentElement['clientWidth'],\r\n            document.body['scrollWidth'],\r\n            document.documentElement['scrollWidth'],\r\n            document.body['offsetWidth'],\r\n            document.documentElement['offsetWidth']\r\n        ));\r\n\r\n        let documentHeight = parseInt(Math.max(\r\n            document.documentElement['clientHeight'],\r\n            document.body['scrollHeight'],\r\n            document.documentElement['scrollHeight'],\r\n            document.body['offsetHeight'],\r\n            document.documentElement['offsetHeight']\r\n        ));\r\n\r\n        this.width = documentWidth < parseInt(screen.width) ? documentWidth : parseInt(screen.width);\r\n        this.height = documentHeight < parseInt(screen.height) ? documentHeight : parseInt(screen.height);\r\n    }\r\n\r\n    /**\r\n     * @returns {Device}\r\n     */\r\n    onResize() {\r\n        this.width = window.innerWidth;\r\n        this.height = window.innerHeight;\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @returns {number}\r\n     */\r\n    getWidth() {\r\n        return this.width;\r\n    }\r\n\r\n    /**\r\n     * @returns {number}\r\n     */\r\n    getHeight() {\r\n        return this.height;\r\n    }\r\n\r\n    /**\r\n     * @returns {Vector2d}\r\n     */\r\n    getSize() {\r\n        return new Vector2dInteger(this.width, this.height);\r\n    }\r\n}\r\n","import EngineComponent from \"api/EngineComponent\";\r\nimport InvalidArgumentException from \"exceptions/InvalidArgumentException\";\r\nimport IEngineComponent from \"api/interfaces/IEngineComponent\";\r\nimport Mutable from \"objects/Mutable\";\r\n\r\nexport default class SceneHandler extends EngineComponent {\r\n    /**\r\n     * @type {{\r\n        * width: number|string,\r\n        * height: number|string,\r\n        * visible: boolean|string,\r\n        * position: string,\r\n        * top: number|string,\r\n        * bottom: number|string,\r\n        * left: number|string,\r\n        * right: number|string,\r\n        * zIndex: number|string,\r\n        * opacity: number|string,\r\n        * backgroundColor: null|string,\r\n        * smoothing: boolean\r\n        * }}\r\n     */\r\n    static defaults = {\r\n        width: 0,\r\n        height: 0,\r\n\r\n        visible: true,\r\n        position: 'absolute',\r\n        top: 0,\r\n        bottom: 'auto',\r\n        left: 0,\r\n        right: 'auto',\r\n        zIndex: 1000,\r\n        opacity: 1.0,\r\n        backgroundColor: null,\r\n\r\n        smoothing: false\r\n    };\r\n\r\n    /** @type {SceneHandler.defaults|{components: {\r\n        * LayersHandler: IEngineComponent|EngineComponent|LayersHandler,\r\n        * ViewportHandler: IEngineComponent|EngineComponent|ViewportHandler\r\n        * }}}\r\n     */\r\n    _data = {\r\n        components: {\r\n            LayersHandler: null,\r\n            ViewportHandler: null\r\n        }\r\n    };\r\n\r\n    _engine;\r\n\r\n    _element;\r\n    _context;\r\n\r\n    constructor() {\r\n        super();\r\n    }\r\n\r\n    get layers() {\r\n        return this.LayersHandler.layers;\r\n    }\r\n\r\n    /**\r\n     * @return {LayersHandler|null}\r\n     */\r\n    get LayersHandler() {\r\n        return this._data.components.LayersHandler;\r\n    }\r\n\r\n    /**\r\n     * @param {LayersHandler|null} handler\r\n     */\r\n    set LayersHandler(handler) {\r\n        if (!handler.instanceOf(IEngineComponent))\r\n            throw new InvalidArgumentException('Handler not implements IEngineComponent');\r\n        return this._data.components.LayersHandler = handler;\r\n    }\r\n\r\n    get viewport() {\r\n        return this.ViewportHandler.viewport;\r\n    }\r\n\r\n    /**\r\n     * @return {ViewportHandler|null}\r\n     */\r\n    get ViewportHandler() {\r\n        return this._data.components.ViewportHandler;\r\n    }\r\n\r\n    /**\r\n     * @param {ViewportHandler|null} handler\r\n     */\r\n    set ViewportHandler(handler) {\r\n        if (!handler.instanceOf(IEngineComponent))\r\n            throw new InvalidArgumentException('Handler not implements IEngineComponent');\r\n        return this._data.components.ViewportHandler = handler;\r\n    }\r\n\r\n    init(eventHandler, engine, options) {\r\n        super.init(eventHandler);\r\n\r\n        if (options && typeof options === 'object') this.options = options;\r\n        options = Mutable.extend(true, {}, SceneHandler.defaults, options);\r\n        if (options.components !== undefined) delete options.components;\r\n\r\n        this._engine = engine;\r\n        this._data = Mutable.extend(true, {}, this._data, options);\r\n\r\n        this.initCanvas();\r\n    }\r\n\r\n    initCanvas() {\r\n        const $ = `.j2d[guid=\"${this._engine.guid}\"]`;\r\n        let node = document.querySelector($);\r\n        if (node !== null) {\r\n            if (node.nodeName === 'DIV') {\r\n                let nodes = document.querySelectorAll($ + ' canvas');\r\n                if (nodes.length === 0) {\r\n                    let canvas = window.document.createElement('canvas');\r\n                    node.appendChild(canvas);\r\n                    nodes = [canvas];\r\n                } else if (nodes.length > 1) {\r\n                    nodes.forEach((_node, i) => {\r\n                        if (i !== 0) node.removeChild(_node);\r\n                    });\r\n                }\r\n                node = nodes[0];\r\n            }\r\n\r\n            if (node.nodeName === 'CANVAS') {\r\n                node.width = this._data.width;\r\n                node.height = this._data.height;\r\n                node.style.zIndex = this._data.zIndex;\r\n                node.style.position = this._data.position;\r\n\r\n                node.style.left = this._data.left;\r\n                node.style.right = this._data.right;\r\n                node.style.top = this._data.top;\r\n                node.style.bottom = this._data.bottom;\r\n\r\n                node.style.backgroundColor = this._data.backgroundColor;\r\n\r\n                this._context = node.getContext('2d');\r\n\r\n                if (!this._data.smoothing) {\r\n                    this._disableSmoothing(this._context);\r\n                }\r\n\r\n                this._context.shadowColor = 'rgba(0, 0, 0, 0)';\r\n\r\n                this._element = node;\r\n\r\n                this._engine.log(`Find scene with GUID \"${this._engine.guid}\"`, 'info');\r\n            }\r\n        }\r\n    }\r\n\r\n    _disableSmoothing() {\r\n        let chrome = window.navigator.userAgent.match(/Chrom(e|ium)\\/([0-9]+)\\./);\r\n        let version = chrome ? parseInt(chrome[2], 10) : false;\r\n\r\n        this._context['imageSmoothingEnabled'] = false;\r\n        this._context['mozImageSmoothingEnabled'] = false;\r\n        this._context['oImageSmoothingEnabled'] = false;\r\n        if (version && version <= 29) {\r\n            this._context['webkitImageSmoothingEnabled'] = false;\r\n        }\r\n        this._context['msImageSmoothingEnabled'] = false;\r\n    }\r\n\r\n    render(data) {\r\n        this.layers.forEach(layer => {\r\n            layer.render(this._context, this.viewport, this.layers, data || {})\r\n        });\r\n    }\r\n}\r\n","import Handler from \"api/Handler\";\r\nimport EngineComponent from \"api/EngineComponent\";\r\n\r\n/**\r\n * FrameHandler\r\n * @constructor\r\n */\r\nexport default class FrameHandler extends EngineComponent {\r\n    static instance;\r\n\r\n    static timestamp = 0;\r\n    static frameLimit = 60;\r\n\r\n    static _breakAnimationFrame = false;\r\n\r\n    /**\r\n     * @type {Array}\r\n     * @private\r\n     */\r\n    _engineStack = [];\r\n\r\n    /**\r\n     * @private\r\n     * @type {{start: boolean, pause: boolean}}}\r\n     */\r\n    _data = {\r\n        start: false,\r\n        pause: false\r\n    };\r\n\r\n    /** @private */\r\n    _loop;\r\n\r\n    constructor() {\r\n        super();\r\n    }\r\n\r\n    set frameLimit(value) {\r\n        if (value <= 60 && value > 0) {\r\n            FrameHandler.frameLimit = value\r\n        }\r\n        return FrameHandler.frameLimit || value;\r\n    }\r\n\r\n    get isStarted() {\r\n        return this._data.start;\r\n    }\r\n\r\n    get isPaused() {\r\n        return this._data.pause;\r\n    }\r\n\r\n    loop(timestamp) {\r\n        if (this._loop === undefined) this._loop = (timestamp) => {\r\n            this.loop(timestamp);\r\n        };\r\n\r\n        if (this._engineStack.length <= 0 && this._data.start || this._data.pause) {\r\n            FrameHandler._breakAnimationFrame = true;\r\n            this._data.start = false;\r\n            return CancelAnimationFrame(this._loop);\r\n        }\r\n        this._data.start = true;\r\n\r\n        RequestAnimationFrame(this._loop);\r\n\r\n        for (let i = 0; i < this._engineStack.length; i++) {\r\n            if (!this._engineStack[i].isEnabled) continue;\r\n            let engine = this._engineStack[i];\r\n\r\n            if (!engine._data.pause) {\r\n                if (engine.io) engine.io.update();\r\n\r\n                if (engine._state && typeof engine._state === 'function') engine.update(timestamp);\r\n\r\n                //let data = engine.data.render;\r\n\r\n                //data.now = Date.now();\r\n                //data.deltaTime = (data.now - data.lastTime) / 100.0;\r\n\r\n                // if (engine.update !== undefined && 'function' === typeof engine.update) {\r\n                //     if (engine.data.asyncUpdate) {\r\n                //         setTimeout(engine.update.bind(engine, timestamp, data), 0);\r\n                //         setTimeout(engine.tweens.update.bind(engine, timestamp), 0);\r\n                //     } else {\r\n                //         engine.update(timestamp, data);\r\n                //         engine.tweens.update(timestamp);\r\n                //     }\r\n                // }\r\n\r\n                // if ((data.deltaTime * 100.0) > data.interval) {\r\n                //     data.lastTime = data.now - ((data.deltaTime * 100.0) % data.interval);\r\n                //\r\n                //     if (engine.render !== undefined && 'function' === typeof engine.render) {\r\n                //         if (data.asyncRender) {\r\n                //             setTimeout(engine.render.bind(engine, timestamp, data), 0);\r\n                //         } else {\r\n                //             engine.render(timestamp, data);\r\n                //         }\r\n                //     }\r\n                // }\r\n\r\n                if (engine.io) engine.io.clear();\r\n            }\r\n        }\r\n    }\r\n\r\n    start(engineHandler) {\r\n        if (this._engineStack[engineHandler.guid] === undefined) {\r\n            this._engineStack[engineHandler.guid] = engineHandler;\r\n            this._engineStack.push(engineHandler);\r\n        }\r\n        if (!this._data.start) this.loop(Date.now() - FrameHandler.timestamp);\r\n        return this;\r\n    }\r\n\r\n    stop(engineHandler) {\r\n        if (this._engineStack[engineHandler.guid] !== undefined) {\r\n            delete this._engineStack[engineHandler.guid];\r\n            this._engineStack.splice(this._engineStack.indexOf(engineHandler.guid), 1);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    init(eventHandler) {\r\n        super.init(eventHandler);\r\n        return this;\r\n    }\r\n\r\n    enable() {\r\n        super.enable();\r\n        this._data.pause = false;\r\n        return this;\r\n    }\r\n\r\n    disable() {\r\n        super.disable();\r\n        this._data.pause = true;\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @singleton\r\n     * @returns {FrameHandler}\r\n     */\r\n    static init() {\r\n        return FrameHandler.instance || (FrameHandler.instance = new FrameHandler());\r\n    }\r\n}\r\n\r\nexport const RequestAnimationFrame = (() => {\r\n    return window.requestAnimationFrame ||\r\n        window.webkitRequestAnimationFrame ||\r\n        window.mozRequestAnimationFrame ||\r\n        window.oRequestAnimationFrame ||\r\n        window.msRequestAnimationFrame ||\r\n        ((callback) => {\r\n            if (!FrameHandler._breakAnimationFrame) {\r\n                if (FrameHandler.timestamp >= Number.MAX_SAFE_INTEGER - 1) FrameHandler.timestamp = 0;\r\n                if (FrameHandler.timestamp === 0) FrameHandler.timestamp = window.performance === undefined\r\n                    ? Date.now()\r\n                    : window.performance.now();\r\n                window.setTimeout(callback.bind(this, window.performance === undefined\r\n                    ? Date.now() - FrameHandler.timestamp\r\n                    : window.performance.now() - FrameHandler.timestamp\r\n                ), 1000.0 / FrameHandler.frameLimit);\r\n            } else {\r\n                FrameHandler._breakAnimationFrame = false\r\n            }\r\n        });\r\n})();\r\n\r\nexport const CancelAnimationFrame = (() => {\r\n    FrameHandler.timestamp = 0;\r\n    return window.cancelAnimationFrame ||\r\n        window.webkitCancelAnimationFrame ||\r\n        window.mozCancelAnimationFrame ||\r\n        window.oCancelAnimationFrame ||\r\n        window.msCancelAnimationFrame;\r\n})();\r\n","import InputHandlerCodes from \"io/InputHandlerCodes\";\r\nimport Keyboard from \"io/devices/Keyboard\";\r\nimport Joystick from \"io/devices/Joystick\";\r\nimport Mouse from \"io/devices/Mouse\";\r\nimport Touch from \"io/devices/Touch\";\r\nimport Device from \"api/Device\";\r\nimport EngineComponent from \"api/EngineComponent\";\r\n\r\n/**\r\n * InputHandler\r\n * @constructor\r\n * @extends EngineComponent\r\n *\r\n * @interface IEngineComponent\r\n */\r\nexport default class InputHandler extends EngineComponent {\r\n\r\n    static IO = {\r\n        KEYBOARD: 'keyboard',\r\n        JOYSTICK: 'joystick',\r\n        MOUSE: 'mouse',\r\n        TOUCH: 'touch'\r\n    };\r\n\r\n    defaultIO = {\r\n        KEYBOARD: Keyboard,\r\n        JOYSTICK: Joystick,\r\n        MOUSE: Mouse,\r\n        TOUCH: Touch\r\n    };\r\n\r\n    static KEY = InputHandlerCodes;\r\n    KEY = InputHandler.KEY;\r\n\r\n    static KEYS_HELPER = InputHandler.prototype.KEYS_HELPER = {\r\n        getKeyById: function (index) {\r\n            return InputHandler.KEY[index] || 'KEY_UNKNOWN_' + index;\r\n        },\r\n        getKeyByCode: function (keyCode) {\r\n            return InputHandler.KEY[keyCode] || 0;\r\n        }\r\n    };\r\n\r\n    constructor() {\r\n        super();\r\n\r\n        this.preventDefault = false;\r\n        this.IO = [];\r\n        this.options = {\r\n            cursor: 'none'\r\n        };\r\n\r\n        this.store = {};\r\n\r\n        this.data = {};\r\n\r\n        this.keyCodeMap = {\r\n            //DEBUG_INFO: [[InputHandler.KEY.KEY_CTRL, InputHandler.KEY.KEY_F1], 'j2d.debug.toggleScreen', {}],\r\n            FULLSCREEN: [[InputHandler.KEY.KEY_CTRL, InputHandler.KEY.KEY_F11], 'j2d.scene.toggleFullScreen', {}]\r\n        };\r\n    }\r\n\r\n    bindListeners() {\r\n        for (let i = 0; i < this.IO.length; i++) {\r\n            if (this.IO[i].enable() === false) return false;\r\n        }\r\n    };\r\n\r\n    unBindListeners() {\r\n        for (let i = 0; i < this.IO.length; i++) {\r\n            if (this.IO[i].disable() === false) return false;\r\n        }\r\n    };\r\n\r\n    update() {\r\n        if (!this.isEnabled) return false;\r\n        for (let i = 0; i < this.IO.length; i++) {\r\n            if (this.IO[i].update() === false) return false;\r\n        }\r\n        return true;\r\n    };\r\n\r\n    clear() {\r\n        if (!this.isEnabled) return false;\r\n        for (let i = 0; i < this.IO.length; i++) {\r\n            if (this.IO[i].clear() === false) return false;\r\n        }\r\n        return true;\r\n    };\r\n\r\n    load(newKeyCodeMap) {\r\n        let oldKeyCodeMap = JSON.stringify(this.keyCodeMap);\r\n        this.keyCodeMap = JSON.parse(newKeyCodeMap);\r\n        return oldKeyCodeMap;\r\n    };\r\n\r\n    save() {\r\n        return JSON.stringify(this.keyCodeMap);\r\n    };\r\n\r\n    flush() {\r\n    }\r\n\r\n    // TODO:: to refactoring\r\n\r\n    static _getPressData(manager, keyList) {\r\n        return {\r\n            keyList: keyList,\r\n            time: manager.store.keys.pressedTime[keyList[0]]\r\n        };\r\n    }\r\n\r\n    checkPressedKeyList(keyList) {\r\n        if (typeof keyList === 'object' && keyList instanceof Array) {\r\n            if (keyList.length !== this.data.keys.keysDown.length) {\r\n                return false;\r\n                //} else if (this.data.keys.keysDown.equals(keyList)) {\r\n                //    return getPressData(this, keyList);\r\n            }\r\n            return false;\r\n        }\r\n        if (isNaN(keyList)) return false;\r\n        if (-1 !== this.data.keys.keysDown.indexOf(keyList)) {\r\n            return InputHandler._getPressData(this, keyList);\r\n        }\r\n        return false;\r\n    }\r\n\r\n    checkPressedKeyMap(key) {\r\n        if (this.keyCodeMap[key] === undefined) return false;\r\n        return this.checkPressedKeyList(this.keyCodeMap[key][0]);\r\n    }\r\n\r\n    setKeys(mapObject) {\r\n        //this.keyMap = $.extend(true, {}, this.keyMap, mapObject);\r\n        return this;\r\n    }\r\n\r\n    init(eventHandler, io, options) {\r\n        super.init(eventHandler);\r\n        if (options && typeof options === 'object') {\r\n            this.options = options;\r\n        }\r\n        if (io && typeof io === 'object' && io instanceof Array) {\r\n            this.IO = [];\r\n            io.map(function (device) {\r\n                if (typeof device === 'string' && InputHandler.IO[device.toUpperCase()] !== undefined) {\r\n                    device = new (this.defaultIO[device.toUpperCase()])();\r\n                    this.IO[device.toString()] = device;\r\n                    this.IO.push(device);\r\n                    if (this.IO[device.toString()].init(this) === false) {\r\n                        throw new Error('Error. Device \"' + device + '\" not initialize.');\r\n                    }\r\n                } else if (typeof device === 'object' && device instanceof Device) {\r\n                    this.IO[device.toString()] = device;\r\n                    this.IO.push(device);\r\n                    if (this.IO[device.toString()].init(this) === false) {\r\n                        throw new Error('Error. Device \"' + device + '\" not initialize.');\r\n                    }\r\n                } else {\r\n                    throw new Error('Error. Unknown IO device \"' + device.toString() + '\" is not supported yet.');\r\n                }\r\n            }.bind(this));\r\n        }\r\n        return this;\r\n    }\r\n\r\n    enable() {\r\n        super.enable();\r\n        this.bindListeners();\r\n        return this;\r\n    }\r\n\r\n    disable() {\r\n        super.disable();\r\n        this.unBindListeners();\r\n        return this;\r\n    }\r\n\r\n    toggle(status) {\r\n        super.toggle(status);\r\n        return this;\r\n    }\r\n}\r\n","import Handler from \"api/Handler\";\r\nimport EngineComponent from \"../api/EngineComponent\";\r\n\r\n/**\r\n * EventHandler\r\n * @constructor\r\n */\r\nexport default class EventHandler extends EngineComponent {\r\n\r\n    events = [];\r\n    onces = [];\r\n\r\n    constructor() {\r\n        super();\r\n        this.flush();\r\n    }\r\n\r\n    /**\r\n     * @param {string} eventName\r\n     * @param {function} callback\r\n     */\r\n    on(eventName, callback) {\r\n        if (this.events[eventName] !== undefined) {\r\n            var stack = this.events[eventName];\r\n            if (stack.indexOf(callback) === -1) {\r\n                stack.push(callback);\r\n            }\r\n        } else {\r\n            this.events[eventName] = [];\r\n            this.events[eventName].push(callback)\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {string} eventName\r\n     * @param {function} callback\r\n     */\r\n    once(eventName, callback) {\r\n        if (this.onces[eventName] !== undefined) {\r\n            var stack = this.onces[eventName];\r\n            if (stack.indexOf(callback) === -1) {\r\n                stack.push(callback);\r\n            }\r\n        } else {\r\n            this.onces[eventName] = [];\r\n            this.onces[eventName].push(callback)\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {string} eventName\r\n     * @param {function} callback\r\n     */\r\n    off(eventName, callback) {\r\n        if (this.onces[eventName] !== undefined) {\r\n            var stack = this.events[eventName];\r\n            if (stack.indexOf(callback) !== -1) {\r\n                stack.splice(stack.indexOf(callback));\r\n            }\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {string} eventName\r\n     * @param {Object} [data]\r\n     */\r\n    trigger(eventName, data) {\r\n        var stack, i, result;\r\n\r\n        if (this.onces[eventName] !== undefined) {\r\n            stack = this.onces[eventName];\r\n            for (i = 0; i < stack.length; i++) {\r\n                result = stack[i].call(stack[i], data);\r\n                if (typeof result === 'boolean' && !result) return this;\r\n            }\r\n            this.flush(eventName);\r\n        }\r\n\r\n        if (this.events[eventName] !== undefined) {\r\n            stack = this.events[eventName];\r\n            for (i = 0; i < stack.length; i++) {\r\n                result = stack[i].call(stack[i], data);\r\n                if (typeof result === 'boolean' && !result) return this;\r\n            }\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {string} [eventName]\r\n     */\r\n    flush(eventName) {\r\n        if (eventName !== undefined) {\r\n            if (this.events[eventName] !== undefined) {\r\n                this.events[eventName] = [];\r\n            }\r\n            if (this.onces[eventName] !== undefined) {\r\n                this.onces[eventName] = [];\r\n            }\r\n        } else {\r\n            this.onces = [];\r\n            this.events = [];\r\n        }\r\n        return this;\r\n    }\r\n\r\n    init(eventHandler) {\r\n        super.init(eventHandler);\r\n        return this;\r\n    }\r\n\r\n    enable() {\r\n        super.enable();\r\n        return this;\r\n    }\r\n\r\n    disable() {\r\n        super.disable();\r\n        return this;\r\n    }\r\n\r\n    toggle(status) {\r\n        super.toggle(status);\r\n        return this;\r\n    }\r\n}\r\n","import Exception from \"exceptions/Exception\";\r\n\r\n/**\r\n * InvalidArgumentException\r\n * Create custom exception with message\r\n *\r\n * @class InvalidArgumentException\r\n * @exports module:exceptions/InvalidArgumentException\r\n *\r\n * @constructor\r\n * @extends Exception\r\n * @param {string} message\r\n * @property {string} message\r\n */\r\nexport default class InvalidArgumentException extends Exception {\r\n    constructor(message) {\r\n        super(message)\r\n    }\r\n\r\n    /**\r\n     * Convert exception to String\r\n     * @returns {string}\r\n     */\r\n    toString = function () {\r\n        return this.message;\r\n    }\r\n}\r\n","import PrototypeInterface from \"api/PrototypeInterface\";\r\n\r\n/**\r\n * IEngineComponent\r\n * @constructor\r\n */\r\nexport default class IEngineComponent extends PrototypeInterface {\r\n};\r\n","import PrototypeObject from \"api/PrototypeObject\";\r\nimport IEngine from \"api/interfaces/IEngine\";\r\nimport RuntimeException from \"exceptions/RuntimeException\";\r\n\r\n/**\r\n * Engine\r\n * @constructor\r\n */\r\nexport default class Engine extends PrototypeObject {\r\n    static interfaces = [IEngine];\r\n    static _$classPreInitialize = [];\r\n\r\n    _isEnabled = false;\r\n\r\n    constructor(id) {\r\n        super();\r\n\r\n        if (!Engine._$classPreInitialize.includes(id)) {\r\n            throw new RuntimeException(`The constructor is private. Please use static ${this.constructor.name}.init()`);\r\n        } else Engine._$classPreInitialize.splice(Engine._$classPreInitialize.indexOf(id), 1);\r\n    }\r\n\r\n    get isEnabled() {\r\n        return this._isEnabled;\r\n    }\r\n\r\n    enable() {\r\n        this._isEnabled = true;\r\n        return this;\r\n    };\r\n\r\n    disable() {\r\n        this._isEnabled = false;\r\n        return this;\r\n    };\r\n\r\n    toggle(status) {\r\n        if (status === undefined) status = !this.isEnabled;\r\n        if (status) {\r\n            this.enable();\r\n        } else {\r\n            this.disable();\r\n        }\r\n        return this;\r\n    };\r\n};\r\n\r\n","import Engine from \"api/Engine\";\r\nimport IEngineComponent from \"api/interfaces/IEngineComponent\";\r\nimport InvalidArgumentException from \"exceptions/InvalidArgumentException\";\r\nimport EventHandler from \"events/EventHandler\";\r\nimport InputHandler from \"io/InputHandler\";\r\nimport FrameHandler from \"core/FrameHandler\";\r\nimport SceneHandler from \"core/SceneHandler\";\r\nimport Device from \"utils/Device\";\r\nimport SystemConsole from \"utils/SystemConsole\";\r\nimport UUID from \"utils/UUID\";\r\nimport LayersHandler from \"layers/LayersHandler\";\r\nimport ViewportHandler from \"core/ViewportHandler\";\r\nimport Mutable from \"objects/Mutable\";\r\n\r\n/**\r\n * @class EngineJ2D\r\n * @exports module:\"j2d\"\r\n *\r\n * @param {Element|HTMLElement|HTMLInputElement} element\r\n * @param {EngineJ2D.defaults|{}} data\r\n *\r\n * @constructor\r\n */\r\nexport default class EngineJ2D extends Engine {\r\n    /** @type {string} */\r\n    static VERSION = '1.0.0-dev (VeNoM iNjecTioN)';\r\n\r\n    /** @type {boolean} */\r\n    static PluginInit = false;\r\n\r\n    /** @type {{id: string, pause: boolean, components: {\r\n        * EventHandler: IEngineComponent|EngineComponent|EventHandler,\r\n        * FrameHandler: IEngineComponent|EngineComponent|FrameHandler,\r\n        * InputHandler: IEngineComponent|EngineComponent|InputHandler,\r\n        * MediaHandler: IEngineComponent,\r\n        * TweenHandler: IEngineComponent,\r\n        * SceneHandler: IEngineComponent|EngineComponent|SceneHandler\r\n        * }}}\r\n     */\r\n    static defaults = {\r\n        id: '',\r\n        pause: false,\r\n        components: {\r\n            EventHandler: null,\r\n            FrameHandler: null,\r\n            InputHandler: null,\r\n            MediaHandler: null,\r\n            TweenHandler: null,\r\n            SceneHandler: null\r\n        }\r\n    };\r\n\r\n    /** @type {Array.<EngineJ2D>|string} */\r\n    static stack = [];\r\n\r\n    /** @type jQuery|function */\r\n    static _jQuery;\r\n\r\n    /** @type boolean */\r\n    _initialized = false;\r\n\r\n    /** @type {Element|HTMLElement|HTMLInputElement} */\r\n    _element = null;\r\n\r\n    /** @type {EngineJ2D.defaults|{}} */\r\n    _data = {};\r\n\r\n    /** @type {function|null} */\r\n    _state = null;\r\n\r\n    /** @type {Device} */\r\n    device = new Device();\r\n\r\n    /** @type {SystemConsole} */\r\n    logger = new SystemConsole();\r\n\r\n    constructor(element, data) {\r\n        super(data !== undefined ? data.id : null);\r\n\r\n        this._element = element;\r\n        this._data = data;\r\n\r\n        this.log(this._data.components);\r\n    }\r\n\r\n    get guid() {\r\n        return this._data.id;\r\n    }\r\n\r\n    set state(state) {\r\n        return this._state = state;\r\n    }\r\n\r\n    /* +Handlers */\r\n\r\n    get events() {\r\n        return this.EventHandler;\r\n    }\r\n\r\n    get EventHandler() {\r\n        return this._data.components.EventHandler;\r\n    }\r\n\r\n    set EventHandler(handler) {\r\n        if (!handler.instanceOf(IEngineComponent))\r\n            throw new InvalidArgumentException('Handler not implements IEngineComponent');\r\n        return this._data.components.EventHandler = handler;\r\n    }\r\n\r\n    get frame() {\r\n        return this.FrameHandler;\r\n    }\r\n\r\n    get FrameHandler() {\r\n        return this._data.components.FrameHandler;\r\n    }\r\n\r\n    set FrameHandler(handler) {\r\n        if (!handler.instanceOf(IEngineComponent))\r\n            throw new InvalidArgumentException('Handler not implements IEngineComponent');\r\n        return this._data.components.FrameHandler = handler;\r\n    }\r\n\r\n    get io() {\r\n        return this.InputHandler;\r\n    }\r\n\r\n    get InputHandler() {\r\n        return this._data.components.InputHandler;\r\n    }\r\n\r\n    set InputHandler(handler) {\r\n        if (!handler.instanceOf(IEngineComponent))\r\n            throw new InvalidArgumentException('Handler not implements IEngineComponent');\r\n        return this._data.components.InputHandler = handler;\r\n    }\r\n\r\n    get media() {\r\n        return this.MediaHandler;\r\n    }\r\n\r\n    get MediaHandler() {\r\n        return this._data.components.MediaHandler;\r\n    }\r\n\r\n    set MediaHandler(handler) {\r\n        if (!handler.instanceOf(IEngineComponent))\r\n            throw new InvalidArgumentException('Handler not implements IEngineComponent');\r\n        return this._data.components.MediaHandler = handler;\r\n    }\r\n\r\n    get tweens() {\r\n        return this.TweenHandler;\r\n    }\r\n\r\n    get TweenHandler() {\r\n        return this._data.components.TweenHandler;\r\n    }\r\n\r\n    set TweenHandler(handler) {\r\n        if (!handler.instanceOf(IEngineComponent))\r\n            throw new InvalidArgumentException('Handler not implements IEngineComponent');\r\n        return this._data.components.TweenHandler = handler;\r\n    }\r\n\r\n    get scene() {\r\n        return this.SceneHandler;\r\n    }\r\n\r\n    get SceneHandler() {\r\n        return this._data.components.SceneHandler;\r\n    }\r\n\r\n    set SceneHandler(handler) {\r\n        if (!handler.instanceOf(IEngineComponent))\r\n            throw new InvalidArgumentException('Handler not implements IEngineComponent');\r\n        return this._data.components.SceneHandler = handler;\r\n    }\r\n\r\n    /* -Handlers */\r\n\r\n    /* +GameEngine */\r\n\r\n    start() {\r\n        if (!this._initialized) this.tryLoadComponents();\r\n        this.enable();\r\n\r\n        this.frame.start(this);\r\n        this.events.trigger('start');\r\n    };\r\n\r\n    stop() {\r\n        if (!this._initialized) this.tryLoadComponents();\r\n        this.disable();\r\n\r\n        this.frame.stop(this);\r\n        this.events.trigger('stop');\r\n    };\r\n\r\n    pause() {\r\n        if (!this._initialized) this.tryLoadComponents();\r\n\r\n        if (this.io) this.io.flush();\r\n        if (this.media) this.media.pause();\r\n        this._data.pause = true;\r\n        this._element.classList.add('pause');\r\n        this.events.trigger('pause');\r\n    };\r\n\r\n    resume() {\r\n        if (!this._initialized) this.tryLoadComponents();\r\n\r\n        this._element.classList.remove('pause');\r\n        this._element.focus();\r\n        this._data.pause = false;\r\n        if (this.io) this.io.flush();\r\n        if (this.media) this.media.resume();\r\n        this.events.trigger('resume');\r\n    };\r\n\r\n    update(timestamp) {\r\n        if (this._state) this._state.bind(this, timestamp)();\r\n    }\r\n\r\n    /* -GameEngine **/\r\n\r\n    /* +System **/\r\n\r\n    log(message, level) {\r\n        this.logger.log(message, level);\r\n    };\r\n\r\n    tryLoadComponents() {\r\n        if (this._initialized) return;\r\n        // EventHandler\r\n        if (this.EventHandler === null) {\r\n            this.EventHandler = new EventHandler();\r\n        }\r\n        this.EventHandler.enable();\r\n\r\n        // InputHandler\r\n        if (this.InputHandler === null) {\r\n            this.InputHandler = new InputHandler();\r\n            this.InputHandler.init(this.EventHandler, [\r\n                InputHandler.IO.KEYBOARD,\r\n                InputHandler.IO.MOUSE\r\n            ], {\r\n                cursor: 'default'\r\n            });\r\n        }\r\n        this.InputHandler.enable();\r\n\r\n        // SceneHandler\r\n        if (this.SceneHandler === null) {\r\n            this.SceneHandler = new SceneHandler();\r\n            this.SceneHandler.init(this.EventHandler, this, {\r\n                width: 640,\r\n                height: 360,\r\n                backgroundColor: 'black'\r\n            });\r\n\r\n            this.SceneHandler.LayersHandler = new LayersHandler();\r\n            this.SceneHandler.LayersHandler.init(this.EventHandler);\r\n\r\n            this.SceneHandler.ViewportHandler = new ViewportHandler();\r\n            this.SceneHandler.ViewportHandler.init(this.EventHandler);\r\n        }\r\n        this.SceneHandler.LayersHandler.enable();\r\n        this.SceneHandler.ViewportHandler.enable();\r\n        this.SceneHandler.enable();\r\n\r\n        // FrameHandler\r\n        if (this.FrameHandler === null) {\r\n            this.FrameHandler = FrameHandler.init();\r\n            this.FrameHandler.init(this.EventHandler);\r\n        }\r\n        this.FrameHandler.enable();\r\n\r\n        this._initialized = true;\r\n    }\r\n\r\n    /* -System **/\r\n\r\n    /**\r\n     * @name EngineJ2D\r\n     * @static\r\n     *\r\n     * @param {string|jQuery} selected\r\n     * @param {EngineJ2D.defaults|Object} options\r\n     *\r\n     * @returns {EngineJ2D|EngineJ2D[]|Array.<EngineJ2D>}\r\n     */\r\n    static init(selected, options) {\r\n        if (selected === undefined) selected = '.j2d';\r\n        if (options === undefined) options = {};\r\n\r\n        options = Mutable.extend(true, {}, EngineJ2D.defaults, options);\r\n\r\n        let nodes = [];\r\n        if (typeof selected === 'string') {\r\n            nodes = window.document.querySelectorAll(selected);\r\n        } else if (typeof selected === 'object' && window.jQuery !== undefined && selected instanceof window.jQuery) {\r\n            nodes = selected.get();\r\n        } else return null;\r\n\r\n        let inactiveNodes = [];\r\n\r\n        nodes.forEach(node => {\r\n            if (!node.hasAttribute('guid')) inactiveNodes.push(node)\r\n        });\r\n\r\n        inactiveNodes.forEach((element) => {\r\n            options.id = UUID.generate();\r\n\r\n            element.setAttribute('guid', options.id);\r\n\r\n            let id = element.getAttribute('id');\r\n            if (id === undefined || id === null) {\r\n                element.setAttribute('guid', options.id);\r\n            }\r\n\r\n            let tabIndex = element.getAttribute('tabindex');\r\n            if (tabIndex === undefined || tabIndex === null || tabIndex === false) {\r\n                element.setAttribute('tabindex', '-1');\r\n            }\r\n\r\n            if (!element.classList.contains('j2d')) {\r\n                element.classList.add('j2d');\r\n            }\r\n\r\n            Engine._$classPreInitialize.push(options.id);\r\n            EngineJ2D.stack[options.id] = new EngineJ2D(element, options);\r\n            EngineJ2D.stack.push(options.id);\r\n\r\n            element.click();\r\n            element.focus();\r\n        });\r\n\r\n        let resumeBind = (current) => {\r\n            let nodes, engine;\r\n            nodes = window.document.querySelectorAll('div.canvas[guid]:not(.pause-disable):not(:focus)');\r\n            Array.prototype.forEach.call(nodes, (node) => {\r\n                if (current !== node) {\r\n                    node.classList.remove('active');\r\n                    engine = EngineJ2D.stack[node.getAttribute('guid')] || null;\r\n                    if (engine) engine.pause();\r\n                }\r\n            });\r\n\r\n            nodes = window.document.querySelectorAll('div.canvas[guid].active.pause-disable:not(:focus)');\r\n            Array.prototype.forEach.call(nodes, (node) => {\r\n                if (current !== node) {\r\n                    node.classList.remove('active');\r\n                }\r\n            });\r\n        };\r\n\r\n        function resumeEventListener() {\r\n            let engine;\r\n            if (this.classList.contains('pause')) {\r\n                engine = EngineJ2D.stack[this.getAttribute('guid')] || null;\r\n                if (engine) engine.resume();\r\n                resumeBind(this);\r\n            } else if (!this.classList.contains('resume-by-click') && this.classList.contains(':focus')) {\r\n                this.classList.add('active');\r\n                this.focus();\r\n                engine = EngineJ2D.stack[this.getAttribute('guid')] || null;\r\n                if (engine) engine.resume();\r\n                resumeBind(this);\r\n            }\r\n            return true;\r\n        }\r\n\r\n        let activeNodes = [];\r\n        nodes = window.document.querySelectorAll('.j2d[guid]');\r\n        Array.prototype.forEach.call(nodes, (node) => {\r\n            activeNodes.push(EngineJ2D.stack[node.getAttribute('guid')] || null);\r\n            node.addEventListener('click', resumeEventListener);\r\n            node.addEventListener('touch', resumeEventListener);\r\n            node.addEventListener('mouseenter', resumeEventListener);\r\n        });\r\n        return (1 === activeNodes.length) ? activeNodes[0] : activeNodes;\r\n    }\r\n\r\n    static ready(callback) {\r\n        if (EngineJ2D.PluginInit) {\r\n            if (EngineJ2D._jQuery) {\r\n                EngineJ2D._jQuery(document).ready(callback);\r\n            } else callback();\r\n        } else {\r\n            if (EngineJ2D._jQuery) {\r\n                EngineJ2D._jQuery(document).on('j2d-ready', () => {\r\n                    EngineJ2D._jQuery(document).ready(callback);\r\n                });\r\n            } else window.document.addEventListener('j2d-ready', callback);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @param {jQuery} jQuery\r\n     * @return {jQuery}\r\n     */\r\n    static jQuery(jQuery) {\r\n        EngineJ2D._jQuery = jQuery !== undefined ? jQuery : window.jQuery;\r\n\r\n        (function ($) {\r\n            //noinspection JSUnresolvedVariable\r\n            /**\r\n             * @param {EngineJ2D.defaults} [options]\r\n             * @returns {EngineJ2D|Array.<EngineJ2D>}\r\n             */\r\n            $.fn.j2d = function (options) {\r\n                /** @type {jQuery|EngineJ2D._jQuery} */\r\n                let instance = this;\r\n                return EngineJ2D.init(instance, options);\r\n            };\r\n        })(EngineJ2D._jQuery);\r\n\r\n        return EngineJ2D._jQuery;\r\n    }\r\n}\r\n\r\n/* ------------------------------ Plugin ------------------------------ */\r\n(EngineJ2D.initPlugin = () => {\r\n    if (EngineJ2D.PluginInit) return true;\r\n\r\n    (new SystemConsole()).logSystem('j2D v.' + EngineJ2D.VERSION, 'https://github.com/fsggs/j2d');\r\n\r\n    let firefox = window.navigator.userAgent.match(/Firefox\\/([0-9]+)\\./);\r\n    let version = firefox ? parseInt(firefox[2], 10) : false;\r\n\r\n    let isFullScreen = () => {\r\n        //noinspection JSUnresolvedVariable\r\n        return !!(window.document.webkitFullscreenElement\r\n            || window.document.webkitCurrentFullScreenElement\r\n            || (version && version < 47) ? window.document.mozFullScreenElement : window.document.fullscreenElement\r\n                || window.document.msFullscreenElement\r\n        );\r\n    };\r\n\r\n    function fullScreenEventListener() {\r\n        let fullScreen = isFullScreen();\r\n        if (!fullScreen) {\r\n            let node, engine;\r\n            node = window.document.querySelector('.j2d[guid].active');\r\n            if (node) engine = EngineJ2D.stack[node.getAttribute('guid')] || null;\r\n            if (engine) engine.scene.resizeToFullPage(fullScreen);\r\n\r\n            node = window.document.querySelector('.j2d[guid]:not(.active)');\r\n            if (node) engine = EngineJ2D.stack[node.getAttribute('guid')] || null;\r\n            if (engine) engine.toggle(!fullScreen);\r\n        }\r\n    }\r\n\r\n    let html = window.document.querySelector('html');\r\n\r\n    if (!html.classList.contains('j2d-engine')) {\r\n        window.document.addEventListener('fullscreenchange', fullScreenEventListener);\r\n        window.document.addEventListener('webkitfullscreenchange', fullScreenEventListener);\r\n        window.document.addEventListener('mozfullscreenchange', fullScreenEventListener);\r\n        window.document.addEventListener('MSFullscreenChange', fullScreenEventListener);\r\n\r\n        window.addEventListener('focus', () => {\r\n            let node, engine;\r\n            node = window.document.querySelector('.j2d[guid].active:not(.resume-by-click)');\r\n            if (node) engine = EngineJ2D.stack[node.getAttribute('guid')] || null;\r\n            if (engine) engine.resume();\r\n        });\r\n\r\n        window.addEventListener('blur', () => {\r\n            let nodes, engine;\r\n            nodes = window.document.querySelectorAll('.j2d[guid]:not(.pause-disable)');\r\n            nodes.forEach(node => {\r\n                if (node) engine = EngineJ2D.stack[node.getAttribute('guid')] || null;\r\n                if (engine) engine.pause();\r\n            });\r\n        });\r\n\r\n        window.addEventListener('resize', () => {\r\n            EngineJ2D.stack.forEach(guid => {\r\n                EngineJ2D.stack[guid].device.onResize();\r\n            });\r\n\r\n            let fullScreen = isFullScreen();\r\n            if (fullScreen) {\r\n                let node, engine;\r\n                node = window.document.querySelector('.j2d[guid].active');\r\n                if (node) engine = EngineJ2D.stack[node.getAttribute('guid')] || null;\r\n                if (engine) engine.scene.resizeToFullPage(fullScreen);\r\n            }\r\n            return true;\r\n        });\r\n        html.classList.add('j2d-engine');\r\n    }\r\n\r\n    window.document.dispatchEvent((new CustomEvent('j2d-ready')));\r\n\r\n    return EngineJ2D.PluginInit = true;\r\n})();\r\n"]}