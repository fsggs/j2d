{"version":3,"sources":["utils/MathUtil.es6","utils/ObjectUtil.es6","nodes/_deprecated/_deprecated_RectNode.es6","nodes/_deprecated/_deprecated_CameraNode.es6","utils/Vector2d.es6","utils/UUID.es6","nodes/_deprecated/_deprecated_BaseNode.es6","nodes/BaseNode.es6","nodes/_deprecated/_deprecated_AnimatedNode.es6","transitions/utils/Interpolation.es6","transitions/utils/Easing.es6","nodes/primitive2D/Sprite.es6","nodes/primitive2D/Rectangle.es6","io/devices/Touch.es6","io/devices/Pointer.es6","io/devices/Mouse.es6","io/devices/Keyboard.es6","io/devices/Joystick.es6","api/interfaces/IInputHandler.es6","api/interfaces/IHandler.es6","api/interfaces/IEngine.es6","utils/_deprecated_Events.es6","utils/_deprecated_ArrayMap.es6","states/_deprecated_DefaultGameState.es6","states/_deprecated_BaseGameState.es6","transitions/_deprecated_Tween.es6","stores/BaseStore.es6","nodes/GroupNode.es6","nodes/CameraNode.es6","objects/Immutable.es6","loaders/_deprecated_AssetsLoader.es6","media/_deprecated_Video.es6","media/_deprecated_Sound.es6","media/_deprecated_Audio.es6","layers/Layer.es6","io/_deprecated_MediaManager.es6","io/_deprecated_InputManager.es6","io/InputHandlerCodes.es6","exceptions/UnexpectedValueException.es6","exceptions/RuntimeException.es6","exceptions/RangeException.es6","exceptions/OutOfRangeException.es6","exceptions/OutOfBoundsException.es6","exceptions/LogicException.es6","exceptions/LengthException.es6","exceptions/Exception.es6","exceptions/BadMethodCallException.es6","exceptions/BadFunctionCallException.es6","core/_deprecated_ViewportManager.es6","core/_deprecated_SceneManager.es6","core/_deprecated_LayersManager.es6","core/_deprecated_GameStatesManager.es6","api/PrototypeObject.es6","api/PrototypeInterface.es6","api/Handler.es6","api/EngineComponent.es6","api/Device.es6","objects/Mutable.es6","core/ViewportHandler.es6","layers/LayersHandler.es6","utils/SystemConsole.es6","utils/Device.es6","core/SceneHandler.es6","core/FrameHandler.es6","io/InputHandler.es6","events/EventHandler.es6","exceptions/InvalidArgumentException.es6","api/interfaces/IEngineComponent.es6","api/Engine.es6","j2d.es6"],"names":["MathUtil","number","isFinite","Math","floor","min","max","opacity","random","vector4","parseInt","omitZero","degree","PI","radian","ObjectUtil","args","Array","prototype","slice","call","arguments","deepness","splice","out","undefined","_typeof","Object","create","i","length","object","key","hasOwnProperty","extend","_deprecated_RectNode","data","_classCallCheck","this","_possibleConstructorReturn","__proto__","getPrototypeOf","_ObjectUtil2","default","RectNode","defaults","color","context","viewport","collection","visible","inViewport","tempOpacity","globalAlpha","angle","save","translate","getPosition","x","offset","y","rotate","_MathUtil2","degree2Radian","fillStyle","lineWidth","fillRect","position","size","scale","restore","draw","_deprecated_AnimatedNode","type","_deprecated_CameraNode","CameraNode","screen","calculate","Vector2d","array","vector1","vector2","sqrt","pow","getVector","atan2","UUID","replace","c","r","v","toString","_deprecated_BaseNode","BaseNode","id","_UUID2","generate","_Vector2d2","getSize","getOffset","value","enabledCache","cache","_this","_data","_Mutable2","device","toLowerCase","constructor","NodeName","name","isSpecial","AnimatedNode","duration","durationAsSpeed","tween","_Tween2","getDistance","to","start","getAngle","velocity","InterpolationEnum","Interpolation","Linear","k","m","f","fn","Utils","Bezier","b","n","pw","bn","Bernstein","CatmullRom","p0","p1","t","fc","Factorial","a","s","p2","p3","v0","v1","t2","t3","get","interpolation","register","interpolationFunction","linear","bezier","catmull-rom","EasingEnum","Easing","None","Quadratic","In","Out","InOut","Cubic","Quartic","Quintic","Sinusoidal","cos","sin","Exponential","Circular","Elastic","p","asin","Back","Bounce","easing","easingFunction","quadratic-in","quadratic-out","quadratic-in-out","cubic-in","cubic-out","cubic-in-out","quartic-in","quartic-out","quartic-in-out","quintic-in","quintic-out","quintic-in-out","sinusoidal-in","sinusoidal-out","sinusoidal-in-out","exponential-in","exponential-out","exponential-in-out","circular-in","circular-out","circular-in-out","elastic-in","elastic-out","elastic-in-out","back-in","back-out","back-in-out","bounce-in","bounce-out","bounce-in-out","Sprite","gl","textureBuffer","createBuffer","bindBuffer","ARRAY_BUFFER","bufferData","Float32Array","STATIC_DRAW","_this2","texture","createTexture","bindTexture","TEXTURE_2D","texImage2D","RGBA","UNSIGNED_BYTE","Uint8Array","image","Image","src","addEventListener","texParameteri","TEXTURE_MAG_FILTER","LINEAR","TEXTURE_MIN_FILTER","LINEAR_MIPMAP_NEAREST","generateMipmap","scene","components","SceneHandler","_shaderProgram","render","startsWith","attributes","aPosition","getAttribLocation","aTexture","uTexture","getUniformLocation","uResolution","uPosition","uAngle","uScale","uCenter","positionBuffer","bindPositionBuffer","bindTextureBuffer","useProgram","enableVertexAttribArray","vertexAttribPointer","FLOAT","uniform2fv","canvas","clientWidth","clientHeight","uniform1f","center","uniform1i","drawArrays","TRIANGLES","_colorRGBA","_Rectangle3","VertexShader","Rectangle","width","height","defineProperty","enumerable","writable","cacheData","vectorColorToRGBA","setWebGLCache","toCenter","cx","cy","_webGLCache","uColor","bindAttributes","program","uniform4fv","Touch","input","Error","IO","_Pointer3","Pointer","pointer","store","options","cursor","window","document","body","style","toggle","distance","Mouse","e","isEnabled","preventDefault","keyCode","KEYS_HELPER","getKeyById","__fixMouseButtonId","button","keys","keysDown","indexOf","push","recordMouseDragDistance","tracker","pageX","pageY","recordMouseClickTime","pressedTime","delta","startTime","timeStamp","events","trigger","keysUp","toFixed","wheelDelta","_get","setPointerImage","keyMouseDownEventHandler","keyMouseUpEventHandler","keyMouseMoveEventHandler","scrollMouseEventHandler","removeEventListener","Keyboard","recordKeyPressTime","keyDownEventHandler","keyUpEventHandler","Joystick","IInputHandler","IHandler","IEngine","Events","flush","eventName","onces","callback","stack","ArrayMap","l","equals","result","contains","DefaultGameState","gsm","timestamp","setTimeout","setNextState","bind","BaseGameState","currentState","loader","_Events2","event","on","off","once","STATE_NOT_LOADED","STATE_INIT","STATE_LOAD","STATE_UPDATE","STATE_RENDER","STATE_UNLOAD","tweens","Tween","tweenNode","node","state","stateDefaults","properties","isStarted","stateData","_tweenStateData","tweenStateStack","time","nextState","currentStateAnimation","previousStatesTime","getStateTimeDuration","elapsed","import","util","animateTween","_Easing2","chainedTweensStack","forEach","withPrevious","tweenStateTimings","startState","index","parsedTweenStateStack","nextStateDelay","nextAllStateDelay","concat","reverseProperties","stateStack","stackLength","j","sIndex","delay","shift","calculateProperties","global","performance","now","isAnimated","cleanProperties","_calculateStackState","_calculateStackStateTimings","delayTime","add","stopChainedTweens","remove","stop","count","update","defaultDuration","property","temp","isNaN","Number","parseFloat","startProperties","endProperties","BaseStore","_Immutable2","_isEnabled","_RuntimeException2","oldState","toJS","newState","GroupNode","guid","_nodes","isSpecialNode","instanceOf","_BaseNode3","has","isLostContext","FREEZE_NODE_METHODS","FREEZE_NODE_ARRAY_METHODS","Immutable","_InvalidArgumentException2","ImmutableArray","assign","unFreeze","JSON","stringify","freeze","__$ImmutableOptions","isFrozen","oldObject","newObject","console","log","getOwnPropertyNames","String","_get2","_len","_key","apply","_get3","_len2","_key2","fill","_get4","_len3","_key3","_get5","_len4","_key4","pop","reduce","reduceRight","reverse","sort","unshift","AssetsLoader","progress","Video","createMasterGain","audioContext","masterGain","createGain","createGainNode","gain","connect","destination","Sound","manager","audioNode","getAudioContext","AudioContext","webkitAudioContext","getMasterGain","buffer","_setupAudioNode","iOSAutoEnable","iOSEnable","media","load","sound","loadBuffer","soundNode","disconnect","sprite","loaded","_inactiveNode","pos","timerId","loop","soundId","round","Date","_nodeById","paused","_clearEndTimer","rate","onEndTimer","timer","loopStart","loopEnd","refreshBuffer","playStart","currentTime","volume","bufferSource","noteGrainOn","play","activeNode","noteOff","vol","z","pos3d","panner","setPosition","panningModel","model","readyState","createPanner","_drainPool","newNode","inactive","format","autoPlay","muted","url","loadSound","test","atob","split","dataView","charCodeAt","decodeAudioData","xhr","XMLHttpRequest","open","responseType","onload","response","onerror","gainNode","send","arraybuffer","error","createBufferSource","playbackRate","AudioNode","Audio","audio","code","preload","listener","ceil","extension","isSupportAudio","warn","extractFormat","source","exec","isSupportCodec","_load","nodes","_unload","clearTimeout","audios","navigator","isCocoonJS","playSprite","pause","_activeNode","_pause","_stop","mute","_mute","unMute","_unMute","_volume","_position","zsaz","_pos3d","listenerEvent","LAYER_PREFIX","Layer","_isGlobal","find","_registry","_BaseNode2","html5Audio","MediaManager","j2d","_ArrayMap2","iOSEnabled","codecs","mp3","canPlayType","opus","ogg","wav","aac","m4a","mp4","weba","fileExtension","sounds","webAudio","userAgent","unlock","noteOn","playbackState","PLAYING_STATE","FINISHED_STATE","getKey","filter","checkKeyMap","enableCallback","which","keyMap","$","isArray","eval","keysPressed","onMouseClick","enabled","isPlay","element","hasClass","DEPRECATED_InputManager","mouse","inArray","enableAdditionalData","startPosition","timePressed","preventAll","previousDistance","onMouseWheel","originalEvent","fixMouseWheel","mouseWheelCancel","onMouseMove","currentPosition","onKeyboardPress","writeMode","char","fromCharCode","focus","onTouchTap","touch","touches","changedTouches","onTouchMove","bindEvents","selector","unbindEvents","getPressData","keyList","FULLSCREEN","KEY_CTRL","KEY_F11","j2dPlugin","pluginInit","dX","offsetWidth","dY","offsetHeight","left","top","keyPressed","SCROLL_MOUSE_UP","SCROLL_MOUSE_DOWN","newKeyMap","oldKeyMap","parse","mapObject","current","previous","checkPressedKeyList","mode","css","enable","KEY_MOUSE_LEFT","KEY_MOUSE_MIDDLE","KEY_MOUSE_RIGHT","KEY_BACKSPACE","KEY_TAB","KEY_ENTER","KEY_SHIFT","KEY_ALT","KEY_PAUSE","KEY_BREAK","KEY_CAPS_LOCK","KEY_ESCAPE","KEY_SPACE_BAR","KEY_PAGE_UP","KEY_PAGE_DOWN","KEY_END","KEY_HOME","KEY_LEFT_ARROW","KEY_UP_ARROW","KEY_RIGHT_ARROW","KEY_DOWN_ARROW","KEY_INSERT","KEY_DELETE","KEY_0","KEY_1","KEY_2","KEY_3","KEY_4","KEY_5","KEY_6","KEY_7","KEY_8","KEY_9","KEY_A","KEY_B","KEY_C","KEY_D","KEY_E","KEY_F","KEY_G","KEY_H","KEY_I","KEY_J","KEY_K","KEY_L","KEY_M","KEY_N","KEY_O","KEY_P","KEY_Q","KEY_R","KEY_S","KEY_T","KEY_U","KEY_V","KEY_W","KEY_X","KEY_Y","KEY_Z","KEY_LEFT_WINDOW_KEY","KEY_RIGHT_WINDOW_KEY","KEY_SELECT_KEY","KEY_NUMPAD_0","KEY_NUMPAD_1","KEY_NUMPAD_2","KEY_NUMPAD_3","KEY_NUMPAD_4","KEY_NUMPAD_5","KEY_NUMPAD_6","KEY_NUMPAD_7","KEY_NUMPAD_8","KEY_NUMPAD_9","KEY_MULTIPLY","KEY_ADD","KEY_SUBTRACT","KEY_DECIMAL_POINT","KEY_DIVIDE","KEY_F1","KEY_F2","KEY_F3","KEY_F4","KEY_F5","KEY_F6","KEY_F7","KEY_F8","KEY_F9","KEY_F10","KEY_F12","KEY_NUM_LOCK","KEY_SCROLL_LOCK","KEY_SEMI_COLON","KEY_EQUAL_SIGN","KEY_COMMA","KEY_DASH","KEY_PERIOD","KEY_FORWARD_SLASH","KEY_GRAVE_ACCENT","KEY_OPEN_BRACKET","KEY_BACK_SLASH","KEY_CLOSE_BRACKET","KEY_SINGLE_QUOTE","KEY_LEFT_COMMAND","KEY_RIGHT_COMMAND","KEY_MOUSE_3","KEY_MOUSE_4","KEY_MOUSE_5","KEY_MOUSE_6","KEY_MOUSE_7","KEY_MOUSE_8","KEY_MOUSE_9","KEY_MOUSE_10","UnexpectedValueException","message","RuntimeException","RangeException","OutOfRangeException","OutOfBoundsException","LogicException","LengthException","Exception","BadMethodCallException","BadFunctionCallException","calculateScale","offsetX","offsetY","ViewportManager","cameras","camera","init","_CameraNode2","getCameraViewport","SceneManager","setGameCallback","frameManager","_FrameManager2","Init","layersManager","_LayersManager2","viewportManager","_ViewportManager2","gameStatesManager","_GameStatesManager2","initLayers","sceneManager","clear","fillBackground","originalWidth","originalHeight","originalMargin","getComputedStyle","initCanvas","setScreen","setDefaultViewport","getLayer","addLayer","querySelectorAll","createElement","zIndex","webGL","getContext","smoothing","disableSmoothing","shadowColor","backgroundColor","appendChild","clearRect","gameState","gameConstructor","patchGameStateRender","getState","newGameState","frameLimit","FrameHandler","getPreviousState","unload","io","getCurrent","fullscreen","getElementById","attr","requestFullscreen","webkitRequestFullscreen","webkitRequestFullScreen","mozRequestFullScreen","msRequestFullscreen","exitFullscreen","webkitExitFullscreen","webkitCancelFullScreen","mozCancelFullScreen","msExitFullscreen","resize","enableFullscreen","margin","setOffset","fullScreen","layers","getViewport","globalCollection","addCamera","setViewport","_updateNoCamerasViewport","updateViewport","display","enableFullScreen","LayersManager","_CollectionNode2","GameStatesManager","sceneCallback","_DefaultGameState2","states","previousState","PrototypeObject","interfaces","scope","_Device2","browser","version","implement","_PrototypeInterface2","PrototypeInterface","Handler","eventHandler","status","disable","_IHandler2","EngineComponent","_IEngineComponent2","Device","DeviceName","Mutable","__$MutableOptions","ViewportHandler","LayersHandler","_Layer2","_layers","SystemConsole","link","level","documentWidth","documentElement","documentHeight","_browser","getVersion","_version","innerWidth","innerHeight","match","appName","appVersion","vertex","fragment","onWebGLInit","engine","_engine","querySelector","nodeName","removeChild","right","bottom","_context","bindWebGLListeners","_element","toUpperCase","DEPTH_TEST","BLEND","blendFunc","SRC_ALPHA","ONE_MINUS_SRC_ALPHA","onWebGLContextLost","onWebGLContextRestored","isContextLost","getExtension","loseContext","nodePrototype","FragmentShader","createProgram","_vertextShader","compileShader","createShader","VERTEX_SHADER","_fragmentShader","FRAGMENT_SHADER","attachShader","linkProgram","getProgramParameter","LINK_STATUS","info","clearColor","COLOR_BUFFER_BIT","DEPTH_BUFFER_BIT","handler","shader","shaderSource","getShaderParameter","COMPILE_STATUS","getShaderInfoLog","chrome","imageSmoothingEnabled","lastTime","deltaTime","interval","_frameLimit","_loop","_engineStack","_breakAnimationFrame","CancelAnimationFrame","RequestAnimationFrame","engineHandler","_timestamp","instance","requestAnimationFrame","webkitRequestAnimationFrame","mozRequestAnimationFrame","oRequestAnimationFrame","msRequestAnimationFrame","MAX_SAFE_INTEGER","cancelAnimationFrame","webkitCancelAnimationFrame","mozCancelAnimationFrame","oCancelAnimationFrame","msCancelAnimationFrame","InputHandler","KEYBOARD","MOUSE","KEY","keyCodeMap","DEBUG_INFO","newKeyCodeMap","oldKeyCodeMap","_getPressData","defaultIO","bindListeners","unBindListeners","getKeyByCode","EventHandler","_events","_onces","InvalidArgumentException","IEngineComponent","Engine","_$classPreInitialize","_IEngine2","EngineJ2D","_SystemConsole2","_initialized","tryLoadComponents","frame","classList","resume","logger","COMPONENT","_EventHandler2","_InputHandler2","_SceneHandler2","_LayersHandler2","_ViewportHandler2","_FrameHandler2","MediaHandler","TweenHandler","selected","resumeEventListener","getAttribute","resumeBind","jQuery","inactiveNodes","hasAttribute","setAttribute","tabIndex","_Engine3","click","activeNodes","PluginInit","_jQuery","ready","check","alert","CustomEvent","params","bubbles","cancelable","detail","customEvent","createEvent","initCustomEvent","Event","initPlugin","fullScreenEventListener","isFullScreen","resizeToFullPage","CompatibilityCheck","logSystem","VERSION","webkitFullscreenElement","webkitCurrentFullScreenElement","mozFullScreenElement","fullscreenElement","msFullscreenElement","html","onResize","dispatchEvent"],"mappings":"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","file":"j2d.min.js","sourcesContent":["/**\r\n * @class MathUtil\r\n * @exports module:utils/MathUtil\r\n *\r\n * @constructor\r\n */\r\nexport default class MathUtil {\r\n    /**\r\n     * @param {number} number\r\n     * @returns {number}\r\n     */\r\n    static number2Integer(number) {\r\n        return number >> 0;\r\n    }\r\n\r\n    /**\r\n     * @param {number} number\r\n     * @returns {boolean}\r\n     */\r\n    static isInteger(number) {\r\n        return typeof number === \"number\" && isFinite(number)\r\n            && number > -9007199254740992 && number < 9007199254740992\r\n            && Math.floor(number) === number;\r\n    }\r\n\r\n    /**\r\n     * @param {number} min\r\n     * @param {number} max\r\n     * @param {number} opacity\r\n     * @returns {string}\r\n     */\r\n    static randomColor(min, max, opacity) {\r\n        return 'rgba('\r\n            + MathUtil.random(min, max) + ', '\r\n            + MathUtil.random(min, max) + ', '\r\n            + MathUtil.random(min, max) + ', '\r\n            + opacity + ')';\r\n    }\r\n\r\n    static vectorColorToRGBA(vector4) {\r\n        return 'rgba('\r\n            + parseInt(vector4[0] / (1 / 255)) + ', '\r\n            + parseInt(vector4[1] / (1 / 255)) + ', '\r\n            + parseInt(vector4[2] / (1 / 255)) + ', '\r\n            + vector4[3] + ')';\r\n    }\r\n\r\n    /**\r\n     * @param {number} min\r\n     * @param {number} max\r\n     * @param {boolean} [omitZero]\r\n     * @returns {number}\r\n     */\r\n    static random(min, max, omitZero) {\r\n        let random = (Math.floor(Math.random() * (max - min + 1) + min));\r\n        return (omitZero && random === 0)\r\n            ? MathUtil.random(min, max, omitZero)\r\n            : random;\r\n    }\r\n\r\n    /**\r\n     * @param {number} degree\r\n     * @returns {number}\r\n     */\r\n    static degree2Radian(degree) {\r\n        return degree * (Math.PI / 180);\r\n    }\r\n\r\n    /**\r\n     * @param {number} radian\r\n     * @returns {number}\r\n     */\r\n    static radian2Degree(radian) {\r\n        return radian * (180 / Math.PI);\r\n    }\r\n}\r\n","/**\r\n * @class ObjectUtil\r\n * @exports module:utils/ObjectUtil\r\n *\r\n * @constructor\r\n */\r\nexport default class ObjectUtil {\r\n    static extend() {\r\n        let args = Array.prototype.slice.call(arguments);\r\n        let deepness = false;\r\n        if (typeof args[0] === 'boolean') {\r\n            deepness = args[0];\r\n            args.splice(0, 1);\r\n        }\r\n\r\n        let out = args[0] || function () {\r\n                if (args[1] !== undefined && args[1] !== null && typeof args[1] === 'object') {\r\n                    return Object.create(args[1])\r\n                }\r\n                return {};\r\n            }();\r\n\r\n        for (let i = 1; i < args.length; i++) {\r\n            let object = args[i];\r\n\r\n            if (!object) continue;\r\n\r\n            for (let key in object) {\r\n                //noinspection JSUnresolvedFunction\r\n                if (object.hasOwnProperty(key)) {\r\n                    if (typeof object[key] === 'object' && object[key] !== null) {\r\n                        out[key] = deepness ? ObjectUtil.extend(deepness, out[key], object[key]) : object[key];\r\n                    } else {\r\n                        out[key] = object[key];\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        return out;\r\n    }\r\n}\r\n","import ObjectUtil from \"../../utils/ObjectUtil\";\r\nimport AnimatedNode from \"nodes/AnimatedNode\";\r\nimport MathUtil from \"../../utils/MathUtil\";\r\n\r\n/**\r\n * @class RectNode\r\n * @exports module:nodes/RectNode\r\n *\r\n * @constructor\r\n * @extends nodes/_deprecated_AnimatedNode\r\n * @param {BaseNode.defaults|AnimatedNode.defaults|RectNode.defaults|Object} [data]\r\n * @property {BaseNode.defaults|AnimatedNode.defaults|RectNode.defaults} data\r\n */\r\nexport default class _deprecated_RectNode extends _deprecated_AnimatedNode {\r\n    static defaults = {\r\n        type: 'RectNode',\r\n        color: '#000000'\r\n    };\r\n\r\n    constructor(data) {\r\n        super(ObjectUtil.extend(true, {}, RectNode.defaults, data));\r\n    }\r\n\r\n    /**\r\n     * @returns {string}\r\n     */\r\n    getColor() {\r\n        return this.data.color;\r\n    }\r\n\r\n    /**\r\n     * @param {string} color\r\n     * @returns {RectNode}\r\n     */\r\n    setColor(color) {\r\n        this.data.color = color;\r\n        return this;\r\n    }\r\n\r\n    /* ------------------------------ Draw ------------------------------ */\r\n\r\n    /**\r\n     * @param {CanvasRenderingContext2D} context\r\n     * @param {{offset: {x: number, y: number}, size: {x: number, y: number}, scale: number, angle: number}} viewport\r\n     * @param {_deprecated_CollectionNode} collection\r\n     * @param {object} data\r\n     * @returns {null}\r\n     */\r\n    draw(context, viewport, collection, data) {\r\n        if (this.data.visible && this.inViewport(viewport)) {\r\n            //console.log(this.inViewport(viewport));\r\n            if (this.data.opacity !== 1.0) {\r\n                var tempOpacity = context.globalAlpha;\r\n                context.globalAlpha = this.data.opacity;\r\n            }\r\n\r\n            if (this.data.angle || viewport.angle !== 0.0) {\r\n                context.save();\r\n\r\n                context.translate(\r\n                    this.getPosition().x - viewport.offset.x,\r\n                    this.getPosition().y - viewport.offset.y);\r\n                context.rotate(MathUtil.degree2Radian(this.data.angle + viewport.angle));\r\n                context.translate(\r\n                    -(this.getPosition().x - viewport.offset.x),\r\n                    -(this.getPosition().y - viewport.offset.y));\r\n            }\r\n\r\n            context.fillStyle = this.data.color;\r\n            context.lineWidth = 0;\r\n\r\n            context.fillRect(\r\n                this.data.position.x - viewport.offset.x,\r\n                this.data.position.y - viewport.offset.y,\r\n                this.data.size.x * this.data.scale * viewport.scale,\r\n                this.data.size.y * this.data.scale * viewport.scale\r\n            );\r\n\r\n            if (this.data.angle || viewport.angle !== 0.0) {\r\n                context.restore();\r\n            }\r\n\r\n            if (this.data.opacity !== 1.0) {\r\n                context.globalAlpha = tempOpacity;\r\n            }\r\n        }\r\n        return null;\r\n    }\r\n\r\n    /* ------------------------------ Render ------------------------------ */\r\n\r\n    /**\r\n     * @override\r\n     *\r\n     * @param {CanvasRenderingContext2D} context\r\n     * @param {{offset: {x: number, y: number}, size: {x: number, y: number}, scale: number, angle: number}} viewport\r\n     * @param {_deprecated_CollectionNode} collection\r\n     * @param {object} data\r\n     * @returns {BaseNode|AnimatedNode|_deprecated_RectNode}\r\n     */\r\n    render(context, viewport, collection, data) {\r\n        this.draw(context, viewport, collection, data);\r\n        return this;\r\n    }\r\n}\r\n","import ObjectUtil from \"../../utils/ObjectUtil\";\r\nimport AnimatedNode from \"nodes/AnimatedNode\";\r\n\r\n/**\r\n * @class CameraNode\r\n * @exports module:nodes/CameraNode\r\n *\r\n * @constructor\r\n * @extends nodes/_deprecated_AnimatedNode\r\n * @param {BaseNode.defaults|AnimatedNode.defaults|CameraNode.defaults|Object} [data]\r\n * @property {BaseNode.defaults|AnimatedNode.defaults|CameraNode.defaults} data\r\n */\r\nexport default class _deprecated_CameraNode extends _deprecated_AnimatedNode {\r\n    static defaults = {\r\n        type: 'CameraNode'\r\n    };\r\n\r\n    constructor(data) {\r\n        super(ObjectUtil.extend(true, {}, CameraNode.defaults, data));\r\n    }\r\n\r\n    /**\r\n     * @param {{x: number, y: number, offsetX: number, offsetY: number}} screen\r\n     * @param {Function|callback} calculate\r\n     * @returns {{offset: {x: number, y: number}, size: {x: number, y: number}, scale: number, angle: number}}\r\n     */\r\n    getCameraViewport(screen, calculate) {\r\n        return calculate(screen, {\r\n            offset: this.data.position,\r\n            size: this.data.size,\r\n            angle: this.data.angle,\r\n            scale: this.data.scale\r\n        });\r\n    };\r\n\r\n    /* ------------------------------ Render ------------------------------ */\r\n\r\n    /**\r\n     * @override\r\n     *\r\n     * @param {CanvasRenderingContext2D} context\r\n     * @param {{offset: {x: number, y: number}, size: {x: number, y: number}, scale: number, angle: number}} viewport\r\n     * @param {_deprecated_CollectionNode} collection\r\n     * @param {object} data\r\n     * @returns {BaseNode|AnimatedNode|CameraNode}\r\n     */\r\n    render(context, viewport, collection, data) {\r\n        return this;\r\n    }\r\n}\r\n","/**\r\n * @class Vector2d\r\n * @exports module:utils/Vector2d\r\n *\r\n * @constructor\r\n * @param {number} x\r\n * @param {number} y\r\n */\r\nexport default class Vector2d {\r\n    constructor(x, y) {\r\n        this.x = x;\r\n        this.y = y;\r\n    }\r\n\r\n    /**\r\n     * @returns {number}\r\n     */\r\n    getX() {\r\n        return this.x;\r\n    }\r\n\r\n    /**\r\n     * @returns {number}\r\n     */\r\n    getY() {\r\n        return this.y;\r\n    }\r\n\r\n    /**\r\n     * @returns {{x: number, y: number}}\r\n     */\r\n    getVector() {\r\n        return {x: this.x, y: this.y};\r\n    }\r\n\r\n    /**\r\n     * @returns {Array.<number>}\r\n     */\r\n    toArray() {\r\n        return [this.x, this.y];\r\n    }\r\n\r\n    /**\r\n     * @param {Array.<number>} array\r\n     * @returns {Vector2d}\r\n     */\r\n    fromArray(array) {\r\n        this.x = array[0];\r\n        this.y = array[1];\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @returns {string}\r\n     */\r\n    toString() {\r\n        return \"(\" + this.x + \",\" + this.y + \")\";\r\n    }\r\n\r\n    /**\r\n     * @param {Vector2d} vector1\r\n     * @param {Vector2d} vector2\r\n     * @returns {number}\r\n     */\r\n    static getDistance(vector1, vector2) {\r\n        return Math.sqrt(\r\n            Math.pow(vector2.getVector().x - vector1.getVector().x, 2) +\r\n            Math.pow(vector2.getVector().y - vector1.getVector().y, 2)\r\n        );\r\n    }\r\n\r\n    /**\r\n     * @param {Vector2d} vector1\r\n     * @param {Vector2d} vector2\r\n     * @returns {number}\r\n     */\r\n    static getAngle(vector1, vector2) {\r\n        return Math.atan2(\r\n                vector2.getVector().y - vector1.getVector().y,\r\n                vector2.getVector().x - vector1.getVector().x\r\n            ) * (180 / Math.PI);\r\n    }\r\n}\r\n","/**\r\n * Class for generate uuid\r\n *\r\n * @class UUID\r\n * @exports module:utils/UUID\r\n *\r\n * @constructor\r\n */\r\nexport default class UUID {\r\n    static generate = function () {\r\n        return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {\r\n            let r = Math.random() * 16 | 0, v = c == 'x' ? r : (r & 0x3 | 0x8);\r\n            return v.toString(16);\r\n        });\r\n    }\r\n}\r\n","import ObjectUtil from \"../../utils/ObjectUtil\";\r\nimport UUID from \"../../utils/UUID\";\r\nimport Vector2d from \"../../utils/Vector2d\";\r\n\r\n/**\r\n * @class BaseNode\r\n * @exports module:nodes/BaseNode\r\n *\r\n * @abstract\r\n * @constructor\r\n * @param {BaseNode.defaults|Object} [data]\r\n * @property {BaseNode.defaults} data\r\n */\r\n\r\nexport default class _deprecated_BaseNode {\r\n    static defaults = {\r\n        /** @type {string|null} */\r\n        id: null,\r\n        type: 'BaseNode',\r\n\r\n        position: {\r\n            x: 0.0,\r\n            y: 0.0\r\n        },\r\n        size: {\r\n            x: 0.0,\r\n            y: 0.0\r\n        },\r\n        offset: {\r\n            x: 0.0,\r\n            y: 0.0\r\n        },\r\n\r\n        visible: true,\r\n        angle: 0.0,\r\n        scale: 1.0,\r\n        opacity: 1.0,\r\n\r\n        cache: null,\r\n        enabledCache: false // TODO:: Collections & AnimatedPrimitiveNode\r\n    };\r\n\r\n    constructor(data) {\r\n        this.data = ObjectUtil.extend(true, {}, BaseNode.defaults, data);\r\n\r\n        if (this.data.id === null) {\r\n            this.data.id = UUID.generate();\r\n        }\r\n    }\r\n\r\n    get opacity() {\r\n        return this.data.opacity;\r\n    }\r\n\r\n    set opacity(value) {\r\n        this.data.opacity = value;\r\n    }\r\n\r\n    get visible() {\r\n        return this.data.visible;\r\n    }\r\n\r\n    set visible(value) {\r\n        this.data.visible = !!value;\r\n    }\r\n\r\n    get angle() {\r\n        return this.data.angle;\r\n    }\r\n\r\n    set angle(value) {\r\n        this.data.angle = value % 360;\r\n    }\r\n\r\n    get scale() {\r\n        return this.data.scale;\r\n    }\r\n\r\n    set scale(value) {\r\n        this.data.scale = value;\r\n    }\r\n\r\n    get cache() {\r\n        return this.data.enabledCache;\r\n    }\r\n\r\n    set cache(value) {\r\n        this.data.enabledCache = !!value;\r\n    }\r\n\r\n    /**\r\n     * @param {BaseNode.defaults|Object} data\r\n     */\r\n    load(data) {\r\n        this.data = ObjectUtil.extend(true, {}, this.data, data);\r\n    }\r\n\r\n    /**\r\n     * @returns {BaseNode.defaults}\r\n     */\r\n    save() {\r\n        return this.data;\r\n    }\r\n\r\n    /**\r\n     * @returns {Vector2d}\r\n     */\r\n    getPosition() {\r\n        return new Vector2d(this.data.position.x, this.data.position.y);\r\n    }\r\n\r\n    /**\r\n     * @param {Vector2d|BaseNode} position\r\n     * @returns {BaseNode}\r\n     */\r\n    setPosition(position) {\r\n        if (position !== undefined) {\r\n            if (position instanceof Vector2d) {\r\n                this.data.position = position.getVector();\r\n            } else if (position instanceof BaseNode) {\r\n                this.data.position = position.getPosition().getVector();\r\n            }\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @returns {Vector2d}\r\n     */\r\n    getSize() {\r\n        return new Vector2d(this.data.size.x, this.data.size.y);\r\n    }\r\n\r\n    /**\r\n     * @param {Vector2d|BaseNode} size\r\n     * @returns {BaseNode}\r\n     */\r\n    setSize(size) {\r\n        if (size !== undefined) {\r\n            if (size instanceof Vector2d) {\r\n                this.data.size = size.getVector();\r\n            } else if (size instanceof BaseNode) {\r\n                this.data.size = size.getSize().getVector();\r\n            }\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @returns {Vector2d}\r\n     */\r\n    getOffset() {\r\n        return new Vector2d(this.data.offset.x, this.data.offset.y);\r\n    }\r\n\r\n    /**\r\n     * @param {Vector2d|BaseNode} offset\r\n     * @returns {BaseNode}\r\n     */\r\n    setOffset(offset) {\r\n        if (offset !== undefined) {\r\n            if (offset instanceof Vector2d) {\r\n                this.data.offset = offset.getVector();\r\n            } else if (offset instanceof BaseNode) {\r\n                this.data.offset = offset.getOffset().getVector();\r\n            }\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /* ------------------------------ Render ------------------------------ */\r\n\r\n    /**\r\n     * Must be override this in child!\r\n     *\r\n     * @deprecated\r\n     * @overridable\r\n     *\r\n     * @param {CanvasRenderingContext2D} context\r\n     * @param {{offset: {x: number, y: number}, size: {x: number, y: number}, scale: number, angle: number}} viewport\r\n     * @param {CollectionNode} collection\r\n     * @param {object} data\r\n     * @returns {BaseNode}\r\n     */\r\n    render(context, viewport, collection, data) {\r\n        // throw new Exception('Trying to render base node.'); // TODO:: exceptions\r\n        return this;\r\n    }\r\n\r\n    //TODO:: Fix on fullscreen\r\n    /**\r\n     * @param {{offset: {x: number, y: number}, size: {x: number, y: number}, scale: number, angle: number}} viewport\r\n     * @returns {boolean}\r\n     */\r\n    inViewport(viewport) {\r\n        return !((this.data.position.x > viewport.offset.x + viewport.size.x\r\n        || this.data.position.x + viewport.size.x < viewport.offset.x)\r\n        || (this.data.position.y > viewport.offset.y + viewport.size.y\r\n        || this.data.position.y + viewport.size.y < viewport.offset.y));\r\n    }\r\n}\r\n\r\n\r\n\r\n\r\n","import PrototypeObject from \"api/PrototypeObject\";\r\nimport UUID from \"utils/UUID\";\r\nimport Mutable from \"objects/Mutable\";\r\n\r\n/**\r\n * @property {BaseNode.defaults|{}} _data\r\n */\r\nexport default class BaseNode extends PrototypeObject {\r\n    static NodeName = 'BaseNode';\r\n    static isSpecial = false;\r\n\r\n    /** @type {{id: null|string}} */\r\n    static defaults = {\r\n        id: null\r\n    };\r\n\r\n    _data;\r\n\r\n    constructor(data) {\r\n        super();\r\n        if (typeof data === 'string') data = {id: data};\r\n        this._data = Mutable.extend(true, {}, BaseNode.defaults, data);\r\n        if (this._data.id === null) this._data.id = UUID.generate();\r\n    }\r\n\r\n    get guid() {\r\n        return this._data.id;\r\n    }\r\n\r\n    get isSpecialNode() {\r\n        return this.constructor.isSpecial || false;\r\n    }\r\n\r\n    toString() {\r\n        return function (device) {\r\n            return (device[0].toLowerCase() + device.slice(1))\r\n        }(this.constructor.NodeName || this.constructor.name);\r\n    }\r\n}\r\n","import ObjectUtil from \"../../utils/ObjectUtil\";\r\nimport BaseNode from \"../BaseNode\";\r\nimport Vector2d from \"../../utils/Vector2d\";\r\nimport Tween from \"transitions/Tween\";\r\n\r\n// TODO:: move(+v.x, +v.y)\r\n\r\n/**\r\n * @class AnimatedNode\r\n * @exports module:nodes/AnimatedNode\r\n *\r\n * @abstract\r\n * @constructor\r\n * @extends nodes/BaseNode\r\n * @param {BaseNode.defaults|AnimatedNode.defaults|Object} [data]\r\n * @property {BaseNode.defaults|AnimatedNode.defaults} data\r\n */\r\nexport default class AnimatedNode extends BaseNode {\r\n    static defaults = {\r\n        type: 'AnimatedNode'\r\n    };\r\n\r\n    constructor(data) {\r\n        super(ObjectUtil.extend(true, {}, AnimatedNode.defaults, data));\r\n    }\r\n\r\n    /**\r\n     * @param {Vector2d|BaseNode} position\r\n     * @param {number} [duration]\r\n     * @param {boolean} [durationAsSpeed]\r\n     */\r\n    moveTo(position, duration, durationAsSpeed) {\r\n        if (duration === undefined || typeof duration !== 'number') duration = 1000.0;\r\n\r\n        if (typeof position === 'object') {\r\n            var tween = new Tween(this);\r\n\r\n            if (position instanceof Vector2d) {\r\n                if (durationAsSpeed) duration = Vector2d.getDistance(this.getPosition(), position) / duration;\r\n                tween.to({\r\n                    position: {\r\n                        x: position.getVector().x,\r\n                        y: position.getVector().y\r\n                    }\r\n                }, duration);\r\n            } else if (position instanceof BaseNode) {\r\n                if (durationAsSpeed) duration = Vector2d.getDistance(this.getPosition(), position.getPosition()) / duration;\r\n                tween.to({\r\n                    position: {\r\n                        x: position.getPosition().getVector().x,\r\n                        y: position.getPosition().getVector().y\r\n                    }\r\n                }, duration);\r\n            }\r\n\r\n            tween.start();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @param {Vector2d|BaseNode} size\r\n     * @param {number} [duration]\r\n     * @param {boolean} [durationAsSpeed]\r\n     */\r\n    resizeTo(size, duration, durationAsSpeed) {\r\n        if (duration === undefined || typeof duration !== 'number') duration = 1000.0;\r\n        if (typeof position === 'object') {\r\n            var tween = new Tween(this);\r\n\r\n            if (size instanceof Vector2d) {\r\n                if (durationAsSpeed) duration = Vector2d.getDistance(this.getSize(), size) / duration;\r\n                tween.to({\r\n                    size: {\r\n                        x: size.getVector().x,\r\n                        y: size.getVector().y\r\n                    }\r\n                }, duration);\r\n            } else if (size instanceof BaseNode) {\r\n                if (durationAsSpeed) duration = Vector2d.getDistance(this.getSize(), size.getSize()) / duration;\r\n                tween.to({\r\n                    size: {\r\n                        x: size.getSize().getVector().x,\r\n                        y: size.getSize().getVector().y\r\n                    }\r\n                }, duration);\r\n            }\r\n\r\n            tween.start();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @param {number|BaseNode} angle\r\n     * @param {number} [duration]\r\n     */\r\n    rotateTo(angle, duration) {\r\n        if (duration === undefined || typeof duration !== 'number') duration = 1000.0;\r\n        var tween = new Tween(this);\r\n\r\n        if (typeof angle === 'number') {\r\n            tween.to({angle: angle % 360}, duration);\r\n        } else if (typeof angle === 'object' && angle instanceof BaseNode) {\r\n            tween.to({\r\n                angle: Vector2d.getAngle(angle.getPosition(), this.getPosition())\r\n            }, duration);\r\n        }\r\n\r\n        tween.start();\r\n    }\r\n\r\n    /**\r\n     * @param {number} [velocity]\r\n     */\r\n    turn(velocity) {\r\n        if (velocity === undefined || typeof velocity !== 'number') velocity = 1.0;\r\n        this.angle += velocity;\r\n    }\r\n}\r\n","let InterpolationEnum;\r\n\r\n/**\r\n * @class Interpolation\r\n * @exports module:transitions/utils/Interpolation\r\n *\r\n * @type {{Linear: Interpolation.Linear, Bezier: Interpolation.Bezier, CatmullRom: Interpolation.CatmullRom}}\r\n */\r\nlet Interpolation = {\r\n    /**\r\n     * @return {number}\r\n     */\r\n    Linear: function (v, k) {\r\n        var m = v.length - 1;\r\n        var f = m * k;\r\n        var i = Math.floor(f);\r\n        var fn = Interpolation.Utils.Linear;\r\n\r\n        if (k < 0) return fn(v[0], v[1], f);\r\n        if (k > 1) return fn(v[m], v[m - 1], m - f);\r\n\r\n        return fn(v[i], v[i + 1 > m ? m : i + 1], f - i);\r\n    },\r\n\r\n    /**\r\n     * @return {number}\r\n     */\r\n    Bezier: function (v, k) {\r\n        var b = 0;\r\n        var n = v.length - 1;\r\n        var pw = Math.pow;\r\n        var bn = Interpolation.Utils.Bernstein;\r\n\r\n        for (var i = 0; i <= n; i++) {\r\n            b += pw(1 - k, n - i) * pw(k, i) * v[i] * bn(n, i);\r\n        }\r\n\r\n        return b;\r\n    },\r\n\r\n    /**\r\n     * @return {number}\r\n     */\r\n    CatmullRom: function (v, k) {\r\n        var m = v.length - 1;\r\n        var f = m * k;\r\n        var i = Math.floor(f);\r\n        var fn = Interpolation.Utils.CatmullRom;\r\n\r\n        if (v[0] === v[m]) {\r\n            if (k < 0) i = Math.floor(f = m * (1 + k));\r\n\r\n            return fn(v[(i - 1 + m) % m], v[i], v[(i + 1) % m], v[(i + 2) % m], f - i);\r\n        } else {\r\n            if (k < 0) return v[0] - (fn(v[0], v[0], v[1], v[1], -f) - v[0]);\r\n            if (k > 1) return v[m] - (fn(v[m], v[m], v[m - 1], v[m - 1], f - m) - v[m]);\r\n\r\n            return fn(v[i ? i - 1 : 0], v[i], v[m < i + 1 ? m : i + 1], v[m < i + 2 ? m : i + 2], f - i);\r\n        }\r\n    },\r\n\r\n    Utils: {\r\n        /**\r\n         * @return {number}\r\n         */\r\n        Linear: function (p0, p1, t) {\r\n            return (p1 - p0) * t + p0;\r\n        },\r\n\r\n        /**\r\n         * @return {number}\r\n         */\r\n        Bernstein: function (n, i) {\r\n            var fc = Interpolation.Utils.Factorial;\r\n            return fc(n) / fc(i) / fc(n - i);\r\n        },\r\n\r\n        Factorial: (function () {\r\n            var a = [1];\r\n            return function (n) {\r\n                var s = 1;\r\n                if (a[n]) return a[n];\r\n\r\n                for (var i = n; i > 1; i--) {\r\n                    s *= i;\r\n                }\r\n                a[n] = s;\r\n\r\n                return s;\r\n            };\r\n        })(),\r\n\r\n        /**\r\n         * @return {number}\r\n         */\r\n        CatmullRom: function (p0, p1, p2, p3, t) {\r\n            var v0 = (p2 - p0) * 0.5;\r\n            var v1 = (p3 - p1) * 0.5;\r\n            var t2 = t * t;\r\n            var t3 = t * t2;\r\n\r\n            return (2 * p1 - 2 * p2 + v0 + v1) * t3 + (-3 * p1 + 3 * p2 - 2 * v0 - v1) * t2 + v0 * t + p1;\r\n        }\r\n    },\r\n\r\n    get: (interpolation) => {\r\n        if (InterpolationEnum[interpolation] !== undefined) {\r\n            return InterpolationEnum[interpolation];\r\n        }\r\n\r\n        // TODO:: Exceptions\r\n        //throw new InvalidArgumentException('Unknown interpolation: ' + interpolation);\r\n    },\r\n\r\n    register: (interpolation, interpolationFunction) => {\r\n        InterpolationEnum[interpolation] = interpolationFunction;\r\n    }\r\n};\r\n\r\nInterpolationEnum = {\r\n    'linear': Interpolation.Linear,\r\n    'bezier': Interpolation.Bezier,\r\n    'catmull-rom': Interpolation.CatmullRom\r\n};\r\n\r\nexport default Interpolation;\r\n","import Tween from \"transitions/Tween\";\r\n\r\nlet EasingEnum;\r\n\r\n/**\r\n * @class Easing\r\n * @exports module:transitions/utils/Easing\r\n *\r\n * @type {{Linear: {None: Easing.Linear.None}, Quadratic: {In: Easing.Quadratic.In, Out: Easing.Quadratic.Out, InOut: Easing.Quadratic.InOut}, Cubic: {In: Easing.Cubic.In, Out: Easing.Cubic.Out, InOut: Easing.Cubic.InOut}, Quartic: {In: Easing.Quartic.In, Out: Easing.Quartic.Out, InOut: Easing.Quartic.InOut}, Quintic: {In: Easing.Quintic.In, Out: Easing.Quintic.Out, InOut: Easing.Quintic.InOut}, Sinusoidal: {In: Easing.Sinusoidal.In, Out: Easing.Sinusoidal.Out, InOut: Easing.Sinusoidal.InOut}, Exponential: {In: Easing.Exponential.In, Out: Easing.Exponential.Out, InOut: Easing.Exponential.InOut}, Circular: {In: Easing.Circular.In, Out: Easing.Circular.Out, InOut: Easing.Circular.InOut}, Elastic: {In: Easing.Elastic.In, Out: Easing.Elastic.Out, InOut: Easing.Elastic.InOut}, Back: {In: Easing.Back.In, Out: Easing.Back.Out, InOut: Easing.Back.InOut}, Bounce: {In: Easing.Bounce.In, Out: Easing.Bounce.Out, InOut: Easing.Bounce.InOut}}}\r\n */\r\nlet Easing = {\r\n    Linear: {\r\n        /**\r\n         * @return {number}\r\n         */\r\n        None: function (k) {\r\n            return k;\r\n        }\r\n    },\r\n    Quadratic: {\r\n        /**\r\n         * @return {number}\r\n         */\r\n        In: function (k) {\r\n            return k * k;\r\n        },\r\n\r\n        /**\r\n         * @return {number}\r\n         */\r\n        Out: function (k) {\r\n            return k * (2 - k);\r\n        },\r\n\r\n        /**\r\n         * @return {number}\r\n         */\r\n        InOut: function (k) {\r\n            if ((k *= 2) < 1) return 0.5 * k * k;\r\n            return -0.5 * (--k * (k - 2) - 1);\r\n        }\r\n    },\r\n\r\n    Cubic: {\r\n        /**\r\n         * @return {number}\r\n         */\r\n        In: function (k) {\r\n            return k * k * k;\r\n        },\r\n\r\n        /**\r\n         * @return {number}\r\n         */\r\n        Out: function (k) {\r\n            return --k * k * k + 1;\r\n        },\r\n\r\n        /**\r\n         * @return {number}\r\n         */\r\n        InOut: function (k) {\r\n            if ((k *= 2) < 1) return 0.5 * k * k * k;\r\n            return 0.5 * ((k -= 2) * k * k + 2);\r\n        }\r\n    },\r\n\r\n    Quartic: {\r\n        /**\r\n         * @return {number}\r\n         */\r\n        In: function (k) {\r\n            return k * k * k * k;\r\n        },\r\n\r\n        /**\r\n         * @return {number}\r\n         */\r\n        Out: function (k) {\r\n            return 1 - (--k * k * k * k);\r\n        },\r\n\r\n        /**\r\n         * @return {number}\r\n         */\r\n        InOut: function (k) {\r\n            if ((k *= 2) < 1)  return 0.5 * k * k * k * k;\r\n            return -0.5 * ((k -= 2) * k * k * k - 2);\r\n        }\r\n    },\r\n\r\n    Quintic: {\r\n        /**\r\n         * @return {number}\r\n         */\r\n        In: function (k) {\r\n            return k * k * k * k * k;\r\n        },\r\n\r\n        /**\r\n         * @return {number}\r\n         */\r\n        Out: function (k) {\r\n            return --k * k * k * k * k + 1;\r\n        },\r\n\r\n        /**\r\n         * @return {number}\r\n         */\r\n        InOut: function (k) {\r\n            if ((k *= 2) < 1) return 0.5 * k * k * k * k * k;\r\n            return 0.5 * ((k -= 2) * k * k * k * k + 2);\r\n        }\r\n\r\n    },\r\n\r\n    Sinusoidal: {\r\n        /**\r\n         * @return {number}\r\n         */\r\n        In: function (k) {\r\n            return 1 - Math.cos(k * Math.PI / 2);\r\n        },\r\n\r\n        /**\r\n         * @return {number}\r\n         */\r\n        Out: function (k) {\r\n            return Math.sin(k * Math.PI / 2);\r\n        },\r\n\r\n        /**\r\n         * @return {number}\r\n         */\r\n        InOut: function (k) {\r\n            return 0.5 * (1 - Math.cos(Math.PI * k));\r\n        }\r\n    },\r\n\r\n    Exponential: {\r\n        /**\r\n         * @return {number}\r\n         */\r\n        In: function (k) {\r\n            return k === 0 ? 0 : Math.pow(1024, k - 1);\r\n        },\r\n\r\n        /**\r\n         * @return {number}\r\n         */\r\n        Out: function (k) {\r\n            return k === 1 ? 1 : 1 - Math.pow(2, -10 * k);\r\n        },\r\n\r\n        /**\r\n         * @return {number}\r\n         */\r\n        InOut: function (k) {\r\n            if (k === 0) return 0;\r\n            if (k === 1) return 1;\r\n            if ((k *= 2) < 1) return 0.5 * Math.pow(1024, k - 1);\r\n\r\n            return 0.5 * (-Math.pow(2, -10 * (k - 1)) + 2);\r\n        }\r\n    },\r\n\r\n    Circular: {\r\n        /**\r\n         * @return {number}\r\n         */\r\n        In: function (k) {\r\n            return 1 - Math.sqrt(1 - k * k);\r\n        },\r\n\r\n        /**\r\n         * @return {number}\r\n         */\r\n        Out: function (k) {\r\n            return Math.sqrt(1 - (--k * k));\r\n        },\r\n\r\n        /**\r\n         * @return {number}\r\n         */\r\n        InOut: function (k) {\r\n            if ((k *= 2) < 1) return -0.5 * (Math.sqrt(1 - k * k) - 1);\r\n            return 0.5 * (Math.sqrt(1 - (k -= 2) * k) + 1);\r\n        }\r\n    },\r\n\r\n    Elastic: {\r\n        /**\r\n         * @return {number}\r\n         */\r\n        In: function (k) {\r\n            var s;\r\n            var a = 0.1;\r\n            var p = 0.4;\r\n\r\n            if (k === 0) return 0;\r\n            if (k === 1) return 1;\r\n\r\n            if (!a || a < 1) {\r\n                a = 1;\r\n                s = p / 4;\r\n            } else {\r\n                s = p * Math.asin(1 / a) / (2 * Math.PI);\r\n            }\r\n\r\n            return -(a * Math.pow(2, 10 * (k -= 1)) * Math.sin((k - s) * (2 * Math.PI) / p));\r\n        },\r\n\r\n        /**\r\n         * @return {number}\r\n         */\r\n        Out: function (k) {\r\n            var s;\r\n            var a = 0.1;\r\n            var p = 0.4;\r\n\r\n            if (k === 0) return 0;\r\n            if (k === 1) return 1;\r\n\r\n            if (!a || a < 1) {\r\n                a = 1;\r\n                s = p / 4;\r\n            } else {\r\n                s = p * Math.asin(1 / a) / (2 * Math.PI);\r\n            }\r\n\r\n            return (a * Math.pow(2, -10 * k) * Math.sin((k - s) * (2 * Math.PI) / p) + 1);\r\n        },\r\n\r\n        /**\r\n         * @return {number}\r\n         */\r\n        InOut: function (k) {\r\n\r\n            var s;\r\n            var a = 0.1;\r\n            var p = 0.4;\r\n\r\n            if (k === 0) return 0;\r\n            if (k === 1) return 1;\r\n\r\n            if (!a || a < 1) {\r\n                a = 1;\r\n                s = p / 4;\r\n            } else {\r\n                s = p * Math.asin(1 / a) / (2 * Math.PI);\r\n            }\r\n\r\n            if ((k *= 2) < 1) {\r\n                return -0.5 * (a * Math.pow(2, 10 * (k -= 1)) * Math.sin((k - s) * (2 * Math.PI) / p));\r\n            }\r\n\r\n            return a * Math.pow(2, -10 * (k -= 1)) * Math.sin((k - s) * (2 * Math.PI) / p) * 0.5 + 1;\r\n\r\n        }\r\n\r\n    },\r\n\r\n    Back: {\r\n        /**\r\n         * @return {number}\r\n         */\r\n        In: function (k) {\r\n            var s = 1.70158;\r\n\r\n            return k * k * ((s + 1) * k - s);\r\n        },\r\n\r\n        /**\r\n         * @return {number}\r\n         */\r\n        Out: function (k) {\r\n            var s = 1.70158;\r\n\r\n            return --k * k * ((s + 1) * k + s) + 1;\r\n        },\r\n\r\n        /**\r\n         * @return {number}\r\n         */\r\n        InOut: function (k) {\r\n            var s = 1.70158 * 1.525;\r\n            if ((k *= 2) < 1) return 0.5 * (k * k * ((s + 1) * k - s));\r\n\r\n            return 0.5 * ((k -= 2) * k * ((s + 1) * k + s) + 2);\r\n        }\r\n    },\r\n\r\n    Bounce: {\r\n        /**\r\n         * @return {number}\r\n         */\r\n        In: function (k) {\r\n            return 1 - Tween.Easing.Bounce.Out(1 - k);\r\n        },\r\n\r\n        /**\r\n         * @return {number}\r\n         */\r\n        Out: function (k) {\r\n            if (k < (1 / 2.75)) {\r\n                return 7.5625 * k * k;\r\n            } else if (k < (2 / 2.75)) {\r\n                return 7.5625 * (k -= (1.5 / 2.75)) * k + 0.75;\r\n            } else if (k < (2.5 / 2.75)) {\r\n                return 7.5625 * (k -= (2.25 / 2.75)) * k + 0.9375;\r\n            } else {\r\n                return 7.5625 * (k -= (2.625 / 2.75)) * k + 0.984375;\r\n            }\r\n        },\r\n\r\n        /**\r\n         * @return {number}\r\n         */\r\n        InOut: function (k) {\r\n            if (k < 0.5) return Tween.Easing.Bounce.In(k * 2) * 0.5;\r\n            return Tween.Easing.Bounce.Out(k * 2 - 1) * 0.5 + 0.5;\r\n        }\r\n    },\r\n\r\n    get: (easing) => {\r\n        if (EasingEnum[easing] !== undefined) {\r\n            return EasingEnum[easing];\r\n        }\r\n\r\n        // TODO:: Exceptions\r\n        //throw new InvalidArgumentException('Unknown easing: ' + easing);\r\n    },\r\n    register: (easing, easingFunction) => {\r\n        EasingEnum[easing] = easingFunction;\r\n    }\r\n};\r\n\r\nEasingEnum = {\r\n    'linear': Easing.Linear.None,\r\n\r\n    'quadratic-in': Easing.Quadratic.In,\r\n    'quadratic-out': Easing.Quadratic.Out,\r\n    'quadratic-in-out': Easing.Quadratic.InOut,\r\n\r\n    'cubic-in': Easing.Cubic.In,\r\n    'cubic-out': Easing.Cubic.Out,\r\n    'cubic-in-out': Easing.Cubic.InOut,\r\n\r\n    'quartic-in': Easing.Quartic.In,\r\n    'quartic-out': Easing.Quartic.Out,\r\n    'quartic-in-out': Easing.Quartic.InOut,\r\n\r\n    'quintic-in': Easing.Quintic.In,\r\n    'quintic-out': Easing.Quintic.Out,\r\n    'quintic-in-out': Easing.Quintic.InOut,\r\n\r\n    'sinusoidal-in': Easing.Sinusoidal.In,\r\n    'sinusoidal-out': Easing.Sinusoidal.Out,\r\n    'sinusoidal-in-out': Easing.Sinusoidal.InOut,\r\n\r\n    'exponential-in': Easing.Exponential.In,\r\n    'exponential-out': Easing.Exponential.Out,\r\n    'exponential-in-out': Easing.Exponential.InOut,\r\n\r\n    'circular-in': Easing.Circular.In,\r\n    'circular-out': Easing.Circular.Out,\r\n    'circular-in-out': Easing.Circular.InOut,\r\n\r\n    'elastic-in': Easing.Elastic.In,\r\n    'elastic-out': Easing.Elastic.Out,\r\n    'elastic-in-out': Easing.Elastic.InOut,\r\n\r\n    'back-in': Easing.Back.In,\r\n    'back-out': Easing.Back.Out,\r\n    'back-in-out': Easing.Back.InOut,\r\n\r\n    'bounce-in': Easing.Bounce.In,\r\n    'bounce-out': Easing.Bounce.Out,\r\n    'bounce-in-out': Easing.Bounce.InOut\r\n};\r\n\r\nexport default Easing;\r\n","import Rectangle from \"nodes/primitive2D/Rectangle\";\r\n\r\n/**\r\n * Rectangle\r\n * @constructor\r\n *\r\n * @property {BaseNode._data|{position: Array.<number>, size: Array.<number>}} _data\r\n */\r\nexport default class Sprite extends Rectangle {\r\n    textureBuffer = null;\r\n    texture = null;\r\n\r\n    bindTextureBuffer(gl) {\r\n        this.textureBuffer = gl.createBuffer();\r\n        gl.bindBuffer(gl.ARRAY_BUFFER, this.textureBuffer);\r\n\r\n        gl.bufferData(gl.ARRAY_BUFFER, new Float32Array([\r\n            0.0, 0.0,\r\n            1.0, 0.0,\r\n            0.0, 1.0,\r\n            0.0, 1.0,\r\n            1.0, 0.0,\r\n            1.0, 1.0\r\n        ]), gl.STATIC_DRAW);\r\n    }\r\n\r\n    bindTexture(gl) {\r\n        this.texture = gl.createTexture();\r\n        gl.bindTexture(gl.TEXTURE_2D, this.texture);\r\n        gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, 1, 1, 0, gl.RGBA, gl.UNSIGNED_BYTE, new Uint8Array([0, 0, 0, 0]));\r\n\r\n        let image = new Image();\r\n        image.src = 'img/logo.png';\r\n        image.addEventListener('load', () => {\r\n            gl.bindTexture(gl.TEXTURE_2D, this.texture);\r\n            gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA,gl.UNSIGNED_BYTE, image);\r\n            gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\r\n            gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR_MIPMAP_NEAREST);\r\n            gl.generateMipmap(gl.TEXTURE_2D);\r\n            gl.bindTexture(gl.TEXTURE_2D, null);\r\n        });\r\n    }\r\n\r\n    draw(context, viewport, data) {\r\n        let gl = context, scene = data.components.SceneHandler;\r\n\r\n        if (Sprite._shaderProgram && scene._data.render.startsWith('webgl')) {\r\n            // WebGL Render\r\n\r\n            let attributes = {\r\n                aPosition: gl.getAttribLocation(Sprite._shaderProgram, 'aPosition'),\r\n                aTexture: gl.getAttribLocation(Sprite._shaderProgram, 'aTexture'),\r\n                uTexture: gl.getUniformLocation(Sprite._shaderProgram, 'uTexture'),\r\n                uResolution: gl.getUniformLocation(Sprite._shaderProgram, 'uResolution'),\r\n                uPosition: gl.getUniformLocation(Sprite._shaderProgram, 'uPosition'),\r\n                uAngle: gl.getUniformLocation(Sprite._shaderProgram, 'uAngle'),\r\n                uScale: gl.getUniformLocation(Sprite._shaderProgram, 'uScale'),\r\n                uCenter: gl.getUniformLocation(Sprite._shaderProgram, 'uCenter')\r\n            };\r\n\r\n            if (this.positionBuffer === null) this.bindPositionBuffer(gl);\r\n            if (this.textureBuffer === null) this.bindTextureBuffer(gl);\r\n            if (this.texture === null) this.bindTexture(gl);\r\n\r\n            gl.useProgram(Sprite._shaderProgram);\r\n\r\n            gl.bindTexture(gl.TEXTURE_2D, this.texture);\r\n\r\n            gl.enableVertexAttribArray(attributes.aPosition);\r\n            gl.bindBuffer(gl.ARRAY_BUFFER, this.positionBuffer);\r\n            gl.vertexAttribPointer(attributes.aPosition, 2, gl.FLOAT, false, 0, 0);\r\n\r\n            gl.enableVertexAttribArray(attributes.aTexture);\r\n            gl.bindBuffer(gl.ARRAY_BUFFER, this.textureBuffer);\r\n            gl.vertexAttribPointer(attributes.aTexture, 2, gl.FLOAT, false, 0, 0);\r\n\r\n            gl.uniform2fv(attributes.uResolution, new Float32Array([gl.canvas.clientWidth, gl.canvas.clientHeight]));\r\n            gl.uniform2fv(attributes.uPosition, new Float32Array(this._data.position));\r\n            gl.uniform1f(attributes.uAngle, this._data.angle);\r\n            gl.uniform2fv(attributes.uScale, new Float32Array(this._data.scale));\r\n            gl.uniform2fv(attributes.uCenter, new Float32Array(this._data.center));\r\n\r\n            gl.uniform1i(attributes.uTexture, 0);\r\n\r\n            gl.drawArrays(gl.TRIANGLES, 0, 6);\r\n        } else {\r\n            // Canvas2D Render\r\n            let tempOpacity = 1.0;\r\n\r\n            if (this._data.opacity !== 1.0) {\r\n                tempOpacity = context.globalAlpha;\r\n                context.globalAlpha = this._data.opacity;\r\n            }\r\n\r\n            if (this._data.angle) {\r\n                context.save();\r\n\r\n                context.translate(this._data.position[0], this._data.position[1]);\r\n                context.rotate(this._data.angle);\r\n                context.translate(-(this._data.position[0]), -(this._data.position[1]));\r\n            }\r\n\r\n            context.fillStyle = this._colorRGBA;\r\n            context.lineWidth = 0;\r\n\r\n            context.fillRect(\r\n                this._data.position[0] - this._data.size[0] / 2,\r\n                this._data.position[1] - this._data.size[1] / 2,\r\n                this._data.size[0] * this._data.scale[0],\r\n                this._data.size[1] * this._data.scale[1]\r\n            );\r\n\r\n            if (this._data.angle) {\r\n                context.restore();\r\n            }\r\n\r\n            if (this._data.opacity !== 1.0) {\r\n                context.globalAlpha = tempOpacity;\r\n            }\r\n        }\r\n    }\r\n\r\n    static _vertextShader = null;\r\n    static _fragmentShader = null;\r\n    static _shaderProgram = null;\r\n\r\n    static VertexShader = Rectangle.VertexShader;\r\n\r\n    // language=GLSL\r\n    static FragmentShader = `\r\n        precision mediump float;\r\n        varying vec2 vTexture; \r\n        uniform sampler2D uTexture;\r\n        \r\n        void main() {\r\n            gl_FragColor = texture2D(uTexture, vTexture);\r\n        }\r\n    `;\r\n}\r\n","import BaseNode from \"nodes/BaseNode\";\r\nimport MathUtil from \"utils/MathUtil\";\r\n\r\n/**\r\n * Rectangle\r\n * @constructor\r\n *\r\n * @property {BaseNode._data|{position: Array.<number>, size: Array.<number>}} _data\r\n */\r\nexport default class Rectangle extends BaseNode {\r\n    _webGLCache = {\r\n        positionBuffer: null,\r\n        attributes: [],\r\n        cacheData: null\r\n    };\r\n\r\n    constructor(x, y, width, height) {\r\n        super({\r\n            position: [x || 0.0, y || 0.0],\r\n            size: [width || 0.0, height || 0.0],\r\n            angle: MathUtil.degree2Radian(45),\r\n            scale: [1.0, 1.0],\r\n            center: [0.0, 0.0],\r\n            color: [Math.random(), Math.random(), Math.random(), 1.0],\r\n            opacity: 1.0\r\n        });\r\n\r\n        this._colorRGBA = MathUtil.vectorColorToRGBA(this._data.color);\r\n\r\n        this.setWebGLCache();\r\n        this.toCenter();\r\n    }\r\n\r\n    toCenter(cx, cy) {\r\n        if (cx === undefined) cx = this._data.size[0] / 2;\r\n        if (cy === undefined) cy = this._data.size[1] / 2;\r\n\r\n        this._data.center = [-cx, -cy];\r\n        this._webGLCache.cacheData.uCenter = new Float32Array([-cx, -cy])\r\n    }\r\n\r\n    setWebGLCache() {\r\n        this._webGLCache.cacheData = {\r\n            uResolution: null,\r\n            uPosition: new Float32Array(this._data.position),\r\n            uScale: new Float32Array(this._data.scale),\r\n            uCenter: new Float32Array(this._data.center),\r\n            uColor: new Float32Array(this._data.color)\r\n        };\r\n    }\r\n\r\n    bindPositionBuffer(gl) {\r\n        this._webGLCache.positionBuffer = gl.createBuffer();\r\n        gl.bindBuffer(gl.ARRAY_BUFFER, this._webGLCache.positionBuffer);\r\n\r\n        let x = [0, this._data.size[0]];\r\n        let y = [0, this._data.size[1]];\r\n\r\n        gl.bufferData(gl.ARRAY_BUFFER, new Float32Array([\r\n            x[0], y[0],\r\n            x[1], y[0],\r\n            x[0], y[1],\r\n            x[0], y[1],\r\n            x[1], y[0],\r\n            x[1], y[1],\r\n        ]), gl.STATIC_DRAW);\r\n    }\r\n\r\n    bindAttributes(gl) {\r\n        this._webGLCache.attributes = {\r\n            aPosition: gl.getAttribLocation(Rectangle._shaderProgram, 'aPosition'),\r\n            uColor: gl.getUniformLocation(Rectangle._shaderProgram, 'uColor'),\r\n            uResolution: gl.getUniformLocation(Rectangle._shaderProgram, 'uResolution'),\r\n            uPosition: gl.getUniformLocation(Rectangle._shaderProgram, 'uPosition'),\r\n            uAngle: gl.getUniformLocation(Rectangle._shaderProgram, 'uAngle'),\r\n            uScale: gl.getUniformLocation(Rectangle._shaderProgram, 'uScale'),\r\n            uCenter: gl.getUniformLocation(Rectangle._shaderProgram, 'uCenter')\r\n        };\r\n    }\r\n\r\n    draw(context, viewport, data) {\r\n        let gl = context, scene = data.components.SceneHandler;\r\n\r\n        if (Rectangle._shaderProgram && scene._data.render.startsWith('webgl')) {\r\n            // WebGL Render\r\n\r\n            if (this._webGLCache.attributes.length === 0) this.bindAttributes(gl);\r\n            if (this._webGLCache.positionBuffer === null) this.bindPositionBuffer(gl);\r\n            if (this._webGLCache.cacheData.uResolution === null) {\r\n                this._webGLCache.cacheData.uResolution = new Float32Array([gl.canvas.clientWidth, gl.canvas.clientHeight]);\r\n            }\r\n\r\n            if(scene._data.program === undefined || scene._data.program !== 'RECTANGLE') {\r\n                gl.useProgram(Rectangle._shaderProgram);\r\n                scene._data.program = 'RECTANGLE';\r\n            }\r\n\r\n            gl.enableVertexAttribArray(this._webGLCache.attributes.aPosition);\r\n            gl.bindBuffer(gl.ARRAY_BUFFER, this._webGLCache.positionBuffer);\r\n            gl.vertexAttribPointer(this._webGLCache.attributes.aPosition, 2, gl.FLOAT, false, 0, 0);\r\n\r\n            gl.uniform2fv(this._webGLCache.attributes.uResolution, this._webGLCache.cacheData.uResolution);\r\n            gl.uniform2fv(this._webGLCache.attributes.uPosition, this._webGLCache.cacheData.uPosition);\r\n            gl.uniform1f(this._webGLCache.attributes.uAngle, this._data.angle);\r\n            gl.uniform2fv(this._webGLCache.attributes.uScale, this._webGLCache.cacheData.uScale);\r\n            gl.uniform2fv(this._webGLCache.attributes.uCenter, this._webGLCache.cacheData.uCenter);\r\n\r\n            gl.uniform4fv(this._webGLCache.attributes.uColor, this._webGLCache.cacheData.uColor);\r\n\r\n            gl.drawArrays(gl.TRIANGLES, 0, 6);\r\n        } else {\r\n            // Canvas2D Render\r\n            let tempOpacity = 1.0;\r\n\r\n            if (this._data.opacity !== 1.0) {\r\n                tempOpacity = context.globalAlpha;\r\n                context.globalAlpha = this._data.opacity;\r\n            }\r\n\r\n            if (this._data.angle) {\r\n                context.save();\r\n\r\n                context.translate(this._data.position[0], this._data.position[1]);\r\n                context.rotate(this._data.angle);\r\n                context.translate(-(this._data.position[0]), -(this._data.position[1]));\r\n            }\r\n\r\n            context.fillStyle = this._colorRGBA;\r\n            context.lineWidth = 0;\r\n\r\n            context.fillRect(\r\n                this._data.position[0] - this._data.size[0] / 2,\r\n                this._data.position[1] - this._data.size[1] / 2,\r\n                this._data.size[0] * this._data.scale[0],\r\n                this._data.size[1] * this._data.scale[1]\r\n            );\r\n\r\n            if (this._data.angle) {\r\n                context.restore();\r\n            }\r\n\r\n            if (this._data.opacity !== 1.0) {\r\n                context.globalAlpha = tempOpacity;\r\n            }\r\n        }\r\n    }\r\n\r\n    render(context, viewport, data) {\r\n        this.draw(context, viewport, data);\r\n    }\r\n\r\n    static _vertextShader = null;\r\n    static _fragmentShader = null;\r\n    static _shaderProgram = null;\r\n\r\n    // language=GLSL\r\n    static VertexShader = `\r\n        precision mediump float;\r\n\r\n        attribute vec2 aPosition;\r\n        uniform vec2 uResolution;\r\n        uniform vec2 uPosition;\r\n        uniform float uAngle;\r\n        uniform vec2 uScale;\r\n        uniform vec2 uCenter;\r\n        \r\n        attribute vec2 aTexture;\r\n        varying vec2 vTexture;\r\n        \r\n        mat3 projection () {\r\n            return mat3(\r\n                2.0 / uResolution[0], 0.0, 0.0,\r\n                0.0, -2.0 / uResolution[1], 0.0,\r\n                -1.0, 1.0, 1.0\r\n            );\r\n        }\r\n        \r\n        mat3 translate (mat3 m) {\r\n            return m * mat3(\r\n                1.0, 0.0, 0.0,\r\n                0.0, 1.0, 0.0,\r\n                uPosition[0], uPosition[1], 1.0\r\n            );\r\n        }\r\n        \r\n         mat3 rotate (mat3 m) {\r\n            float s = sin(uAngle);\r\n            float c = cos(uAngle);\r\n            return m * mat3(\r\n                c, s, 0.0,\r\n                -s, c, 0.0,\r\n                0.0, 0.0, 1.0\r\n            );\r\n        }\r\n        \r\n        mat3 scale (mat3 m) {\r\n            return m * mat3(\r\n                uScale[0], 0.0, 0.0,\r\n                0.0, uScale[1], 0.0,\r\n                0.0, 0.0, 1.0\r\n            );\r\n        }\r\n        \r\n        mat3 center (mat3 m) {\r\n            return m * mat3(\r\n                1.0, 0.0, 0.0,\r\n                0.0, 1.0, 0.0,\r\n                uCenter[0], uCenter[1], 1.0\r\n            );\r\n        }\r\n\r\n        void main() {\r\n            gl_Position = vec4((center(scale(rotate(translate(projection())))) * vec3(aPosition, 1)).xy, 0, 1);\r\n            vTexture = aTexture;\r\n        }\r\n    `;\r\n\r\n    // language=GLSL\r\n    static FragmentShader = `\r\n        precision mediump float;\r\n        \r\n        uniform vec4 uColor;\r\n        \r\n        void main() {\r\n            gl_FragColor = uColor;\r\n        }\r\n    `;\r\n};\r\n","import Pointer from \"io/devices/Pointer\";\r\n\r\nexport default class Touch extends Pointer {\r\n    static DeviceName = Pointer.prototype.constructor.name; // this fix device name in InputHandler\r\n\r\n    constructor(input) {\r\n        super(input);\r\n    }\r\n\r\n    init(input) {\r\n        if (input !== undefined && this.input === undefined) this.input = input;\r\n        return true;\r\n    };\r\n\r\n    update() {\r\n        return true;\r\n    };\r\n\r\n    clear() {\r\n        return true;\r\n    };\r\n\r\n    enable() {\r\n        throw new Error('Error. IO interface \"' + Touch.IO + '\" exist, but not supported yet.');\r\n        //return true;\r\n    };\r\n\r\n    disable() {\r\n        throw new Error('Error. IO interface \"' + Touch.IO + '\" exist, but not supported yet.');\r\n        //return true;\r\n    };\r\n}\r\n","import Device from \"api/Device\";\r\n\r\nexport default class Pointer extends Device {\r\n    constructor(input) {\r\n        super(input);\r\n        if (this.constructor.name === 'Pointer') {\r\n            throw new Error('Error. Pointer is abstract class.');\r\n        }\r\n    }\r\n\r\n    setPointerImage(image) {\r\n        if (image) {\r\n            switch (image) {\r\n                case 'none':\r\n                case 'default':\r\n                case 'auto':\r\n                case 'crosshair':\r\n                case 'e-resize':\r\n                case 'help':\r\n                case 'move':\r\n                case 'n-resize':\r\n                case 'ne-resize':\r\n                case 'nw-resize':\r\n                case 'pointer':\r\n                case 'progress':\r\n                case 's-resize':\r\n                case 'se-resize':\r\n                case 'sw-resize':\r\n                case 'text':\r\n                case 'w-resize':\r\n                case 'wait':\r\n                case 'inherit':\r\n                    break;\r\n                default:\r\n                    image = 'url(\"' + image + '\"), auto'\r\n            }\r\n        }\r\n        this.input.data.pointer.image = this.input.store.pointer.image = this.input.options.cursor = image;\r\n        window.document.body.style.cursor = this.input.data.pointer.image;\r\n        return this;\r\n    };\r\n\r\n    toggleCursor(toggle) {\r\n        if (this.input.data.image !== 'none' && (toggle === undefined || toggle === false)) {\r\n            this.input.store.pointer.image = window.document.body.style.cursor;\r\n            window.document.body.style.cursor = 'none';\r\n        } else {\r\n            window.document.body.style.cursor = this.input.store.pointer.image;\r\n        }\r\n        return this;\r\n    };\r\n\r\n    isPointerVisible() {\r\n        return this.input.data.pointer.image === 'none';\r\n    };\r\n\r\n    getPointerPosition() {\r\n        if (this.data.pointer === undefined) return [0, 0];\r\n        return [this.data.pointer.x, this.data.pointer.y];\r\n    };\r\n\r\n    getPointerMoveDistance() {\r\n        if (this.data.pointer === undefined) return 0;\r\n        return this.data.pointer.distance;\r\n    };\r\n}\r\n","import Pointer from \"io/devices/Pointer\";\r\n\r\nexport default class Mouse extends Pointer {\r\n    static DeviceName = Pointer.prototype.constructor.name; // this fix device name in InputHandler\r\n\r\n    __fixMouseButtonId = (id) => {\r\n        if (id > 2) {\r\n            return id;\r\n        } else if (id === 0) {\r\n            return 'LEFT';\r\n        } else if (id === 1) {\r\n            return 'MIDDLE';\r\n        } else if (id === 2) {\r\n            return 'RIGHT';\r\n        }\r\n    };\r\n\r\n    keyMouseDownEventHandler = (e) => {\r\n        if (this.input.isEnabled && this.input.preventDefault) e.preventDefault();\r\n\r\n        let keyCode = this.input.KEYS_HELPER.getKeyById('KEY_MOUSE_' + this.__fixMouseButtonId(e.button));\r\n        if (!(this.input.data.keys.keysDown.indexOf(keyCode) !== -1)) {\r\n            this.input.data.keys.keysDown.push(keyCode);\r\n        }\r\n\r\n        this.input.store.recordMouseDragDistance = true;\r\n        this.input.store.pointer = {\r\n            tracker: {\r\n                x: e.pageX,\r\n                y: e.pageY\r\n            }\r\n        };\r\n\r\n        this.input.store.recordMouseClickTime = true;\r\n        if (this.input.store.keys.pressedTime[keyCode] !== undefined) {\r\n            this.input.store.keys.pressedTime[keyCode].delta = this.input.store.keys.pressedTime[keyCode].startTime - e.timeStamp\r\n        } else {\r\n            this.input.store.keys.pressedTime[keyCode] = {\r\n                startTime: e.timeStamp,\r\n                delta: 0\r\n            };\r\n        }\r\n\r\n        this.input.events.trigger('io.mouseKeyDown', e);\r\n    };\r\n\r\n    keyMouseUpEventHandler = (e) => {\r\n        if (this.input.isEnabled && this.input.preventDefault) e.preventDefault();\r\n\r\n        let keyCode = this.input.KEYS_HELPER.getKeyById('KEY_MOUSE_' + this.__fixMouseButtonId(e.button));\r\n        if (!(this.input.data.keys.keysUp.indexOf(keyCode) !== -1)) {\r\n            this.input.data.keys.keysUp.push(keyCode);\r\n        }\r\n\r\n        this.input.store.recordMouseDragDistance = false;\r\n        this.input.data.pointer.distance = 0;\r\n        this.input.store.pointer = {\r\n            tracker: {\r\n                x: 0,\r\n                y: 0\r\n            }\r\n        };\r\n\r\n        this.input.store.recordMouseClickTime = false;\r\n        if (this.input.store.keys.pressedTime[keyCode] !== undefined) {\r\n            this.input.store.keys.pressedTime.splice(keyCode, 1)\r\n        }\r\n\r\n        this.input.events.trigger('io.mouseKeyUp', e);\r\n    };\r\n\r\n    keyMouseMoveEventHandler = (e) => {\r\n        if (this.input.isEnabled && this.input.preventDefault) e.preventDefault();\r\n\r\n        this.input.data.pointer = {\r\n            x: e.pageX,\r\n            y: e.pageY,\r\n            distance: (this.input.store.recordMouseDragDistance) ? Math.sqrt(\r\n                Math.pow((e.pageX - this.input.store.pointer.tracker.x), 2)\r\n                + Math.pow((e.pageY - this.input.store.pointer.tracker.y), 2)\r\n            ).toFixed(2) : 0.0,\r\n            image: this.input.data.pointer.image\r\n        };\r\n\r\n        this.input.events.trigger('io.mouseMove', e);\r\n    };\r\n\r\n    scrollMouseEventHandler = (e) => {\r\n        if (this.input.isEnabled && this.input.preventDefault) e.preventDefault();\r\n\r\n        let keyCode = (e.wheelDelta / 120 > 0)\r\n            ? this.input.KEYS_HELPER.getKeyById('SCROLL_MOUSE_UP')\r\n            : this.input.KEYS_HELPER.getKeyById('SCROLL_MOUSE_DOWN');\r\n\r\n        if (!(this.input.data.keys.keysUp.indexOf(keyCode) !== -1)) {\r\n            this.input.data.keys.keysUp.push(keyCode);\r\n            this.input.data.keys.keysDown.push(keyCode);\r\n        }\r\n\r\n        this.input.events.trigger('io.mouseScroll', e);\r\n    };\r\n\r\n    init(input) {\r\n        super.init(input);\r\n        this.input.data.keys = {\r\n            keysUp: [],\r\n            keysDown: []\r\n        };\r\n        this.input.store.keys = {\r\n            pressedTime: []\r\n        };\r\n        this.input.data.pointer = {\r\n            image: this.input.options.cursor || 'none',\r\n            x: 0,\r\n            y: 0,\r\n            distance: 0\r\n        };\r\n        this.input.store.pointer = {\r\n            tracker: {\r\n                x: 0,\r\n                y: 0\r\n            },\r\n            image: this.input.options.cursor || 'none'\r\n        };\r\n        this.input.store.recordMouseDragDistance = false;\r\n        this.input.store.recordMouseClickTime = false;\r\n        this.setPointerImage(this.input.options.cursor || 'none');\r\n    };\r\n\r\n    update() {\r\n        //TODO:: fix pointer by viewport scene\r\n        return true;\r\n    };\r\n\r\n    clear() {\r\n        if (this.input.data.keys !== undefined) {\r\n            this.input.data.keys = {\r\n                keysUp: [],\r\n                keysDown: []\r\n            };\r\n        }\r\n        if (this.input.data.pointer !== undefined) {\r\n            this.input.data.pointer = {\r\n                image: this.input.options.pointer || 'none',\r\n                x: 0,\r\n                y: 0,\r\n                distance: 0\r\n            };\r\n        }\r\n        return true;\r\n    };\r\n\r\n    enable() {\r\n        window.addEventListener('mousedown', this.keyMouseDownEventHandler, false);\r\n        window.addEventListener('mouseup', this.keyMouseUpEventHandler, false);\r\n        window.addEventListener('mousemove', this.keyMouseMoveEventHandler, false);\r\n        window.addEventListener('wheel', this.scrollMouseEventHandler, false);\r\n        return true;\r\n    };\r\n\r\n    disable() {\r\n        window.removeEventListener('mousedown', this.keyMouseDownEventHandler, false);\r\n        window.removeEventListener('mouseup', this.keyMouseUpEventHandler, false);\r\n        window.removeEventListener('mousemove', this.keyMouseMoveEventHandler, false);\r\n        window.removeEventListener('wheel', this.scrollMouseEventHandler, false);\r\n        return true;\r\n    };\r\n}\r\n","import Device from \"api/Device\";\r\n\r\nexport default class Keyboard extends Device {\r\n    keyDownEventHandler = (e) => {\r\n        if (this.input.isEnabled && this.input.preventDefault) e.preventDefault();\r\n        if (!(this.input.data.keys.keysDown.indexOf(e.keyCode) !== -1)) {\r\n            this.input.data.keys.keysDown.push(e.keyCode);\r\n        }\r\n\r\n        this.input.store.recordKeyPressTime = true;\r\n        if (this.input.store.keys.pressedTime[e.keyCode] !== undefined) {\r\n            this.input.store.keys.pressedTime[e.keyCode].delta = this.input.store.keys.pressedTime[e.keyCode].startTime - e.timeStamp\r\n        } else {\r\n            this.input.store.keys.pressedTime[e.keyCode] = {\r\n                startTime: e.timeStamp,\r\n                delta: 0\r\n            };\r\n        }\r\n\r\n        this.input.events.trigger('io.keyboardKeyDown', e);\r\n    };\r\n\r\n    keyUpEventHandler = (e) => {\r\n        if (this.input.isEnabled && this.input.preventDefault) e.preventDefault();\r\n        if (!(this.input.data.keys.keysUp.indexOf(e.keyCode) !== -1)) {\r\n            this.input.data.keys.keysUp.push(e.keyCode);\r\n        }\r\n\r\n        this.input.store.recordKeyPressTime = false;\r\n        if (this.input.store.keys.pressedTime[e.keyCode] !== undefined) {\r\n            this.input.store.keys.pressedTime.splice(e.keyCode, 1)\r\n        }\r\n\r\n        this.input.events.trigger('io.keyboardKeyUp', e);\r\n    };\r\n\r\n    init(input) {\r\n        super.init(input);\r\n        this.input.data.keys = {\r\n            keysUp: [],\r\n            keysDown: []\r\n        };\r\n        this.input.store.keys = {\r\n            pressedTime: []\r\n        };\r\n        this.input.store.recordKeyPressTime = false;\r\n    };\r\n\r\n    update() {\r\n        return true;\r\n    };\r\n\r\n    clear() {\r\n        if (this.input.data.keys !== undefined) {\r\n            this.input.data.keys = {\r\n                keysUp: [],\r\n                keysDown: []\r\n            };\r\n        }\r\n        return true;\r\n    };\r\n\r\n    enable() {\r\n        window.addEventListener('keydown', this.keyDownEventHandler, false);\r\n        window.addEventListener('keyup', this.keyUpEventHandler, false);\r\n        return true;\r\n    };\r\n\r\n    disable() {\r\n        window.removeEventListener('keydown', this.keyDownEventHandler, false);\r\n        window.removeEventListener('keyup', this.keyUpEventHandler, false);\r\n        return true;\r\n    };\r\n};\r\n","import Device from \"api/Device\";\r\n\r\nexport default class Joystick extends Device {\r\n    constructor(input) {\r\n        super(input);\r\n    }\r\n\r\n    init(input) {\r\n        if (input !== undefined && this.input === undefined) this.input = input;\r\n        return true;\r\n    };\r\n\r\n    update() {\r\n        return true;\r\n    };\r\n\r\n    clear() {\r\n        return true;\r\n    };\r\n\r\n    enable() {\r\n        throw new Error('Error. IO interface \"' + Joystick.IO + '\" exist, but not supported yet.');\r\n        //return true;\r\n    };\r\n\r\n    disable() {\r\n        throw new Error('Error. IO interface \"' + Joystick.IO + '\" exist, but not supported yet.');\r\n        //return true;\r\n    };\r\n}\r\n\r\n","import PrototypeInterface from \"api/PrototypeInterface\";\r\n\r\n/**\r\n * IInputHandler\r\n * @constructor\r\n */\r\nexport default class IInputHandler extends PrototypeInterface {\r\n};\r\n","import PrototypeInterface from \"api/PrototypeInterface\";\r\n\r\n/**\r\n * IHandler\r\n * @constructor\r\n */\r\nexport default class IHandler extends PrototypeInterface {\r\n}\r\n","import PrototypeInterface from \"api/PrototypeInterface\";\r\n\r\n/**\r\n * IEngine\r\n * @constructor\r\n */\r\nexport default class IEngine extends PrototypeInterface {\r\n};\r\n","/**\r\n * @class Events\r\n * @exports module:utils/Events\r\n *\r\n * @constructor\r\n */\r\nexport default class Events {\r\n    events = [];\r\n    onces = [];\r\n\r\n    constructor() {\r\n        this.flush();\r\n    }\r\n\r\n    /**\r\n     * @param {string} [eventName]\r\n     */\r\n    flush(eventName) {\r\n        if (eventName !== undefined) {\r\n            if (this.events[eventName] !== undefined) {\r\n                this.events[eventName] = [];\r\n            }\r\n            if (this.onces[eventName] !== undefined) {\r\n                this.onces[eventName] = [];\r\n            }\r\n        } else {\r\n            this.onces = [];\r\n            this.events = [];\r\n        }\r\n    }\r\n\r\n\r\n    /**\r\n     * @param {string} eventName\r\n     * @param {function} callback\r\n     */\r\n    on(eventName, callback) {\r\n        if (this.events[eventName] !== undefined) {\r\n            var stack = this.events[eventName];\r\n            if (stack.indexOf(callback) === -1) {\r\n                stack.push(callback);\r\n            }\r\n        } else {\r\n            this.events[eventName] = [];\r\n            this.events[eventName].push(callback)\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @param {string} eventName\r\n     * @param {function} callback\r\n     */\r\n    once(eventName, callback) {\r\n        if (this.onces[eventName] !== undefined) {\r\n            var stack = this.onces[eventName];\r\n            if (stack.indexOf(callback) === -1) {\r\n                stack.push(callback);\r\n            }\r\n        } else {\r\n            this.onces[eventName] = [];\r\n            this.onces[eventName].push(callback)\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @param {string} eventName\r\n     * @param {function} callback\r\n     */\r\n    off(eventName, callback) {\r\n        if (this.onces[eventName] !== undefined) {\r\n            var stack = this.events[eventName];\r\n            if (stack.indexOf(callback) !== -1) {\r\n                stack.splice(stack.indexOf(callback));\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @param {string} eventName\r\n     * @param {Object} [data]\r\n     */\r\n    trigger(eventName, data) {\r\n        var stack, i;\r\n\r\n        if (this.events[eventName] !== undefined) {\r\n            stack = this.events[eventName];\r\n            for (i = 0; i < stack.length; i++) {\r\n                stack[i].call(stack[i], data);\r\n            }\r\n        }\r\n\r\n        if (this.onces[eventName] !== undefined) {\r\n            stack = this.onces[eventName];\r\n            for (i = 0; i < stack.length; i++) {\r\n                stack[i].call(stack[i], data);\r\n            }\r\n            this.flush(eventName);\r\n        }\r\n    };\r\n}\r\n","/**\r\n * @class ArrayMap\r\n * @exports module:utils/ArrayMap\r\n *\r\n * @constructor\r\n * @extends Array\r\n * @param args\r\n */\r\nexport default class ArrayMap extends Array {\r\n    last = () => {\r\n        return this[this.length - 1];\r\n    };\r\n\r\n    constructor(args) {\r\n        super(args);\r\n    }\r\n\r\n    /**\r\n     * @param {ArrayMap.<T>} array\r\n     * @returns {boolean}\r\n     */\r\n    equals(array) {\r\n        if (!array)\r\n            return false;\r\n\r\n        if (this.length != array.length)\r\n            return false;\r\n\r\n        for (var i = 0, l = this.length; i < l; i++) {\r\n            if (this[i] instanceof Array && array[i] instanceof Array) {\r\n                if (!this[i].equals(array[i]))\r\n                    return false;\r\n            }\r\n            else if (this[i] != array[i]) {\r\n                return false;\r\n            }\r\n        }\r\n        return true;\r\n    }\r\n\r\n    /**\r\n     * @param {string|Object} object\r\n     * @returns {boolean}\r\n     */\r\n    contains(object) {\r\n        var i = this.length;\r\n        while (i--) {\r\n            if (this[i] === object) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * @param {Function} callback\r\n     * @returns {boolean}\r\n     */\r\n    each(callback) {\r\n        if (!callback) return false;\r\n        var result = false;\r\n        for (var i = 0; i < this.length; i++) {\r\n            if ((result = callback(this[i], i)) == false) {\r\n                return result;\r\n            }\r\n        }\r\n        return result;\r\n    }\r\n\r\n    /**\r\n     * @param {string|Object} key\r\n     * @param {*} value\r\n     * @returns {ArrayMap.<T>}\r\n     */\r\n    add(key, value) {\r\n        if (this.contains(key))\r\n            this[key] = value;\r\n        else {\r\n            this.push(key);\r\n            this[key] = value;\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {string|Object} key\r\n     * @returns {*}\r\n     */\r\n    get(key) {\r\n        return this.contains(key) ? this[key] : null;\r\n    }\r\n\r\n    /**\r\n     * @param {string|Object} key\r\n     * @returns {ArrayMap.<T>}\r\n     */\r\n    remove(key) {\r\n        for (var i = 0; i < this.length; ++i) {\r\n            if (this[i] == key) {\r\n                this.splice(i, 1);\r\n                delete this[key];\r\n                return this;\r\n            }\r\n        }\r\n        return this;\r\n    }\r\n}\r\n","import BaseGameState from \"states/BaseGameState\";\r\n\r\n/**\r\n * Default game state\r\n *\r\n * @class DefaultGameState\r\n * @abstract\r\n * @constructor\r\n *\r\n * @param {GameStatesManager} gsm\r\n * @param {DefaultGameState.defaults|BaseGameState.defaults|Object} [data]\r\n * @property {DefaultGameState.defaults|BaseGameState.defaults|Object} data\r\n */\r\nexport default class DefaultGameState extends BaseGameState {\r\n    constructor(gsm, data) {\r\n        if (data === undefined) data = {};\r\n        data.id = 'init_j2d';\r\n        super(gsm, data);\r\n    }\r\n\r\n    // init(data) {\r\n    //     return BaseGameState.prototype.init.call(this, data);\r\n    // }\r\n    //\r\n    // load(data) {\r\n    //     return BaseGameState.prototype.load.call(this, data);\r\n    // }\r\n\r\n    update(timestamp, data) {\r\n        setTimeout(function () {\r\n            this.gsm.setNextState();\r\n        }.bind(this), 1000);\r\n        return true;\r\n    }\r\n\r\n    // render(timestamp, data) {\r\n    //     return true;\r\n    // }\r\n    //\r\n    // unload(data) {\r\n    //     return BaseGameState.prototype.unload.call(this, data);\r\n    // }\r\n}\r\n","import ObjectUtil from \"utils/ObjectUtil\";\r\nimport UUID from \"utils/UUID\";\r\nimport Events from \"utils/Events\";\r\n/**\r\n * Base class of state\r\n *\r\n * @class BaseGameState\r\n * @abstract\r\n * @constructor\r\n *\r\n * @param {GameStatesManager} gsm\r\n * @param {BaseGameState.defaults|Object} [data]\r\n * @property {BaseGameState.defaults|Object} data\r\n * @property {string} id\r\n */\r\nexport default class BaseGameState {\r\n    static defaults = {\r\n        id: 'BaseState',\r\n        currentState: 0\r\n    };\r\n\r\n    static STATE = {\r\n        STATE_NOT_LOADED: 0,\r\n        STATE_INIT: 1,\r\n        STATE_LOAD: 2,\r\n        STATE_UPDATE: 3,\r\n        STATE_RENDER: 4,\r\n        STATE_UNLOAD: 5\r\n    };\r\n\r\n    constructor(gsm, data) {\r\n        if (data === undefined) data = {};\r\n        if (data === undefined) data = {};\r\n        data.currentState = 0;\r\n        if (data.id === undefined || data.id === null) {\r\n            data.id = UUID.generate();\r\n        }\r\n        this.data = ObjectUtil.extend(true, {}, BaseGameState.defaults, data);\r\n\r\n        this.gsm = gsm;\r\n        this.loader = null;\r\n        this.events = new Events();\r\n    }\r\n\r\n    get id() {\r\n        return this.data.id;\r\n    }\r\n\r\n    set id(value) {\r\n        this.data.id = value;\r\n    }\r\n\r\n    init(data) {\r\n        if (typeof data === 'object' && data.callback !== undefined) {\r\n            data.callback();\r\n        }\r\n        return true;\r\n    }\r\n\r\n    load(data) {\r\n        if (typeof data === 'object' && data.callback !== undefined) data.callback();\r\n        return true;\r\n    }\r\n\r\n    update(timestamp, data) {\r\n        return true;\r\n    }\r\n\r\n    render(timestamp, data) {\r\n        return true;\r\n    }\r\n\r\n    unload(data) {\r\n        if (typeof data === 'object' && data.callback !== undefined) data.callback();\r\n        return true;\r\n    }\r\n\r\n    /* Events wrappers */\r\n    /**\r\n     * @param {string} event\r\n     * @param {function} callback\r\n     * @returns {boolean}\r\n     */\r\n    on(event, callback) {\r\n        return this.events.on(event, callback);\r\n    }\r\n\r\n    /**\r\n     * @param {string} event\r\n     * @param {function} callback\r\n     * @returns {boolean}\r\n     */\r\n    off(event, callback) {\r\n        return this.events.off(event, callback);\r\n    }\r\n\r\n    /**\r\n     * @param {string} event\r\n     * @param {function} callback\r\n     * @returns {boolean}\r\n     */\r\n    once(event, callback) {\r\n        return this.events.once(event, callback);\r\n    }\r\n\r\n    /**\r\n     * @param {string} event\r\n     * @returns {boolean}\r\n     */\r\n    flush(event) {\r\n        return this.events.flush(event);\r\n    }\r\n\r\n    /**\r\n     * @param {string} event\r\n     * @param {Array.<*>} data\r\n     * @returns {boolean}\r\n     */\r\n    trigger(event, data) {\r\n        return this.events.trigger(event, data);\r\n    }\r\n}\r\n","import ObjectUtil from \"utils/ObjectUtil\";\r\nimport Events from \"utils/Events\";\r\nimport Easing from \"transitions/utils/Easing\";\r\nvar tweens = [];\r\n\r\n/**\r\n * @class Tween\r\n * @exports module:transitions/Tween\r\n *\r\n * @constructor\r\n * @param {BaseNode|{data: object}} tweenNode\r\n * @param {Tween.defaults|Object} [data]\r\n * @property {Tween.defaults} data\r\n */\r\nexport default class Tween {\r\n    static defaults = {\r\n        currentStateAnimation: 0,\r\n        tweenStateStack: [],\r\n        tweenStateTimings: [],\r\n        chainedTweensStack: [],\r\n\r\n        isAnimated: false,\r\n        isStarted: false,\r\n        startTime: null,\r\n\r\n        delayTime: 0,\r\n\r\n        defaultDuration: 1000\r\n    };\r\n\r\n    static stateDefaults = {\r\n        data: null,\r\n        duration: 1000,\r\n        delay: 0,\r\n        easing: 'linear',\r\n        interpolation: 'linear'\r\n    };\r\n\r\n    static Easing = Easing;\r\n\r\n    constructor(tweenNode, data) {\r\n        this.data = ObjectUtil.extend(true, {}, Tween.defaults, data);\r\n        this.node = tweenNode;\r\n        this.events = new Events();\r\n\r\n        this.state = {};\r\n\r\n        // TODO:: Exceptions\r\n        // if (!(node instanceof BaseNode) || typeof node.data !== 'object') {\r\n        //     throw new InvalidArgumentException('Unknown tween node');\r\n        // }\r\n    }\r\n\r\n    /* Methods */\r\n    /**\r\n     * @param {Tween.defaults|Object} data\r\n     * @returns {{data: null, duration: number, delay: number, easing: string, interpolation: string}}\r\n     */\r\n    _tweenStateData(data) {\r\n        return (data !== undefined && typeof data === 'object')\r\n            ? ObjectUtil.extend(true, {}, Tween.stateDefaults, data)\r\n            : Tween.stateDefaults;\r\n    }\r\n\r\n    /**\r\n     * @param {Object} properties\r\n     * @param {Tween.defaults|Object} [data]\r\n     * @returns {Tween}\r\n     */\r\n    to(properties, data) {\r\n        var tween = this;\r\n\r\n        if (!tween.data.isStarted) {\r\n\r\n            if (typeof data === 'number') data = {data: data};\r\n            var stateData = (typeof data !== 'number') ? this._tweenStateData(data) : data;\r\n            if (data !== undefined && typeof data === 'number') stateData.duration = data;\r\n\r\n            tween.data.tweenStateStack.push([properties, stateData]);\r\n\r\n            return tween;\r\n        }\r\n\r\n        // TODO:: Exceptions\r\n        // throw new RuntimeException('You can not add a state after the start of the tween.');\r\n    }\r\n\r\n    /**\r\n     * @param {number} time\r\n     * @returns {boolean}\r\n     */\r\n    update(time) {\r\n        var tween = this;\r\n\r\n        var nextState = tween.data.tweenStateStack[tween.data.currentStateAnimation + 1];\r\n\r\n        if (time < tween.data.startTime || nextState === undefined) return true;\r\n\r\n        if (!tween.data.isStarted) {\r\n            tween.events.trigger('start', [tween.node]);\r\n            tween.data.isStarted = true;\r\n        }\r\n\r\n        var currentState = tween.data.tweenStateStack[tween.data.currentStateAnimation];\r\n\r\n        var previousStatesTime = tween.getStateTimeDuration(tween.data.currentStateAnimation, true);\r\n\r\n        var elapsed = (time - (tween.data.startTime + previousStatesTime)) / nextState[1].duration;\r\n        elapsed = elapsed > 1 ? 1 : elapsed;\r\n\r\n        tween.node.import(\r\n            Tween.util.animateTween(currentState[0], nextState[0], Easing.get(nextState[1].easing)(elapsed))\r\n        );\r\n\r\n        tween.events.trigger('update', [tween.node]);\r\n\r\n        if (elapsed === 1) {\r\n            if (tween.data.currentStateAnimation < tween.data.tweenStateStack.length) {\r\n                tween.data.currentStateAnimation++;\r\n            } else {\r\n                tween.events.trigger('complete', [tween.node]);\r\n\r\n                for (var i = 0; i < tween.data.chainedTweensStack.length; i++) {\r\n                    tween.data.chainedTweensStack[i].start(\r\n                        tween.data.startTime + tween.getStateTimeDuration(tween.data.currentStateAnimation - 1, true)\r\n                    );\r\n                }\r\n                return false;\r\n            }\r\n        }\r\n        return true;\r\n    }\r\n\r\n\r\n    _calculateStackStateTimings(tweenStateStack) {\r\n        var result = [];\r\n\r\n        tweenStateStack.forEach(function (value) {\r\n            result.push(value[1].duration);\r\n        });\r\n\r\n        return result;\r\n    }\r\n\r\n    /**\r\n     * @param {number} [position]\r\n     * @param {boolean} [withPrevious]\r\n     *\r\n     * @returns {number}\r\n     */\r\n    getStateTimeDuration(position, withPrevious) {\r\n        if (position === undefined || position === null) position = this.data.currentStateAnimation;\r\n        if (withPrevious === undefined) withPrevious = false;\r\n\r\n        if (this.data.tweenStateTimings[position] === undefined) return 0;\r\n\r\n        if (withPrevious) {\r\n            var result = 0;\r\n            for (var i = 1; i <= position; i++) {\r\n                result += this.data.tweenStateTimings[i];\r\n            }\r\n            return result;\r\n        } else {\r\n            return this.data.tweenStateTimings[position];\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @param {Array.<Object, Tween.stateDefaults>} startState\r\n     * @param {Array.<Array<Object, Tween.stateDefaults>>} tweenStateStack\r\n     */\r\n    _calculateStackState(startState, tweenStateStack) {\r\n        var result = [startState];\r\n        var index = 1;\r\n\r\n        var parsedTweenStateStack = [startState];\r\n        var nextStateDelay = 0;\r\n        var nextAllStateDelay = 0;\r\n\r\n        tweenStateStack.forEach(function (value) {\r\n            if (typeof value[0] === 'object' && !(value[0] instanceof Array)) {\r\n                if (nextStateDelay !== 0) {\r\n                    value[1].delay = nextStateDelay;\r\n                    nextStateDelay = 0;\r\n                } else if (nextAllStateDelay !== 0) {\r\n                    value[1].delay = nextAllStateDelay;\r\n                }\r\n                parsedTweenStateStack.push([value[0], value[1]]);\r\n                index++;\r\n            } else if (typeof value[0] === 'string') {\r\n                var i = 0;\r\n                switch (value[0]) {\r\n                    case 'delay':\r\n                        nextStateDelay = value[1].data;\r\n                        break;\r\n                    case 'delayAll':\r\n                        nextAllStateDelay = value[1].data;\r\n                        break;\r\n                    case 'repeat':\r\n                        for (i = 0; i < value[1].data; i++) {\r\n                            parsedTweenStateStack.push(parsedTweenStateStack[index]);\r\n                            index++;\r\n                        }\r\n                        break;\r\n                    case 'repeatAll':\r\n                        for (i = 0; i < value[1].data; i++) {\r\n                            parsedTweenStateStack.concat(parsedTweenStateStack);\r\n                            index++;\r\n                        }\r\n                        break;\r\n                    case 'yoyo':\r\n                    case 'reverse':\r\n                        for (i = 0; i < value[1].data; i++) {\r\n                            if (parsedTweenStateStack[index - 1] !== undefined) {\r\n                                parsedTweenStateStack.push([\r\n                                    Tween.util.reverseProperties(parsedTweenStateStack[index - 1][0]),\r\n                                    parsedTweenStateStack[index - 1][1]\r\n                                ]);\r\n                                index++;\r\n                            }\r\n                        }\r\n                        break;\r\n                    case 'yoyoAll':\r\n                    case 'reverseAll':\r\n                        for (i = 0; i < value[1].data; i++) {\r\n                            var stateStack = parsedTweenStateStack.slice(0);\r\n\r\n                            var stackLength = stateStack.length;\r\n                            for (var j = 0; j < stackLength; j++) {\r\n                                var sIndex = stackLength - j - 1;\r\n                                if (stateStack[sIndex] !== undefined) {\r\n                                    parsedTweenStateStack.push([\r\n                                        Tween.util.reverseProperties(stateStack[sIndex][0]),\r\n                                        stateStack[sIndex][1]\r\n                                    ]);\r\n                                    index++;\r\n                                }\r\n                            }\r\n                        }\r\n                        break;\r\n                }\r\n            }\r\n        });\r\n\r\n        // parsedTweenStateStack.forEach(function (value) {\r\n        //     console.info(value[0].position.x);\r\n        // });\r\n\r\n        index = 0;\r\n        parsedTweenStateStack.shift();\r\n        parsedTweenStateStack.forEach(function (value) {\r\n            if (typeof value[0] === 'object' && !(value[0] instanceof Array)) {\r\n                result.push([Tween.util.calculateProperties(result[index][0], ObjectUtil.extend(true, {}, result[index][0], value[0])), value[1]]);\r\n                index++;\r\n            }\r\n        });\r\n\r\n        return result;\r\n    }\r\n\r\n    /**\r\n     * @param {number} [time]\r\n     * @returns {Tween}\r\n     */\r\n    start(time) {\r\n        var tween = this;\r\n        if (time === undefined) time = global.performance.now();\r\n        tween.data.isAnimated = true;\r\n\r\n        if (!tween.data.isStarted) {\r\n            tween.data.isStarted = true;\r\n            tween.state = [Tween.util.cleanProperties(tween.node.data), Tween.stateDefaults];\r\n            tween.data.tweenStateStack = this._calculateStackState(tween.state, tween.data.tweenStateStack);\r\n            tween.data.tweenStateTimings = this._calculateStackStateTimings(tween.data.tweenStateStack);\r\n        }\r\n\r\n        tween.data.startTime = time + tween.data.delayTime;\r\n\r\n        return Tween.add(tween);\r\n    }\r\n\r\n    /**\r\n     * @returns {Tween}\r\n     */\r\n    stop() {\r\n        var tween = this;\r\n        if (!tween.data.isAnimated) return this;\r\n\r\n        tween.data.isAnimated = false;\r\n        tween.events.trigger('stop', [tween.node]);\r\n        tween.stopChainedTweens();\r\n\r\n        return Tween.remove(tween);\r\n    }\r\n\r\n    /**\r\n     * @returns {Tween}\r\n     */\r\n    stopChainedTweens() {\r\n        var tween = this;\r\n        for (var i = 0; i < tween.data.chainedTweensStack.length; i++) {\r\n            tween.data.chainedTweensStack[i].stop();\r\n        }\r\n\r\n        return tween;\r\n    }\r\n\r\n\r\n    /* Extended animation methods */\r\n    /**\r\n     * @param {number} delay\r\n     * @returns {Tween}\r\n     */\r\n    delay(delay) {\r\n        if (delay === undefined) delay = 1000;\r\n        this.to('delay', delay);\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {number} delay\r\n     * @returns {Tween}\r\n     */\r\n    delayAll(delay) {\r\n        if (delay === undefined) delay = 1000;\r\n        this.to('delayAll', delay);\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {number} [count]\r\n     * @returns {Tween}\r\n     */\r\n    repeat(count) {\r\n        if (count === undefined) count = 1;\r\n        this.to('repeat', count);\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {number} [count]\r\n     * @returns {Tween}\r\n     */\r\n    repeatAll(count) {\r\n        if (count === undefined) count = 1;\r\n        this.to('repeatAll', count);\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {number} [count]\r\n     * @returns {Tween}\r\n     */\r\n    yoyo(count) {\r\n        if (count === undefined) count = 1;\r\n        this.to('yoyo', count);\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {number} [count]\r\n     * @returns {Tween}\r\n     */\r\n    reverse(count) {\r\n        if (count === undefined) count = 1;\r\n        this.to('reverse', count);\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {number} [count]\r\n     * @returns {Tween}\r\n     */\r\n    yoyoAll(count) {\r\n        if (count === undefined) count = 1;\r\n        this.to('yoyoAll', count);\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {number} [count]\r\n     * @returns {Tween}\r\n     */\r\n    reverseAll(count) {\r\n        if (count === undefined) count = 1;\r\n        this.to('reverseAll', count);\r\n        return this;\r\n    }\r\n\r\n\r\n    /* Events wrappers */\r\n    /**\r\n     * @param {string} event\r\n     * @param {function} callback\r\n     * @returns {boolean}\r\n     */\r\n    on(event, callback) {\r\n        return this.events.on(event, callback);\r\n    }\r\n\r\n    /**\r\n     * @param {string} event\r\n     * @param {function} callback\r\n     * @returns {boolean}\r\n     */\r\n    off(event, callback) {\r\n        return this.events.off(event, callback);\r\n    }\r\n\r\n    /**\r\n     * @param {string} event\r\n     * @param {function} callback\r\n     * @returns {boolean}\r\n     */\r\n    once(event, callback) {\r\n        return this.events.once(event, callback);\r\n    }\r\n\r\n    /**\r\n     * @param {string} event\r\n     * @returns {boolean}\r\n     */\r\n    flush(event) {\r\n        return this.events.flush(event);\r\n    }\r\n\r\n    /**\r\n     * @param {string} event\r\n     * @param {Array.<*>} data\r\n     * @returns {boolean}\r\n     */\r\n    trigger(event, data) {\r\n        return this.events.trigger(event, data);\r\n    }\r\n\r\n    /* Static Methods */\r\n    /**\r\n     * @param {number} index\r\n     * @returns {Array.<Tween>|Tween}\r\n     */\r\n    static get(index) {\r\n        return (index === undefined) ? tweens : tweens[index];\r\n    }\r\n\r\n    /**\r\n     * @param {Tween} tween\r\n     * @returns {Tween}\r\n     */\r\n    static add(tween) {\r\n        tweens.push(tween);\r\n        return tween;\r\n    }\r\n\r\n    /**\r\n     * @param {Tween} tween\r\n     * @returns {Tween}\r\n     */\r\n    static remove(tween) {\r\n        var i = tweens.indexOf(tween);\r\n        if (i !== -1) tweens.splice(i, 1);\r\n        return tween;\r\n    }\r\n\r\n    /**\r\n     * @returns {void}\r\n     */\r\n    static flush() {\r\n        tweens = [];\r\n    }\r\n\r\n    /**\r\n     * @param {number} time\r\n     * @returns {boolean}\r\n     */\r\n    static update(time) {\r\n        if (tweens.length === 0) return false;\r\n\r\n        var i = 0;\r\n\r\n        while (i < tweens.length) {\r\n            if (tweens[i].update(time)) {\r\n                i++;\r\n            } else {\r\n                tweens.splice(i, 1);\r\n            }\r\n        }\r\n        return true;\r\n    }\r\n\r\n    static util = {\r\n        animateTween: function (currentState, nextState, value) {\r\n            var result = {};\r\n            var property;\r\n            var temp;\r\n\r\n            for (property in nextState) {\r\n                if (nextState.hasOwnProperty(property) && currentState.hasOwnProperty(property)) {\r\n                    temp = null;\r\n\r\n                    if (typeof nextState[property] === 'number') {\r\n                        if (currentState[property] === nextState[property]) {\r\n                            temp = currentState[property];\r\n                        } else {\r\n                            temp = currentState[property] + (nextState[property] - currentState[property]) * value;\r\n                        }\r\n                    } else if (typeof nextState[property] === 'object') {\r\n                        temp = this.animateTween(currentState[property], nextState[property], value);\r\n                    }\r\n                    if (temp !== null) result[property] = temp;\r\n                }\r\n            }\r\n\r\n            return Object.keys(result).length > 0 ? result : null;\r\n        },\r\n\r\n        cleanProperties: function (properties) {\r\n            var result = {};\r\n            var property;\r\n            var temp;\r\n\r\n            for (property in properties) {\r\n                if (properties.hasOwnProperty(property) && property !== 'id') {\r\n                    temp = null;\r\n                    if ((typeof properties[property] === 'string' && !isNaN(properties[property]))\r\n                        || typeof properties[property] === 'number'\r\n                    ) {\r\n                        temp = properties[property];\r\n                    } else if (typeof properties[property] === 'object') {\r\n                        temp = this.cleanProperties(properties[property]);\r\n                    }\r\n                    if (temp !== null) result[property] = temp;\r\n                }\r\n            }\r\n\r\n            return Object.keys(result).length > 0 ? result : null;\r\n        },\r\n\r\n        reverseProperties: function (properties) {\r\n            var result = {};\r\n            var property;\r\n            var temp;\r\n\r\n            for (property in properties) {\r\n                if (properties.hasOwnProperty(property) && property !== 'id') {\r\n                    temp = null;\r\n                    if (typeof properties[property] === 'string' && !isNaN(properties[property])) {\r\n                        temp = Number(parseFloat(properties[property]) * -1).toString();\r\n                    } else if (typeof properties[property] === 'number') {\r\n                        temp = properties[property];\r\n                    } else if (typeof properties[property] === 'object') {\r\n                        temp = this.reverseProperties(properties[property]);\r\n                    }\r\n                    if (temp !== null) result[property] = temp;\r\n                }\r\n            }\r\n\r\n            return Object.keys(result).length > 0 ? result : null;\r\n        },\r\n\r\n        calculateProperties: function (startProperties, endProperties) {\r\n            var result = {};\r\n            var property;\r\n            var temp;\r\n\r\n            for (property in endProperties) {\r\n                if (endProperties.hasOwnProperty(property) && startProperties.hasOwnProperty(property) && property !== 'id') {\r\n                    temp = null;\r\n\r\n                    if (typeof endProperties[property] === 'string' && !isNaN(endProperties[property]) && typeof startProperties[property] === 'number') {\r\n                        temp = startProperties[property] + parseFloat(endProperties[property]);\r\n                    } else if (typeof endProperties[property] === 'number' && typeof startProperties[property] === 'string' && !isNaN(startProperties[property])) {\r\n                        temp = endProperties[property] - parseFloat(startProperties[property]);\r\n                    } else if (typeof endProperties[property] === 'number' && typeof startProperties[property] === 'number') {\r\n                        temp = endProperties[property];\r\n                    } else if (typeof endProperties[property] === 'object') {\r\n                        temp = this.calculateProperties(startProperties[property], endProperties[property]);\r\n                    }\r\n\r\n                    if (temp !== null) result[property] = temp;\r\n                }\r\n            }\r\n            return Object.keys(result).length > 0 ? result : null;\r\n        }\r\n    }\r\n}\r\n","import Immutable from \"objects/Immutable\";\r\nimport Mutable from \"objects/Mutable\";\r\nimport Handler from \"api/Handler\";\r\nimport RuntimeException from \"exceptions/RuntimeException\";\r\n\r\nexport default class BaseStore extends Handler {\r\n    /** @type Immutable */\r\n    state;\r\n\r\n    constructor(state) {\r\n        super();\r\n        this.state = new Immutable(state);\r\n    }\r\n\r\n    /**\r\n     * @return {Immutable}\r\n     */\r\n    getState() {\r\n        return this.state;\r\n    }\r\n\r\n    /**\r\n     * @param {Object} state\r\n     * @param {function(Immutable, Immutable)} callback(newState, oldState)\r\n     */\r\n    setState(state, callback) {\r\n        if (!this._isEnabled) throw new RuntimeException('Trying setState() on disabled store.');\r\n\r\n        let oldState = this.state;\r\n        this.state = new Immutable(Mutable.extend(true, {}, oldState.toJS(), state));\r\n\r\n        if (this.events) {\r\n            this.events.trigger('update', {\r\n                newState: this.state,\r\n                oldState\r\n            });\r\n        }\r\n\r\n        if (callback) callback(this.state, oldState);\r\n    }\r\n}\r\n","import BaseNode from \"nodes/BaseNode\";\r\nimport RuntimeException from \"exceptions/RuntimeException\";\r\n\r\nexport default class GroupNode extends BaseNode {\r\n    /** @type {Array.<BaseNode|GroupNode>} */\r\n    _nodes = [];\r\n\r\n    get(guid) {\r\n        return this._nodes[guid] || null;\r\n    }\r\n\r\n    has(guid) {\r\n        return this._nodes[guid] !== undefined;\r\n    }\r\n\r\n    add(node) {\r\n        if (node.isSpecialNode) {\r\n            throw new RuntimeException(`You try add the ${node.constructor.name} to GroupNode, but this not work.`);\r\n        }\r\n        if (node.instanceOf(BaseNode)) {\r\n            this._nodes[node.guid] = node;\r\n            this._nodes.push(node);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    insert(node, index) {\r\n        if (node.isSpecialNode) {\r\n            throw new RuntimeException(`You try add the ${node.constructor.name} to GroupNode, but this not work.`);\r\n        }\r\n        if (node.instanceOf(BaseNode)) {\r\n            this._nodes[node.guid] = node;\r\n            this._nodes.splice(index, 0, node);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    remove(node) {\r\n        if (node.instanceOf(BaseNode) && this.has(node.guid)) {\r\n            this._nodes.splice(this._nodes.indexOf(node), 1);\r\n            delete this._nodes[node.guid];\r\n        }\r\n        return this;\r\n    }\r\n\r\n    flush() {\r\n        this._nodes = [];\r\n        return this;\r\n    }\r\n\r\n    render(context, viewport, data) {\r\n        if (data.components.SceneHandler._data.isLostContext) return;\r\n\r\n        if (this._nodes.length !== 0) {\r\n            for (let i = 0; i < this._nodes.length; i++) {\r\n                this._nodes[i].render(context, viewport, data);\r\n            }\r\n        }\r\n    }\r\n}\r\n","import BaseNode from \"nodes/BaseNode\";\r\n\r\nexport default class CameraNode extends BaseNode {\r\n\r\n}\r\n","import InvalidArgumentException from \"exceptions/InvalidArgumentException\";\r\nimport Mutable from \"objects/Mutable\";\r\n\r\nconst FREEZE_NODE_METHODS = ['get', 'set', 'toJS', 'toJSON'];\r\nconst FREEZE_NODE_ARRAY_METHODS = [\r\n    'concat', 'copyWithin', 'fill', 'filter', 'map', 'pop', 'reduce',\r\n    'reduceRight', 'reverse', 'shift', 'slice', 'sort', 'splice', 'unshift',\r\n];\r\n\r\n/**\r\n * @exports module:objects/Immutable\r\n */\r\nexport default class Immutable extends Object {\r\n    __$ImmutableOptions;\r\n\r\n    constructor(object, options) {\r\n        if (object !== undefined && typeof object !== 'object') {\r\n            throw new InvalidArgumentException('Attribute object type must be instance of Object.');\r\n        }\r\n\r\n        if (options === undefined) options = {};\r\n        if (object === undefined) object = {};\r\n\r\n        super(object instanceof Array ? new ImmutableArray(object, options) : Object.assign({}, object));\r\n\r\n        this.__$ImmutableOptions = options;\r\n\r\n        if (!Object.isFrozen(this)) Immutable.freeze(this, options);\r\n    }\r\n\r\n    toJS = () => Immutable.unFreeze(Object.assign(this instanceof Array ? [] : {}, this));\r\n\r\n    toJSON = () => JSON.stringify(\r\n        Immutable.unFreeze(Object.assign(this instanceof Array ? [] : {}, this))\r\n    );\r\n\r\n    get = () => Immutable.freeze(Object.assign(this instanceof Array ? [] : {}, this), this.__$ImmutableOptions);\r\n\r\n    set = (data) => {\r\n        if (data !== undefined && typeof data !== 'object') {\r\n            throw new InvalidArgumentException('Attribute object type must be instance of Object.');\r\n        }\r\n\r\n        if (Object.isFrozen(this)) {\r\n            let oldObject = Immutable.unFreeze(Object.assign(this instanceof Array ? [] : {}, this));\r\n            let newObject = Mutable.extend(true, oldObject instanceof Array ? [] : {}, oldObject, data);\r\n            console.log(oldObject, this, newObject);\r\n\r\n            return Immutable.freeze(newObject, this.__$ImmutableOptions);\r\n        }\r\n\r\n        return null;\r\n    };\r\n\r\n    /**\r\n     * @param {Object} object\r\n     * @param {Object} options\r\n     * @return {Object}\r\n     */\r\n    static freeze(object, options) {\r\n        let properties = Object.getOwnPropertyNames(object);\r\n        for (let i = 0; i < properties.length; i++) {\r\n            if (object.hasOwnProperty(properties[i])\r\n                && object[properties[i]] !== null\r\n                && (typeof object[properties[i]] === 'object' || typeof object[properties[i]] === 'function')\r\n                && !Object.isFrozen(object[properties[i]])\r\n                && !(FREEZE_NODE_METHODS.indexOf(properties[i]) !== -1)\r\n                && !(FREEZE_NODE_ARRAY_METHODS.indexOf(properties[i]) !== -1)\r\n                && properties[i] !== '__$ImmutableOptions'\r\n            ) {\r\n                object[properties[i]] = new Immutable(object[properties[i]], options);\r\n            }\r\n        }\r\n\r\n        Object.freeze(object);\r\n        return object;\r\n    }\r\n\r\n    /**\r\n     * @param {Object} object\r\n     * @return {Object}\r\n     */\r\n    static unFreeze(object) {\r\n        let result = object instanceof Array ? [] : {};\r\n\r\n        if (object instanceof Array) {\r\n            for (let i = 0; i < object.length; i++) result.push(object[i]);\r\n        } else if (object instanceof String) {\r\n            result = String(object).toString();\r\n        } else if (typeof object === 'object') {\r\n            for (let property in object) {\r\n                if (object.hasOwnProperty(property)\r\n                    && !(FREEZE_NODE_METHODS.indexOf(property) !== -1)\r\n                    && !(FREEZE_NODE_ARRAY_METHODS.indexOf(property) !== -1)\r\n                    && property !== '__$ImmutableOptions'\r\n                ) {\r\n                    result[property] = (typeof object[property] === 'object' && Object.isFrozen(object[property]))\r\n                        ? Immutable.unFreeze(object[property])\r\n                        : object[property];\r\n                }\r\n            }\r\n        }\r\n\r\n        return result;\r\n    }\r\n}\r\n\r\nclass ImmutableArray extends Array {\r\n    __$ImmutableOptions;\r\n\r\n    constructor(array, options) {\r\n        if (options === undefined) options = {};\r\n\r\n        super([]);\r\n\r\n        this.__$ImmutableOptions = options;\r\n\r\n        if ((typeof array === 'object' && array instanceof Array)) {\r\n            for (let i = 0; i < array.length; i++) this[i] = array[i];\r\n        }\r\n    }\r\n\r\n    // Immutable methods\r\n    /**\r\n     * @param args\r\n     * @return {Immutable|ImmutableArray|Object}\r\n     */\r\n    concat(...args) {\r\n        return Immutable.freeze(super.concat(...args), this.__$ImmutableOptions);\r\n    }\r\n\r\n    /**\r\n     * @param args\r\n     * @return {Immutable|ImmutableArray|Object}\r\n     */\r\n    copyWithin(...args) {\r\n        return Immutable.freeze(super.copyWithin(...args), this.__$ImmutableOptions);\r\n    }\r\n\r\n    /**\r\n     * @param args\r\n     * @return {Immutable|ImmutableArray|Object}\r\n     */\r\n    fill(...args) {\r\n        let array = Immutable.unFreeze(Object.assign([], this));\r\n        return Immutable.freeze(array.fill(...args), this.__$ImmutableOptions);\r\n    }\r\n\r\n    /**\r\n     * @param args\r\n     * @return {Immutable|ImmutableArray|Object}\r\n     */\r\n    filter(...args) {\r\n        return Immutable.freeze(super.filter(...args), this.__$ImmutableOptions);\r\n    }\r\n\r\n    /**\r\n     * @param args\r\n     * @return {Immutable|ImmutableArray|Object}\r\n     */\r\n    map(...args) {\r\n        return Immutable.freeze(super.map(...args), this.__$ImmutableOptions);\r\n    }\r\n\r\n    /**\r\n     * @param args\r\n     * @return {Immutable|ImmutableArray|Object}\r\n     */\r\n    pop(...args) {\r\n        let array = Immutable.unFreeze(Object.assign([], this));\r\n        array.pop(...args);\r\n        return Immutable.freeze(array, this.__$ImmutableOptions);\r\n    }\r\n\r\n    /**\r\n     * @param args\r\n     * @return {Immutable|ImmutableArray|Object}\r\n     */\r\n    push(...args) {\r\n        let array = Immutable.unFreeze(Object.assign([], this));\r\n        array.push(...args);\r\n        return Immutable.freeze(array, this.__$ImmutableOptions);\r\n    }\r\n\r\n    /**\r\n     * @param args\r\n     * @return {Immutable|ImmutableArray|Object}\r\n     */\r\n    reduce(...args) {\r\n        let array = Immutable.unFreeze(Object.assign([], this));\r\n        return Immutable.freeze(array.reduce(...args), this.__$ImmutableOptions);\r\n    }\r\n\r\n    /**\r\n     * @param args\r\n     * @return {Immutable|ImmutableArray|Object}\r\n     */\r\n    reduceRight(...args) {\r\n        let array = Immutable.unFreeze(Object.assign([], this));\r\n        return Immutable.freeze(array.reduceRight(...args), this.__$ImmutableOptions);\r\n    }\r\n\r\n    /**\r\n     * @param args\r\n     * @return {Immutable|ImmutableArray|Object}\r\n     */\r\n    reverse(...args) {\r\n        let array = Immutable.unFreeze(Object.assign([], this));\r\n        return Immutable.freeze(array.reverse(...args), this.__$ImmutableOptions);\r\n    }\r\n\r\n    /**\r\n     * @param args\r\n     * @return {Immutable|ImmutableArray|Object}\r\n     */\r\n    shift(...args) {\r\n        let array = Immutable.unFreeze(Object.assign([], this));\r\n        array.shift(...args);\r\n        return Immutable.freeze(array, this.__$ImmutableOptions);\r\n    }\r\n\r\n    /**\r\n     * @param args\r\n     * @return {Immutable|ImmutableArray|Object}\r\n     */\r\n    slice(...args) {\r\n        let array = Immutable.unFreeze(Object.assign([], this));\r\n        return Immutable.freeze(array.slice(...args), this.__$ImmutableOptions);\r\n    }\r\n\r\n    /**\r\n     * @param args\r\n     * @return {Immutable|ImmutableArray|Object}\r\n     */\r\n    sort(...args) {\r\n        let array = Immutable.unFreeze(Object.assign([], this));\r\n        return Immutable.freeze(array.sort(...args), this.__$ImmutableOptions);\r\n    }\r\n\r\n    /**\r\n     * @param args\r\n     * @return {Immutable|ImmutableArray|Object}\r\n     */\r\n    splice(...args) {\r\n        let array = Immutable.unFreeze(Object.assign([], this));\r\n        return Immutable.freeze(array.splice(...args), this.__$ImmutableOptions);\r\n    }\r\n\r\n    /**\r\n     * @param args\r\n     * @return {Immutable|ImmutableArray|Object}\r\n     */\r\n    unshift(...args) {\r\n        let array = Immutable.unFreeze(Object.assign([], this));\r\n        array.unshift(...args);\r\n        return Immutable.freeze(array, this.__$ImmutableOptions);\r\n    }\r\n}\r\n","/**\r\n * Assets Loader\r\n *\r\n * @class AssetsLoader\r\n * @exports module:loaders/AssetsLoader\r\n *\r\n * @constructor\r\n */\r\nexport default class AssetsLoader {\r\n    progress = 0;\r\n\r\n    getProgress() {\r\n        return this.progress;\r\n    }\r\n\r\n    load() {\r\n    }\r\n\r\n    isLoaded(index) {\r\n    }\r\n\r\n    dispose(index) {\r\n    }\r\n}\r\n","/**\r\n * @class Video\r\n * @exports module:media/Video\r\n *\r\n * @constructor\r\n */\r\nexport default class Video {\r\n}\r\n","import ObjectUtil from \"utils/ObjectUtil\";\r\nimport UUID from \"utils/UUID\";\r\nimport Events from \"utils/Events\";\r\nimport Audio from \"media/Audio\";\r\n\r\nvar cache = {};\r\nvar audioContext;\r\nvar masterGain;\r\n\r\nfunction createMasterGain() {\r\n    if (audioContext) {\r\n        masterGain = (audioContext.createGain === undefined)\r\n            ? audioContext.createGainNode()\r\n            : audioContext.createGain();\r\n        masterGain.gain.value = 1;\r\n        masterGain.connect(audioContext.destination);\r\n        return masterGain;\r\n    }\r\n    return null;\r\n}\r\n\r\n/**\r\n * @class Sound\r\n * @exports module:media/Sound\r\n *\r\n * @constructor\r\n * @extends media/Audio\r\n * @param {Audio.defaults|Object} [data]\r\n * @param {MediaManager} [manager]\r\n */\r\nexport default class Sound extends Audio {\r\n    static defaults = {\r\n        id: null,\r\n        src: [],\r\n        format: null,\r\n        autoPlay: false,\r\n\r\n        duration: 0,\r\n        loop: false,\r\n        sprite: {},\r\n        volume: 1,\r\n        muted: false,\r\n        pos3d: [0, 0, -0.5],\r\n        rate: 1,\r\n\r\n        loaded: false,\r\n        buffer: false,\r\n        model: null,\r\n        onEndTimer: []\r\n    };\r\n\r\n    constructor(data, manager) {\r\n        super(data, manager);\r\n\r\n        this.manager = manager;\r\n        this.events = !!this.manager ? this.manager.events : new Events();\r\n        this.data = ObjectUtil.extend(true, {}, Sound.defaults, data);\r\n        this.audioNode = [];\r\n        audioContext = manager\r\n            ? manager.getAudioContext()\r\n            : new (window.AudioContext || window.webkitAudioContext);\r\n\r\n        masterGain = manager\r\n            ? manager.getMasterGain()\r\n            : createMasterGain();\r\n\r\n        if (this.data.id === null) {\r\n            this.data.id = UUID.generate();\r\n        }\r\n\r\n        if (audioContext && this.data.buffer) {\r\n            this._setupAudioNode(this);\r\n        }\r\n\r\n        if (this.manager && audioContext && this.manager.data.iOSAutoEnable) {\r\n            this.manager.iOSEnable = true;\r\n        }\r\n\r\n        if (this.manager) this.manager.media.get('sounds').add(this.data.id, this);\r\n\r\n        this.load();\r\n    }\r\n\r\n    _load(sound) {\r\n        loadBuffer(sound, sound.data.src);\r\n        return sound;\r\n    }\r\n\r\n    _unload(soundNode) {\r\n        soundNode.disconnect(0);\r\n    }\r\n\r\n    play(sprite, callback) {\r\n        var sound = this;\r\n\r\n        if (typeof sprite === 'function')  callback = sprite;\r\n\r\n        if (!sprite || typeof sprite === 'function') sprite = 'default';\r\n\r\n        if (!sound.data.loaded) {\r\n            sound.events.on('load', function () {\r\n                sound.play(sprite, callback);\r\n            });\r\n\r\n            return sound;\r\n        }\r\n\r\n        if (!sound.data.sprite[sprite]) {\r\n            if (typeof callback === 'function') callback();\r\n            return sound;\r\n        }\r\n\r\n        sound._inactiveNode(sound, function (node) {\r\n            node.sprite = sprite;\r\n\r\n            var pos = (node.pos > 0) ? node.pos : sound.data.sprite[sprite][0] / 1000;\r\n            var duration = sound.data.sprite[sprite][1] / 1000 - node.pos;\r\n            if (node.pos > 0) pos = sound.data.sprite[sprite][0] / 1000 + pos;\r\n            var loop = !!(sound.data.loop || sound.data.sprite[sprite][2]);\r\n\r\n            var soundId = (typeof callback === 'string')\r\n                ? callback\r\n                : Math.round(Date.now() * Math.random()) + '', timerId;\r\n\r\n            (function () {\r\n                var data = {\r\n                    id: soundId,\r\n                    sprite: sprite,\r\n                    loop: loop\r\n                };\r\n\r\n                timerId = setTimeout(function () {\r\n                    if (audioContext && !loop) {\r\n                        sound._nodeById(sound, data.id).paused = true;\r\n                        sound._nodeById(sound, data.id).pos = 0;\r\n                        sound._clearEndTimer(sound, data.id);\r\n                    }\r\n                    sound.events.trigger('unload', soundId);\r\n                }, (duration / sound.data.rate) * 1000);\r\n\r\n                sound.data.onEndTimer.push({timer: timerId, id: data.id});\r\n            })();\r\n\r\n            var loopStart = sound.data.sprite[sprite][0] / 1000,\r\n                loopEnd = sound.data.sprite[sprite][1] / 1000;\r\n\r\n            node.id = soundId;\r\n            node.paused = false;\r\n            refreshBuffer(sound, [loop, loopStart, loopEnd], soundId);\r\n            sound.data.playStart = audioContext.currentTime;\r\n            node.gain.value = sound.data.volume;\r\n\r\n            if (typeof node.bufferSource.start === 'undefined') {\r\n                loop ? node.bufferSource.noteGrainOn(0, pos, 86400) : node.bufferSource.noteGrainOn(0, pos, duration);\r\n            } else {\r\n                loop ? node.bufferSource.start(0, pos, 86400) : node.bufferSource.start(0, pos, duration);\r\n            }\r\n\r\n            sound.events.trigger('play');\r\n            if (typeof callback === 'function') callback(soundId);\r\n\r\n            return sound;\r\n        });\r\n\r\n        return sound;\r\n    }\r\n\r\n    _pause(activeNode) {\r\n        if (!activeNode.bufferSource || activeNode.paused) {\r\n            return true;\r\n        }\r\n\r\n        activeNode.paused = true;\r\n        if (activeNode.bufferSource.stop == undefined) {\r\n            activeNode.bufferSource.noteOff(0);\r\n        } else {\r\n            activeNode.bufferSource.stop(0);\r\n        }\r\n        return false;\r\n    }\r\n\r\n    _stop(activeNode) {\r\n        if (!activeNode.bufferSource || activeNode.paused) {\r\n            return true;\r\n        }\r\n\r\n        activeNode.paused = true;\r\n\r\n        if (typeof activeNode.bufferSource.stop === 'undefined') {\r\n            activeNode.bufferSource.noteOff(0);\r\n        } else {\r\n            activeNode.bufferSource.stop(0);\r\n        }\r\n        return false;\r\n    }\r\n\r\n    _mute(activeNode) {\r\n        activeNode.gain.value = 0;\r\n    }\r\n\r\n    _unMute(activeNode) {\r\n        activeNode.gain.value = this.data.volume;\r\n    }\r\n\r\n    _volume(activeNode, vol) {\r\n        activeNode.gain.value = vol;\r\n    }\r\n\r\n    _position(activeNode, v) {\r\n        if (v !== undefined && v == true) return activeNode.pos;\r\n        return activeNode.pos + (audioContext.currentTime - this.data.playStart);\r\n    }\r\n\r\n    _pos3d(activeNode, x, y, z) {\r\n        if (activeNode) {\r\n            this.data.pos3d = [x, y, z];\r\n            activeNode.panner.setPosition(x, y, z);\r\n            activeNode.panner.panningModel = this.data.model || 'HRTF';\r\n        }\r\n    }\r\n\r\n    _setupAudioNode() {\r\n        var sound = this,\r\n            node = sound.audioNode,\r\n            index = sound.audioNode.length;\r\n\r\n        node[index] = (audioContext.createGain === undefined)\r\n            ? audioContext.createGainNode()\r\n            : audioContext.createGain();\r\n\r\n        node[index].gain.value = sound.data.volume;\r\n        node[index].paused = true;\r\n        node[index].pos = 0;\r\n        node[index].readyState = 4;\r\n        node[index].connect(masterGain);\r\n\r\n        node[index].panner = audioContext.createPanner();\r\n        node[index].panner.panningModel = sound.data.model || 'equalpower';\r\n        node[index].panner.setPosition(sound.data.pos3d[0], sound.data.pos3d[1], sound.data.pos3d[2]);\r\n        node[index].panner.connect(node[index]);\r\n\r\n        return node[index];\r\n    }\r\n\r\n    /* Private */\r\n    _inactiveNode(sound, callback) {\r\n        var node = null;\r\n\r\n        for (var i = 0; i < sound.audioNode.length; i++) {\r\n            if (sound.audioNode[i].paused && sound.audioNode[i].readyState === 4) {\r\n                callback(sound.audioNode[i]);\r\n                node = true;\r\n                break;\r\n            }\r\n        }\r\n\r\n        sound._drainPool(sound);\r\n\r\n        if (node) return;\r\n\r\n        var newNode = sound._setupAudioNode();\r\n        callback(newNode);\r\n    }\r\n\r\n    _drainPool(sound) {\r\n        var inactive = 0;\r\n\r\n        for (var i = 0; i < sound.audioNode.length; i++) {\r\n            if (sound.audioNode[i].paused) inactive++;\r\n        }\r\n\r\n        for (i = sound.audioNode.length - 1; i >= 0; i--) {\r\n            if (inactive <= 5) break;\r\n\r\n            if (sound.audioNode[i].paused) {\r\n                if (audioContext) sound.audioNode[i].disconnect(0);\r\n                sound.audioNode.splice(i, 1);\r\n                inactive--;\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n\r\n/* WebAudioAPI Helpers */\r\n/**\r\n * Buffer a sound from URL (or from cache) and decode to audio source (Web Audio API).\r\n * @param  {Object} sound The Sound object for the sound to load.\r\n * @param  {String} url The path to the sound file.\r\n */\r\nvar loadBuffer = function (sound, url) {\r\n    if (url in cache) {\r\n        sound.data.duration = cache[url].duration;\r\n\r\n        loadSound(sound);\r\n        return;\r\n    }\r\n\r\n    if (/^data:[^;]+;base64,/.test(url)) {\r\n        var data = atob(url.split(',')[1]);\r\n        var dataView = new Uint8Array(data.length);\r\n        for (var i = 0; i < data.length; ++i) {\r\n            dataView[i] = data.charCodeAt(i);\r\n        }\r\n\r\n        decodeAudioData(dataView.buffer, sound, url);\r\n    } else {\r\n        var xhr = new XMLHttpRequest();\r\n        xhr.open('GET', url, true);\r\n        xhr.responseType = 'arraybuffer';\r\n        xhr.onload = function () {\r\n            decodeAudioData(xhr.response, sound, url);\r\n        };\r\n        xhr.onerror = function () {\r\n            if (audioContext) {\r\n                sound.data.buffer = true;\r\n                sound.audioNode = [];\r\n                delete sound.gainNode;\r\n                delete cache[url];\r\n                sound.load();\r\n            }\r\n        };\r\n        try {\r\n            xhr.send();\r\n        } catch (e) {\r\n            xhr.onerror();\r\n        }\r\n    }\r\n};\r\n\r\n/**\r\n * Decode audio data from an array buffer.\r\n * @param  {ArrayBuffer} arraybuffer The audio data.\r\n * @param  {Object} sound The Sound object for the sound to load.\r\n * @param  {String} url The path to the sound file.\r\n */\r\nvar decodeAudioData = function (arraybuffer, sound, url) {\r\n    audioContext.decodeAudioData(\r\n        arraybuffer,\r\n        function (buffer) {\r\n            if (buffer) {\r\n                cache[url] = buffer;\r\n                loadSound(sound, buffer);\r\n            }\r\n        },\r\n        function (error) {\r\n            sound.events.trigger('loaderror', error);\r\n        }\r\n    );\r\n};\r\n\r\n/**\r\n * Finishes loading the Web Audio API sound and fires the loaded event\r\n * @param  {Object}  sound    The Sound object for the sound to load.\r\n * @param  {Object} [buffer] The decoded buffer sound source.\r\n */\r\nvar loadSound = function (sound, buffer) {\r\n    sound.data.duration = (buffer) ? buffer.duration : sound.data.duration;\r\n\r\n    if (Object.getOwnPropertyNames(sound.data.sprite).length === 0) {\r\n        sound.data.sprite = {default: [0, sound.data.duration * 1000]};\r\n    }\r\n\r\n    if (!sound.data.loaded) {\r\n        sound.data.loaded = true;\r\n        sound.events.trigger('load');\r\n    }\r\n\r\n    if (sound.data.autoPlay) {\r\n        sound.play();\r\n    }\r\n};\r\n\r\n/**\r\n * Load the sound back into the buffer source.\r\n * @param  {Object} sound   The sound to load.\r\n * @param  {Array}  loop  Loop boolean, pos, and duration.\r\n * @param  {String} id    (optional) The play instance ID.\r\n */\r\nvar refreshBuffer = function (sound, loop, id) {\r\n    var node = sound._nodeById(sound, id);\r\n\r\n    node.bufferSource = audioContext.createBufferSource();\r\n    node.bufferSource.buffer = cache[sound.data.src];\r\n    node.bufferSource.connect(node.panner);\r\n    node.bufferSource.loop = loop[0];\r\n    if (loop[0]) {\r\n        node.bufferSource.loopStart = loop[1];\r\n        node.bufferSource.loopEnd = loop[1] + loop[2];\r\n    }\r\n    //noinspection JSPrimitiveTypeWrapperUsage\r\n    node.bufferSource.playbackRate.value = sound.data.rate;\r\n};\r\n","import ObjectUtil from \"utils/ObjectUtil\";\r\nimport UUID from \"utils/UUID\";\r\nimport Events from \"utils/Events\";\r\n\r\nvar cache = {};\r\nvar AudioNode = window.Audio;\r\n\r\n/**\r\n * @class Audio\r\n * @exports module:media/Audio\r\n *\r\n * @constructor\r\n * @param {Audio.defaults|Object} [data]\r\n * @param {MediaManager} [manager]\r\n */\r\nexport default class Audio {\r\n    static defaults = {\r\n        id: null,\r\n        src: [],\r\n        format: null,\r\n        autoPlay: false,\r\n\r\n        duration: 0,\r\n        loop: false,\r\n        sprite: {},\r\n        volume: 1,\r\n        muted: false,\r\n        pos3d: [0, 0, -0.5],\r\n\r\n        loaded: false,\r\n        onEndTimer: []\r\n    };\r\n\r\n    constructor(data, manager) {\r\n        var audio = this;\r\n        audio.manager = manager !== undefined ? manager : null;\r\n        audio.events = !!audio.manager ? audio.manager.events : new Events();\r\n        audio.data = ObjectUtil.extend(true, {}, Audio.defaults, data);\r\n\r\n        audio.audioNode = [];\r\n\r\n        if (audio.data.id === null) {\r\n            audio.data.id = UUID.generate();\r\n        }\r\n\r\n        if (audio.manager) audio.manager.media.get('audios').add(audio.data.id, audio);\r\n\r\n        audio.load();\r\n    }\r\n\r\n\r\n    _load(audio) {\r\n        var audioNode = new AudioNode();\r\n\r\n        audioNode.addEventListener('error', function () {\r\n            console.error({type: audioNode.error ? audioNode.error.code : 0});\r\n        }, false);\r\n\r\n        audio.audioNode.push(audioNode);\r\n\r\n        audioNode.src = audio.data.src;\r\n        audioNode.pos = 0;\r\n        audioNode.preload = 'auto';\r\n        audioNode.volume = (!!audio.manager)\r\n            ? (audio.manager.muted) ? 0 : audio.data.volume * (audio.manager.volume / 100)\r\n            : (audio.data.muted) ? 0 : audio.data.volume;\r\n\r\n        var listener = function () {\r\n            audio.data.duration = Math.ceil(audioNode.duration * 10) / 10;\r\n\r\n            if (Object.getOwnPropertyNames(audio.data.sprite).length === 0) {\r\n                audio.data.sprite = {default: [0, audio.data.duration * 1000]};\r\n            }\r\n\r\n            if (!audio.data.loaded) {\r\n                audio.data.loaded = true;\r\n                audio.events.trigger('load');\r\n            }\r\n\r\n            if (audio.data.autoPlay) {\r\n                audio.play();\r\n            }\r\n\r\n            audioNode.removeEventListener('canplaythrough', listener, false);\r\n        };\r\n        audioNode.addEventListener('canplaythrough', listener, false);\r\n        audioNode.load();\r\n\r\n        return audio;\r\n    }\r\n\r\n    load() {\r\n        var audio = this;\r\n        var url = '', extension = '';\r\n\r\n        if (audio.manager && (!!audio.manager.isSupportAudio)) {\r\n            console.warn('No audio support.');\r\n            return false;\r\n        }\r\n\r\n        var extractFormat = function (source, format) {\r\n            if (format) return format;\r\n\r\n            var extension = /^data:audio\\/([^;,]+);/i.exec(source);\r\n            if (!extension) {\r\n                extension = /\\.([^.]+)$/.exec(source.split('?', 1)[0]);\r\n            }\r\n\r\n            if (extension) {\r\n                return extension[1].toLowerCase();\r\n            } else {\r\n                console.warn('Could not extract format from passed URLs, please add format');\r\n            }\r\n            return null;\r\n        };\r\n\r\n        if (audio.data.src instanceof Array) {\r\n            for (var i = 0; i < audio.data.src.length; i++) {\r\n                url = audio.data.src[i];\r\n                extension = extractFormat(audio.data.src[i], audio.data.format);\r\n                if (null !== extension) break;\r\n            }\r\n            audio.data.src = url;\r\n        } else if (typeof audio.data.src === 'string') {\r\n            extension = extractFormat(audio.data.src, audio.data.format);\r\n        } else {\r\n            console.warn('Unknown audio source');\r\n            return false;\r\n        }\r\n\r\n        if (audio.manager && audio.manager.isSupportCodec[extension]) {\r\n            console.warn('Codec not support');\r\n            return false;\r\n        }\r\n\r\n        return audio._load(audio);\r\n    }\r\n\r\n    _unload(audioNode) {\r\n        audioNode.src = '';\r\n    }\r\n\r\n    unload() {\r\n        var audio = this;\r\n\r\n        var nodes = audio.audioNode;\r\n        for (var i = 0; i < audio.audioNode.length; i++) {\r\n            if (!nodes[i].paused) {\r\n                audio.stop(nodes[i].id);\r\n                audio.events.trigger('unload', nodes[i].id);\r\n            }\r\n            audio._unload(nodes[i]);\r\n        }\r\n\r\n        for (i = 0; i < audio.data.onEndTimer.length; i++) {\r\n            clearTimeout(audio.data.onEndTimer[i].timer);\r\n        }\r\n\r\n        if (audio.manager) {\r\n            var audios = this.manager.get('audios');\r\n            var index = audios.indexOf(audio);\r\n            if (index !== null && index >= 0) {\r\n                audios.splice(index, 1);\r\n            }\r\n        }\r\n\r\n        delete cache[audio.data.src];\r\n        audio = null;\r\n    };\r\n\r\n    src(source) {\r\n        var audio = this;\r\n\r\n        if (source) {\r\n            audio.stop();\r\n            audio.data.src = source;\r\n            audio.data.loaded = false;\r\n            audio.load();\r\n        } //TODO:: else throw\r\n\r\n        return null;\r\n    }\r\n\r\n    play(sprite, callback) {\r\n        var audio = this;\r\n\r\n        if (typeof sprite === 'function') callback = sprite;\r\n        if (!sprite || typeof sprite === 'function') sprite = 'default';\r\n\r\n        if (!audio.data.loaded) {\r\n            audio.events.on('load', function () {\r\n                audio.play(sprite, callback);\r\n            });\r\n\r\n            return audio;\r\n        }\r\n\r\n        if (!audio.data.sprite[sprite]) {\r\n            if (typeof callback === 'function') callback();\r\n            return audio;\r\n        }\r\n\r\n        audio._inactiveNode(audio, function (node) {\r\n            node.sprite = sprite;\r\n\r\n            var pos = (node.pos > 0) ? node.pos : audio.data.sprite[sprite][0] / 1000;\r\n            var duration = audio.data.sprite[sprite][1] / 1000 - (pos - audio.data.sprite[sprite][0] / 1000);\r\n            var loop = !!(audio.data.loop || audio.data.sprite[sprite][2]);\r\n\r\n            var soundId = (typeof callback === 'string')\r\n                ? callback\r\n                : Math.round(Date.now() * Math.random()) + '', timerId;\r\n\r\n            (function () {\r\n                var data = {\r\n                    id: soundId,\r\n                    sprite: sprite,\r\n                    loop: loop\r\n                };\r\n\r\n                timerId = setTimeout(function () {\r\n                    if (loop) {\r\n                        audio.stop(data.id).play(sprite, data.id);\r\n                    } else {\r\n                        audio.stop(data.id);\r\n                    }\r\n\r\n                    audio.events.trigger('unload', soundId);\r\n                }, (duration / audio.data.rate) * 1000);\r\n\r\n                audio.data.onEndTimer.push({timer: timerId, id: data.id});\r\n            })();\r\n\r\n\r\n            if (node.readyState === 4 || !node.readyState && navigator.isCocoonJS) {\r\n                node.id = soundId;\r\n                node.currentTime = pos;\r\n\r\n                node.muted = audio.manager\r\n                    ? (audio.manager.muted || node.muted)\r\n                    : (audio.data.muted || node.muted);\r\n\r\n                node.volume = audio.manager\r\n                    ? audio.data.volume * (audio.manager.volume / 100)\r\n                    : audio.data.volume;\r\n\r\n                setTimeout(function () {\r\n                    node.play();\r\n                }, 0);\r\n            } else {\r\n                audio._clearEndTimer(soundId);\r\n\r\n                (function () {\r\n                    var audio = audio,\r\n                        playSprite = sprite,\r\n                        fn = callback,\r\n                        newNode = node;\r\n\r\n                    var listener = function () {\r\n                        audio.play(playSprite, fn);\r\n                        newNode.removeEventListener('canplaythrough', listener, false);\r\n                    };\r\n\r\n                    newNode.addEventListener('canplaythrough', listener, false);\r\n                })();\r\n\r\n                return audio;\r\n            }\r\n\r\n            audio.events.trigger('play');\r\n            if (typeof callback === 'function') callback(soundId);\r\n\r\n            return audio;\r\n        });\r\n\r\n        return audio;\r\n    }\r\n\r\n    _pause(activeNode) {\r\n        activeNode.pause();\r\n        return false;\r\n    }\r\n\r\n    pause(id) {\r\n        var audio = this;\r\n\r\n        if (!audio.data.loaded) {\r\n            audio.events.on('play', function () {\r\n                audio.pause(id);\r\n            });\r\n            return audio;\r\n        }\r\n\r\n        audio._clearEndTimer(audio, id);\r\n\r\n        var activeNode = (id) ? audio._nodeById(id) : audio._activeNode(audio);\r\n        if (activeNode) {\r\n            activeNode.pos = audio.pos(null, id);\r\n            var result = audio._pause(activeNode);\r\n            if (result) return audio;\r\n        }\r\n\r\n        audio.events.trigger('pause');\r\n\r\n        return audio;\r\n    }\r\n\r\n    _stop(activeNode) {\r\n        if (!isNaN(activeNode.duration)) {\r\n            activeNode.pause();\r\n            activeNode.currentTime = 0;\r\n        }\r\n        return false;\r\n    }\r\n\r\n    stop(id) {\r\n        var audio = this;\r\n\r\n        if (!audio.data.loaded) {\r\n            audio.events.on('play', function () {\r\n                audio.stop(id);\r\n            });\r\n\r\n            return audio;\r\n        }\r\n\r\n        audio._clearEndTimer(audio, id);\r\n\r\n        var activeNode = (id) ? audio._nodeById(audio, id) : audio._activeNode(audio);\r\n        if (activeNode) {\r\n            activeNode.pos = 0;\r\n            var result = audio._stop(activeNode);\r\n            if (result) return audio;\r\n        }\r\n\r\n        return audio;\r\n    }\r\n\r\n    _mute(activeNode) {\r\n        activeNode.muted = true;\r\n    }\r\n\r\n    mute(id) {\r\n        var audio = this;\r\n\r\n        if (!audio.data.loaded) {\r\n            audio.events.on('play', function () {\r\n                audio.mute(id);\r\n            });\r\n            return audio;\r\n        }\r\n\r\n        var activeNode = (id) ? audio._nodeById(id) : audio._activeNode(audio);\r\n        if (activeNode) audio._mute();\r\n\r\n        return audio;\r\n    }\r\n\r\n    _unMute(activeNode) {\r\n        activeNode.muted = false;\r\n    }\r\n\r\n    unMute(id) {\r\n        var audio = this;\r\n\r\n        if (!audio.data.loaded) {\r\n            audio.events.on('play', function () {\r\n                audio.unMute(id);\r\n            });\r\n            return audio;\r\n        }\r\n\r\n        var activeNode = (id) ? audio._nodeById(id) : audio._activeNode(audio);\r\n        if (activeNode) audio._unMute();\r\n\r\n        return audio;\r\n    }\r\n\r\n    _volume(activeNode, vol) {\r\n        activeNode.volume = vol;\r\n    }\r\n\r\n    volume(vol, id) {\r\n        var audio = this;\r\n\r\n        vol = parseFloat(vol);\r\n\r\n        if (vol >= 0 && vol <= 1) {\r\n            audio.data.volume = vol;\r\n\r\n            if (!audio.data.loaded) {\r\n                audio.events.on('play', function () {\r\n                    audio.volume(vol, id);\r\n                });\r\n                return audio;\r\n            }\r\n\r\n            var activeNode = (id) ? audio._nodeById(id) : audio._activeNode(audio);\r\n            if (activeNode) {\r\n                vol = audio.manager\r\n                    ? vol * (audio.manager.volume / 100)\r\n                    : audio.data.volume;\r\n                audio._volume(vol);\r\n            }\r\n\r\n            return audio;\r\n        }\r\n        return audio.data.volume;\r\n    }\r\n\r\n    loop(loop) {\r\n        var audio = this;\r\n\r\n        if (typeof loop === 'boolean') {\r\n            audio.data.loop = loop;\r\n            return audio;\r\n        }\r\n        return audio.data.loop;\r\n    }\r\n\r\n    sprite(sprite) {\r\n        var audio = this;\r\n\r\n        if (typeof sprite === 'object') {\r\n            audio.data.sprite = sprite;\r\n            return audio;\r\n        }\r\n        return audio.data.sprite;\r\n    }\r\n\r\n    _position(activeNode, v) {\r\n        return activeNode.currentTime;\r\n    }\r\n\r\n    pos(pos, id) {\r\n        var audio = this;\r\n\r\n        if (!audio.data.loaded) {\r\n            audio.events.on('load', function () {\r\n                audio.pos(pos);\r\n            });\r\n            return typeof pos === 'number' ? audio : audio.data.pos || 0;\r\n        }\r\n\r\n        pos = parseFloat(pos);\r\n\r\n        var activeNode = (id) ? audio._nodeById(id) : audio._activeNode(audio);\r\n        if (activeNode) {\r\n            if (pos >= 0) {\r\n                audio.pause(id);\r\n                activeNode.pos = pos;\r\n                audio.play(activeNode.sprite, id);\r\n                return audio;\r\n            } else {\r\n                return audio._position(activeNode, false);\r\n            }\r\n        } else if (pos >= 0) {\r\n            return audio;\r\n        } else {\r\n            for (var i = 0; i < audio.audioNode.length; i++) {\r\n                if (audio.audioNode[i].paused && audio.audioNode[i].readyState === 4) {\r\n                    return audio._position(audio.audioNode[i], true);\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    _pos3d(activeNode, x, y, zsaz) {\r\n        return null;\r\n    }\r\n\r\n    pos3d(x, y, z, id) {\r\n        var audio = this;\r\n\r\n        y = (typeof y === 'undefined' || !y) ? 0 : y;\r\n        z = (typeof z === 'undefined' || !z) ? -0.5 : z;\r\n\r\n        if (!audio.data.loaded) {\r\n            audio.events.on('play', function () {\r\n                audio.pos3d(x, y, z, id);\r\n            });\r\n            return audio;\r\n        }\r\n\r\n        if (x >= 0 || x < 0) {\r\n            var activeNode = (id) ? audio._nodeById(id) : audio._activeNode(audio);\r\n            audio._pos3d(activeNode, x, y, z);\r\n        } else {\r\n            return audio.data.pos3d;\r\n        }\r\n\r\n        return audio;\r\n    }\r\n\r\n    /* Private */\r\n    _nodeById(audio, id) {\r\n        var node = audio.audioNode[0];\r\n\r\n        for (var i = 0; i < audio.audioNode.length; i++) {\r\n            if (audio.audioNode[i].id === id) {\r\n                node = audio.audioNode[i];\r\n                break;\r\n            }\r\n        }\r\n\r\n        return node;\r\n    }\r\n\r\n    _clearEndTimer(audio, id) {\r\n        var index = -1;\r\n\r\n        for (var i = 0; i < audio.data.onEndTimer.length; i++) {\r\n            if (audio.data.onEndTimer[i].id === id) {\r\n                index = i;\r\n                break;\r\n            }\r\n        }\r\n\r\n        var timer = audio.data.onEndTimer[index];\r\n        if (timer) {\r\n            clearTimeout(timer.timer);\r\n            audio.data.onEndTimer.splice(index, 1);\r\n        }\r\n    }\r\n\r\n    _activeNode(audio) {\r\n        var node = null;\r\n\r\n        for (var i = 0; i < audio.audioNode.length; i++) {\r\n            if (!audio.audioNode[i].paused) {\r\n                node = audio.audioNode[i];\r\n                break;\r\n            }\r\n        }\r\n\r\n        audio._drainPool(audio);\r\n\r\n        return node;\r\n    }\r\n\r\n    _inactiveNode(audio, callback) {\r\n        var node = null;\r\n\r\n        for (var i = 0; i < audio.audioNode.length; i++) {\r\n            if (audio.audioNode[i].paused && audio.audioNode[i].readyState === 4) {\r\n                callback(audio.audioNode[i]);\r\n                node = true;\r\n                break;\r\n            }\r\n        }\r\n\r\n        audio._drainPool(audio);\r\n\r\n        if (node) return;\r\n\r\n        audio.load();\r\n        var newNode = audio.audioNode[audio.audioNode.length - 1];\r\n        var listenerEvent = navigator.isCocoonJS ? 'canplaythrough' : 'loadedmetadata';\r\n        var listener = function () {\r\n            newNode.removeEventListener(listenerEvent, listener, false);\r\n            callback(newNode);\r\n        };\r\n        newNode.addEventListener(listenerEvent, listener, false);\r\n    }\r\n\r\n    _drainPool(audio) {\r\n        var inactive = 0;\r\n\r\n        for (var i = 0; i < audio.audioNode.length; i++) {\r\n            if (audio.audioNode[i].paused) inactive++;\r\n        }\r\n\r\n        for (i = audio.audioNode.length - 1; i >= 0; i--) {\r\n            if (inactive <= 5) break;\r\n\r\n            if (audio.audioNode[i].paused) {\r\n                audio.audioNode.splice(i, 1);\r\n                inactive--;\r\n            }\r\n        }\r\n    }\r\n}\r\n","import GroupNode from \"nodes/GroupNode\";\r\nimport BaseNode from \"nodes/BaseNode\";\r\nimport RuntimeException from \"exceptions/RuntimeException\";\r\n\r\nexport const LAYER_PREFIX = '__layer$';\r\n\r\nexport default class Layer extends GroupNode {\r\n    static isSpecial = true; // This fix situation when add Layer in GroupNode.\r\n\r\n    _isGlobal = false;\r\n\r\n    _registry = [];\r\n\r\n    get(key) {\r\n        return this._nodes[`${LAYER_PREFIX}${key}`] || this._nodes[key] || null;\r\n    }\r\n\r\n    has(key) {\r\n        return this._nodes[`${LAYER_PREFIX}${key}`] !== undefined || this._nodes[key] !== undefined;\r\n    }\r\n\r\n    constructor(guid) {\r\n        super({id: `${LAYER_PREFIX}${guid}`});\r\n        if (guid === 'global') this._isGlobal = true;\r\n    }\r\n\r\n    add(node, index) {\r\n        index = index === undefined ? this.count() : this.find('main') + index;\r\n        if (node.instanceOf(Layer) && this._isGlobal) {\r\n            if (this._registry[node.guid] !== undefined) {\r\n                throw new RuntimeException(`Global layer already contain layer with id: \"${node.guid}\"`);\r\n            }\r\n            this._registry[node.guid] = node;\r\n            this._nodes[node.guid] = node;\r\n            this._nodes.splice(index, 0, node);\r\n            //TODO:: registry of layers\r\n        } else if (node.instanceOf(Layer) && !this._isGlobal) {\r\n            throw RuntimeException('Only global layer has another layer as child.');\r\n        } else if (node.instanceOf(BaseNode) && this._isGlobal) {\r\n            this._nodes[this.find('main')].add(node);\r\n        } else if (node.instanceOf(BaseNode) && !this._isGlobal) {\r\n            super.add(node)\r\n        }\r\n        return this;\r\n    }\r\n\r\n    remove(node) {\r\n        if (node.instanceOf(Layer)) {\r\n            delete this._registry[node.guid];\r\n        }\r\n        super.remove(node);\r\n        return this;\r\n    }\r\n\r\n    count() {\r\n        return this._nodes.length;\r\n    }\r\n\r\n    find(key) {\r\n        let node = this._nodes[`${LAYER_PREFIX}${key}`];\r\n        if (!node) return null;\r\n        return this._nodes.indexOf(node);\r\n    }\r\n}\r\n","import ObjectUtil from \"../utils/ObjectUtil\";\r\nimport Events from \"../utils/Events\";\r\nimport ArrayMap from \"../utils/ArrayMap\";\r\n/**\r\n * j2D (JavaScript 2D Engine)\r\n *\r\n * @authors DeVinterX, James Simpson of GoldFire Studios(howler.js)\r\n * @original_source https://github.com/goldfire/howler.js/blob/master/howler.js\r\n * @license BSD, MIT(howler.js)\r\n * @version 0.2.0-dev\r\n */\r\n\r\nvar AudioNode = window.Audio;\r\nvar audioContext = false;\r\nvar html5Audio = false;\r\n\r\ntry {\r\n    //noinspection JSUnresolvedVariable\r\n    var AudioContext = window.AudioContext || window.webkitAudioContext;\r\n    audioContext = new AudioContext();\r\n} catch (e) {\r\n    console.warn('Web Audio API is not supported in your browser');\r\n}\r\n\r\ntry {\r\n    //noinspection JSUnresolvedFunction\r\n    html5Audio = !!new AudioNode();\r\n} catch (e) {\r\n    console.warn('HTML5 Audio is not supported in your browser');\r\n}\r\n\r\nif (audioContext) {\r\n    var masterGain = (audioContext.createGain === undefined)\r\n        ? audioContext.createGainNode()\r\n        : audioContext.createGain();\r\n    masterGain.gain.value = 1;\r\n    masterGain.connect(audioContext.destination);\r\n}\r\n\r\n/* MediaManager */\r\n\r\n/**\r\n * @class MediaManager\r\n * @exports module:io/MediaManager\r\n *\r\n * @param {EngineJ2D} j2d\r\n * @param {MediaManager.defaults|Object|undefined} [data]\r\n * @constructor\r\n */\r\nexport default class MediaManager {\r\n    static defaults = {\r\n        volume: 1,\r\n        muted: false,\r\n        codecs: {},\r\n        iOSAutoEnable: true\r\n    };\r\n\r\n    constructor(j2d, data) {\r\n        if (data === undefined) data = {};\r\n        this.j2d = j2d;\r\n        this.data = ObjectUtil.extend(true, {}, MediaManager.defaults, data);\r\n        this.events = new Events();\r\n        this.media = new ArrayMap();\r\n\r\n        this.media.add('sounds', new ArrayMap());\r\n        this.media.add('audios', new ArrayMap());\r\n        this.media.add('videos', new ArrayMap());\r\n\r\n        this.volume = this.data.volume * 100;\r\n        this.iOSEnabled = false;\r\n\r\n        if (audioContext || html5Audio) {\r\n            var test = new AudioNode();\r\n            this.data.codecs = {\r\n                mp3: !!test.canPlayType('audio/mpeg;').replace(/^no$/, ''),\r\n                opus: !!test.canPlayType('audio/ogg; codecs=\"opus\"').replace(/^no$/, ''),\r\n                ogg: !!test.canPlayType('audio/ogg; codecs=\"vorbis\"').replace(/^no$/, ''),\r\n                wav: !!test.canPlayType('audio/wav; codecs=\"1\"').replace(/^no$/, ''),\r\n                aac: !!test.canPlayType('audio/aac;').replace(/^no$/, ''),\r\n                m4a: !!(test.canPlayType('audio/x-m4a;') || test.canPlayType('audio/m4a;') || test.canPlayType('audio/aac;')).replace(/^no$/, ''),\r\n                mp4: !!(test.canPlayType('audio/x-mp4;') || test.canPlayType('audio/mp4;') || test.canPlayType('audio/aac;')).replace(/^no$/, ''),\r\n                weba: !!test.canPlayType('audio/webm; codecs=\"vorbis\"').replace(/^no$/, '')\r\n            };\r\n            test = null;\r\n        }\r\n    }\r\n\r\n    get volume() {\r\n        return this.data.volume * 100;\r\n    }\r\n\r\n    set volume(value) {\r\n        this.data.volume = parseFloat(value / 100);\r\n\r\n        if (value >= 0 && value <= 1) {\r\n            if (audioContext) {\r\n                masterGain.gain.value = this.data.volume;\r\n            } else {\r\n                var sounds = this.media.get('sounds');\r\n                for (var key in sounds) {\r\n                    if (sounds.hasOwnProperty(key) && !sounds[key].webAudio) {\r\n                        for (var i = 0; i < sounds[key].audioNode.length; i++) {\r\n                            sounds[key].audioNode[i].volume = sounds[key].volume * this.data.volume;\r\n                        }\r\n                    }\r\n                }\r\n                sounds = null;\r\n            }\r\n        }\r\n    }\r\n\r\n    get muted() {\r\n        return !!this.data.muted;\r\n    }\r\n\r\n    set muted(value) {\r\n        this.data.muted = !!value;\r\n\r\n        if (audioContext) {\r\n            masterGain.gain.value = this.data.muted ? 0 : this.data.volume;\r\n        } else {\r\n            var sounds = this.media.get('sounds');\r\n            for (var key in sounds) {\r\n                if (sounds.hasOwnProperty(key) && sounds[key].webAudio === false) {\r\n                    for (var i = 0; i < sounds[key].audioNode.length; i++) {\r\n                        sounds[key].audioNode[i].muted = this.data.muted;\r\n                    }\r\n                }\r\n            }\r\n            sounds = null;\r\n        }\r\n    }\r\n\r\n    get iOSEnable() {\r\n        return !!this.data.iOSAutoEnable;\r\n    }\r\n\r\n    set iOSEnable(value) {\r\n        if (audioContext && (this.iOSEnabled || !/iPhone|iPad|iPod/i.test(navigator.userAgent))) {\r\n            return value;\r\n        }\r\n        this.iOSEnabled = false;\r\n\r\n        var unlock = function () {\r\n            var buffer = audioContext.createBuffer(1, 1, 22050);\r\n            var source = audioContext.createBufferSource();\r\n            source.buffer = buffer;\r\n            source.connect(audioContext.destination);\r\n\r\n            if (source.start === undefined) {\r\n                source.noteOn(0);\r\n            } else {\r\n                source.start(0);\r\n            }\r\n\r\n            setTimeout(function () {\r\n                if ((source.playbackState === source.PLAYING_STATE\r\n                    || source.playbackState === source.FINISHED_STATE)) {\r\n                    this.iOSEnabled = true;\r\n                    this.data.iOSAutoEnable = false;\r\n\r\n                    window.removeEventListener('touchend', unlock, false);\r\n                }\r\n            }, 0);\r\n        };\r\n        window.addEventListener('touchend', unlock, false);\r\n    }\r\n\r\n    get isSupportAudio() {\r\n        return !audioContext && !html5Audio;\r\n    }\r\n\r\n\r\n    getAudioContext() {\r\n        return audioContext;\r\n    }\r\n\r\n    getMasterGain() {\r\n        return masterGain;\r\n    }\r\n\r\n    mute() {\r\n        this.muted = true;\r\n        return this;\r\n    }\r\n\r\n    unMute() {\r\n        this.muted = false;\r\n        return this;\r\n    }\r\n\r\n    isSupportCodec(fileExtension) {\r\n        return !!this.data.codecs[fileExtension];\r\n    }\r\n\r\n    addSound(data) {\r\n        new Sound(data, this);\r\n        return this;\r\n    }\r\n\r\n    addAudio(data) {\r\n        new Audio(data, this);\r\n        return this;\r\n    }\r\n\r\n    addVideo(data) {\r\n        //new Video(this, data);\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {string} id\r\n     * @returns {Sound}\r\n     */\r\n    sound(id) {\r\n        return this.media.get('sounds').get(id);\r\n    }\r\n\r\n    audio(id) {\r\n        return this.media.get('audios').get(id);\r\n    }\r\n\r\n    video(id) {\r\n        return this.media.get('videos').get(id);\r\n    }\r\n\r\n    removeSound(id) {\r\n        if (this.media.get('sounds').contains(id)) {\r\n            this.media.get('sounds').get(id).stop();\r\n            this.media.get('sounds').remove(id);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    removeAudio(id) {\r\n        if (this.media.get('audios').contains(id)) {\r\n            this.media.get('audios').get(id).stop();\r\n            this.media.get('audios').remove(id);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    removeVideo(id) {\r\n        if (this.media.get('videos').contains(id)) {\r\n            this.media.get('videos').get(id).stop();\r\n            this.media.get('videos').remove(id);\r\n        }\r\n        return this;\r\n    }\r\n}\r\n","import ArrayMap from \"utils/ArrayMap\";\r\nimport Vector2d from \"utils/Vector2d\";\r\n\r\n/**\r\n * @param e\r\n * @param {boolean} [enableCallback]\r\n * @returns {boolean}\r\n */\r\nvar checkKeyMap = function (e, enableCallback) {\r\n    if (enableCallback === undefined) enableCallback = true;\r\n\r\n    var j2d = e.data.manager.j2d,\r\n        manager = e.data.manager,\r\n        keyCode = e.which,\r\n        keyMap = e.data.manager.keyMap;\r\n\r\n    for (var index in keyMap) {\r\n        if (keyMap.hasOwnProperty(index)) {\r\n            var value = keyMap[index];\r\n            if (!$.isArray(value[0]) && value[0] === keyCode && !!value[1]) {\r\n                if (typeof value[1] === 'string') {\r\n                    value[1] = eval('(' + value[1] + ')');\r\n                }\r\n                if ((typeof value[1] === 'function') && enableCallback) {\r\n                    value[1](j2d, value[2]);\r\n                }\r\n                return true;\r\n            } else if ($.isArray(value[0])\r\n                && manager.data.keysPressed.equals(value[0]) && !!value[1]\r\n            ) {\r\n                if (typeof value[1] === 'string') {\r\n                    value[1] = eval('(' + value[1] + ')');\r\n                }\r\n                if (typeof value[1] === 'function' && enableCallback) {\r\n                    value[1](j2d, value[2]);\r\n                }\r\n                return true\r\n            }\r\n        }\r\n    }\r\n    return false\r\n};\r\nvar events = {\r\n    onMouseClick: function (e) {\r\n        var manager = e.data.manager;\r\n        if (!manager.data.enabled || !manager.j2d.isPlay || !manager.j2d.element.hasClass('active')) return true;\r\n        var keysPressed = manager.data.keysPressed;\r\n        var keyCode = getKey(DEPRECATED_InputManager.key, e.which) || 'KEY_UNKNOWN_' + e.which;\r\n        var mouse = manager.data.mouse;\r\n\r\n        if (e.data.event !== 2) {\r\n            if (e.data.event === 0) {\r\n                if (-1 === $.inArray(DEPRECATED_InputManager.key[keyCode], keysPressed)) {\r\n                    keysPressed.push(DEPRECATED_InputManager.key[keyCode]);\r\n\r\n                    if (manager.data.enableAdditionalData) {\r\n                        mouse.startPosition.x = e.pageX;\r\n                        mouse.startPosition.y = e.pageY;\r\n                        mouse.distance = 0;\r\n\r\n                        manager.data.timePressed = e.timeStamp;\r\n                    }\r\n                }\r\n                if (checkKeyMap(e, false) || manager.data.preventAll) {\r\n                    e.preventDefault();\r\n                }\r\n            } else {\r\n                if (checkKeyMap(e) || manager.data.preventAll) {\r\n                    e.preventDefault();\r\n                }\r\n                if (manager.data.enableAdditionalData) {\r\n                    mouse.previousDistance = mouse.distance;\r\n                    mouse.startPosition.x = 0;\r\n                    mouse.startPosition.y = 0;\r\n                }\r\n\r\n                keysPressed.splice(\r\n                    keysPressed.indexOf(DEPRECATED_InputManager.key[keyCode]), 1\r\n                );\r\n            }\r\n            manager.element.trigger(e.data.event === 0 ?\r\n                'mouseKeyDown' : 'mouseKeyUp', {keyCode: keyCode}\r\n            );\r\n        } else {\r\n            if (checkKeyMap(e, false)) {\r\n                e.preventDefault();\r\n            }\r\n        }\r\n    },\r\n\r\n    onMouseWheel: function (e) {\r\n        var manager = e.data.manager;\r\n        if (!manager.data.enabled || !manager.j2d.isPlay || !manager.j2d.element.hasClass('active')) return true;\r\n        var keysPressed = manager.data.keysPressed;\r\n        var keyCode = (e.originalEvent.wheelDelta / 120 > 0) ?\r\n            getKey(DEPRECATED_InputManager.key, 4) : getKey(DEPRECATED_InputManager.key, 5);\r\n\r\n        e.which = (e.originalEvent.wheelDelta / 120 > 0) ? 4 : 5;\r\n\r\n        if (-1 === $.inArray(DEPRECATED_InputManager.key[keyCode], keysPressed)) {\r\n            keysPressed.push(DEPRECATED_InputManager.key[keyCode]);\r\n        }\r\n\r\n        if (checkKeyMap(e) || manager.data.preventAll) {\r\n            e.preventDefault();\r\n            manager.fixMouseWheel();\r\n        }\r\n\r\n        manager.element.trigger('mouseWheel', {keyCode: keyCode});\r\n    },\r\n\r\n    mouseWheelCancel: function (keysPressed, keyCode) {\r\n        keysPressed.splice(\r\n            keysPressed.indexOf(DEPRECATED_InputManager.key[keyCode]), 1\r\n        );\r\n    },\r\n\r\n    onMouseMove: function (e) {\r\n        var manager = e.data.manager;\r\n        var mouse = e.data.manager.data.mouse;\r\n\r\n        manager.data.mouse.currentPosition.x = e.pageX;\r\n        manager.data.mouse.currentPosition.y = e.pageY;\r\n\r\n        if (e.data.manager.data.enableAdditionalData) {\r\n            mouse.distance = Math.sqrt(\r\n                Math.pow((mouse.currentPosition.x - mouse.startPosition.x), 2)\r\n                + Math.pow((mouse.currentPosition.y - mouse.startPosition.y), 2)\r\n            ).toFixed(1);\r\n        }\r\n    },\r\n\r\n    onKeyboardPress: function (e) {\r\n        var manager = e.data.manager;\r\n        if (!manager.data.enabled || !manager.j2d.isPlay || !manager.element.hasClass('active')) return true;\r\n        var keysPressed = manager.data.keysPressed;\r\n        var keyCode = getKey(DEPRECATED_InputManager.key, e.which) || 'KEY_UNKNOWN_' + e.which;\r\n        if (e.data.event === 2 && true === manager.data.writeMode) {\r\n            var char = String.fromCharCode(e.which || e.keyCode);\r\n            e.preventDefault();\r\n            manager.element.focus().trigger('keyboardCharPress', {\r\n                key: e.which || e.keyCode,\r\n                keyCode: keyCode,\r\n                char: char\r\n            });\r\n        }\r\n\r\n        if (e.data.event !== 2 && false === manager.data.writeMode) {\r\n            if (e.data.event === 0) {\r\n                if (-1 === $.inArray(DEPRECATED_InputManager.key[keyCode], keysPressed)) {\r\n                    keysPressed.push(DEPRECATED_InputManager.key[keyCode]);\r\n                    if (manager.data.enableAdditionalData) {\r\n                        manager.data.timePressed = e.timeStamp;\r\n                    }\r\n                }\r\n                if (checkKeyMap(e, false) || manager.data.preventAll) {\r\n                    e.preventDefault();\r\n                }\r\n            } else {\r\n                if (checkKeyMap(e) || manager.data.preventAll) {\r\n                    e.preventDefault();\r\n                }\r\n\r\n                keysPressed.splice(\r\n                    keysPressed.indexOf(DEPRECATED_InputManager.key[keyCode]), 1\r\n                );\r\n            }\r\n\r\n            manager.element.trigger(e.data.event === 0 ?\r\n                'keyboardKeyDown' : 'keyboardKeyUp', {keyCode: keyCode, key: e.which || e.keyCode}\r\n            );\r\n        }\r\n\r\n        if (e.data.event !== 2 && true === manager.data.writeMode) {\r\n            manager.element.trigger(e.data.event === 0 ?\r\n                'keyboardKeyDown' : 'keyboardKeyUp', {keyCode: keyCode, key: e.which || e.keyCode}\r\n            );\r\n        }\r\n    },\r\n\r\n    onTouchTap: function (e) {\r\n        var manager = e.data.manager;\r\n        if (!manager.data.enabled || !manager.j2d.isPlay || !manager.j2d.element.hasClass('active')) return true;\r\n        var keysPressed = manager.data.keysPressed;\r\n        var keyCode = getKey(DEPRECATED_InputManager.key, e.which + 1) || 'KEY_UNKNOWN_' + e.which;\r\n        var touch = e.originalEvent.touches[0] || e.originalEvent.changedTouches[0];\r\n        var mouse = manager.data.mouse;\r\n\r\n        if (e.data.event === 0) {\r\n            if (-1 === $.inArray(DEPRECATED_InputManager.key[keyCode], keysPressed)) {\r\n                keysPressed.push(DEPRECATED_InputManager.key[keyCode]);\r\n                if (manager.data.enableAdditionalData) {\r\n                    mouse.startPosition.x = touch.pageX;\r\n                    mouse.startPosition.y = touch.pageY;\r\n                    mouse.distance = 0;\r\n\r\n                    manager.data.timePressed = e.timeStamp;\r\n                }\r\n            }\r\n            if (checkKeyMap(e, false) || manager.data.preventAll) {\r\n                e.preventDefault();\r\n            }\r\n        } else {\r\n            if (checkKeyMap(e) || manager.data.preventAll) {\r\n                e.preventDefault();\r\n            }\r\n\r\n            if (manager.data.enableAdditionalData) {\r\n                mouse.previousDistance = mouse.distance;\r\n                mouse.startPosition.x = 0;\r\n                mouse.startPosition.y = 0;\r\n            }\r\n\r\n            keysPressed.splice(\r\n                keysPressed.indexOf(DEPRECATED_InputManager.key[keyCode]), 1\r\n            );\r\n        }\r\n\r\n        manager.element.trigger(e.data.event === 0 ?\r\n            'mouseKeyDown' : 'mouseKeyUp', {keyCode: keyCode}\r\n        );\r\n    },\r\n\r\n    onTouchMove: function (e) {\r\n        var touch = e.originalEvent.touches[0] || e.originalEvent.changedTouches[0];\r\n        var mouse = e.data.manager.data.mouse;\r\n\r\n        mouse.currentPosition.x = touch.pageX.toFixed(0);\r\n        mouse.currentPosition.y = touch.pageY.toFixed(0);\r\n\r\n        if (e.data.manager.data.enableAdditionalData) {\r\n            mouse.distance = Math.sqrt(\r\n                Math.pow((mouse.currentPosition.x - mouse.startPosition.x), 2)\r\n                + Math.pow((mouse.currentPosition.y - mouse.startPosition.y), 2)\r\n            ).toFixed(1);\r\n        }\r\n    }\r\n};\r\n\r\n/**\r\n * @param {DEPRECATED_InputManager} manager\r\n */\r\nvar bindEvents = function (manager) {\r\n    var selector = '[guid=' + manager.id + ']';\r\n\r\n    $(document).on('contextmenu', selector, {manager: manager, event: 2}, events.onMouseClick);\r\n    $(document).on('mousedown', selector, {manager: manager, event: 0}, events.onMouseClick);\r\n    $(document).on('mouseup', selector, {manager: manager, event: 1}, events.onMouseClick);\r\n    $(document).on('mousewheel', selector, {manager: manager}, events.onMouseWheel);\r\n    $(document).on('mousemove', selector, {manager: manager}, events.onMouseMove);\r\n\r\n    $(document).on('keydown', null, {manager: manager, event: 0}, events.onKeyboardPress);\r\n    $(document).on('keyup', null, {manager: manager, event: 1}, events.onKeyboardPress);\r\n    $(document).on('keypress', null, {manager: manager, event: 2}, events.onKeyboardPress);\r\n\r\n    $(document).on('touchstart', selector, {manager: manager, event: 0}, events.onTouchTap);\r\n    $(document).on('touchend', selector, {manager: manager, event: 1}, events.onTouchTap);\r\n    $(document).on('touchmove ', selector, {manager: manager}, events.onTouchMove);\r\n};\r\n\r\n/**\r\n * @param {DEPRECATED_InputManager} manager\r\n */\r\nvar unbindEvents = function (manager) {\r\n    var selector = '[guid=' + manager.id + ']';\r\n\r\n    $(document).off('contextmenu', selector, {manager: manager, event: 1}, events.onMouseClick);\r\n    $(document).off('mousedown', selector, {manager: manager, event: 0}, events.onMouseClick);\r\n    $(document).off('mouseup', selector, {manager: manager, event: 1}, events.onMouseClick);\r\n    $(document).off('mousewheel', selector, {manager: manager}, events.onMouseWheel);\r\n    $(document).off('mousemove', selector, {manager: manager}, events.onMouseMove);\r\n\r\n    $(document).off('keydown', null, {manager: manager, event: 0}, events.onKeyboardPress);\r\n    $(document).off('keyup', null, {manager: manager, event: 1}, events.onKeyboardPress);\r\n    $(document).off('keypress', null, {manager: manager, event: 2}, events.onKeyboardPress);\r\n\r\n    $(document).off('touchstart', selector, {manager: manager, event: 0}, events.onTouchTap);\r\n    $(document).off('touchend', selector, {manager: manager, event: 1}, events.onTouchTap);\r\n    $(document).off('touchmove ', selector, {manager: manager}, events.onTouchMove);\r\n};\r\n\r\n/**\r\n * @param {DEPRECATED_InputManager} manager\r\n * @param {Array.<number>|number[]} keyList\r\n * @returns {{keyList: Array.<number>|number[]|number, time: number}|boolean}\r\n */\r\nvar getPressData = function (manager, keyList) {\r\n    if (!manager.data.enableAdditionalData) return true;\r\n    return {\r\n        keyList: keyList,\r\n        time: Date.now() - manager.data.timePressed\r\n    };\r\n};\r\n\r\n/**\r\n * @param {Object} object\r\n * @param {number} value\r\n * @returns {T}\r\n */\r\nfunction getKey(object, value) {\r\n    return Object.keys(object).filter(function (key) {\r\n        return object[key] === value\r\n    })[0];\r\n}\r\n\r\n/**\r\n * @class DEPRECATED_InputManager\r\n * @exports module:io/DEPRECATED_InputManager\r\n *\r\n * @param {EngineJ2D} j2d\r\n * @constructor\r\n *\r\n * @type {DEPRECATED_InputManager.key} key\r\n */\r\nexport default class DEPRECATED_InputManager {\r\n    constructor(j2d) {\r\n        this.j2d = j2d;\r\n\r\n        /** @type string */\r\n        this.id = j2d.data.id;\r\n\r\n        /** @type Element|jQuery */\r\n        this.element = j2d.element;\r\n\r\n        this.data = {\r\n            mouse: {\r\n                startPosition: {\r\n                    x: 0,\r\n                    y: 0\r\n                },\r\n                currentPosition: {\r\n                    x: 0,\r\n                    y: 0\r\n                },\r\n                previousDistance: 0,\r\n                distance: 0\r\n            },\r\n            viewport: {\r\n                position: {\r\n                    x: 0,\r\n                    y: 0\r\n                }\r\n            },\r\n            enabled: false,\r\n            enableAdditionalData: false,\r\n            keysPressed: new ArrayMap(),\r\n            writeMode: false,\r\n            timePressed: 0,\r\n            preventAll: false,\r\n\r\n            cursor: {\r\n                enabled: false,\r\n                image: 'auto'\r\n            }\r\n        };\r\n\r\n        this.keyMap = {\r\n            //DEBUG_INFO: [[DEPRECATED_InputManager.key.KEY_CTRL, DEPRECATED_InputManager.key.KEY_F1], 'j2d.debug.toggleScreen', {}],\r\n            FULLSCREEN: [[DEPRECATED_InputManager.key.KEY_CTRL, DEPRECATED_InputManager.key.KEY_F11], 'j2d.scene.toggleFullScreen', {}]\r\n        };\r\n    }\r\n\r\n    /**\r\n     * @returns {DEPRECATED_InputManager}\r\n     */\r\n    init() {\r\n        if (!this.data.enabled && window.j2dPlugin.pluginInit) {\r\n            bindEvents(this);\r\n\r\n            this.data.enabled = true;\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @returns {boolean}\r\n     */\r\n    update() {\r\n        if (!this.data.enabled) return false;\r\n\r\n        var dX = this.j2d.scene.canvas.offsetWidth / this.j2d.scene.data.width,\r\n            dY = this.j2d.scene.canvas.offsetHeight / this.j2d.scene.data.height,\r\n            x = this.data.mouse.currentPosition.x / dX,\r\n            y = this.data.mouse.currentPosition.y / dY;\r\n\r\n        var offset = this.element.offset();\r\n\r\n        this.data.viewport.x = this.j2d.scene.viewport.x + x - offset.left;\r\n        this.data.viewport.y = this.j2d.scene.viewport.y + y - offset.top;\r\n        return true;\r\n    }\r\n\r\n    /**\r\n     * @returns {DEPRECATED_InputManager}\r\n     */\r\n    flush() {\r\n        this.data.keysPressed.length = 0;\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @returns {DEPRECATED_InputManager}\r\n     */\r\n    clear() {\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @returns {DEPRECATED_InputManager}\r\n     */\r\n    fixMouseWheel() {\r\n        var keyPressed = this.data.keysPressed;\r\n        if (-1 !== $.inArray(DEPRECATED_InputManager.key.SCROLL_MOUSE_UP, keyPressed)) {\r\n            events.mouseWheelCancel(keyPressed, DEPRECATED_InputManager.key.SCROLL_MOUSE_UP);\r\n        } else if (-1 !== $.inArray(DEPRECATED_InputManager.key.SCROLL_MOUSE_DOWN, keyPressed)) {\r\n            events.mouseWheelCancel(keyPressed, DEPRECATED_InputManager.key.SCROLL_MOUSE_DOWN);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @returns {DEPRECATED_InputManager}\r\n     */\r\n    enable() {\r\n        if (!this.data.enabled) {\r\n            //bindEvents(this);\r\n            this.data.enabled = false;\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @returns {DEPRECATED_InputManager}\r\n     */\r\n    disable() {\r\n        if (this.data.enabled) {\r\n            //unbindEvents(this);\r\n            this.data.enabled = false;\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {string} newKeyMap\r\n     * @returns {string}\r\n     */\r\n    load(newKeyMap) {\r\n        var oldKeyMap = JSON.stringify(this.keyMap);\r\n        this.keyMap = JSON.parse(newKeyMap);\r\n        return oldKeyMap;\r\n    }\r\n\r\n    /**\r\n     * @returns {string}\r\n     */\r\n    save() {\r\n        return JSON.stringify(this.keyMap);\r\n    }\r\n\r\n    /**\r\n     * KeyMap Manager\r\n     *\r\n     * @param mapObject\r\n     * @returns {DEPRECATED_InputManager}\r\n     */\r\n    setKeys(mapObject) {\r\n        this.keyMap = $.extend(true, {}, this.keyMap, mapObject);\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @returns {{current: number, previous: number}}\r\n     */\r\n    getMouseMoveDistance() {\r\n        if (!this.data.enableAdditionalData) return 0;\r\n        return {current: this.data.mouse.distance, previous: this.data.mouse.previousDistance};\r\n    }\r\n\r\n    /* +Input Checkers **/\r\n    /**\r\n     * @param {Array.<number>|number[]|number} keyList\r\n     * @returns {boolean}\r\n     */\r\n    checkPressedKeyList(keyList) {\r\n        if ($.isArray(keyList)) {\r\n            if (keyList.length !== this.data.keysPressed.length) {\r\n                return false;\r\n            } else if (this.data.keysPressed.equals(keyList)) {\r\n                this.fixMouseWheel();\r\n                return getPressData(this, keyList);\r\n            }\r\n            this.fixMouseWheel();\r\n            return false;\r\n        }\r\n        //if (!this.data.keysPressed.equals([])) console.log(this.data.keysPressed);\r\n        if (isNaN(keyList)) return false;\r\n        if (-1 !== this.data.keysPressed.indexOf(keyList)) {\r\n            this.fixMouseWheel();\r\n            return getPressData(this, keyList);\r\n        }\r\n        this.fixMouseWheel();\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * @param {string} key\r\n     * @returns {boolean}\r\n     */\r\n    checkPressedKeyMap(key) {\r\n        if (this.keyMap[key] === undefined) return false;\r\n        var keyList = this.keyMap[key][0];\r\n\r\n        return this.checkPressedKeyList(keyList);\r\n    }\r\n\r\n    getPosition() {\r\n        return new Vector2d(this.data.viewport.x + 0.5, this.data.viewport.y + 0.3);\r\n    }\r\n\r\n//onNode (id) {\r\n//    if (!id.layer.visible) return false;\r\n//    return (this.data.viewport.x > id.options.position.x && this.data.viewport.x < id.options.position.x + id.options.size.x) &&\r\n//        (this.data.viewport.y > id.options.position.y && this.data.viewport.y < id.options.position.y + id.options.size.y);\r\n//}\r\n    /* -Input Checkers **/\r\n\r\n    /* +Input Write Mode **/\r\n    /**\r\n     * @param {boolean} mode\r\n     * @returns {DEPRECATED_InputManager}\r\n     */\r\n    setWriteMode(mode) {\r\n        this.data.writeMode = !!mode;\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @returns {boolean}\r\n     */\r\n    isWriteMode() {\r\n        return !!this.data.writeMode;\r\n    }\r\n\r\n    /* -Input Write Mode **/\r\n\r\n    /**\r\n     * @param {string} image\r\n     * @returns {DEPRECATED_InputManager}\r\n     */\r\n    setCursorImage(image) {\r\n        this.data.cursor.image = 'url(\"' + image + '\"), auto';\r\n        $(this.element).css('cursor', this.data.cursor.image);\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {boolean} enable\r\n     * @returns {DEPRECATED_InputManager}\r\n     */\r\n    toggleCursor(enable) {\r\n        if (enable !== undefined) {\r\n            this.data.cursor.enable = !!enable;\r\n        } else {\r\n            this.data.cursor.enable = !this.data.cursor.enable;\r\n        }\r\n\r\n        if (!this.data.cursor.enable) {\r\n            this.data.cursor.image = $(this.j2d.element).css('cursor');\r\n            $(this.element).css('cursor', 'none');\r\n        } else {\r\n            $(this.element).css('cursor', this.data.cursor.image);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @returns {boolean}\r\n     */\r\n    isCursorVisible() {\r\n        return !!this.data.cursor.enable;\r\n    }\r\n\r\n    /** -Cursor **/\r\n\r\n    /**\r\n     * Static keys arrayList\r\n     *\r\n     * @readonly\r\n     * @enum {number}\r\n     */\r\n    static key = {\r\n        KEY_MOUSE_LEFT: 1,\r\n        KEY_MOUSE_MIDDLE: 2,\r\n        KEY_MOUSE_RIGHT: 3,\r\n\r\n        SCROLL_MOUSE_UP: 4,\r\n        SCROLL_MOUSE_DOWN: 5,\r\n\r\n        KEY_BACKSPACE: 8,\r\n        KEY_TAB: 9,\r\n        KEY_ENTER: 13,\r\n        KEY_SHIFT: 16,\r\n        KEY_CTRL: 17,\r\n        KEY_ALT: 18,\r\n        KEY_PAUSE: 19,\r\n        KEY_BREAK: 19,\r\n        KEY_CAPS_LOCK: 20,\r\n        KEY_ESCAPE: 27,\r\n        KEY_SPACE_BAR: 32,\r\n        KEY_PAGE_UP: 33,\r\n        KEY_PAGE_DOWN: 34,\r\n        KEY_END: 35,\r\n        KEY_HOME: 36,\r\n        KEY_LEFT_ARROW: 37,\r\n        KEY_UP_ARROW: 38,\r\n        KEY_RIGHT_ARROW: 39,\r\n        KEY_DOWN_ARROW: 40,\r\n        KEY_INSERT: 45,\r\n        KEY_DELETE: 46,\r\n        KEY_0: 48,\r\n        KEY_1: 49,\r\n        KEY_2: 50,\r\n        KEY_3: 51,\r\n        KEY_4: 52,\r\n        KEY_5: 53,\r\n        KEY_6: 54,\r\n        KEY_7: 55,\r\n        KEY_8: 56,\r\n        KEY_9: 57,\r\n        KEY_A: 65,\r\n        KEY_B: 66,\r\n        KEY_C: 67,\r\n        KEY_D: 68,\r\n        KEY_E: 69,\r\n        KEY_F: 70,\r\n        KEY_G: 71,\r\n        KEY_H: 72,\r\n        KEY_I: 73,\r\n        KEY_J: 74,\r\n        KEY_K: 75,\r\n        KEY_L: 76,\r\n        KEY_M: 77,\r\n        KEY_N: 78,\r\n        KEY_O: 79,\r\n        KEY_P: 80,\r\n        KEY_Q: 81,\r\n        KEY_R: 82,\r\n        KEY_S: 83,\r\n        KEY_T: 84,\r\n        KEY_U: 85,\r\n        KEY_V: 86,\r\n        KEY_W: 87,\r\n        KEY_X: 88,\r\n        KEY_Y: 89,\r\n        KEY_Z: 90,\r\n        KEY_LEFT_WINDOW_KEY: 91,\r\n        KEY_RIGHT_WINDOW_KEY: 92,\r\n        KEY_SELECT_KEY: 93,\r\n        KEY_NUMPAD_0: 96,\r\n        KEY_NUMPAD_1: 97,\r\n        KEY_NUMPAD_2: 98,\r\n        KEY_NUMPAD_3: 99,\r\n        KEY_NUMPAD_4: 100,\r\n        KEY_NUMPAD_5: 101,\r\n        KEY_NUMPAD_6: 102,\r\n        KEY_NUMPAD_7: 103,\r\n        KEY_NUMPAD_8: 104,\r\n        KEY_NUMPAD_9: 105,\r\n        KEY_MULTIPLY: 106,\r\n        KEY_ADD: 107,\r\n        KEY_SUBTRACT: 109,\r\n        KEY_DECIMAL_POINT: 110,\r\n        KEY_DIVIDE: 111,\r\n        KEY_F1: 112,\r\n        KEY_F2: 113,\r\n        KEY_F3: 114,\r\n        KEY_F4: 115,\r\n        KEY_F5: 116,\r\n        KEY_F6: 117,\r\n        KEY_F7: 118,\r\n        KEY_F8: 119,\r\n        KEY_F9: 120,\r\n        KEY_F10: 121,\r\n        KEY_F11: 122,\r\n        KEY_F12: 123,\r\n        KEY_NUM_LOCK: 144,\r\n        KEY_SCROLL_LOCK: 145,\r\n        KEY_SEMI_COLON: 186,\r\n        KEY_EQUAL_SIGN: 187,\r\n        KEY_COMMA: 188,\r\n        KEY_DASH: 189,\r\n        KEY_PERIOD: 190,\r\n        KEY_FORWARD_SLASH: 191,\r\n        KEY_GRAVE_ACCENT: 192,\r\n        KEY_OPEN_BRACKET: 219,\r\n        KEY_BACK_SLASH: 220,\r\n        KEY_CLOSE_BRACKET: 221,\r\n        KEY_SINGLE_QUOTE: 222,\r\n        KEY_LEFT_COMMAND: 224,\r\n        KEY_RIGHT_COMMAND: 224\r\n    };\r\n}\r\n","export default {\r\n    KEY_MOUSE_LEFT: 1,\r\n    KEY_MOUSE_MIDDLE: 2,\r\n    KEY_MOUSE_RIGHT: 3,\r\n\r\n    SCROLL_MOUSE_UP: 4,\r\n    SCROLL_MOUSE_DOWN: 5,\r\n\r\n    KEY_BACKSPACE: 8,\r\n    KEY_TAB: 9,\r\n    KEY_ENTER: 13,\r\n    KEY_SHIFT: 16,\r\n    KEY_CTRL: 17,\r\n    KEY_ALT: 18,\r\n    KEY_PAUSE: 19,\r\n    KEY_BREAK: 19,\r\n    KEY_CAPS_LOCK: 20,\r\n    KEY_ESCAPE: 27,\r\n    KEY_SPACE_BAR: 32,\r\n    KEY_PAGE_UP: 33,\r\n    KEY_PAGE_DOWN: 34,\r\n    KEY_END: 35,\r\n    KEY_HOME: 36,\r\n    KEY_LEFT_ARROW: 37,\r\n    KEY_UP_ARROW: 38,\r\n    KEY_RIGHT_ARROW: 39,\r\n    KEY_DOWN_ARROW: 40,\r\n    KEY_INSERT: 45,\r\n    KEY_DELETE: 46,\r\n    KEY_0: 48,\r\n    KEY_1: 49,\r\n    KEY_2: 50,\r\n    KEY_3: 51,\r\n    KEY_4: 52,\r\n    KEY_5: 53,\r\n    KEY_6: 54,\r\n    KEY_7: 55,\r\n    KEY_8: 56,\r\n    KEY_9: 57,\r\n    KEY_A: 65,\r\n    KEY_B: 66,\r\n    KEY_C: 67,\r\n    KEY_D: 68,\r\n    KEY_E: 69,\r\n    KEY_F: 70,\r\n    KEY_G: 71,\r\n    KEY_H: 72,\r\n    KEY_I: 73,\r\n    KEY_J: 74,\r\n    KEY_K: 75,\r\n    KEY_L: 76,\r\n    KEY_M: 77,\r\n    KEY_N: 78,\r\n    KEY_O: 79,\r\n    KEY_P: 80,\r\n    KEY_Q: 81,\r\n    KEY_R: 82,\r\n    KEY_S: 83,\r\n    KEY_T: 84,\r\n    KEY_U: 85,\r\n    KEY_V: 86,\r\n    KEY_W: 87,\r\n    KEY_X: 88,\r\n    KEY_Y: 89,\r\n    KEY_Z: 90,\r\n    KEY_LEFT_WINDOW_KEY: 91,\r\n    KEY_RIGHT_WINDOW_KEY: 92,\r\n    KEY_SELECT_KEY: 93,\r\n    KEY_NUMPAD_0: 96,\r\n    KEY_NUMPAD_1: 97,\r\n    KEY_NUMPAD_2: 98,\r\n    KEY_NUMPAD_3: 99,\r\n    KEY_NUMPAD_4: 100,\r\n    KEY_NUMPAD_5: 101,\r\n    KEY_NUMPAD_6: 102,\r\n    KEY_NUMPAD_7: 103,\r\n    KEY_NUMPAD_8: 104,\r\n    KEY_NUMPAD_9: 105,\r\n    KEY_MULTIPLY: 106,\r\n    KEY_ADD: 107,\r\n    KEY_SUBTRACT: 109,\r\n    KEY_DECIMAL_POINT: 110,\r\n    KEY_DIVIDE: 111,\r\n    KEY_F1: 112,\r\n    KEY_F2: 113,\r\n    KEY_F3: 114,\r\n    KEY_F4: 115,\r\n    KEY_F5: 116,\r\n    KEY_F6: 117,\r\n    KEY_F7: 118,\r\n    KEY_F8: 119,\r\n    KEY_F9: 120,\r\n    KEY_F10: 121,\r\n    KEY_F11: 122,\r\n    KEY_F12: 123,\r\n    KEY_NUM_LOCK: 144,\r\n    KEY_SCROLL_LOCK: 145,\r\n    KEY_SEMI_COLON: 186,\r\n    KEY_EQUAL_SIGN: 187,\r\n    KEY_COMMA: 188,\r\n    KEY_DASH: 189,\r\n    KEY_PERIOD: 190,\r\n    KEY_FORWARD_SLASH: 191,\r\n    KEY_GRAVE_ACCENT: 192,\r\n    KEY_OPEN_BRACKET: 219,\r\n    KEY_BACK_SLASH: 220,\r\n    KEY_CLOSE_BRACKET: 221,\r\n    KEY_SINGLE_QUOTE: 222,\r\n    KEY_LEFT_COMMAND: 224,\r\n    KEY_RIGHT_COMMAND: 224,\r\n\r\n    //fix mouse with extra buttons\r\n    KEY_MOUSE_3: 403,\r\n    KEY_MOUSE_4: 404,\r\n    KEY_MOUSE_5: 405,\r\n    KEY_MOUSE_6: 406,\r\n    KEY_MOUSE_7: 407,\r\n    KEY_MOUSE_8: 408,\r\n    KEY_MOUSE_9: 409,\r\n    KEY_MOUSE_10: 410\r\n};\r\n","import Exception from \"exceptions/Exception\";\r\n\r\n/**\r\n * UnexpectedValueException\r\n * Create custom exception with message\r\n *\r\n * @class UnexpectedValueException\r\n * @exports module:exceptions/UnexpectedValueException\r\n *\r\n * @constructor\r\n * @extends Exception\r\n * @param {string} message\r\n * @property {string} message\r\n */\r\nexport default class UnexpectedValueException extends Exception {\r\n    constructor(message) {\r\n        super(message)\r\n    }\r\n\r\n    /**\r\n     * Convert exception to String\r\n     * @returns {string}\r\n     */\r\n    toString = function () {\r\n        return this.message;\r\n    }\r\n}\r\n","import Exception from \"exceptions/Exception\";\r\n\r\n/**\r\n * RuntimeException\r\n * Create custom exception with message\r\n *\r\n * @class RuntimeException\r\n * @exports module:exceptions/RuntimeException\r\n *\r\n * @constructor\r\n * @extends Exception\r\n * @param {string} message\r\n * @property {string} message\r\n */\r\nexport default class RuntimeException extends Exception {\r\n    constructor(message) {\r\n        super(message)\r\n    }\r\n\r\n    /**\r\n     * Convert exception to String\r\n     * @returns {string}\r\n     */\r\n    toString = function () {\r\n        return this.message;\r\n    }\r\n}\r\n","import Exception from \"exceptions/Exception\";\r\n\r\n/**\r\n * RangeException\r\n * Create custom exception with message\r\n *\r\n * @class RangeException\r\n * @exports module:exceptions/RangeException\r\n *\r\n * @constructor\r\n * @extends Exception\r\n * @param {string} message\r\n * @property {string} message\r\n */\r\nexport default class RangeException extends Exception {\r\n    constructor(message) {\r\n        super(message)\r\n    }\r\n\r\n    /**\r\n     * Convert exception to String\r\n     * @returns {string}\r\n     */\r\n    toString = function () {\r\n        return this.message;\r\n    }\r\n}\r\n","import Exception from \"exceptions/Exception\";\r\n\r\n/**\r\n * OutOfRangeException\r\n * Create custom exception with message\r\n *\r\n * @class OutOfRangeException\r\n * @exports module:exceptions/OutOfRangeException\r\n *\r\n * @constructor\r\n * @extends Exception\r\n * @param {string} message\r\n * @property {string} message\r\n */\r\nexport default class OutOfRangeException extends Exception {\r\n    constructor(message) {\r\n        super(message)\r\n    }\r\n\r\n    /**\r\n     * Convert exception to String\r\n     * @returns {string}\r\n     */\r\n    toString = function () {\r\n        return this.message;\r\n    }\r\n}\r\n","import Exception from \"exceptions/Exception\";\r\n\r\n/**\r\n * OutOfBoundsException\r\n * Create custom exception with message\r\n *\r\n * @class OutOfBoundsException\r\n * @exports module:exceptions/OutOfBoundsException\r\n *\r\n * @constructor\r\n * @extends Exception\r\n * @param {string} message\r\n * @property {string} message\r\n */\r\nexport default class OutOfBoundsException extends Exception {\r\n    constructor(message) {\r\n        super(message)\r\n    }\r\n\r\n    /**\r\n     * Convert exception to String\r\n     * @returns {string}\r\n     */\r\n    toString = function () {\r\n        return this.message;\r\n    }\r\n}\r\n","import Exception from \"exceptions/Exception\";\r\n\r\n/**\r\n * LogicException\r\n * Create custom exception with message\r\n *\r\n * @class LogicException\r\n * @exports module:exceptions/LogicException\r\n *\r\n * @constructor\r\n * @extends Exception\r\n * @param {string} message\r\n * @property {string} message\r\n */\r\nexport default class LogicException extends Exception {\r\n    constructor(message) {\r\n        super(message)\r\n    }\r\n\r\n    /**\r\n     * Convert exception to String\r\n     * @returns {string}\r\n     */\r\n    toString = function () {\r\n        return this.message;\r\n    }\r\n}\r\n","import Exception from \"exceptions/Exception\";\r\n\r\n/**\r\n * LengthException\r\n * Create custom exception with message\r\n *\r\n * @class LengthException\r\n * @exports module:exceptions/LengthException\r\n *\r\n * @constructor\r\n * @extends Exception\r\n * @param {string} message\r\n * @property {string} message\r\n */\r\nexport default class LengthException extends Exception {\r\n    constructor(message) {\r\n        super(message)\r\n    }\r\n\r\n    /**\r\n     * Convert exception to String\r\n     * @returns {string}\r\n     */\r\n    toString = function () {\r\n        return this.message;\r\n    }\r\n}\r\n","/**\r\n * Default Exception\r\n * Create custom exception with message\r\n *\r\n * @class Exception\r\n * @exports module:exceptions/Exception\r\n *\r\n * @constructor\r\n * @extends Error\r\n * @param {string} message\r\n * @property {string} message\r\n */\r\nexport default class Exception extends Error {\r\n    constructor(message) {\r\n        super(message);\r\n        this.message = message;\r\n\r\n        /**\r\n         * Convert exception to String\r\n         * @returns {string}\r\n         */\r\n        this.toString = function () {\r\n            return this.message;\r\n        }\r\n    }\r\n}\r\n","import Exception from \"exceptions/Exception\";\r\n\r\n/**\r\n * BadMethodCallException\r\n * Create custom exception with message\r\n *\r\n * @class BadMethodCallException\r\n * @exports module:exceptions/BadMethodCallException\r\n *\r\n * @constructor\r\n * @extends Exception\r\n * @param {string} message\r\n * @property {string} message\r\n */\r\nexport default class BadMethodCallException extends Exception {\r\n    constructor(message) {\r\n        super(message)\r\n    }\r\n\r\n    /**\r\n     * Convert exception to String\r\n     * @returns {string}\r\n     */\r\n    toString = function () {\r\n        return this.message;\r\n    }\r\n}\r\n","import Exception from \"exceptions/Exception\";\r\n\r\n/**\r\n * BadFunctionCallException\r\n * Create custom exception with message\r\n *\r\n * @class BadFunctionCallException\r\n * @exports module:exceptions/BadFunctionCallException\r\n *\r\n * @constructor\r\n * @extends Exception\r\n * @param {string} message\r\n * @property {string} message\r\n */\r\nexport default class BadFunctionCallException extends Exception {\r\n    constructor(message) {\r\n        super(message)\r\n    }\r\n\r\n    /**\r\n     * Convert exception to String\r\n     * @returns {string}\r\n     */\r\n    toString = function () {\r\n        return this.message;\r\n    }\r\n}\r\n","import ArrayMap from \"utils/ArrayMap\";\r\nimport CameraNode from \"nodes/CameraNode\";\r\nimport Vector2d from \"utils/Vector2d\";\r\n\r\n/**\r\n * @param {{x: number, y: number, offsetX: number, offsetY: number}} screen\r\n * @param {{offset: {x: number, y: number}, size: {x: number, y: number}, scale: number, angle: number}} viewport\r\n * @returns {{offset: {x: number, y: number}, size: {x: number, y: number}, scale: number, angle: number}}\r\n */\r\nvar calculateScale = function (screen, viewport) {\r\n    var data = {\r\n        offset: {x: 0, y: 0},\r\n        size: {x: 0, y: 0},\r\n        scale: 1.0,\r\n        angle: viewport.angle\r\n    };\r\n\r\n    data.offset.x = screen.offsetX + viewport.offset.x;\r\n    data.offset.y = screen.offsetY + viewport.offset.y;\r\n\r\n    data.size.x = (screen.x < viewport.size.x) ? screen.x : viewport.size.x;\r\n    data.size.y = (screen.y < viewport.size.y) ? screen.y : viewport.size.y;\r\n\r\n    data.scale = viewport.scale * (((screen.x / viewport.size.x) + (screen.y / viewport.size.y)) / 2);\r\n    return data;\r\n};\r\n\r\n/**\r\n * @class ViewportManager\r\n * @exports module:core/ViewportManager\r\n *\r\n * @constructor\r\n *\r\n * @property {ArrayMap.<CameraNode>|CameraNode[]} cameras\r\n * @property {string} camera\r\n * @property {{x: number, y: number, offsetX: number, offsetY: number}} screen\r\n * @property {boolean} init\r\n * @property {{offset: {x: number, y: number}, size: {x: number, y: number}, scale: number, angle: number}} data\r\n */\r\nexport default class ViewportManager {\r\n    constructor() {\r\n        /** @type ArrayMap.<CameraNode>|CameraNode[] */\r\n        this.cameras = new ArrayMap();\r\n\r\n        /** @type string */\r\n        this.camera = 'No active cameras';\r\n\r\n        /** @type {{x: number, y: number, offsetX: number, offsetY: number}} */\r\n        this.screen = {\r\n            x: 0,\r\n            y: 0,\r\n            offsetX: 0,\r\n            offsetY: 0\r\n        };\r\n\r\n        this.init = false;\r\n\r\n        this.data = {\r\n            offset: {x: 0.0, y: 0.0},\r\n            size: {x: 0.0, y: 0.0},\r\n            scale: 1.0,\r\n            angle: 0.0\r\n        };\r\n    }\r\n\r\n    /**\r\n     * @param {{x: number|undefined, y: number|undefined}|Array<number>} data\r\n     * @returns {ViewportManager}\r\n     */\r\n    setScreen(data) {\r\n        if (typeof data == 'object') {\r\n            if (data instanceof Array && data.length == 2) {\r\n                this.screen = {\r\n                    x: data[0],\r\n                    y: data[1],\r\n                    offsetX: this.screen.offsetX,\r\n                    offsetY: this.screen.offsetY\r\n                };\r\n                return this;\r\n            }\r\n            if (data.x !== undefined && data.y !== undefined) {\r\n                this.screen = {\r\n                    x: data.x,\r\n                    y: data.y,\r\n                    offsetX: this.screen.offsetX,\r\n                    offsetY: this.screen.offsetY\r\n                };\r\n            }\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {{x: number|undefined, y: number|undefined}|Array<number>} data\r\n     * @returns {ViewportManager}\r\n     */\r\n    setOffset(data) {\r\n        if (typeof data == 'object') {\r\n            if (data instanceof Array && data.length == 2) {\r\n                this.screen = {\r\n                    x: this.screen.x,\r\n                    y: this.screen.y,\r\n                    offsetX: data[0],\r\n                    offsetY: data[1]\r\n                };\r\n                return this;\r\n            }\r\n            if (data.x !== undefined && data.y !== undefined) {\r\n                this.screen = {\r\n                    x: this.screen.x,\r\n                    y: this.screen.y,\r\n                    offsetX: data.x,\r\n                    offsetY: data.y\r\n                };\r\n            }\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {string} key\r\n     * @param {CameraNode} node\r\n     * @returns {ViewportManager}\r\n     */\r\n    addCamera(key, node) {\r\n        if (node instanceof CameraNode) {\r\n            this.cameras.add(key, node);\r\n            return this;\r\n        }\r\n        // throw new InvalidArgumentException('Unknown camera node type');\r\n    }\r\n\r\n    /**\r\n     * @param {string} key\r\n     * @returns {ViewportManager}\r\n     */\r\n    removeCamera(key) {\r\n        this.cameras.remove(key);\r\n        if (this.camera == key) {\r\n            this.camera = 'No active cameras';\r\n            this.data = {\r\n                offset: {x: 0.0, y: 0.0},\r\n                size: {x: 0.0, y: 0.0},\r\n                scale: 1.0,\r\n                angle: 0.0\r\n            }\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {string} key\r\n     * @returns {ViewportManager}\r\n     */\r\n    updateViewport(key) {\r\n        if (this.cameras[key] !== undefined && this.cameras[key] instanceof CameraNode) {\r\n            this.data = this.cameras[key].getCameraViewport(this.screen, calculateScale);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @deprecated Please use CameraNode\r\n     *\r\n     * @param {Vector2d|null} [offset]\r\n     * @param {Vector2d|null} [size]\r\n     * @returns {ViewportManager}\r\n     */\r\n    setViewport(offset, size) {\r\n        if (offset !== undefined && typeof offset == 'object') {\r\n            if (offset instanceof Vector2d) {\r\n                this.data.offset = offset.getVector();\r\n            }\r\n        }\r\n\r\n        if (size !== undefined && typeof size == 'object') {\r\n            if (size instanceof Vector2d) {\r\n                this.data.size = size.getVector();\r\n            }\r\n        }\r\n\r\n        this.data = calculateScale(this.screen, this.data);\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {{offset: {x: number, y: number}, size: {x: number, y: number}, scale: number, angle: number}} viewport\r\n     * @returns {ViewportManager}\r\n     */\r\n    setDefaultViewport(viewport) {\r\n        if (!this.init) {\r\n            this.data = viewport;\r\n            this.init = true;\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @returns {{offset: {x: number, y: number}, size: {x: number, y: number}, scale: number, angle: number}}\r\n     */\r\n    getViewport() {\r\n        return this.data;\r\n    }\r\n}\r\n","import ObjectUtil from \"utils/ObjectUtil\";\r\nimport Vector2d from \"utils/Vector2d\";\r\nimport FrameManager from \"core/FrameManager\";\r\nimport LayersManager from \"core/LayersManager\";\r\nimport ViewportManager from \"core/ViewportManager\";\r\nimport GameStatesManager from \"core/GameStatesManager\";\r\n\r\n/**\r\n * @class SceneManager\r\n * @exports module:core/SceneManager\r\n *\r\n * @param {EngineJ2D} j2d\r\n * @constructor\r\n *\r\n * @property {SceneManager.defaults} data\r\n *\r\n * @property {string} backgroundColor\r\n * @property {number} opacity\r\n * @property {boolean} visible\r\n * @property {number} zIndex\r\n * @property {{x:number, y:number}} viewport\r\n */\r\nexport default class SceneManager {\r\n    static defaults = {\r\n        width: 0,\r\n        height: 0,\r\n\r\n        originalWidth: 0,\r\n        originalHeight: 0,\r\n        originalMargin: 0,\r\n\r\n        visible: true,\r\n        position: 'absolute',\r\n        top: 0,\r\n        left: 0,\r\n        zIndex: 1000,\r\n        opacity: 1.0,\r\n        backgroundColor: false,\r\n\r\n        frameLimit: 60,\r\n\r\n        enableFullScreen: false,\r\n\r\n        viewport: {x: 0, y: 0}\r\n    };\r\n\r\n    constructor(j2d) {\r\n        this.setGameCallback = this.setGameCallback.bind(this);\r\n        this.start = this.start.bind(this);\r\n\r\n        /** @type EngineJ2D */\r\n        this.j2d = j2d;\r\n\r\n        /** @type {HTMLCanvasElement} */\r\n        this.canvas = null;\r\n\r\n        /** @type {CanvasRenderingContext2D} */\r\n        this.context = null;\r\n\r\n        /** @type {FrameManager} */\r\n        this.frameManager = FrameManager.Init();\r\n\r\n        /** @type {LayersManager} */\r\n        this.layersManager = new LayersManager();\r\n\r\n        /** @type {ViewportManager} */\r\n        this.viewportManager = new ViewportManager();\r\n\r\n        /** @type {GameStatesManager} */\r\n        this.gameStatesManager = new GameStatesManager({}, this.setGameCallback);\r\n\r\n        this.initLayers();\r\n    }\r\n\r\n    get backgroundColor() {\r\n        return this.data.backgroundColor;\r\n    }\r\n\r\n    set backgroundColor(value) {\r\n        this.data.backgroundColor = value;\r\n        this.context.fillStyle = value;\r\n        this.context.fillRect(0, 0, this.data.width, this.data.height);\r\n    }\r\n\r\n    get opacity() {\r\n        return this.data.opacity;\r\n    }\r\n\r\n    set opacity(value) {\r\n        this.data.opacity = value;\r\n        this.canvas.style.opacity = value;\r\n    }\r\n\r\n    get visible() {\r\n        return this.data.visible;\r\n    }\r\n\r\n    set visible(value) {\r\n        this.data.visible = !!value;\r\n        this.canvas.style.display = (!!value) ? 'block' : 'none';\r\n    }\r\n\r\n    get zIndex() {\r\n        return 1000 - this.data.zIndex;\r\n    }\r\n\r\n    set zIndex(value) {\r\n        this.data.zIndex = 1000 + value;\r\n        this.canvas.style.zIndex = 1000 + value;\r\n    }\r\n\r\n    get viewport() {\r\n        return this.data.viewport;\r\n    }\r\n\r\n    /**\r\n     * @param {BaseGameState} state\r\n     * @returns {Function}\r\n     */\r\n    patchGameStateRender(state) {\r\n        var sceneManager = this;\r\n        var constructor = state.constructor;\r\n        if (typeof constructor === 'function' && constructor.prototype.render === undefined) {\r\n            constructor.prototype.render = function (timestamp, data) {\r\n                sceneManager.clear().fillBackground().render(data);\r\n                return true;\r\n            };\r\n        }\r\n        return constructor;\r\n    };\r\n\r\n    /**\r\n     * @param {SceneManager.defaults|Object|undefined} options\r\n     * @returns {SceneManager}\r\n     */\r\n    init(options) {\r\n        this.data = ObjectUtil.extend(true, {}, SceneManager.defaults, options);\r\n\r\n        this.j2d.trigger('beforeInit');\r\n\r\n        this.data.originalWidth = this.data.width;\r\n        this.data.originalHeight = this.data.height;\r\n        this.data.originalMargin = getComputedStyle(this.j2d.element)['margin'];\r\n\r\n        this.j2d.element.style.width = this.data.width + 'px';\r\n        this.j2d.element.style.height = this.data.height + 'px';\r\n\r\n        this.initCanvas();\r\n\r\n        this.viewportManager.setScreen({\r\n            x: this.data.width,\r\n            y: this.data.height\r\n        }).setDefaultViewport({\r\n            offset: {\r\n                x: 0.0,\r\n                y: 0.0\r\n            },\r\n            size: {\r\n                x: this.data.width,\r\n                y: this.data.height\r\n            },\r\n            scale: 1.0,\r\n            angle: 0.0\r\n        });\r\n\r\n        this.j2d.trigger('afterInit');\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @returns {SceneManager}\r\n     */\r\n    initLayers() {\r\n        if (!this.layersManager.getLayer('scene')) {\r\n            this.layersManager.addLayer('scene', 0);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @returns {SceneManager}\r\n     */\r\n    initCanvas() {\r\n        if (document.querySelectorAll('.j2d[guid=\"' + this.j2d.data.id + '\"] canvas').length === 0) {\r\n            this.canvas = document.createElement('canvas');\r\n\r\n            this.canvas.width = this.data.width;\r\n            this.canvas.height = this.data.height;\r\n            this.canvas.style.zIndex = this.data.zIndex;\r\n            this.canvas.style.position = this.data.position;\r\n\r\n            this.canvas.style.left = this.data.left;\r\n            this.canvas.style.top = this.data.top;\r\n\r\n            if (this.j2d.data.webGL) {\r\n                //WebGL2D.enable(this.canvas);\r\n                this.context = this.canvas.getContext('WebGL-2d');\r\n            } else {\r\n                this.context = this.canvas.getContext('2d');\r\n            }\r\n\r\n            if (!this.j2d.data.smoothing) {\r\n                this.j2d.util.disableSmoothing(this.context);\r\n            }\r\n\r\n            this.context.shadowColor = 'rgba(0,0,0,0)';\r\n            if (this.data.backgroundColor) this.backgroundColor = this.data.backgroundColor;\r\n            if (this.data.opacity) this.opacity = this.data.opacity;\r\n            if (this.data.visible) this.visible = this.data.visible;\r\n            if (this.data.zIndex) this.zIndex = 1000 - this.data.zIndex;\r\n\r\n            this.j2d.element.appendChild(this.canvas);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {{x:number, y:number}|Vector2d} [pos]\r\n     * @param {{x:number, y:number}|Vector2d} [size]\r\n     * @returns {SceneManager}\r\n     */\r\n    clear(pos, size) {\r\n        if (pos !== undefined && size !== undefined) {\r\n            this.context.clearRect(pos.x - this.viewport.x, pos.y - this.viewport.y, size.x, size.y);\r\n        } else {\r\n            this.context.clearRect(0, 0, this.data.width, this.data.height);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {number} width\r\n     * @param {number} height\r\n     * @returns {SceneManager}\r\n     */\r\n    resize(width, height) {\r\n        this.canvas.width = this.data.width = width;\r\n        this.canvas.height = this.data.height = height;\r\n\r\n        if (this.data.backgroundColor) {\r\n            this.context.save();\r\n\r\n            this.clear();\r\n            this.backgroundColor = this.data.backgroundColor;\r\n\r\n            this.context.restore();\r\n        }\r\n        if (!this.j2d.data.smoothing) {\r\n            this.j2d.util.disableSmoothing(this.context);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * TODO:: refactor this\r\n     * @param {string} gameState\r\n     * @returns {SceneManager}\r\n     */\r\n    setGameCallback(gameState) {\r\n        var sceneManager = this;\r\n        sceneManager.data.gameState = gameState || 'init_j2d';\r\n        sceneManager.frameManager.stop(sceneManager.j2d.data.id);\r\n\r\n        var gameConstructor = sceneManager.patchGameStateRender(\r\n            sceneManager.gameStatesManager.getState(gameState)\r\n        );\r\n\r\n        var newGameState = new gameConstructor(sceneManager.gameStatesManager, {});\r\n        newGameState.init({\r\n            callback: function () {\r\n                newGameState.load({\r\n                    callback: function () {\r\n                        sceneManager.frameManager.start(sceneManager.j2d.data.id, newGameState, {\r\n                            j2d: sceneManager.j2d,\r\n                            frameLimit: FrameHandler.frameLimit\r\n                        });\r\n\r\n                        sceneManager.j2d.trigger('changedGameState');\r\n\r\n                        // TODO:: async unload?\r\n                        sceneManager.gameStatesManager.getPreviousState().unload();\r\n                    }\r\n                });\r\n            }\r\n        });\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {Function|callback} callback\r\n     * @param {*} data\r\n     * @returns {SceneManager}\r\n     */\r\n    async(callback, data) {\r\n        setTimeout(callback.call(callback, data), 0);\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @returns {SceneManager}\r\n     */\r\n    start() {\r\n        var sceneManager = this;\r\n        if (sceneManager.j2d.data.io) {\r\n            sceneManager.j2d.data.io.init();\r\n        }\r\n        sceneManager.j2d.trigger('beforeStart');\r\n\r\n        sceneManager.frameManager.stop(sceneManager.j2d.data.id);\r\n\r\n        var gameConstructor = sceneManager.patchGameStateRender(\r\n            sceneManager.gameStatesManager.getCurrent()\r\n        );\r\n\r\n        var newGameState = new gameConstructor(sceneManager.gameStatesManager, {});\r\n        newGameState.init({\r\n            callback: function () {\r\n                newGameState.load({\r\n                    callback: function () {\r\n                        sceneManager.frameManager.start(sceneManager.j2d.data.id, newGameState, {\r\n                            j2d: sceneManager.j2d,\r\n                            frameLimit: FrameHandler.frameLimit\r\n                        });\r\n\r\n                        sceneManager.j2d.trigger('afterStart');\r\n                    }\r\n                });\r\n            }\r\n        });\r\n\r\n        return sceneManager;\r\n    }\r\n\r\n    /**\r\n     * @returns {SceneManager}\r\n     */\r\n    stop() {\r\n        this.frameManager.stop(this.j2d.data.id);\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {boolean} [fullscreen]\r\n     * @returns {SceneManager}\r\n     */\r\n    fullScreen(fullscreen) {\r\n        var element = document.getElementById(this.j2d.element.attr('id'));\r\n\r\n        if (undefined === element.requestFullscreen) {\r\n            //noinspection JSUnresolvedVariable\r\n            element.requestFullscreen = element.webkitRequestFullscreen\r\n                || element.webkitRequestFullScreen\r\n                || element.mozRequestFullScreen\r\n                || element.msRequestFullscreen;\r\n        }\r\n\r\n        if (undefined === document.exitFullscreen) {\r\n            //noinspection JSUnresolvedVariable\r\n            document.exitFullscreen = document.webkitExitFullscreen\r\n                || document.webkitCancelFullScreen\r\n                || document.mozCancelFullScreen\r\n                || document.msExitFullscreen;\r\n        }\r\n        if (fullscreen) {\r\n            element.requestFullscreen();\r\n        } else {\r\n            document.exitFullscreen();\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {boolean} [fullscreen]\r\n     * @returns {SceneManager}\r\n     */\r\n    resizeToFullPage(fullscreen) {\r\n        var j2d = this.j2d;\r\n        var sceneManager = this;\r\n\r\n        if (fullscreen) {\r\n            sceneManager.data.originalWidth = sceneManager.data.width;\r\n            sceneManager.data.originalHeight = sceneManager.data.height;\r\n\r\n            sceneManager.resize(j2d.device.width, j2d.device.height);\r\n            sceneManager.data.enableFullscreen = true;\r\n\r\n            j2d.element.style.width = j2d.device.width + 'px';\r\n            j2d.element.style.height = j2d.device.height + 'px';\r\n            j2d.element.style.margin = 0;\r\n\r\n            sceneManager.viewportManager.setScreen({\r\n                x: j2d.device.width,\r\n                y: j2d.device.height\r\n            }).setOffset({\r\n                x: -(j2d.device.width - sceneManager.data.originalWidth) / 2,\r\n                y: -(j2d.device.height - sceneManager.data.originalHeight) / 2\r\n            });\r\n        } else {\r\n            sceneManager.resize(sceneManager.data.originalWidth, sceneManager.data.originalHeight);\r\n            sceneManager.data.enableFullscreen = false;\r\n\r\n            j2d.element.style.width = sceneManager.data.originalWidth + 'px';\r\n            j2d.element.style.height = sceneManager.data.originalHeight + 'px';\r\n            j2d.element.style.margin = sceneManager.data.originalMargin;\r\n\r\n            sceneManager.viewportManager.setScreen({\r\n                x: sceneManager.data.originalWidth,\r\n                y: sceneManager.data.originalHeight\r\n            }).setOffset({\r\n                x: 0,\r\n                y: 0\r\n            });\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {EngineJ2D} j2d\r\n     * @param {{fullscreen: boolean}} data\r\n     * @returns {SceneManager}\r\n     */\r\n    toggleFullScreen(j2d, data) {\r\n        if (data === undefined) {\r\n            data = {fullscreen: false};\r\n        }\r\n        if (!j2d.scene.enableFullscreen || data.fullscreen) {\r\n            j2d.scene.fullScreen(true);\r\n        } else {\r\n            j2d.scene.fullScreen(false);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @returns {CollectionNode|null}\r\n     */\r\n    getSceneLayer() {\r\n        return this.layersManager.getLayer('scene');\r\n    }\r\n\r\n    /**\r\n     * @returns {SceneManager}\r\n     */\r\n    fillBackground() {\r\n        if (this.data.backgroundColor) {\r\n            this.backgroundColor = this.data.backgroundColor;\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {Object} data\r\n     * @returns {SceneManager}\r\n     */\r\n    render(data) {\r\n        var sceneManager = this;\r\n        sceneManager.layersManager.layers.forEach(function (value, index) {\r\n            sceneManager.layersManager.layers[index].render(\r\n                sceneManager.context,\r\n                sceneManager.viewportManager.getViewport(),\r\n                sceneManager.layersManager.globalCollection,\r\n                data || {}\r\n            );\r\n        });\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {BaseNode} node\r\n     * @param {string} [key]\r\n     * @returns {SceneManager}\r\n     */\r\n    add(node, key) {\r\n        if (this.layersManager.globalCollection.has('scene')) {\r\n            this.layersManager.globalCollection.get('scene').add(node, key);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {BaseNode} [node]\r\n     * @param {string} [key]\r\n     * @returns {SceneManager}\r\n     */\r\n    remove(node, key) {\r\n        if (this.layersManager.globalCollection.has('scene')) {\r\n            this.layersManager.globalCollection.get('scene').remove(node, key);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {CameraNode} node\r\n     * @returns {SceneManager}\r\n     */\r\n    registerCamera(node) {\r\n        this.viewportManager.addCamera(node.data.id, node);\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Hack to mode without Cameras\r\n     * @returns {SceneManager}\r\n     */\r\n    _updateNoCamerasViewport(scene) {\r\n        // This hack use deprecated method, i known.\r\n        scene.viewportManager.setViewport(\r\n            new Vector2d(0, 0),\r\n            new Vector2d(scene.data.width, scene.data.height)\r\n        );\r\n\r\n        return scene;\r\n    }\r\n\r\n    /**\r\n     * @param {CameraNode} [node]\r\n     * @returns {SceneManager}\r\n     */\r\n    updateViewport(node) {\r\n        if (node === undefined) return this._updateNoCamerasViewport(this);\r\n        this.viewportManager.updateViewport(node.data.id);\r\n        return this;\r\n    }\r\n\r\n\r\n    // static util = {\r\n    //     /**\r\n    //      * @param {CanvasRenderingContext2D} context\r\n    //      */\r\n    //     disableSmoothing: (context) => {\r\n    //         let chrome = window.navigator.userAgent.match(/Chrom(e|ium)\\/([0-9]+)\\./);\r\n    //         let version = chrome ? parseInt(chrome[2], 10) : false;\r\n    //\r\n    //         context['imageSmoothingEnabled'] = false;\r\n    //         context['mozImageSmoothingEnabled'] = false;\r\n    //         context['oImageSmoothingEnabled'] = false;\r\n    //         if (version && version <= 29) {\r\n    //             context['webkitImageSmoothingEnabled'] = false;\r\n    //         }\r\n    //         context['msImageSmoothingEnabled'] = false;\r\n    //     }\r\n    // };\r\n\r\n    // /** Utils **/\r\n    //util = EngineJ2D.util;\r\n}\r\n","import CollectionNode from \"nodes/CollectionNode\";\r\nimport UUID from \"utils/UUID\";\r\n\r\n/**\r\n * @class LayersManager\r\n * @exports module:core/LayersManager\r\n *\r\n * @constructor\r\n */\r\nexport default class LayersManager {\r\n    constructor() {\r\n        /** @type CollectionNode */\r\n        this.globalCollection = new CollectionNode({id: 'GlobalLayer'});\r\n\r\n        /** @type Array.<CollectionNode>|CollectionNode[] */\r\n        this.layers = [];\r\n\r\n        /** @type number */\r\n        this.index = 1000;\r\n    }\r\n\r\n    /**\r\n     * @param {string} name\r\n     * @param {number} [zIndex]\r\n     * @param {CollectionNode|undefined} [node]\r\n     * @returns {LayersManager}\r\n     */\r\n    addLayer(name, zIndex, node) {\r\n        name = name || UUID.generate();\r\n\r\n        if (node === undefined || node instanceof CollectionNode) {\r\n            if (zIndex === undefined) {\r\n                zIndex = this.index;\r\n                this.index++;\r\n            } else {\r\n                zIndex += 1000;\r\n            }\r\n\r\n            node = node || new CollectionNode({id: name, zIndex: zIndex});\r\n\r\n            this.globalCollection.add(node, name);\r\n            this.layers[zIndex] = node;\r\n\r\n            return this;\r\n        }\r\n        // throw new InvalidArgumentException('Unknown node type to add as layers');\r\n    }\r\n\r\n    /**\r\n     * @param {string} name\r\n     * @returns {LayersManager}\r\n     */\r\n    removeLayer(name) {\r\n        delete this.layers[this.globalCollection.get(name).zIndex];\r\n        this.globalCollection.remove(null, name);\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {string} name\r\n     * @returns {CollectionNode|null}\r\n     */\r\n    getLayer(name) {\r\n        if (this.globalCollection.has(name)) {\r\n            return this.globalCollection.get(name);\r\n        }\r\n        return null;\r\n    }\r\n\r\n    /**\r\n     * @param {string} name\r\n     * @param {number} zIndex\r\n     * @returns {LayersManager}\r\n     */\r\n    setZIndex(name, zIndex) {\r\n        if (this.globalCollection.has(name)) {\r\n            delete this.layers[this.globalCollection.get(name).zIndex];\r\n            this.globalCollection.get(name).zIndex = zIndex;\r\n            this.layers[zIndex] = this.globalCollection.get(name);\r\n        }\r\n        return this;\r\n    }\r\n}\r\n","import ArrayMap from \"utils/ArrayMap\";\r\nimport ObjectUtil from \"utils/ObjectUtil\";\r\nimport DefaultGameState from \"states/DefaultGameState\";\r\nimport BaseGameState from \"states/BaseGameState\";\r\n\r\n/**\r\n * Game states Manager\r\n *\r\n * @class GameStatesManager\r\n * @abstract\r\n * @constructor\r\n *\r\n * @param {GameStatesManager.defaults|Object} data\r\n * @param {function} sceneCallback\r\n * @property {GameStatesManager.defaults|Object} data\r\n * @property {number} state\r\n */\r\nexport default class GameStatesManager {\r\n    /**\r\n     * @type {{previousState: null, currentState: number, states: ArrayMap}}\r\n     */\r\n    static defaults = {\r\n        previousState: null,\r\n        currentState: 0,\r\n        states: new ArrayMap()\r\n    };\r\n\r\n    constructor(data, sceneCallback) {\r\n        this.data = ObjectUtil.extend(true, {}, GameStatesManager.defaults, data);\r\n        this.add(new DefaultGameState());\r\n        this.sceneCallback = sceneCallback;\r\n    }\r\n\r\n    get state() {\r\n        return this.data.currentState;\r\n    }\r\n\r\n    set state(value) {\r\n        this.data.currentState = value;\r\n    }\r\n\r\n    /**\r\n     * @param {string} [id]\r\n     * @returns {BaseGameState|null}\r\n     */\r\n    getState(id) {\r\n        if (id === undefined) return this.getCurrent();\r\n        if (this.data.states.contains(id)) {\r\n            return this.data.states[id];\r\n        }\r\n        return null\r\n    }\r\n\r\n    getPreviousState() {\r\n        return this.data.states.get(this.data.states[this.data.previousState]);\r\n    }\r\n\r\n    getNextState() {\r\n        if (this.data.states[this.state + 1] !== undefined) {\r\n            return this.data.states.get(this.data.states[this.state + 1]);\r\n        }\r\n        return null;\r\n    }\r\n\r\n    getCurrent() {\r\n        return this.data.states.get(this.data.states[this.data.currentState]);\r\n    }\r\n\r\n    /**\r\n     * @param {string} id\r\n     */\r\n    setState(id) {\r\n        if (this.data.states.contains(id)) {\r\n            this.data.previousState = this.data.currentState;\r\n            this.data.currentState = this.data.states.indexOf(id);\r\n            this.sceneCallback(id);\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    setNextState() {\r\n        if (this.data.states[this.state + 1] !== undefined) {\r\n            this.data.previousState = this.data.currentState;\r\n            this.data.currentState = this.state + 1;\r\n            this.sceneCallback(this.data.states[this.state]);\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    setPreviousState() {\r\n        if (this.data.states[this.data.previousState] !== undefined) {\r\n            var state = this.data.previousState;\r\n            this.data.previousState = this.data.currentState;\r\n            this.data.currentState = state;\r\n            this.sceneCallback(this.data.states[state]);\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {BaseGameState} state\r\n     * @param {string} [id]\r\n     */\r\n    add(state, id) {\r\n        if (id === undefined) id = state.data.id;\r\n        if (!this.data.states.contains(id) && state instanceof BaseGameState) {\r\n            this.data.states.add(id, state);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {string} id\r\n     */\r\n    remove(id) {\r\n        if (this.data.states.contains(id)) {\r\n            this.data.states.remove(id);\r\n        }\r\n        return this;\r\n    }\r\n}\r\n","import PrototypeInterface from \"api/PrototypeInterface\";\r\nimport Device from \"utils/Device\";\r\n\r\n/**\r\n * PrototypeObject\r\n * @constructor\r\n */\r\nexport default class PrototypeObject {\r\n    static interfaces = [];\r\n\r\n    constructor() {\r\n        if (this.constructor.interfaces === undefined) this.constructor.interfaces = [];\r\n\r\n        let scope = [];\r\n\r\n        // Disable fault exception IE < 11\r\n        if (Device.browser === 'MSIE' && Device.version < 11) {\r\n            this.__proto__ = Object.assign({}, this.prototype);\r\n        }\r\n\r\n        /**\r\n         TODO:: Object.getPrototypeOf(obj),\r\n         @link https://developer.mozilla.org/ru/docs/Web/JavaScript/Reference/Global_Objects/Object/getPrototypeOf\r\n         */\r\n        let implement = (object) => {\r\n            // Disable fault exception IE < 11\r\n            if (Device.browser === 'MSIE' && Device.version < 11) {\r\n                object.__proto__ = Object.assign({}, object.prototype || {});\r\n            }\r\n\r\n            if (object.__proto__.constructor.name === 'Object'\r\n                || object.__proto__.constructor === undefined\r\n                || object.__proto__.constructor.interfaces.length < 1\r\n            ) return;\r\n\r\n            for (let i = 0; i < object.__proto__.constructor.interfaces.length; i++) {\r\n                if (!(scope.indexOf(object.__proto__.constructor.interfaces[i].name) !== -1)) {\r\n                    scope.push(object.__proto__.constructor.interfaces[i].name);\r\n                    this.constructor.interfaces.push(object.__proto__.constructor.interfaces[i]);\r\n                }\r\n            }\r\n\r\n            implement(object.__proto__);\r\n        };\r\n\r\n        implement(this.__proto__);\r\n    }\r\n\r\n    instanceOf(interfaces) {\r\n        let i = 0;\r\n        if (typeof interfaces === 'object' && interfaces instanceof Array) {\r\n            for (i = 0; i < interfaces.length; i++) {\r\n                if (typeof interfaces[i] === 'function' && new (interfaces[i]) instanceof PrototypeInterface) {\r\n                    if (this.constructor.interfaces.indexOf(interfaces[i]) === -1) return false;\r\n                } else if (typeof interfaces[i] === 'function') {\r\n                    if (!(this instanceof interfaces[i])) return false;\r\n                } else throw new Error('Error. \"' + interfaces[i].constructor.name + '\" is not interface!');\r\n            }\r\n        } else if (typeof interfaces === 'function' && new (interfaces) instanceof PrototypeInterface) {\r\n            return this.constructor.interfaces.indexOf(interfaces) !== -1;\r\n        } else if (typeof interfaces === 'function') {\r\n            if (!(this instanceof interfaces)) return false;\r\n        } else {\r\n            throw new Error('Error. \"' + interfaces.constructor.name + '\" is not interface!');\r\n        }\r\n        return true;\r\n    }\r\n\r\n    toString() {\r\n        return this.__proto__.constructor.name;\r\n    }\r\n}\r\n","/**\r\n * PrototypeInterface\r\n * @constructor\r\n */\r\nexport default class PrototypeInterface {\r\n    static interfaces = [PrototypeInterface];\r\n\r\n    instanceOf(interfaces) {\r\n        let i = 0, j = 0;\r\n        if (typeof interfaces === 'object' && interfaces instanceof Array) {\r\n            for (i = 0; i < interfaces.length; i++) {\r\n                if (typeof interfaces[i] === 'function' && new (interfaces[i]) instanceof PrototypeInterface) {\r\n                    for (j = 0; j < this.constructor.interfaces.length; j++) {\r\n                        if (!(new (this.constructor.interfaces[j]) instanceof interfaces[i])) return false;\r\n                    }\r\n                } else throw new Error('Error. \"' + interfaces[i].constructor.name + '\" is not interface!');\r\n            }\r\n        } else if (typeof interfaces === 'function' && new (interfaces) instanceof PrototypeInterface) {\r\n            for (i = 0; i < this.constructor.interfaces.length; i++) {\r\n                if (!(new (this.constructor.interfaces[i]) instanceof interfaces)) return false;\r\n            }\r\n        } else {\r\n            throw new Error('Error. \"' + interfaces.constructor.name + '\" is not interface!');\r\n        }\r\n        return true;\r\n    }\r\n}\r\n","import PrototypeObject from \"api/PrototypeObject\";\r\nimport IHandler from \"api/interfaces/IHandler\";\r\n\r\n/**\r\n * Handler\r\n * @constructor\r\n */\r\nexport default class Handler extends PrototypeObject {\r\n    static interfaces = [IHandler];\r\n\r\n    _isEnabled = false;\r\n\r\n    events = null;\r\n\r\n    constructor() {\r\n        super();\r\n    }\r\n\r\n    init(eventHandler) {\r\n        if (eventHandler !== undefined) {\r\n            this.events = eventHandler;\r\n        }\r\n        return this;\r\n    };\r\n\r\n    get isEnabled() {\r\n        return this._isEnabled;\r\n    }\r\n\r\n    enable() {\r\n        this._isEnabled = true;\r\n        return this;\r\n    };\r\n\r\n    disable() {\r\n        this._isEnabled = false;\r\n        return this;\r\n    };\r\n\r\n    toggle(status) {\r\n        if (status === undefined) status = !this.isEnabled;\r\n        if (status) {\r\n            this.enable();\r\n        } else {\r\n            this.disable();\r\n        }\r\n        return this;\r\n    };\r\n}\r\n","import Handler from \"api/Handler\";\r\nimport IEngineComponent from \"api/interfaces/IEngineComponent\";\r\n\r\n/**\r\n * EngineComponent\r\n * @constructor\r\n *\r\n * @interface IEngineComponent\r\n */\r\nexport default class EngineComponent extends Handler {\r\n    static interfaces = [IEngineComponent];\r\n\r\n    constructor() {\r\n        super();\r\n    }\r\n};\r\n\r\n","/**\r\n * Device\r\n * @constructor\r\n */\r\nexport default class Device {\r\n    input = undefined;\r\n\r\n    constructor(input) {\r\n        if (input !== undefined) this.input = input;\r\n    }\r\n\r\n    enable() {\r\n        return true;\r\n    };\r\n\r\n    disable() {\r\n        return true;\r\n    };\r\n\r\n    init(input) {\r\n        if (input !== undefined && this.input === undefined) this.input = input;\r\n        return false;\r\n    };\r\n\r\n    update() {\r\n        return true;\r\n    };\r\n\r\n    clear() {\r\n        return true;\r\n    };\r\n\r\n    toString() {\r\n        return function (device) {\r\n            return (device[0].toLowerCase() + device.slice(1))\r\n        }(this.constructor.DeviceName || this.constructor.name);\r\n    };\r\n};\r\n","import InvalidArgumentException from \"exceptions/InvalidArgumentException\";\r\n\r\n/**\r\n * @exports module:objects/Mutable\r\n */\r\nexport default class Mutable extends Object {\r\n    __$MutableOptions;\r\n\r\n    constructor(object, options) {\r\n        if (object !== undefined && typeof object !== 'object') {\r\n            throw new InvalidArgumentException('Attribute object type must be instance of Object.');\r\n        }\r\n\r\n        if (options === undefined) options = {};\r\n        if (object === undefined) object = {};\r\n\r\n        super(object);\r\n\r\n        this.__$MutableOptions = options;\r\n    }\r\n\r\n    extend(...args) {\r\n        Mutable.extend(true, typeof this === Array ? [] : {}, this, ...args);\r\n    }\r\n\r\n    static extend(...args) {\r\n        let deepness = false;\r\n        if (typeof args[0] === 'boolean') {\r\n            deepness = args[0];\r\n            args.splice(0, 1);\r\n        }\r\n\r\n        let out = args[0] || function () {\r\n                if (args[1] !== undefined && args[1] !== null && typeof args[1] === 'object') {\r\n                    return Object.create(args[1])\r\n                }\r\n                return {};\r\n            }();\r\n\r\n        for (let i = 1; i < args.length; i++) {\r\n            /** @type {Object} */\r\n            let object = args[i];\r\n\r\n            if (!object) continue;\r\n\r\n            for (let key in object) {\r\n                if (object.hasOwnProperty(key)) {\r\n                    if (typeof object[key] === 'object' && object[key] !== null) {\r\n                        out[key] = deepness ? Mutable.extend(deepness, out[key], object[key]) : object[key];\r\n                    } else {\r\n                        out[key] = object[key];\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        return out;\r\n    }\r\n}\r\n","import EngineComponent from \"api/EngineComponent\";\r\n\r\nexport default class ViewportHandler extends EngineComponent {\r\n    get viewport() {\r\n        return {x: 0, y: 0, z: 0}\r\n    }\r\n}\r\n","import EngineComponent from \"api/EngineComponent\";\r\nimport Layer from \"layers/Layer\";\r\nimport BaseNode from \"nodes/BaseNode\";\r\nimport Mutable from \"objects/Mutable\";\r\n\r\nexport default class LayersHandler extends EngineComponent {\r\n    /**\r\n     * @type {{}}\r\n     */\r\n    static defaults = {};\r\n\r\n    /**\r\n     * @type {LayersHandler.defaults|{}}\r\n     */\r\n    _data;\r\n\r\n    /** @type {Layer} */\r\n    _layers = new Layer('global');\r\n\r\n    constructor() {\r\n        super();\r\n        this.add(new Layer('main'));\r\n    }\r\n\r\n    init(eventHandler, options) {\r\n        super.init(eventHandler);\r\n        this._data = Mutable.extend(true, {}, LayersHandler.defaults, options);\r\n    }\r\n\r\n    get layers() {\r\n        return this._layers;\r\n    }\r\n\r\n    get(key) {\r\n        this._layers.get(key);\r\n    }\r\n\r\n    has(key) {\r\n        this._layers.has(key);\r\n    }\r\n\r\n    add(node, index) {\r\n        if (node.instanceOf(BaseNode)) {\r\n            this._layers.add(node, index);\r\n        }\r\n    }\r\n\r\n    remove(node) {\r\n        if (node.instanceOf(BaseNode)) {\r\n            this._layers.remove(node);\r\n        }\r\n    }\r\n}\r\n","export default class SystemConsole {\r\n    css = (color) => {\r\n        return 'background: ' + color + ';' +\r\n            'background-repeat: no-repeat;' +\r\n            'color: #1df9a8;' +\r\n            'line-height: 16px;' +\r\n            'padding: 1px 0;' +\r\n            'margin: 0;' +\r\n            'user-select: none;' +\r\n            '-webkit-user-select: none;' +\r\n            '-moz-user-select: none;';\r\n    };\r\n\r\n    link = (color) => {\r\n        return 'background: ' + color + ';' +\r\n            'background-repeat: no-repeat;' +\r\n            'font-size: 12px;' +\r\n            'color: #446d96;' +\r\n            'line-height: 14px';\r\n    };\r\n\r\n    logSystem(message, link) {\r\n        if (navigator.userAgent.toLowerCase().indexOf('chrome') > -1\r\n            || navigator.userAgent.toLowerCase().indexOf('firefox') > -1\r\n        ) {\r\n            return console.log(\"%c %c %c %s %c %c %c %c%s\",\r\n                this.css('#5C6166'), this.css('#4F5357'),\r\n                this.css('#313335'), message,\r\n                this.css('#4F5357'), this.css('#5C6166'),\r\n                this.link('none'), this.link('none'), link\r\n            );\r\n        } else return console.log(message, link);\r\n    }\r\n\r\n    log(message, level) {\r\n        let css = '';\r\n        if (typeof level === 'string') level = level.toLowerCase();\r\n        switch (level) {\r\n            case 'info':\r\n                level = 'INFO';\r\n                css = 'background: #308AE4; color: #fff; padding: 1px 4px';\r\n                break;\r\n            case 'warn':\r\n            case 'warning':\r\n                level = 'WARNING';\r\n                css = 'background: #f7a148; color: #fff; padding: 1px 4px';\r\n                break;\r\n            case 'error':\r\n                level = 'ERROR';\r\n                css = 'background: #DB5252; color: #fff; padding: 1px 4px';\r\n                break;\r\n            case 'network':\r\n                level = 'NETWORK';\r\n                css = 'background: #7D2998; color: #fff; padding: 1px 4px';\r\n                break;\r\n            case 'debug':\r\n            case undefined:\r\n            default:\r\n                level = 'DEBUG';\r\n                css = 'background: #ADADAD; color: #fff; padding: 1px 4px';\r\n        }\r\n\r\n        if (navigator.userAgent.toLowerCase().indexOf('chrome') > -1\r\n            || navigator.userAgent.toLowerCase().indexOf('firefox') > -1\r\n        ) {\r\n            return window.console.log(\"%c%s\", css, level, message);\r\n        } else return window.console.log(message);\r\n    };\r\n}\r\n\r\n","import Vector2d from \"utils/Vector2d\";\r\n/**\r\n * Class utility for get system browser window size\r\n *\r\n * @class Device\r\n * @exports module:utils/Device\r\n *\r\n * @constructor\r\n */\r\nexport default class Device {\r\n    static _browser;\r\n    static _version;\r\n\r\n    static get browser() {\r\n        if (!Device._browser) Device.getVersion();\r\n        return Device._browser;\r\n    };\r\n\r\n    static get version() {\r\n        if (!Device._version) Device.getVersion();\r\n        return Device._version;\r\n    };\r\n\r\n    constructor() {\r\n        let documentWidth = parseInt(Math.max(\r\n            document.documentElement['clientWidth'],\r\n            document.body['scrollWidth'],\r\n            document.documentElement['scrollWidth'],\r\n            document.body['offsetWidth'],\r\n            document.documentElement['offsetWidth']\r\n        ));\r\n\r\n        let documentHeight = parseInt(Math.max(\r\n            document.documentElement['clientHeight'],\r\n            document.body['scrollHeight'],\r\n            document.documentElement['scrollHeight'],\r\n            document.body['offsetHeight'],\r\n            document.documentElement['offsetHeight']\r\n        ));\r\n\r\n        this.width = documentWidth < parseInt(screen.width) ? documentWidth : parseInt(screen.width);\r\n        this.height = documentHeight < parseInt(screen.height) ? documentHeight : parseInt(screen.height);\r\n    }\r\n\r\n    /**\r\n     * @returns {Device}\r\n     */\r\n    onResize() {\r\n        this.width = window.innerWidth;\r\n        this.height = window.innerHeight;\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @returns {number}\r\n     */\r\n    getWidth() {\r\n        return this.width;\r\n    }\r\n\r\n    /**\r\n     * @returns {number}\r\n     */\r\n    getHeight() {\r\n        return this.height;\r\n    }\r\n\r\n    /**\r\n     * @returns {Vector2d}\r\n     */\r\n    getSize() {\r\n        return new Vector2d(this.width, this.height);\r\n    }\r\n\r\n    static getVersion = () => {\r\n        let userAgent = navigator.userAgent, temp,\r\n            match = userAgent.match(/(vivaldi|opera|chrome|safari|firefox|msie|edge(?=\\/)|trident(?=\\/))\\/?\\s*(\\d+)/i)\r\n                || [];\r\n        if (/trident/i.test(match[1]) || /edge/i.test(match[1])) {\r\n            temp = /\\brv[ :]+(\\d+)/g.exec(userAgent) || [];\r\n\r\n            Device._browser = 'IE';\r\n            Device._version = parseFloat(temp[1] || '');\r\n            return ['IE', temp[1] || ''];\r\n        }\r\n\r\n        if (match[1] === 'Chrome') {\r\n            temp = userAgent.match(/\\b(OPR|Edge|Vivaldi)\\/(\\d+(\\.\\d+))/);\r\n            if (temp !== null) {\r\n                Device._browser = temp[1].replace('OPR', 'Opera');\r\n                Device._version = parseFloat(temp[2]);\r\n                return [temp[1].replace('OPR', 'Opera'), temp[2]];\r\n            }\r\n        }\r\n        match = match[2] ? [match[1], match[2]] : [navigator.appName, navigator.appVersion, '-?'];\r\n        if ((temp = userAgent.match(/version\\/(\\d+)/i)) !== null) match.splice(1, 1, temp[1]);\r\n\r\n        Device._browser = match[0];\r\n        Device._version = parseFloat(match[1]);\r\n\r\n        return [match[0], match[1]];\r\n    };\r\n}\r\n","import EngineComponent from \"api/EngineComponent\";\r\nimport InvalidArgumentException from \"exceptions/InvalidArgumentException\";\r\nimport IEngineComponent from \"api/interfaces/IEngineComponent\";\r\nimport Mutable from \"objects/Mutable\";\r\nimport RuntimeException from \"exceptions/RuntimeException\";\r\n\r\nexport default class SceneHandler extends EngineComponent {\r\n    /**\r\n     * @type {{\r\n        * width: number|string,\r\n        * height: number|string,\r\n        * visible: boolean|string,\r\n        * position: string,\r\n        * top: number|string,\r\n        * bottom: number|string,\r\n        * left: number|string,\r\n        * right: number|string,\r\n        * zIndex: number|string,\r\n        * opacity: number|string,\r\n        * backgroundColor: null|string,\r\n        * smoothing: boolean\r\n        * }}\r\n     */\r\n    static defaults = {\r\n        width: 0,\r\n        height: 0,\r\n\r\n        visible: true,\r\n        position: 'absolute',\r\n        top: 0,\r\n        bottom: 'auto',\r\n        left: 0,\r\n        right: 'auto',\r\n        zIndex: 1000,\r\n        opacity: 1.0,\r\n        backgroundColor: null,\r\n\r\n        smoothing: false\r\n    };\r\n\r\n    /** @type {SceneHandler.defaults|{render:string, components: {\r\n        * LayersHandler: IEngineComponent|EngineComponent|LayersHandler|boolean|null,\r\n        * ViewportHandler: IEngineComponent|EngineComponent|ViewportHandler|boolean|null\r\n        * }}}\r\n     */\r\n    _data = {\r\n        render: 'auto',\r\n        // render: 'canvas2d',\r\n        isLostContext: false,\r\n        components: {\r\n            LayersHandler: true,\r\n            ViewportHandler: true\r\n        }\r\n    };\r\n\r\n    _engine;\r\n\r\n    /** @type {HTMLCanvasElement} */\r\n    _element;\r\n\r\n    /** @type {CanvasRenderingContext2D|WebGLRenderingContext} */\r\n    _context;\r\n\r\n    _shaders = {\r\n        vertex: [],\r\n        fragment: []\r\n    };\r\n\r\n    constructor() {\r\n        super();\r\n    }\r\n\r\n    get layers() {\r\n        return this.LayersHandler.layers;\r\n    }\r\n\r\n    /**\r\n     * @return {IEngineComponent|EngineComponent|LayersHandler|boolean|null}\r\n     */\r\n    get LayersHandler() {\r\n        if (typeof this._data.components.LayersHandler === 'boolean') {\r\n            return null;\r\n        } else return this._data.components.LayersHandler;\r\n    }\r\n\r\n    /**\r\n     * @param {IEngineComponent|EngineComponent|LayersHandler|boolean|null} handler\r\n     */\r\n    set LayersHandler(handler) {\r\n        if ((typeof handler === 'boolean' && handler === false) || handler === null) {\r\n            this._data.components.LayersHandler = false;\r\n            return;\r\n        } else if (typeof handler === 'object' && !handler.instanceOf(IEngineComponent)) {\r\n            throw new InvalidArgumentException('Handler not implements IEngineComponent');\r\n        }\r\n\r\n        this._data.components.LayersHandler = handler;\r\n    }\r\n\r\n    get viewport() {\r\n        return this.ViewportHandler.viewport;\r\n    }\r\n\r\n    /**\r\n     * @return {IEngineComponent|EngineComponent|ViewportHandler|boolean|null}\r\n     */\r\n    get ViewportHandler() {\r\n        if (typeof this._data.components.ViewportHandler === 'boolean') {\r\n            return null;\r\n        } else return this._data.components.ViewportHandler;\r\n    }\r\n\r\n    /**\r\n     * @param {IEngineComponent|EngineComponent|ViewportHandler|boolean|null} handler\r\n     */\r\n    set ViewportHandler(handler) {\r\n        if ((typeof handler === 'boolean' && handler === false) || handler === null) {\r\n            this._data.components.ViewportHandler = false;\r\n            return;\r\n        } else if (typeof handler === 'object' && !handler.instanceOf(IEngineComponent)) {\r\n            throw new InvalidArgumentException('Handler not implements IEngineComponent');\r\n        }\r\n\r\n        this._data.components.ViewportHandler = handler;\r\n    }\r\n\r\n    init(eventHandler, engine, options) {\r\n        super.init(eventHandler);\r\n\r\n        if (options && typeof options === 'object') this.options = options;\r\n        options = Mutable.extend(true, {}, SceneHandler.defaults, options);\r\n        if (options.components !== undefined) delete options.components;\r\n\r\n        this._engine = engine;\r\n        this._data = Mutable.extend(true, {}, this._data, options);\r\n\r\n        this.initCanvas();\r\n    }\r\n\r\n    initCanvas() {\r\n        const $ = `.j2d[guid=\"${this._engine.guid}\"]`;\r\n\r\n        /** @type {Element|HTMLCanvasElement} */\r\n        let node = document.querySelector($);\r\n        if (node !== null) {\r\n            if (node.nodeName === 'DIV') {\r\n                let nodes = document.querySelectorAll($ + ' canvas');\r\n                if (nodes.length === 0) {\r\n                    let canvas = window.document.createElement('canvas');\r\n                    node.appendChild(canvas);\r\n                    nodes = [canvas];\r\n                } else if (nodes.length > 1) {\r\n                    for (let i = 0; i < nodes.length; i++) {\r\n                        if (i !== 0) node.removeChild(nodes[i]);\r\n                    }\r\n                }\r\n                node = nodes[0];\r\n            }\r\n\r\n            if (node.nodeName === 'CANVAS') {\r\n                node.width = this._data.width;\r\n                node.height = this._data.height;\r\n                node.style.zIndex = this._data.zIndex;\r\n                node.style.position = this._data.position;\r\n\r\n                node.style.left = this._data.left;\r\n                node.style.right = this._data.right;\r\n                node.style.top = this._data.top;\r\n                node.style.bottom = this._data.bottom;\r\n\r\n                node.style.backgroundColor = this._data.backgroundColor;\r\n\r\n                try {\r\n                    // if ((this._data.render === 'auto' || this._data.render === 'webgl2')\r\n                    //     && (this._context = node.getContext('webgl2') || node.getContext('experimental-webgl2'))\r\n                    // ) {\r\n                    //     this._data.render = 'webgl2';\r\n                    // } else\r\n                    if ((this._data.render === 'auto' || this._data.render === 'webgl')\r\n                        && (this._context = node.getContext('webgl') || node.getContext('experimental-webgl'))\r\n                    ) {\r\n                        this._data.render = 'webgl';\r\n                    } else if ((this._data.render === 'auto' || this._data.render === 'canvas2d')\r\n                        && (this._context = node.getContext('2d'))\r\n                    ) {\r\n                        this._data.render = 'canvas2d';\r\n                    } else {\r\n                        //noinspection ExceptionCaughtLocallyJS\r\n                        throw new RuntimeException(`Browser does not support ${(this._data.render === 'auto')\r\n                            ? 'any' : `\"${this._data.render}\"`} render type.`);\r\n                    }\r\n                } catch (error) {\r\n                    this._engine.log(error, 'error');\r\n                    return;\r\n                }\r\n\r\n                if (!this._data.smoothing) {\r\n                    SceneHandler.disableSmoothing(this._context);\r\n                }\r\n\r\n                this._context.shadowColor = 'rgba(0, 0, 0, 0)';\r\n\r\n                if (this._data.render === 'webgl2' || this._data.render === 'webgl') {\r\n                    this.bindWebGLListeners(node);\r\n                    this.onWebGLInit();\r\n                }\r\n\r\n                this._element = node;\r\n\r\n                this._engine.log(`Find scene with GUID \"${this._engine.guid}\" [${this._data.render.toUpperCase()}]`, 'info');\r\n            }\r\n        }\r\n    }\r\n\r\n    onWebGLInit() {\r\n        let gl = this._context;\r\n\r\n        gl.viewport(0, 0, gl.canvas.width, gl.canvas.height);\r\n        //gl.enable(gl.CULL_FACE);\r\n        //gl.cullFace(gl.FRONT);\r\n        gl.enable(gl.DEPTH_TEST);\r\n        //gl.depthFunc(gl.LEQUAL);\r\n        gl.enable(gl.BLEND);\r\n        gl.blendFunc(gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA);\r\n    }\r\n\r\n    onWebGLContextLost = (e) => {\r\n        e.preventDefault();\r\n        this._data.isLostContext = true;\r\n        // cancelRequestAnimationFrame(requestId);\r\n    };\r\n\r\n    onWebGLContextRestored = (e) => {\r\n        e.preventDefault();\r\n        this.onWebGLInit();\r\n        this._data.isLostContext = false;\r\n    };\r\n\r\n    bindWebGLListeners(node) {\r\n        node.addEventListener('webglcontextlost', this.onWebGLContextLost, false);\r\n        node.addEventListener('webglcontextrestored', this.onWebGLContextRestored, false);\r\n    }\r\n\r\n    unBindWebGLListeners(node) {\r\n        node.removeEventListener('webglcontextlost', this.onWebGLContextLost, false);\r\n        node.removeEventListener('webglcontextrestored', this.onWebGLContextRestored, false);\r\n    }\r\n\r\n    destructor() {\r\n        if ((this._data.render === 'webgl2' || this._data.render === 'webgl') && this._context.isContextLost()) {\r\n            this._context.getExtension('WEBGL_lose_context').loseContext();\r\n        }\r\n    }\r\n\r\n    registerNodeShaders(nodePrototype) {\r\n        let gl = this._context;\r\n        if (this._data.render === 'webgl2' || this._data.render === 'webgl') {\r\n            if (nodePrototype.VertexShader && nodePrototype.FragmentShader) {\r\n                nodePrototype._shaderProgram = gl.createProgram();\r\n\r\n                nodePrototype._vertextShader = SceneHandler.compileShader(gl,\r\n                    gl.createShader(gl.VERTEX_SHADER),\r\n                    nodePrototype.VertexShader\r\n                );\r\n                nodePrototype._fragmentShader = SceneHandler.compileShader(gl,\r\n                    gl.createShader(gl.FRAGMENT_SHADER),\r\n                    nodePrototype.FragmentShader\r\n                );\r\n\r\n                gl.attachShader(nodePrototype._shaderProgram, nodePrototype._vertextShader);\r\n                gl.attachShader(nodePrototype._shaderProgram, nodePrototype._fragmentShader);\r\n\r\n                gl.linkProgram(nodePrototype._shaderProgram);\r\n\r\n                if (!gl.getProgramParameter(nodePrototype._shaderProgram, gl.LINK_STATUS)) {\r\n                    console.info('Could not initialise shaders');\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    static compileShader(gl, shader, source) {\r\n        gl.shaderSource(shader, source);\r\n        gl.compileShader(shader);\r\n\r\n        if (!gl.getShaderParameter(shader, gl.COMPILE_STATUS)) {\r\n            console.info(gl.getShaderInfoLog(shader));\r\n            return null;\r\n        }\r\n\r\n        return shader;\r\n    }\r\n\r\n    // +SceneMainLayer Hack\r\n\r\n    get(key) {\r\n        this.layers.get(key);\r\n    }\r\n\r\n    has(key) {\r\n        this.layers.has(key);\r\n    }\r\n\r\n    add(node, index) {\r\n        this.layers.add(node, index);\r\n    }\r\n\r\n    remove(node) {\r\n        this.layers.remove(node);\r\n    }\r\n\r\n    // -SceneMainLayer Hack\r\n\r\n    static disableSmoothing(context) {\r\n        let chrome = window.navigator.userAgent.match(/Chrom(e|ium)\\/([0-9]+)\\./);\r\n        let version = chrome ? parseInt(chrome[2], 10) : false;\r\n\r\n        if (context.hasOwnProperty('imageSmoothingEnabled')) {\r\n            context.imageSmoothingEnabled = false;\r\n        } else {\r\n            context['imageSmoothingEnabled'] = false;\r\n            context['mozImageSmoothingEnabled'] = false;\r\n            context['oImageSmoothingEnabled'] = false;\r\n            if (version && version <= 29) {\r\n                context['webkitImageSmoothingEnabled'] = false;\r\n            }\r\n            context['msImageSmoothingEnabled'] = false;\r\n        }\r\n    }\r\n\r\n    clear() {\r\n        if (this._data.render.startsWith('webgl')) {\r\n            let gl = this._context;\r\n            gl.clearColor(0.0, 0.0, 0.0, 1.0);\r\n            gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);\r\n        } else {\r\n            this._context.clearRect(0, 0, this._element.width, this._element.height);\r\n        }\r\n    }\r\n\r\n    render(data) {\r\n        if (data.components.SceneHandler._data.isLostContext) return;\r\n\r\n        this.clear();\r\n        this.layers.render(this._context, this.viewport, data || {})\r\n    }\r\n}\r\n","import EngineComponent from \"api/EngineComponent\";\r\n\r\n/**\r\n * FrameHandler\r\n * @constructor\r\n */\r\nexport default class FrameHandler extends EngineComponent {\r\n    static instance;\r\n\r\n    static _timestamp = 0;\r\n    static _frameLimit = 60;\r\n\r\n    static _breakAnimationFrame = false;\r\n\r\n    /**\r\n     * @type {Array}\r\n     * @private\r\n     */\r\n    _engineStack = [];\r\n\r\n    /**\r\n     * @private\r\n     * @type {{start: boolean, pause: boolean}}}\r\n     */\r\n    _data = {\r\n        start: false,\r\n        pause: false,\r\n\r\n        now: Date.now(),\r\n        lastTime: Date.now(),\r\n        deltaTime: 0,\r\n        interval: 1000.0 / FrameHandler._frameLimit\r\n    };\r\n\r\n    /** @private */\r\n    _loop;\r\n\r\n    constructor() {\r\n        super();\r\n    }\r\n\r\n    static set frameLimit(value) {\r\n        if (value <= 60 && value > 0) {\r\n            FrameHandler._frameLimit = value\r\n        }\r\n        return FrameHandler._frameLimit || value;\r\n    }\r\n\r\n    get isStarted() {\r\n        return this._data.start;\r\n    }\r\n\r\n    get isPaused() {\r\n        return this._data.pause;\r\n    }\r\n\r\n    loop(timestamp) {\r\n        if (this._loop === undefined) this._loop = (timestamp) => {\r\n            this.loop(timestamp);\r\n        };\r\n\r\n        if (this._engineStack.length <= 0 && this._data.start || this._data.pause) {\r\n            FrameHandler._breakAnimationFrame = true;\r\n            this._data.start = false;\r\n            return CancelAnimationFrame(this._loop);\r\n        }\r\n        this._data.start = true;\r\n\r\n        RequestAnimationFrame(this._loop);\r\n\r\n        for (let i = 0; i < this._engineStack.length; i++) {\r\n            if (!this._engineStack[i].isEnabled) continue;\r\n            let engine = this._engineStack[i];\r\n\r\n            if (!engine._data.pause) {\r\n                if (engine.io) engine.io.update();\r\n\r\n                this._data.now = Date.now();\r\n                this._data.deltaTime = (this._data.now - this._data.lastTime) / 100.0;\r\n\r\n                if ((this._data.deltaTime * 100.0) > this._data.interval) {\r\n                    this._data.lastTime = this._data.now - ((this._data.deltaTime * 100.0) % this._data.interval);\r\n\r\n                    engine._data.timestamp = timestamp;\r\n                    engine._data.deltaTime = this._data.deltaTime;\r\n\r\n                    // TODO:: temporary hack!\r\n                    if (engine.update && typeof engine.update === 'function') {\r\n                        engine.update(this._data.deltaTime, timestamp);\r\n                    }\r\n\r\n                    // TODO:: temporary hack!\r\n                    if (engine.render && typeof engine.render === 'function') {\r\n                        engine.render(this._data.deltaTime, timestamp);\r\n                    }\r\n                }\r\n\r\n                if (engine.io) engine.io.clear();\r\n            }\r\n        }\r\n    }\r\n\r\n    start(engineHandler) {\r\n        if (this._engineStack[engineHandler.guid] === undefined) {\r\n            this._engineStack[engineHandler.guid] = engineHandler;\r\n            this._engineStack.push(engineHandler);\r\n        }\r\n        if (!this._data.start) this.loop(Date.now() - FrameHandler._timestamp);\r\n        return this;\r\n    }\r\n\r\n    stop(engineHandler) {\r\n        if (this._engineStack[engineHandler.guid] !== undefined) {\r\n            delete this._engineStack[engineHandler.guid];\r\n            this._engineStack.splice(this._engineStack.indexOf(engineHandler.guid), 1);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    init(eventHandler) {\r\n        super.init(eventHandler);\r\n        return this;\r\n    }\r\n\r\n    enable() {\r\n        super.enable();\r\n        this._data.pause = false;\r\n        return this;\r\n    }\r\n\r\n    disable() {\r\n        super.disable();\r\n        this._data.pause = true;\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @singleton\r\n     * @returns {FrameHandler}\r\n     */\r\n    static init() {\r\n        return FrameHandler.instance || (FrameHandler.instance = new FrameHandler());\r\n    }\r\n}\r\n\r\nexport const RequestAnimationFrame = (() => {\r\n    return window.requestAnimationFrame ||\r\n        window.webkitRequestAnimationFrame ||\r\n        window.mozRequestAnimationFrame ||\r\n        window.oRequestAnimationFrame ||\r\n        window.msRequestAnimationFrame ||\r\n        ((callback) => {\r\n            if (!FrameHandler._breakAnimationFrame) {\r\n                if (FrameHandler._timestamp >= Number.MAX_SAFE_INTEGER - 1) FrameHandler._timestamp = 0;\r\n                if (FrameHandler._timestamp === 0) FrameHandler._timestamp = window.performance === undefined\r\n                    ? Date.now()\r\n                    : window.performance.now();\r\n\r\n                // The probability of operation of this polyfill is so small that use of .bind() won't affect working\r\n                // capacity, at the same time such approach guarantees correctness of operation of a method.\r\n                window.setTimeout(callback.bind(this, window.performance === undefined\r\n                    ? Date.now() - FrameHandler._timestamp\r\n                    : window.performance.now() - FrameHandler._timestamp\r\n                ), 1000.0 / FrameHandler._frameLimit);\r\n            } else {\r\n                FrameHandler._breakAnimationFrame = false\r\n            }\r\n        });\r\n})();\r\n\r\nexport const CancelAnimationFrame = (() => {\r\n    FrameHandler.timestamp = 0;\r\n    return window.cancelAnimationFrame ||\r\n        window.webkitCancelAnimationFrame ||\r\n        window.mozCancelAnimationFrame ||\r\n        window.oCancelAnimationFrame ||\r\n        window.msCancelAnimationFrame;\r\n})();\r\n","import InputHandlerCodes from \"io/InputHandlerCodes\";\r\nimport Keyboard from \"io/devices/Keyboard\";\r\n// import Joystick from \"io/devices/Joystick\";\r\nimport Mouse from \"io/devices/Mouse\";\r\n// import Touch from \"io/devices/Touch\";\r\nimport Device from \"api/Device\";\r\nimport EngineComponent from \"api/EngineComponent\";\r\n\r\n/**\r\n * InputHandler\r\n * @constructor\r\n * @extends EngineComponent\r\n *\r\n * @interface IEngineComponent\r\n */\r\nexport default class InputHandler extends EngineComponent {\r\n\r\n    static IO = {\r\n        KEYBOARD: 'keyboard',\r\n        // JOYSTICK: 'joystick',\r\n        MOUSE: 'mouse',\r\n        // TOUCH: 'touch'\r\n    };\r\n\r\n    defaultIO = {\r\n        KEYBOARD: Keyboard,\r\n        // JOYSTICK: Joystick,\r\n        MOUSE: Mouse,\r\n        // TOUCH: Touch\r\n    };\r\n\r\n    static KEY = InputHandlerCodes;\r\n    KEY = InputHandler.KEY;\r\n\r\n    static KEYS_HELPER = InputHandler.prototype.KEYS_HELPER = {\r\n        getKeyById: function (index) {\r\n            return InputHandler.KEY[index] || 'KEY_UNKNOWN_' + index;\r\n        },\r\n        getKeyByCode: function (keyCode) {\r\n            return InputHandler.KEY[keyCode] || 0;\r\n        }\r\n    };\r\n\r\n    constructor() {\r\n        super();\r\n\r\n        this.preventDefault = false;\r\n        this.IO = [];\r\n        this.options = {\r\n            cursor: 'none'\r\n        };\r\n\r\n        this.store = {};\r\n\r\n        this.data = {};\r\n\r\n        this.keyCodeMap = {\r\n            DEBUG_INFO: [[InputHandler.KEY.KEY_CTRL, InputHandler.KEY.KEY_F1], 'j2d.scene.debug.toggleScreen', {}],\r\n            FULLSCREEN: [[InputHandler.KEY.KEY_CTRL, InputHandler.KEY.KEY_F11], 'j2d.scene.toggleFullScreen', {}]\r\n        };\r\n    }\r\n\r\n    bindListeners() {\r\n        for (let i = 0; i < this.IO.length; i++) {\r\n            if (this.IO[i].enable() === false) return false;\r\n        }\r\n    };\r\n\r\n    unBindListeners() {\r\n        for (let i = 0; i < this.IO.length; i++) {\r\n            if (this.IO[i].disable() === false) return false;\r\n        }\r\n    };\r\n\r\n    update() {\r\n        if (!this.isEnabled) return false;\r\n        for (let i = 0; i < this.IO.length; i++) {\r\n            if (this.IO[i].update() === false) return false;\r\n        }\r\n        return true;\r\n    };\r\n\r\n    clear() {\r\n        if (!this.isEnabled) return false;\r\n        for (let i = 0; i < this.IO.length; i++) {\r\n            if (this.IO[i].clear() === false) return false;\r\n        }\r\n        return true;\r\n    };\r\n\r\n    load(newKeyCodeMap) {\r\n        let oldKeyCodeMap = JSON.stringify(this.keyCodeMap);\r\n        this.keyCodeMap = JSON.parse(newKeyCodeMap);\r\n        return oldKeyCodeMap;\r\n    };\r\n\r\n    save() {\r\n        return JSON.stringify(this.keyCodeMap);\r\n    };\r\n\r\n    flush() {\r\n    }\r\n\r\n    // TODO:: to refactoring\r\n\r\n    static _getPressData(manager, keyList) {\r\n        return {\r\n            keyList: keyList,\r\n            time: manager.store.keys.pressedTime[keyList[0]]\r\n        };\r\n    }\r\n\r\n    checkPressedKeyList(keyList) {\r\n        if (typeof keyList === 'object' && keyList instanceof Array) {\r\n            if (keyList.length !== this.data.keys.keysDown.length) {\r\n                return false;\r\n                //} else if (this.data.keys.keysDown.equals(keyList)) {\r\n                //    return getPressData(this, keyList);\r\n            }\r\n            return false;\r\n        }\r\n        if (isNaN(keyList)) return false;\r\n        if (-1 !== this.data.keys.keysDown.indexOf(keyList)) {\r\n            return InputHandler._getPressData(this, keyList);\r\n        }\r\n        return false;\r\n    }\r\n\r\n    checkPressedKeyMap(key) {\r\n        if (this.keyCodeMap[key] === undefined) return false;\r\n        return this.checkPressedKeyList(this.keyCodeMap[key][0]);\r\n    }\r\n\r\n    setKeys(mapObject) {\r\n        //this.keyMap = $.extend(true, {}, this.keyMap, mapObject);\r\n        return this;\r\n    }\r\n\r\n    init(eventHandler, io, options) {\r\n        super.init(eventHandler);\r\n        if (options && typeof options === 'object') {\r\n            this.options = options;\r\n        }\r\n        if (io && typeof io === 'object' && io instanceof Array) {\r\n            this.IO = [];\r\n            for (let i = 0; i < io.length; i++) {\r\n                let device = io[i];\r\n\r\n                if (typeof device === 'string' && InputHandler.IO[device.toUpperCase()] !== undefined) {\r\n                    device = new (this.defaultIO[device.toUpperCase()])();\r\n                    this.IO[device.toString()] = device;\r\n                    this.IO.push(device);\r\n                    if (this.IO[device.toString()].init(this) === false) {\r\n                        throw new Error('Error. Device \"' + device + '\" not initialize.');\r\n                    }\r\n                } else if (typeof device === 'object' && device instanceof Device) {\r\n                    this.IO[device.toString()] = device;\r\n                    this.IO.push(device);\r\n                    if (this.IO[device.toString()].init(this) === false) {\r\n                        throw new Error('Error. Device \"' + device + '\" not initialize.');\r\n                    }\r\n                } else {\r\n                    throw new Error('Error. Unknown IO device \"' + device.toString() + '\" is not supported yet.');\r\n                }\r\n            }\r\n        }\r\n        return this;\r\n    }\r\n\r\n    enable() {\r\n        super.enable();\r\n        this.bindListeners();\r\n        return this;\r\n    }\r\n\r\n    disable() {\r\n        super.disable();\r\n        this.unBindListeners();\r\n        return this;\r\n    }\r\n}\r\n","import EngineComponent from \"../api/EngineComponent\";\r\n\r\n/**\r\n * EventHandler\r\n * @constructor\r\n */\r\nexport default class EventHandler extends EngineComponent {\r\n    _events = [];\r\n    _onces = [];\r\n\r\n    /**\r\n     * @param {string} eventName\r\n     * @param {function} callback\r\n     */\r\n    on(eventName, callback) {\r\n        if (this._events[eventName] !== undefined) {\r\n            let stack = this._events[eventName];\r\n            if (stack.indexOf(callback) === -1) {\r\n                stack.push(callback);\r\n            }\r\n        } else {\r\n            this._events[eventName] = [];\r\n            this._events[eventName].push(callback)\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {string} eventName\r\n     * @param {function} callback\r\n     */\r\n    once(eventName, callback) {\r\n        if (this._onces[eventName] !== undefined) {\r\n            let stack = this._onces[eventName];\r\n            if (stack.indexOf(callback) === -1) {\r\n                stack.push(callback);\r\n            }\r\n        } else {\r\n            this._onces[eventName] = [];\r\n            this._onces[eventName].push(callback)\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {string} eventName\r\n     * @param {function} callback\r\n     */\r\n    off(eventName, callback) {\r\n        if (this._events[eventName] !== undefined) {\r\n            let stack = this._events[eventName];\r\n            if (stack.indexOf(callback) !== -1) {\r\n                stack.splice(stack.indexOf(callback));\r\n            }\r\n        }\r\n        if (this._onces[eventName] !== undefined) {\r\n            let stack = this._onces[eventName];\r\n            if (stack.indexOf(callback) !== -1) {\r\n                stack.splice(stack.indexOf(callback));\r\n            }\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {string} eventName\r\n     * @param {Object} [data]\r\n     */\r\n    trigger(eventName, data) {\r\n        let stack, i, result;\r\n\r\n        if (this._onces[eventName] !== undefined) {\r\n            stack = this._onces[eventName];\r\n            for (i = 0; i < stack.length; i++) {\r\n                result = stack[i].call(stack[i], data);\r\n                if (typeof result === 'boolean' && !result) break;\r\n            }\r\n            this._onces[eventName] = [];\r\n            if (typeof result === 'boolean' && !result) return this;\r\n        }\r\n\r\n        if (this._events[eventName] !== undefined) {\r\n            stack = this._events[eventName];\r\n            for (i = 0; i < stack.length; i++) {\r\n                result = stack[i].call(stack[i], data);\r\n                if (typeof result === 'boolean' && !result) break;\r\n            }\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {string} [eventName]\r\n     */\r\n    flush(eventName) {\r\n        if (eventName !== undefined) {\r\n            if (this._events[eventName] !== undefined) {\r\n                this._events[eventName] = [];\r\n            }\r\n            if (this._onces[eventName] !== undefined) {\r\n                this._onces[eventName] = [];\r\n            }\r\n        } else {\r\n            this._onces = [];\r\n            this._events = [];\r\n        }\r\n        return this;\r\n    }\r\n}\r\n","import Exception from \"exceptions/Exception\";\r\n\r\n/**\r\n * InvalidArgumentException\r\n * Create custom exception with message\r\n *\r\n * @class InvalidArgumentException\r\n * @exports module:exceptions/InvalidArgumentException\r\n *\r\n * @constructor\r\n * @extends Exception\r\n * @param {string} message\r\n * @property {string} message\r\n */\r\nexport default class InvalidArgumentException extends Exception {\r\n    constructor(message) {\r\n        super(message)\r\n    }\r\n\r\n    /**\r\n     * Convert exception to String\r\n     * @returns {string}\r\n     */\r\n    toString = function () {\r\n        return this.message;\r\n    }\r\n}\r\n","import PrototypeInterface from \"api/PrototypeInterface\";\r\n\r\n/**\r\n * IEngineComponent\r\n * @constructor\r\n */\r\nexport default class IEngineComponent extends PrototypeInterface {\r\n};\r\n","import PrototypeObject from \"api/PrototypeObject\";\r\nimport IEngine from \"api/interfaces/IEngine\";\r\nimport RuntimeException from \"exceptions/RuntimeException\";\r\n\r\n/**\r\n * Engine\r\n * @constructor\r\n */\r\nexport default class Engine extends PrototypeObject {\r\n    static interfaces = [IEngine];\r\n    static _$classPreInitialize = [];\r\n\r\n    _isEnabled = false;\r\n\r\n    constructor(id) {\r\n        super();\r\n\r\n        if (!(Engine._$classPreInitialize.indexOf(id) !== -1)) {\r\n            throw new RuntimeException(`The constructor is private. Please use static ${this.constructor.name}.init()`);\r\n        } else Engine._$classPreInitialize.splice(Engine._$classPreInitialize.indexOf(id), 1);\r\n    }\r\n\r\n    get isEnabled() {\r\n        return this._isEnabled;\r\n    }\r\n\r\n    enable() {\r\n        this._isEnabled = true;\r\n        return this;\r\n    };\r\n\r\n    disable() {\r\n        this._isEnabled = false;\r\n        return this;\r\n    };\r\n\r\n    toggle(status) {\r\n        if (status === undefined) status = !this.isEnabled;\r\n        if (status) {\r\n            this.enable();\r\n        } else {\r\n            this.disable();\r\n        }\r\n        return this;\r\n    };\r\n};\r\n\r\n","import Engine from \"api/Engine\";\r\nimport IEngineComponent from \"api/interfaces/IEngineComponent\";\r\nimport InvalidArgumentException from \"exceptions/InvalidArgumentException\";\r\nimport EventHandler from \"events/EventHandler\";\r\nimport InputHandler from \"io/InputHandler\";\r\nimport FrameHandler from \"core/FrameHandler\";\r\nimport SceneHandler from \"core/SceneHandler\";\r\nimport Device from \"utils/Device\";\r\nimport SystemConsole from \"utils/SystemConsole\";\r\nimport UUID from \"utils/UUID\";\r\nimport LayersHandler from \"layers/LayersHandler\";\r\nimport ViewportHandler from \"core/ViewportHandler\";\r\nimport Mutable from \"objects/Mutable\";\r\n\r\n/**\r\n * @class EngineJ2D\r\n * @exports module:\"j2d\"\r\n *\r\n * @param {Element|HTMLElement|HTMLInputElement} element\r\n * @param {EngineJ2D.defaults|{}} data\r\n *\r\n * @constructor\r\n */\r\nexport default class EngineJ2D extends Engine {\r\n    /** @type {string} */\r\n    static VERSION = '1.0.0-dev (VeNoM iNjecTioN)';\r\n\r\n    /** @type {boolean} */\r\n    static PluginInit = false;\r\n\r\n    /**\r\n     * Call setter to 'null/false' to disable components, or 'true' to auto load default implementation.\r\n     *\r\n     * @type {{id: string, pause: boolean, deltaTime: number, timestamp: number, components: {\r\n        * EventHandler: IEngineComponent|EngineComponent|EventHandler|boolean|null,\r\n        * FrameHandler: IEngineComponent|EngineComponent|FrameHandler|boolean|null,\r\n        * InputHandler: IEngineComponent|EngineComponent|InputHandler|boolean|null,\r\n        * MediaHandler: IEngineComponent|EngineComponent|boolean|null,\r\n        * TweenHandler: IEngineComponent|EngineComponent|boolean|null,\r\n        * SceneHandler: IEngineComponent|EngineComponent|SceneHandler|boolean|null\r\n        * }}}\r\n     */\r\n    static defaults = {\r\n        id: '',\r\n        pause: false,\r\n        deltaTime: 0,\r\n        timestamp: 0,\r\n        components: {\r\n            EventHandler: true,\r\n            FrameHandler: true,\r\n            InputHandler: false,\r\n            MediaHandler: false,\r\n            TweenHandler: false,\r\n            SceneHandler: true\r\n        }\r\n    };\r\n\r\n    /** @type {Array.<EngineJ2D>|string} */\r\n    static stack = [];\r\n\r\n    /** @type jQuery|function */\r\n    static _jQuery;\r\n\r\n    /** @type boolean */\r\n    _initialized = false;\r\n\r\n    /** @type {Element|HTMLElement|HTMLInputElement} */\r\n    _element = null;\r\n\r\n    /** @type {EngineJ2D.defaults|{}} */\r\n    _data = {};\r\n\r\n    /** @type {function} */ // TODO:: temporary hack!\r\n    update = (deltaTime, timestamp) => {\r\n        // console.info(timestamp);\r\n    };\r\n\r\n    /** @type {function} */ // TODO:: temporary hack!\r\n    render = (deltaTime, timestamp) => {\r\n        if (this._data.components.SceneHandler) {\r\n            this._data.components.SceneHandler.render(this._data);\r\n        }\r\n    };\r\n\r\n    /** @type {Device} */\r\n    device = new Device();\r\n\r\n    /** @type {SystemConsole} */\r\n    logger = new SystemConsole();\r\n\r\n    constructor(element, data) {\r\n        super(data !== undefined ? data.id : null);\r\n\r\n        this._element = element;\r\n        this._data = data;\r\n    }\r\n\r\n    get guid() {\r\n        return this._data.id;\r\n    }\r\n\r\n    /* +Handlers */\r\n\r\n    get events() {\r\n        return this.EventHandler;\r\n    }\r\n\r\n    /**\r\n     * @return {IEngineComponent|EngineComponent|EventHandler|boolean|null}\r\n     */\r\n    get EventHandler() {\r\n        if (typeof this._data.components.EventHandler === 'boolean') {\r\n            return null;\r\n        } else return this._data.components.EventHandler;\r\n    }\r\n\r\n    /**\r\n     * @param {IEngineComponent|EngineComponent|EventHandler|boolean|null} handler\r\n     */\r\n    set EventHandler(handler) {\r\n        if ((typeof handler === 'boolean' && handler === false) || handler === null) {\r\n            this._data.components.EventHandler = false;\r\n            return;\r\n        } else if (typeof handler === 'object' && !handler.instanceOf(IEngineComponent)) {\r\n            throw new InvalidArgumentException('Handler not implements IEngineComponent');\r\n        }\r\n\r\n        this._data.components.EventHandler = handler;\r\n    }\r\n\r\n    get frame() {\r\n        return this.FrameHandler;\r\n    }\r\n\r\n    /**\r\n     * @return {IEngineComponent|EngineComponent|FrameHandler|boolean|null}\r\n     */\r\n    get FrameHandler() {\r\n        if (typeof this._data.components.FrameHandler === 'boolean') {\r\n            return null;\r\n        } else return this._data.components.FrameHandler;\r\n    }\r\n\r\n    /**\r\n     * @param {IEngineComponent|EngineComponent|FrameHandler|boolean|null} handler\r\n     */\r\n    set FrameHandler(handler) {\r\n        if ((typeof handler === 'boolean' && handler === false) || handler === null) {\r\n            this._data.components.FrameHandler = false;\r\n            return;\r\n        } else if (typeof handler === 'object' && !handler.instanceOf(IEngineComponent)) {\r\n            throw new InvalidArgumentException('Handler not implements IEngineComponent');\r\n        }\r\n\r\n        this._data.components.FrameHandler = handler;\r\n    }\r\n\r\n    get io() {\r\n        return this.InputHandler;\r\n    }\r\n\r\n    /**\r\n     * @return {IEngineComponent|EngineComponent|InputHandler|boolean|null}\r\n     */\r\n    get InputHandler() {\r\n        if (typeof this._data.components.InputHandler === 'boolean') {\r\n            return null;\r\n        } else return this._data.components.InputHandler;\r\n    }\r\n\r\n    /**\r\n     * @param {IEngineComponent|EngineComponent|InputHandler|boolean|null} handler\r\n     */\r\n    set InputHandler(handler) {\r\n        if ((typeof handler === 'boolean' && handler === false) || handler === null) {\r\n            this._data.components.InputHandler = false;\r\n            return;\r\n        } else if (typeof handler === 'object' && !handler.instanceOf(IEngineComponent)) {\r\n            throw new InvalidArgumentException('Handler not implements IEngineComponent');\r\n        }\r\n\r\n        this._data.components.InputHandler = handler;\r\n    }\r\n\r\n    get media() {\r\n        return this.MediaHandler;\r\n    }\r\n\r\n    /**\r\n     * @return {IEngineComponent|EngineComponent|MediaHandler|boolean|null}\r\n     */\r\n    get MediaHandler() {\r\n        if (typeof this._data.components.MediaHandler === 'boolean') {\r\n            return null;\r\n        } else return this._data.components.MediaHandler;\r\n    }\r\n\r\n    /**\r\n     * @param {IEngineComponent|EngineComponent|MediaHandler|boolean|null} handler\r\n     */\r\n    set MediaHandler(handler) {\r\n        if ((typeof handler === 'boolean' && handler === false) || handler === null) {\r\n            this._data.components.MediaHandler = false;\r\n            return;\r\n        } else if (typeof handler === 'object' && !handler.instanceOf(IEngineComponent)) {\r\n            throw new InvalidArgumentException('Handler not implements IEngineComponent');\r\n        }\r\n\r\n        this._data.components.MediaHandler = handler;\r\n    }\r\n\r\n    get tweens() {\r\n        return this.TweenHandler;\r\n    }\r\n\r\n    /**\r\n     * @return {IEngineComponent|EngineComponent|TweenHandler|boolean|null}\r\n     */\r\n    get TweenHandler() {\r\n        if (typeof this._data.components.TweenHandler === 'boolean') {\r\n            return null;\r\n        } else return this._data.components.TweenHandler;\r\n    }\r\n\r\n    /**\r\n     * @param {IEngineComponent|EngineComponent|TweenHandler|boolean|null} handler\r\n     */\r\n    set TweenHandler(handler) {\r\n        if ((typeof handler === 'boolean' && handler === false) || handler === null) {\r\n            this._data.components.TweenHandler = false;\r\n            return;\r\n        } else if (typeof handler === 'object' && !handler.instanceOf(IEngineComponent)) {\r\n            throw new InvalidArgumentException('Handler not implements IEngineComponent');\r\n        }\r\n\r\n        this._data.components.TweenHandler = handler;\r\n    }\r\n\r\n    get scene() {\r\n        return this.SceneHandler;\r\n    }\r\n\r\n    /**\r\n     * @return {IEngineComponent|EngineComponent|SceneHandler|boolean|null}\r\n     */\r\n    get SceneHandler() {\r\n        if (typeof this._data.components.SceneHandler === 'boolean') {\r\n            return null;\r\n        } else return this._data.components.SceneHandler;\r\n    }\r\n\r\n    /**\r\n     * @param {IEngineComponent|EngineComponent|SceneHandler|boolean|null} handler\r\n     */\r\n    set SceneHandler(handler) {\r\n        if ((typeof handler === 'boolean' && handler === false) || handler === null) {\r\n            this._data.components.SceneHandler = false;\r\n            return;\r\n        } else if (typeof handler === 'object' && !handler.instanceOf(IEngineComponent)) {\r\n            throw new InvalidArgumentException('Handler not implements IEngineComponent');\r\n        }\r\n\r\n        this._data.components.SceneHandler = handler;\r\n    }\r\n\r\n    /* -Handlers */\r\n\r\n    /* +GameEngine */\r\n    start() {\r\n        if (!this._initialized) this.tryLoadComponents();\r\n        this.enable();\r\n\r\n        this.frame.start(this);\r\n        this.events.trigger('start');\r\n    };\r\n\r\n    stop() {\r\n        if (!this._initialized) this.tryLoadComponents();\r\n        this.disable();\r\n\r\n        this.frame.stop(this);\r\n        this.events.trigger('stop');\r\n    };\r\n\r\n    pause() {\r\n        if (!this._initialized) this.tryLoadComponents();\r\n\r\n        if (this.io) this.io.flush();\r\n        if (this.media) this.media.pause();\r\n        this._data.pause = true;\r\n        this._element.classList.add('pause');\r\n        this.events.trigger('pause');\r\n    };\r\n\r\n    resume() {\r\n        if (!this._initialized) this.tryLoadComponents();\r\n\r\n        this._element.classList.remove('pause');\r\n        this._element.focus();\r\n        this._data.pause = false;\r\n        if (this.io) this.io.flush();\r\n        if (this.media) this.media.resume();\r\n        this.events.trigger('resume');\r\n    };\r\n\r\n    /* -GameEngine **/\r\n\r\n    /* +System **/\r\n\r\n    log(message, level) {\r\n        this.logger.log(message, level);\r\n    };\r\n\r\n    tryLoadComponents() {\r\n        if (this._initialized) return;\r\n\r\n        let COMPONENT = this._data.components;\r\n\r\n        // EventHandler\r\n        if (typeof COMPONENT.EventHandler === 'boolean' && COMPONENT.EventHandler === true) {\r\n            COMPONENT.EventHandler = new EventHandler();\r\n        }\r\n\r\n        if (typeof COMPONENT.EventHandler === 'object' && COMPONENT.EventHandler instanceof IEngineComponent) {\r\n            COMPONENT.EventHandler.enable();\r\n        }\r\n\r\n\r\n        // InputHandler\r\n        if (typeof COMPONENT.InputHandler === 'boolean' && COMPONENT.InputHandler === true) {\r\n            COMPONENT.InputHandler = new InputHandler();\r\n            COMPONENT.InputHandler.init(COMPONENT.EventHandler, [\r\n                InputHandler.IO.KEYBOARD,\r\n                InputHandler.IO.MOUSE\r\n            ], {\r\n                cursor: 'default'\r\n            });\r\n        }\r\n\r\n        if (typeof COMPONENT.InputHandler === 'object' && COMPONENT.InputHandler instanceof IEngineComponent) {\r\n            COMPONENT.InputHandler.enable();\r\n        }\r\n\r\n        // SceneHandler\r\n        if (typeof COMPONENT.SceneHandler === 'boolean' && COMPONENT.SceneHandler === true) {\r\n            COMPONENT.SceneHandler = new SceneHandler();\r\n            COMPONENT.SceneHandler.init(COMPONENT.EventHandler, this, {\r\n                width: 640,\r\n                height: 360,\r\n                backgroundColor: 'black'\r\n            });\r\n\r\n            COMPONENT.SceneHandler.LayersHandler = new LayersHandler();\r\n            COMPONENT.SceneHandler.LayersHandler.init(COMPONENT.EventHandler);\r\n\r\n            COMPONENT.SceneHandler.ViewportHandler = new ViewportHandler();\r\n            COMPONENT.SceneHandler.ViewportHandler.init(COMPONENT.EventHandler);\r\n        }\r\n\r\n        if (typeof COMPONENT.SceneHandler.LayersHandler === 'object'\r\n            && COMPONENT.SceneHandler.LayersHandler instanceof IEngineComponent\r\n        ) {\r\n            COMPONENT.SceneHandler.LayersHandler.enable();\r\n        }\r\n\r\n        if (typeof COMPONENT.SceneHandler.ViewportHandler === 'object'\r\n            && COMPONENT.SceneHandler.ViewportHandler instanceof IEngineComponent\r\n        ) {\r\n            COMPONENT.SceneHandler.ViewportHandler.enable();\r\n        }\r\n\r\n        if (typeof COMPONENT.EventHandler === 'object' && COMPONENT.EventHandler instanceof IEngineComponent) {\r\n            COMPONENT.SceneHandler.enable();\r\n        }\r\n\r\n        // FrameHandler\r\n        if (typeof COMPONENT.FrameHandler === 'boolean' && COMPONENT.FrameHandler === true) {\r\n            COMPONENT.FrameHandler = FrameHandler.init();\r\n            COMPONENT.FrameHandler.init(COMPONENT.EventHandler);\r\n        }\r\n\r\n        if (typeof COMPONENT.FrameHandler === 'object' && COMPONENT.FrameHandler instanceof IEngineComponent) {\r\n            COMPONENT.FrameHandler.enable();\r\n        }\r\n\r\n        this._initialized = true;\r\n    }\r\n\r\n    /* -System **/\r\n\r\n    /**\r\n     * @name EngineJ2D\r\n     * @static\r\n     *\r\n     * @param {string|jQuery} selected\r\n     * @param {EngineJ2D.defaults|Object} [options]\r\n     *\r\n     * @returns {EngineJ2D|EngineJ2D[]|Array.<EngineJ2D>}\r\n     */\r\n    static init(selected, options) {\r\n        if (selected === undefined) selected = '.j2d';\r\n        if (options === undefined) options = {};\r\n\r\n        options = Mutable.extend(true, {}, EngineJ2D.defaults, options);\r\n\r\n        let nodes = [];\r\n        if (typeof selected === 'string') {\r\n            nodes = window.document.querySelectorAll(selected);\r\n        } else if (typeof selected === 'object' && window.jQuery !== undefined && selected instanceof window.jQuery) {\r\n            nodes = selected.get();\r\n        } else return null;\r\n\r\n        let inactiveNodes = [];\r\n\r\n        for (let i = 0; i < nodes.length; i++) {\r\n            if (!nodes[i].hasAttribute('guid')) inactiveNodes.push(nodes[i])\r\n        }\r\n\r\n        for (let i = 0; i < inactiveNodes.length; i++) {\r\n            options.id = UUID.generate();\r\n\r\n            inactiveNodes[i].setAttribute('guid', options.id);\r\n\r\n            let id = inactiveNodes[i].getAttribute('id');\r\n            if (id === undefined || id === null) {\r\n                inactiveNodes[i].setAttribute('guid', options.id);\r\n            }\r\n\r\n            let tabIndex = inactiveNodes[i].getAttribute('tabindex');\r\n            if (tabIndex === undefined || tabIndex === null || tabIndex === false) {\r\n                inactiveNodes[i].setAttribute('tabindex', '-1');\r\n            }\r\n\r\n            if (!inactiveNodes[i].classList.contains('j2d')) {\r\n                inactiveNodes[i].classList.add('j2d');\r\n            }\r\n\r\n            Engine._$classPreInitialize.push(options.id);\r\n            EngineJ2D.stack[options.id] = new EngineJ2D(inactiveNodes[i], options);\r\n            EngineJ2D.stack.push(options.id);\r\n\r\n            inactiveNodes[i].click();\r\n            inactiveNodes[i].focus();\r\n        }\r\n\r\n        let resumeBind = (current) => {\r\n            let nodes, engine;\r\n            nodes = window.document.querySelectorAll('div.canvas[guid]:not(.pause-disable):not(:focus)');\r\n            for (let i = 0; i < nodes.length; i++) {\r\n                if (current !== nodes[i]) {\r\n                    nodes[i].classList.remove('active');\r\n                    engine = EngineJ2D.stack[nodes[i].getAttribute('guid')] || null;\r\n                    if (engine) engine.pause();\r\n                }\r\n            }\r\n\r\n            nodes = window.document.querySelectorAll('div.canvas[guid].active.pause-disable:not(:focus)');\r\n            for (let i = 0; i < nodes.length; i++) {\r\n                if (current !== nodes[i]) {\r\n                    nodes[i].classList.remove('active');\r\n                }\r\n            }\r\n        };\r\n\r\n        function resumeEventListener() {\r\n            let engine;\r\n            if (this.classList.contains('pause')) {\r\n                engine = EngineJ2D.stack[this.getAttribute('guid')] || null;\r\n                if (engine) engine.resume();\r\n                resumeBind(this);\r\n            } else if (!this.classList.contains('resume-by-click') && this.classList.contains(':focus')) {\r\n                this.classList.add('active');\r\n                this.focus();\r\n                engine = EngineJ2D.stack[this.getAttribute('guid')] || null;\r\n                if (engine) engine.resume();\r\n                resumeBind(this);\r\n            }\r\n            return true;\r\n        }\r\n\r\n        let activeNodes = [];\r\n        nodes = window.document.querySelectorAll('.j2d[guid]');\r\n        for (let i = 0; i < nodes.length; i++) {\r\n            activeNodes.push(EngineJ2D.stack[nodes[i].getAttribute('guid')] || null);\r\n            nodes[i].addEventListener('click', resumeEventListener);\r\n            nodes[i].addEventListener('touch', resumeEventListener);\r\n            nodes[i].addEventListener('mouseenter', resumeEventListener);\r\n        }\r\n        return (1 === activeNodes.length) ? activeNodes[0] : activeNodes;\r\n    }\r\n\r\n    static ready(callback) {\r\n        if (EngineJ2D.PluginInit) {\r\n            if (EngineJ2D._jQuery) {\r\n                EngineJ2D._jQuery(document).ready(callback);\r\n            } else callback();\r\n        } else {\r\n            if (EngineJ2D._jQuery) {\r\n                EngineJ2D._jQuery(document).on('j2d-ready', () => {\r\n                    EngineJ2D._jQuery(document).ready(callback);\r\n                });\r\n            } else window.document.addEventListener('j2d-ready', callback);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @param {jQuery} jQuery\r\n     * @return {jQuery}\r\n     */\r\n    static jQuery(jQuery) {\r\n        EngineJ2D._jQuery = jQuery !== undefined ? jQuery : window.jQuery;\r\n\r\n        (function ($) {\r\n            //noinspection JSUnresolvedVariable\r\n            /**\r\n             * @param {EngineJ2D.defaults} [options]\r\n             * @returns {EngineJ2D|Array.<EngineJ2D>}\r\n             */\r\n            $.fn.j2d = function (options) {\r\n                /** @type {jQuery|EngineJ2D._jQuery} */\r\n                let instance = this;\r\n                return EngineJ2D.init(instance, options);\r\n            };\r\n        })(EngineJ2D._jQuery);\r\n\r\n        return EngineJ2D._jQuery;\r\n    }\r\n\r\n    /**\r\n     * @return {boolean}\r\n     */\r\n    static CompatibilityCheck() {\r\n        let check = false;\r\n\r\n        // Disable IE < 11\r\n        if (Device.browser === 'MSIE' && Device.version < 11) {\r\n            let message = 'j2D Error: Please install normal modern browser, IE 11 supported.';\r\n            alert(message);\r\n            console.error(message);\r\n\r\n            check = true;\r\n        }\r\n\r\n        // Fix IE 11\r\n        if (Device.browser === 'IE' && Device.version >= 11) {\r\n            (() => {\r\n                let CustomEvent = (event, params) => {\r\n                    params = params || {bubbles: false, cancelable: false, detail: undefined};\r\n                    /** @type {Event|CustomEvent}*/\r\n                    let customEvent = document.createEvent('CustomEvent');\r\n                    customEvent.initCustomEvent(event, params.bubbles, params.cancelable, params.detail);\r\n                    customEvent.preventDefault = function () {\r\n                        Object.defineProperty(this, 'defaultPrevented', {\r\n                            get: () => {\r\n                                return true;\r\n                            }\r\n                        });\r\n                    };\r\n                    customEvent.preventDefault();\r\n                    return customEvent;\r\n                };\r\n                CustomEvent.prototype = window.Event.prototype;\r\n                window.CustomEvent = CustomEvent;\r\n            })();\r\n        }\r\n\r\n        return check;\r\n    }\r\n}\r\n\r\n/* ------------------------------ Plugin ------------------------------ */\r\n(EngineJ2D.initPlugin = () => {\r\n    if (EngineJ2D.PluginInit || EngineJ2D.CompatibilityCheck()) return true;\r\n\r\n    (new SystemConsole()).logSystem(\r\n        `j2D v.${EngineJ2D.VERSION} | Browser ${Device.browser} v.${Device.version}`, 'https://github.com/fsggs/j2d'\r\n    );\r\n\r\n    let isFullScreen = () => {\r\n        //noinspection JSUnresolvedVariable\r\n        return !!(window.document.webkitFullscreenElement\r\n            || window.document.webkitCurrentFullScreenElement\r\n            || (Device.browser === 'Firefox' && Device.version < 47\r\n                ? window.document.mozFullScreenElement\r\n                : window.document.fullscreenElement)\r\n            || window.document.msFullscreenElement\r\n        );\r\n    };\r\n\r\n    function fullScreenEventListener() {\r\n        let fullScreen = isFullScreen();\r\n        if (!fullScreen) {\r\n            let node, engine;\r\n            node = window.document.querySelector('.j2d[guid].active');\r\n            if (node) engine = EngineJ2D.stack[node.getAttribute('guid')] || null;\r\n            if (engine) engine.scene.resizeToFullPage(fullScreen);\r\n\r\n            node = window.document.querySelector('.j2d[guid]:not(.active)');\r\n            if (node) engine = EngineJ2D.stack[node.getAttribute('guid')] || null;\r\n            if (engine) engine.toggle(!fullScreen);\r\n        }\r\n    }\r\n\r\n    let html = window.document.querySelector('html');\r\n\r\n    if (!html.classList.contains('j2d-engine')) {\r\n        window.document.addEventListener('fullscreenchange', fullScreenEventListener);\r\n        window.document.addEventListener('webkitfullscreenchange', fullScreenEventListener);\r\n        window.document.addEventListener('mozfullscreenchange', fullScreenEventListener);\r\n        window.document.addEventListener('MSFullscreenChange', fullScreenEventListener);\r\n\r\n        window.addEventListener('focus', () => {\r\n            let node, engine;\r\n            node = window.document.querySelector('.j2d[guid].active:not(.resume-by-click)');\r\n            if (node) engine = EngineJ2D.stack[node.getAttribute('guid')] || null;\r\n            if (engine) engine.resume();\r\n        });\r\n\r\n        window.addEventListener('blur', () => {\r\n            let nodes, engine;\r\n            nodes = window.document.querySelectorAll('.j2d[guid]:not(.pause-disable)');\r\n            for (let i = 0; i < nodes.length; i++) {\r\n                if (nodes[i]) engine = EngineJ2D.stack[nodes[i].getAttribute('guid')] || null;\r\n                if (engine) engine.pause();\r\n            }\r\n        });\r\n\r\n        window.addEventListener('resize', () => {\r\n            for (let i = 0; i < EngineJ2D.stack.length; i++) {\r\n                EngineJ2D.stack[EngineJ2D.stack[i]].device.onResize();\r\n            }\r\n\r\n            let fullScreen = isFullScreen();\r\n            if (fullScreen) {\r\n                let node, engine;\r\n                node = window.document.querySelector('.j2d[guid].active');\r\n                if (node) engine = EngineJ2D.stack[node.getAttribute('guid')] || null;\r\n                if (engine) engine.scene.resizeToFullPage(fullScreen);\r\n            }\r\n            return true;\r\n        });\r\n        html.classList.add('j2d-engine');\r\n    }\r\n\r\n    window.document.dispatchEvent((new CustomEvent('j2d-ready')));\r\n\r\n    return EngineJ2D.PluginInit = true;\r\n})();\r\n"]}