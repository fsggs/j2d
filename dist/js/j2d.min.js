/**
 * j2D (JavaScript 2D Engine)
 *
 * @authors DeVinterX
 * @license BSD
 * @version 1.0.3-dev
 */
!function(e,t){if("function"==typeof define&&define.amd)define("transitions/utils/Interpolation",["module","exports"],t);else if("undefined"!=typeof exports)t(module,exports);else{var n={exports:{}};t(n,n.exports),e.j2d=e.j2d||{},e.j2d.transitions=e.j2d.transitions||{},e.j2d.transitions.utils=e.j2d.transitions.utils||{},e.j2d.transitions.utils.Interpolation=n.exports}}(this,function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=void 0,i={Linear:function(e,t){var n=e.length-1,o=n*t,r=Math.floor(o),a=i.Utils.Linear;return t<0?a(e[0],e[1],o):t>1?a(e[n],e[n-1],n-o):a(e[r],e[r+1>n?n:r+1],o-r)},Bezier:function(e,t){for(var n=0,o=e.length-1,r=Math.pow,a=i.Utils.Bernstein,u=0;u<=o;u++)n+=r(1-t,o-u)*r(t,u)*e[u]*a(o,u);return n},CatmullRom:function(e,t){var n=e.length-1,o=n*t,r=Math.floor(o),a=i.Utils.CatmullRom;return e[0]===e[n]?(t<0&&(r=Math.floor(o=n*(1+t))),a(e[(r-1+n)%n],e[r],e[(r+1)%n],e[(r+2)%n],o-r)):t<0?e[0]-(a(e[0],e[0],e[1],e[1],-o)-e[0]):t>1?e[n]-(a(e[n],e[n],e[n-1],e[n-1],o-n)-e[n]):a(e[r?r-1:0],e[r],e[n<r+1?n:r+1],e[n<r+2?n:r+2],o-r)},Utils:{Linear:function(e,t,n){return(t-e)*n+e},Bernstein:function(e,t){var n=i.Utils.Factorial;return n(e)/n(t)/n(e-t)},Factorial:function(){var e=[1];return function(t){var n=1;if(e[t])return e[t];for(var i=t;i>1;i--)n*=i;return e[t]=n,n}}(),CatmullRom:function(e,t,n,i,o){var r=.5*(n-e),a=.5*(i-t),u=o*o,s=o*u;return(2*t-2*n+r+a)*s+(-3*t+3*n-2*r-a)*u+r*o+t}},get:function(e){if(void 0!==n[e])return n[e]},register:function(e,t){n[e]=t}};n={linear:i.Linear,bezier:i.Bezier,"catmull-rom":i.CatmullRom},t.default=i,e.exports=t.default}),function(e,t){if("function"==typeof define&&define.amd)define("transitions/utils/Easing",["module","exports","transitions/Tween"],t);else if("undefined"!=typeof exports)t(module,exports,require("transitions/Tween"));else{var n={exports:{}};t(n,n.exports,e.j2d.transitions.Tween),e.j2d=e.j2d||{},e.j2d.transitions=e.j2d.transitions||{},e.j2d.transitions.utils=e.j2d.transitions.utils||{},e.j2d.transitions.utils.Easing=n.exports}}(this,function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=i(n),r=void 0,a={Linear:{None:function(e){return e}},Quadratic:{In:function(e){return e*e},Out:function(e){return e*(2-e)},InOut:function(e){return(e*=2)<1?.5*e*e:-.5*(--e*(e-2)-1)}},Cubic:{In:function(e){return e*e*e},Out:function(e){return--e*e*e+1},InOut:function(e){return(e*=2)<1?.5*e*e*e:.5*((e-=2)*e*e+2)}},Quartic:{In:function(e){return e*e*e*e},Out:function(e){return 1- --e*e*e*e},InOut:function(e){return(e*=2)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2)}},Quintic:{In:function(e){return e*e*e*e*e},Out:function(e){return--e*e*e*e*e+1},InOut:function(e){return(e*=2)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2)}},Sinusoidal:{In:function(e){return 1-Math.cos(e*Math.PI/2)},Out:function(e){return Math.sin(e*Math.PI/2)},InOut:function(e){return.5*(1-Math.cos(Math.PI*e))}},Exponential:{In:function(e){return 0===e?0:Math.pow(1024,e-1)},Out:function(e){return 1===e?1:1-Math.pow(2,-10*e)},InOut:function(e){return 0===e?0:1===e?1:(e*=2)<1?.5*Math.pow(1024,e-1):.5*(-Math.pow(2,-10*(e-1))+2)}},Circular:{In:function(e){return 1-Math.sqrt(1-e*e)},Out:function(e){return Math.sqrt(1- --e*e)},InOut:function(e){return(e*=2)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1)}},Elastic:{In:function(e){var t,n=.1,i=.4;return 0===e?0:1===e?1:(!n||n<1?(n=1,t=i/4):t=i*Math.asin(1/n)/(2*Math.PI),-(n*Math.pow(2,10*(e-=1))*Math.sin((e-t)*(2*Math.PI)/i)))},Out:function(e){var t,n=.1,i=.4;return 0===e?0:1===e?1:(!n||n<1?(n=1,t=i/4):t=i*Math.asin(1/n)/(2*Math.PI),n*Math.pow(2,-10*e)*Math.sin((e-t)*(2*Math.PI)/i)+1)},InOut:function(e){var t,n=.1,i=.4;return 0===e?0:1===e?1:(!n||n<1?(n=1,t=i/4):t=i*Math.asin(1/n)/(2*Math.PI),(e*=2)<1?-.5*(n*Math.pow(2,10*(e-=1))*Math.sin((e-t)*(2*Math.PI)/i)):n*Math.pow(2,-10*(e-=1))*Math.sin((e-t)*(2*Math.PI)/i)*.5+1)}},Back:{In:function(e){var t=1.70158;return e*e*((t+1)*e-t)},Out:function(e){var t=1.70158;return--e*e*((t+1)*e+t)+1},InOut:function(e){var t=2.5949095;return(e*=2)<1?.5*(e*e*((t+1)*e-t)):.5*((e-=2)*e*((t+1)*e+t)+2)}},Bounce:{In:function(e){return 1-o.default.Easing.Bounce.Out(1-e)},Out:function(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},InOut:function(e){return e<.5?.5*o.default.Easing.Bounce.In(2*e):.5*o.default.Easing.Bounce.Out(2*e-1)+.5}},get:function(e){if(void 0!==r[e])return r[e]},register:function(e,t){r[e]=t}};r={linear:a.Linear.None,"quadratic-in":a.Quadratic.In,"quadratic-out":a.Quadratic.Out,"quadratic-in-out":a.Quadratic.InOut,"cubic-in":a.Cubic.In,"cubic-out":a.Cubic.Out,"cubic-in-out":a.Cubic.InOut,"quartic-in":a.Quartic.In,"quartic-out":a.Quartic.Out,"quartic-in-out":a.Quartic.InOut,"quintic-in":a.Quintic.In,"quintic-out":a.Quintic.Out,"quintic-in-out":a.Quintic.InOut,"sinusoidal-in":a.Sinusoidal.In,"sinusoidal-out":a.Sinusoidal.Out,"sinusoidal-in-out":a.Sinusoidal.InOut,"exponential-in":a.Exponential.In,"exponential-out":a.Exponential.Out,"exponential-in-out":a.Exponential.InOut,"circular-in":a.Circular.In,"circular-out":a.Circular.Out,"circular-in-out":a.Circular.InOut,"elastic-in":a.Elastic.In,"elastic-out":a.Elastic.Out,"elastic-in-out":a.Elastic.InOut,"back-in":a.Back.In,"back-out":a.Back.Out,"back-in-out":a.Back.InOut,"bounce-in":a.Bounce.In,"bounce-out":a.Bounce.Out,"bounce-in-out":a.Bounce.InOut},t.default=a,e.exports=t.default}),function(e,t){if("function"==typeof define&&define.amd)define("api/interfaces/IInputHandler",["module","exports","api/PrototypeInterface"],t);else if("undefined"!=typeof exports)t(module,exports,require("api/PrototypeInterface"));else{var n={exports:{}};t(n,n.exports,e.j2d.api.PrototypeInterface),e.j2d=e.j2d||{},e.j2d.api=e.j2d.api||{},e.j2d.api.interfaces=e.j2d.api.interfaces||{},e.j2d.api.interfaces.IInputHandler=n.exports}}(this,function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=i(n),s=function(e){function t(){return o(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),t}(u.default);t.default=s,e.exports=t.default}),function(e,t){if("function"==typeof define&&define.amd)define("api/interfaces/IHandler",["module","exports","api/PrototypeInterface"],t);else if("undefined"!=typeof exports)t(module,exports,require("api/PrototypeInterface"));else{var n={exports:{}};t(n,n.exports,e.j2d.api.PrototypeInterface),e.j2d=e.j2d||{},e.j2d.api=e.j2d.api||{},e.j2d.api.interfaces=e.j2d.api.interfaces||{},e.j2d.api.interfaces.IHandler=n.exports}}(this,function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=i(n),s=function(e){function t(){return o(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),t}(u.default);t.default=s,e.exports=t.default}),function(e,t){if("function"==typeof define&&define.amd)define("api/interfaces/IEngine",["module","exports","api/PrototypeInterface"],t);else if("undefined"!=typeof exports)t(module,exports,require("api/PrototypeInterface"));else{var n={exports:{}};t(n,n.exports,e.j2d.api.PrototypeInterface),e.j2d=e.j2d||{},e.j2d.api=e.j2d.api||{},e.j2d.api.interfaces=e.j2d.api.interfaces||{},e.j2d.api.interfaces.IEngine=n.exports}}(this,function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=i(n),s=function(e){function t(){return o(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),t}(u.default);t.default=s,e.exports=t.default}),function(e,t){if("function"==typeof define&&define.amd)define("io/devices/Touch",["module","exports","io/devices/Pointer"],t);else if("undefined"!=typeof exports)t(module,exports,require("io/devices/Pointer"));else{var n={exports:{}};t(n,n.exports,e.j2d.io.devices.Pointer),e.j2d=e.j2d||{},e.j2d.io=e.j2d.io||{},e.j2d.io.devices=e.j2d.io.devices||{},e.j2d.io.devices.Touch=n.exports}}(this,function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=i(n),s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),l=function(e){function t(e){return o(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return a(t,e),s(t,[{key:"init",value:function(e){return void 0!==e&&void 0===this.input&&(this.input=e),!0}},{key:"update",value:function(){return!0}},{key:"clear",value:function(){return!0}},{key:"enable",value:function(){throw new Error('Error. IO interface "'+t.IO+'" exist, but not supported yet.')}},{key:"disable",value:function(){throw new Error('Error. IO interface "'+t.IO+'" exist, but not supported yet.')}}]),t}(u.default);Object.defineProperty(l,"DeviceName",{enumerable:!0,writable:!0,value:u.default.prototype.constructor.name}),t.default=l,e.exports=t.default}),function(e,t){if("function"==typeof define&&define.amd)define("io/devices/Pointer",["module","exports","api/Device"],t);else if("undefined"!=typeof exports)t(module,exports,require("api/Device"));else{var n={exports:{}};t(n,n.exports,e.j2d.api.Device),e.j2d=e.j2d||{},e.j2d.io=e.j2d.io||{},e.j2d.io.devices=e.j2d.io.devices||{},e.j2d.io.devices.Pointer=n.exports}}(this,function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=i(n),s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),l=function(e){function t(e){o(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));if("Pointer"===n.constructor.name)throw new Error("Error. Pointer is abstract class.");return n}return a(t,e),s(t,[{key:"setPointerImage",value:function(e){if(e)switch(e){case"none":case"default":case"auto":case"crosshair":case"e-resize":case"help":case"move":case"n-resize":case"ne-resize":case"nw-resize":case"pointer":case"progress":case"s-resize":case"se-resize":case"sw-resize":case"text":case"w-resize":case"wait":case"inherit":break;default:e='url("'+e+'"), auto'}return this.input.data.pointer.image=this.input.store.pointer.image=this.input.options.cursor=e,window.document.body.style.cursor=this.input.data.pointer.image,this}},{key:"toggleCursor",value:function(e){return"none"===this.input.data.image||void 0!==e&&e!==!1?window.document.body.style.cursor=this.input.store.pointer.image:(this.input.store.pointer.image=window.document.body.style.cursor,window.document.body.style.cursor="none"),this}},{key:"isPointerVisible",value:function(){return"none"===this.input.data.pointer.image}},{key:"getPointerPosition",value:function(){return void 0===this.data.pointer?[0,0]:[this.data.pointer.x,this.data.pointer.y]}},{key:"getPointerMoveDistance",value:function(){return void 0===this.data.pointer?0:this.data.pointer.distance}}]),t}(u.default);t.default=l,e.exports=t.default}),function(e,t){if("function"==typeof define&&define.amd)define("io/devices/Mouse",["module","exports","io/devices/Pointer"],t);else if("undefined"!=typeof exports)t(module,exports,require("io/devices/Pointer"));else{var n={exports:{}};t(n,n.exports,e.j2d.io.devices.Pointer),e.j2d=e.j2d||{},e.j2d.io=e.j2d.io||{},e.j2d.io.devices=e.j2d.io.devices||{},e.j2d.io.devices.Mouse=n.exports}}(this,function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=i(n),s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),l=function(e){function t(e){o(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return Object.defineProperty(n,"__fixMouseButtonId",{enumerable:!0,writable:!0,value:function(e){return e>2?e:0===e?"LEFT":1===e?"MIDDLE":2===e?"RIGHT":void 0}}),Object.defineProperty(n,"keyMouseDownEventHandler",{enumerable:!0,writable:!0,value:function(e){n.input.isEnabled&&n.input.preventDefault&&e.preventDefault();var t=n.input.KEYS_HELPER.getKeyById("KEY_MOUSE_"+n.__fixMouseButtonId(e.button));n.input.data.keys.keysDown.includes(t)||n.input.data.keys.keysDown.push(t),n.input.store.recordMouseDragDistance=!0,n.input.store.pointer={tracker:{x:e.pageX,y:e.pageY}},n.input.store.recordMouseClickTime=!0,void 0!==n.input.store.keys.pressedTime[t]?n.input.store.keys.pressedTime[t].delta=n.input.store.keys.pressedTime[t].startTime-e.timeStamp:n.input.store.keys.pressedTime[t]={startTime:e.timeStamp,delta:0},n.input.events.trigger("io.mouseKeyDown",e)}}),Object.defineProperty(n,"keyMouseUpEventHandler",{enumerable:!0,writable:!0,value:function(e){n.input.isEnabled&&n.input.preventDefault&&e.preventDefault();var t=n.input.KEYS_HELPER.getKeyById("KEY_MOUSE_"+n.__fixMouseButtonId(e.button));n.input.data.keys.keysUp.includes(t)||n.input.data.keys.keysUp.push(t),n.input.store.recordMouseDragDistance=!1,n.input.data.pointer.distance=0,n.input.store.pointer={tracker:{x:0,y:0}},n.input.store.recordMouseClickTime=!1,void 0!==n.input.store.keys.pressedTime[t]&&n.input.store.keys.pressedTime.splice(t,1),n.input.events.trigger("io.mouseKeyUp",e)}}),Object.defineProperty(n,"keyMouseMoveEventHandler",{enumerable:!0,writable:!0,value:function(e){n.input.isEnabled&&n.input.preventDefault&&e.preventDefault(),n.input.data.pointer={x:e.pageX,y:e.pageY,distance:n.input.store.recordMouseDragDistance?Math.sqrt(Math.pow(e.pageX-n.input.store.pointer.tracker.x,2)+Math.pow(e.pageY-n.input.store.pointer.tracker.y,2)).toFixed(2):0,image:n.input.data.pointer.image},n.input.events.trigger("io.mouseMove",e)}}),Object.defineProperty(n,"scrollMouseEventHandler",{enumerable:!0,writable:!0,value:function(e){n.input.isEnabled&&n.input.preventDefault&&e.preventDefault();var t=e.wheelDelta/120>0?n.input.KEYS_HELPER.getKeyById("SCROLL_MOUSE_UP"):n.input.KEYS_HELPER.getKeyById("SCROLL_MOUSE_DOWN");n.input.data.keys.keysUp.includes(t)||(n.input.data.keys.keysUp.push(t),n.input.data.keys.keysDown.push(t)),n.input.events.trigger("io.mouseScroll",e)}}),n.keyMouseDownEventHandler=n.keyMouseDownEventHandler.bind(n),n.keyMouseUpEventHandler=n.keyMouseUpEventHandler.bind(n),n.keyMouseMoveEventHandler=n.keyMouseMoveEventHandler.bind(n),n.scrollMouseEventHandler=n.scrollMouseEventHandler.bind(n),n}return a(t,e),s(t,[{key:"init",value:function(e){void 0!==e&&void 0===this.input&&(this.input=e),this.input.data.keys={keysUp:[],keysDown:[]},this.input.store.keys={pressedTime:[]},this.input.data.pointer={image:this.input.options.cursor||"none",x:0,y:0,distance:0},this.input.store.pointer={tracker:{x:0,y:0},image:this.input.options.cursor||"none"},this.input.store.recordMouseDragDistance=!1,this.input.store.recordMouseClickTime=!1,this.setPointerImage(this.input.options.cursor||"none")}},{key:"update",value:function(){return!0}},{key:"clear",value:function(){return void 0!==this.input.data.keys&&(this.input.data.keys={keysUp:[],keysDown:[]}),void 0!==this.input.data.pointer&&(this.input.data.pointer={image:this.input.options.pointer||"none",x:0,y:0,distance:0}),!0}},{key:"enable",value:function(){return window.addEventListener("mousedown",this.keyMouseDownEventHandler,!1),window.addEventListener("mouseup",this.keyMouseUpEventHandler,!1),window.addEventListener("mousemove",this.keyMouseMoveEventHandler,!1),window.addEventListener("wheel",this.scrollMouseEventHandler,!1),!0}},{key:"disable",value:function(){return window.removeEventListener("mousedown",this.keyMouseDownEventHandler,!1),window.removeEventListener("mouseup",this.keyMouseUpEventHandler,!1),window.removeEventListener("mousemove",this.keyMouseMoveEventHandler,!1),window.removeEventListener("wheel",this.scrollMouseEventHandler,!1),!0}}]),t}(u.default);Object.defineProperty(l,"DeviceName",{enumerable:!0,writable:!0,value:u.default.prototype.constructor.name}),t.default=l,e.exports=t.default}),function(e,t){if("function"==typeof define&&define.amd)define("io/devices/Keyboard",["module","exports","api/Device"],t);else if("undefined"!=typeof exports)t(module,exports,require("api/Device"));else{var n={exports:{}};t(n,n.exports,e.j2d.api.Device),e.j2d=e.j2d||{},e.j2d.io=e.j2d.io||{},e.j2d.io.devices=e.j2d.io.devices||{},e.j2d.io.devices.Keyboard=n.exports}}(this,function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=i(n),s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),l=function(e){function t(e){o(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return Object.defineProperty(n,"keyDownEventHandler",{enumerable:!0,writable:!0,value:function(e){n.input.isEnabled&&n.input.preventDefault&&e.preventDefault(),n.input.data.keys.keysDown.includes(e.keyCode)||n.input.data.keys.keysDown.push(e.keyCode),n.input.store.recordKeyPressTime=!0,void 0!==n.input.store.keys.pressedTime[e.keyCode]?n.input.store.keys.pressedTime[e.keyCode].delta=n.input.store.keys.pressedTime[e.keyCode].startTime-e.timeStamp:n.input.store.keys.pressedTime[e.keyCode]={startTime:e.timeStamp,delta:0},n.input.events.trigger("io.keyboardKeyDown",e)}}),Object.defineProperty(n,"keyUpEventHandler",{enumerable:!0,writable:!0,value:function(e){n.input.isEnabled&&n.input.preventDefault&&e.preventDefault(),n.input.data.keys.keysUp.includes(e.keyCode)||n.input.data.keys.keysUp.push(e.keyCode),n.input.store.recordKeyPressTime=!1,void 0!==n.input.store.keys.pressedTime[e.keyCode]&&n.input.store.keys.pressedTime.splice(e.keyCode,1),n.input.events.trigger("io.keyboardKeyUp",e)}}),n.keyDownEventHandler=n.keyDownEventHandler.bind(n),n.keyUpEventHandler=n.keyUpEventHandler.bind(n),n}return a(t,e),s(t,[{key:"init",value:function(e){void 0!==e&&void 0===this.input&&(this.input=e),this.input.data.keys={keysUp:[],keysDown:[]},this.input.store.keys={pressedTime:[]},this.input.store.recordKeyPressTime=!1}},{key:"update",value:function(){return!0}},{key:"clear",value:function(){return void 0!==this.input.data.keys&&(this.input.data.keys={keysUp:[],keysDown:[]}),!0}},{key:"enable",value:function(){return window.addEventListener("keydown",this.keyDownEventHandler,!1),window.addEventListener("keyup",this.keyUpEventHandler,!1),!0}},{key:"disable",value:function(){return window.removeEventListener("keydown",this.keyDownEventHandler,!1),window.removeEventListener("keyup",this.keyUpEventHandler,!1),!0}}]),t}(u.default);t.default=l,e.exports=t.default}),function(e,t){if("function"==typeof define&&define.amd)define("io/devices/Joystick",["module","exports","api/Device"],t);else if("undefined"!=typeof exports)t(module,exports,require("api/Device"));else{var n={exports:{}};t(n,n.exports,e.j2d.api.Device),e.j2d=e.j2d||{},e.j2d.io=e.j2d.io||{},e.j2d.io.devices=e.j2d.io.devices||{},e.j2d.io.devices.Joystick=n.exports}}(this,function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=i(n),s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),l=function(e){function t(e){return o(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return a(t,e),s(t,[{key:"init",value:function(e){return void 0!==e&&void 0===this.input&&(this.input=e),!0}},{key:"update",value:function(){return!0}},{key:"clear",value:function(){return!0}},{key:"enable",value:function(){throw new Error('Error. IO interface "'+t.IO+'" exist, but not supported yet.')}},{key:"disable",value:function(){throw new Error('Error. IO interface "'+t.IO+'" exist, but not supported yet.')}}]),t}(u.default);t.default=l,e.exports=t.default}),function(e,t){if("function"==typeof define&&define.amd)define("core/ViewportManager",["module","exports","utils/ArrayMap","nodes/CameraNode","utils/Vector2d"],t);else if("undefined"!=typeof exports)t(module,exports,require("utils/ArrayMap"),require("nodes/CameraNode"),require("utils/Vector2d"));else{var n={exports:{}};t(n,n.exports,e.j2d.utils.ArrayMap,e.j2d.nodes.CameraNode,e.j2d.utils.Vector2d),e.j2d=e.j2d||{},e.j2d.core=e.j2d.core||{},e.j2d.core.ViewportManager=n.exports}}(this,function(e,t,n,i,o){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var u=r(n),s=r(i),l=r(o),d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),f=function(e,t){var n={offset:{x:0,y:0},size:{x:0,y:0},scale:1,angle:t.angle};return n.offset.x=e.offsetX+t.offset.x,n.offset.y=e.offsetY+t.offset.y,n.size.x=e.x<t.size.x?e.x:t.size.x,n.size.y=e.y<t.size.y?e.y:t.size.y,n.scale=t.scale*((e.x/t.size.x+e.y/t.size.y)/2),n},p=function(){function e(){a(this,e),this.cameras=new u.default,this.camera="No active cameras",this.screen={x:0,y:0,offsetX:0,offsetY:0},this.init=!1,this.data={offset:{x:0,y:0},size:{x:0,y:0},scale:1,angle:0}}return c(e,[{key:"setScreen",value:function(e){if("object"==("undefined"==typeof e?"undefined":d(e))){if(e instanceof Array&&2==e.length)return this.screen={x:e[0],y:e[1],offsetX:this.screen.offsetX,offsetY:this.screen.offsetY},this;void 0!==e.x&&void 0!==e.y&&(this.screen={x:e.x,y:e.y,offsetX:this.screen.offsetX,offsetY:this.screen.offsetY})}return this}},{key:"setOffset",value:function(e){if("object"==("undefined"==typeof e?"undefined":d(e))){if(e instanceof Array&&2==e.length)return this.screen={x:this.screen.x,y:this.screen.y,offsetX:e[0],offsetY:e[1]},this;void 0!==e.x&&void 0!==e.y&&(this.screen={x:this.screen.x,y:this.screen.y,offsetX:e.x,offsetY:e.y})}return this}},{key:"addCamera",value:function(e,t){if(t instanceof s.default)return this.cameras.add(e,t),this}},{key:"removeCamera",value:function(e){return this.cameras.remove(e),this.camera==e&&(this.camera="No active cameras",this.data={offset:{x:0,y:0},size:{x:0,y:0},scale:1,angle:0}),this}},{key:"updateViewport",value:function(e){return void 0!==this.cameras[e]&&this.cameras[e]instanceof s.default&&(this.data=this.cameras[e].getCameraViewport(this.screen,f)),this}},{key:"setViewport",value:function(e,t){return void 0!==e&&"object"==("undefined"==typeof e?"undefined":d(e))&&e instanceof l.default&&(this.data.offset=e.getVector()),void 0!==t&&"object"==("undefined"==typeof t?"undefined":d(t))&&t instanceof l.default&&(this.data.size=t.getVector()),this.data=f(this.screen,this.data),this}},{key:"setDefaultViewport",value:function(e){return this.init||(this.data=e,this.init=!0),this}},{key:"getViewport",value:function(){return this.data}}]),e}();t.default=p,e.exports=t.default}),function(e,t){if("function"==typeof define&&define.amd)define("core/SceneManager",["module","exports","utils/ObjectUtil","utils/Vector2d","core/FrameManager","core/LayersManager","core/ViewportManager","core/GameStatesManager"],t);else if("undefined"!=typeof exports)t(module,exports,require("utils/ObjectUtil"),require("utils/Vector2d"),require("core/FrameManager"),require("core/LayersManager"),require("core/ViewportManager"),require("core/GameStatesManager"));else{var n={exports:{}};t(n,n.exports,e.j2d.utils.ObjectUtil,e.j2d.utils.Vector2d,e.j2d.core.FrameManager,e.j2d.core.LayersManager,e.j2d.core.ViewportManager,e.j2d.core.GameStatesManager),e.j2d=e.j2d||{},e.j2d.core=e.j2d.core||{},e.j2d.core.SceneManager=n.exports}}(this,function(e,t,n,i,o,r,a,u){"use strict";function s(e){return e&&e.__esModule?e:{default:e}}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var d=s(n),c=s(i),f=s(o),p=s(r),y=s(a),h=s(u),v=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),b=function(){function e(t){l(this,e),this.setGameCallback=this.setGameCallback.bind(this),this.start=this.start.bind(this),this.j2d=t,this.canvas=null,this.context=null,this.frameManager=f.default.Init(),this.layersManager=new p.default,this.viewportManager=new y.default,this.gameStatesManager=new h.default({},this.setGameCallback),this.initLayers()}return v(e,[{key:"patchGameStateRender",value:function(e){var t=this,n=e.constructor;return"function"==typeof n&&void 0===n.prototype.render&&(n.prototype.render=function(e,n){return t.clear().fillBackground().render(n),!0}),n}},{key:"init",value:function(t){return this.data=d.default.extend(!0,{},e.defaults,t),this.j2d.trigger("beforeInit"),this.data.originalWidth=this.data.width,this.data.originalHeight=this.data.height,this.data.originalMargin=getComputedStyle(this.j2d.element).margin,this.j2d.element.style.width=this.data.width+"px",this.j2d.element.style.height=this.data.height+"px",this.initCanvas(),this.viewportManager.setScreen({x:this.data.width,y:this.data.height}).setDefaultViewport({offset:{x:0,y:0},size:{x:this.data.width,y:this.data.height},scale:1,angle:0}),this.j2d.trigger("afterInit"),this}},{key:"initLayers",value:function(){return this.layersManager.getLayer("scene")||this.layersManager.addLayer("scene",0),this}},{key:"initCanvas",value:function(){return 0===document.querySelectorAll('.j2d[guid="'+this.j2d.data.id+'"] canvas').length&&(this.canvas=document.createElement("canvas"),this.canvas.width=this.data.width,this.canvas.height=this.data.height,this.canvas.style.zIndex=this.data.zIndex,this.canvas.style.position=this.data.position,this.canvas.style.left=this.data.left,this.canvas.style.top=this.data.top,this.j2d.data.webGL?this.context=this.canvas.getContext("WebGL-2d"):this.context=this.canvas.getContext("2d"),this.j2d.data.smoothing||this.j2d.util.disableSmoothing(this.context),this.context.shadowColor="rgba(0,0,0,0)",this.data.backgroundColor&&(this.backgroundColor=this.data.backgroundColor),this.data.opacity&&(this.opacity=this.data.opacity),this.data.visible&&(this.visible=this.data.visible),this.data.zIndex&&(this.zIndex=1e3-this.data.zIndex),this.j2d.element.appendChild(this.canvas)),this}},{key:"clear",value:function(e,t){return void 0!==e&&void 0!==t?this.context.clearRect(e.x-this.viewport.x,e.y-this.viewport.y,t.x,t.y):this.context.clearRect(0,0,this.data.width,this.data.height),
this}},{key:"resize",value:function(e,t){return this.canvas.width=this.data.width=e,this.canvas.height=this.data.height=t,this.data.backgroundColor&&(this.context.save(),this.clear(),this.backgroundColor=this.data.backgroundColor,this.context.restore()),this.j2d.data.smoothing||this.j2d.util.disableSmoothing(this.context),this}},{key:"setGameCallback",value:function(e){var t=this;t.data.gameState=e||"init_j2d",t.frameManager.stop(t.j2d.data.id);var n=t.patchGameStateRender(t.gameStatesManager.getState(e)),i=new n(t.gameStatesManager,{});return i.init({callback:function(){i.load({callback:function(){t.frameManager.start(t.j2d.data.id,i,{j2d:t.j2d,frameLimit:t.data.frameLimit}),t.j2d.trigger("changedGameState"),t.gameStatesManager.getPreviousState().unload()}})}}),this}},{key:"async",value:function(e,t){return setTimeout(e.call(e,t),0),this}},{key:"start",value:function(){var e=this;e.j2d.data.io&&e.j2d.data.io.init(),e.j2d.trigger("beforeStart"),e.frameManager.stop(e.j2d.data.id);var t=e.patchGameStateRender(e.gameStatesManager.getCurrent()),n=new t(e.gameStatesManager,{});return n.init({callback:function(){n.load({callback:function(){e.frameManager.start(e.j2d.data.id,n,{j2d:e.j2d,frameLimit:e.data.frameLimit}),e.j2d.trigger("afterStart")}})}}),e}},{key:"stop",value:function(){return this.frameManager.stop(this.j2d.data.id),this}},{key:"fullScreen",value:function(e){var t=document.getElementById(this.j2d.element.attr("id"));return void 0===t.requestFullscreen&&(t.requestFullscreen=t.webkitRequestFullscreen||t.webkitRequestFullScreen||t.mozRequestFullScreen||t.msRequestFullscreen),void 0===document.exitFullscreen&&(document.exitFullscreen=document.webkitExitFullscreen||document.webkitCancelFullScreen||document.mozCancelFullScreen||document.msExitFullscreen),e?t.requestFullscreen():document.exitFullscreen(),this}},{key:"resizeToFullPage",value:function(e){var t=this.j2d,n=this;return e?(n.data.originalWidth=n.data.width,n.data.originalHeight=n.data.height,n.resize(t.device.width,t.device.height),n.data.enableFullscreen=!0,t.element.style.width=t.device.width+"px",t.element.style.height=t.device.height+"px",t.element.style.margin=0,n.viewportManager.setScreen({x:t.device.width,y:t.device.height}).setOffset({x:-(t.device.width-n.data.originalWidth)/2,y:-(t.device.height-n.data.originalHeight)/2})):(n.resize(n.data.originalWidth,n.data.originalHeight),n.data.enableFullscreen=!1,t.element.style.width=n.data.originalWidth+"px",t.element.style.height=n.data.originalHeight+"px",t.element.style.margin=n.data.originalMargin,n.viewportManager.setScreen({x:n.data.originalWidth,y:n.data.originalHeight}).setOffset({x:0,y:0})),this}},{key:"toggleFullScreen",value:function(e,t){return void 0===t&&(t={fullscreen:!1}),!e.scene.enableFullscreen||t.fullscreen?e.scene.fullScreen(!0):e.scene.fullScreen(!1),this}},{key:"getSceneLayer",value:function(){return this.layersManager.getLayer("scene")}},{key:"fillBackground",value:function(){return this.data.backgroundColor&&(this.backgroundColor=this.data.backgroundColor),this}},{key:"render",value:function(e){var t=this;return t.layersManager.layers.forEach(function(n,i){t.layersManager.layers[i].render(t.context,t.viewportManager.getViewport(),t.layersManager.globalCollection,e||{})}),this}},{key:"add",value:function(e,t){return this.layersManager.globalCollection.has("scene")&&this.layersManager.globalCollection.get("scene").add(e,t),this}},{key:"remove",value:function(e,t){return this.layersManager.globalCollection.has("scene")&&this.layersManager.globalCollection.get("scene").remove(e,t),this}},{key:"registerCamera",value:function(e){return this.viewportManager.addCamera(e.data.id,e),this}},{key:"_updateNoCamerasViewport",value:function(e){return e.viewportManager.setViewport(new c.default(0,0),new c.default(e.data.width,e.data.height)),e}},{key:"updateViewport",value:function(e){return void 0===e?this._updateNoCamerasViewport(this):(this.viewportManager.updateViewport(e.data.id),this)}},{key:"backgroundColor",get:function(){return this.data.backgroundColor},set:function(e){this.data.backgroundColor=e,this.context.fillStyle=e,this.context.fillRect(0,0,this.data.width,this.data.height)}},{key:"opacity",get:function(){return this.data.opacity},set:function(e){this.data.opacity=e,this.canvas.style.opacity=e}},{key:"visible",get:function(){return this.data.visible},set:function(e){this.data.visible=!!e,this.canvas.style.display=e?"block":"none"}},{key:"zIndex",get:function(){return 1e3-this.data.zIndex},set:function(e){this.data.zIndex=1e3+e,this.canvas.style.zIndex=1e3+e}},{key:"viewport",get:function(){return this.data.viewport}}]),e}();Object.defineProperty(b,"defaults",{enumerable:!0,writable:!0,value:{width:0,height:0,originalWidth:0,originalHeight:0,originalMargin:0,visible:!0,position:"absolute",top:0,left:0,zIndex:1e3,opacity:1,backgroundColor:!1,frameLimit:60,enableFullScreen:!1,viewport:{x:0,y:0}}}),t.default=b,e.exports=t.default}),function(e,t){if("function"==typeof define&&define.amd)define("core/LayersManager",["module","exports","nodes/CollectionNode","utils/UUID"],t);else if("undefined"!=typeof exports)t(module,exports,require("nodes/CollectionNode"),require("utils/UUID"));else{var n={exports:{}};t(n,n.exports,e.j2d.nodes.CollectionNode,e.j2d.utils.UUID),e.j2d=e.j2d||{},e.j2d.core=e.j2d.core||{},e.j2d.core.LayersManager=n.exports}}(this,function(e,t,n,i){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=o(n),u=o(i),s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),l=function(){function e(){r(this,e),this.globalCollection=new a.default({id:"GlobalLayer"}),this.layers=[],this.index=1e3}return s(e,[{key:"addLayer",value:function(e,t,n){if(e=e||u.default.generate(),void 0===n||n instanceof a.default)return void 0===t?(t=this.index,this.index++):t+=1e3,n=n||new a.default({id:e,zIndex:t}),this.globalCollection.add(n,e),this.layers[t]=n,this}},{key:"removeLayer",value:function(e){return delete this.layers[this.globalCollection.get(e).zIndex],this.globalCollection.remove(null,e),this}},{key:"getLayer",value:function(e){return this.globalCollection.has(e)?this.globalCollection.get(e):null}},{key:"setZIndex",value:function(e,t){return this.globalCollection.has(e)&&(delete this.layers[this.globalCollection.get(e).zIndex],this.globalCollection.get(e).zIndex=t,this.layers[t]=this.globalCollection.get(e)),this}}]),e}();t.default=l,e.exports=t.default}),function(e,t){if("function"==typeof define&&define.amd)define("core/GameStatesManager",["module","exports","utils/ArrayMap","utils/ObjectUtil","states/DefaultGameState","states/BaseGameState"],t);else if("undefined"!=typeof exports)t(module,exports,require("utils/ArrayMap"),require("utils/ObjectUtil"),require("states/DefaultGameState"),require("states/BaseGameState"));else{var n={exports:{}};t(n,n.exports,e.j2d.utils.ArrayMap,e.j2d.utils.ObjectUtil,e.j2d.states.DefaultGameState,e.j2d.states.BaseGameState),e.j2d=e.j2d||{},e.j2d.core=e.j2d.core||{},e.j2d.core.GameStatesManager=n.exports}}(this,function(e,t,n,i,o,r){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var s=a(n),l=a(i),d=a(o),c=a(r),f=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),p=function(){function e(t,n){u(this,e),this.data=l.default.extend(!0,{},e.defaults,t),this.add(new d.default),this.sceneCallback=n}return f(e,[{key:"getState",value:function(e){return void 0===e?this.getCurrent():this.data.states.contains(e)?this.data.states[e]:null}},{key:"getPreviousState",value:function(){return this.data.states.get(this.data.states[this.data.previousState])}},{key:"getNextState",value:function(){return void 0!==this.data.states[this.state+1]?this.data.states.get(this.data.states[this.state+1]):null}},{key:"getCurrent",value:function(){return this.data.states.get(this.data.states[this.data.currentState])}},{key:"setState",value:function(e){return this.data.states.contains(e)&&(this.data.previousState=this.data.currentState,this.data.currentState=this.data.states.indexOf(e),this.sceneCallback(e)),this}},{key:"setNextState",value:function(){return void 0!==this.data.states[this.state+1]&&(this.data.previousState=this.data.currentState,this.data.currentState=this.state+1,this.sceneCallback(this.data.states[this.state])),this}},{key:"setPreviousState",value:function(){if(void 0!==this.data.states[this.data.previousState]){var e=this.data.previousState;this.data.previousState=this.data.currentState,this.data.currentState=e,this.sceneCallback(this.data.states[e])}return this}},{key:"add",value:function(e,t){return void 0===t&&(t=e.data.id),!this.data.states.contains(t)&&e instanceof c.default&&this.data.states.add(t,e),this}},{key:"remove",value:function(e){return this.data.states.contains(e)&&this.data.states.remove(e),this}},{key:"state",get:function(){return this.data.currentState},set:function(e){this.data.currentState=e}}]),e}();Object.defineProperty(p,"defaults",{enumerable:!0,writable:!0,value:{previousState:null,currentState:0,states:new s.default}}),t.default=p,e.exports=t.default}),function(e,t){if("function"==typeof define&&define.amd)define("utils/Vector2dInteger",["module","exports","utils/Vector2d"],t);else if("undefined"!=typeof exports)t(module,exports,require("utils/Vector2d"));else{var n={exports:{}};t(n,n.exports,e.j2d.utils.Vector2d),e.j2d=e.j2d||{},e.j2d.utils=e.j2d.utils||{},e.j2d.utils.Vector2dInteger=n.exports}}(this,function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=i(n),s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),l=function(e){function t(e,n){return o(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e>>0,n>>0))}return a(t,e),s(t,[{key:"fromArray",value:function(e){return this.x=e[0]>>0,this.y=e[1]>>0,this}}]),t}(u.default);t.default=l,e.exports=t.default}),function(e,t){if("function"==typeof define&&define.amd)define("utils/Vector2d",["module","exports"],t);else if("undefined"!=typeof exports)t(module,exports);else{var n={exports:{}};t(n,n.exports),e.j2d=e.j2d||{},e.j2d.utils=e.j2d.utils||{},e.j2d.utils.Vector2d=n.exports}}(this,function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=function(){function e(t,i){n(this,e),this.x=t,this.y=i}return i(e,[{key:"getX",value:function(){return this.x}},{key:"getY",value:function(){return this.y}},{key:"getVector",value:function(){return{x:this.x,y:this.y}}},{key:"toArray",value:function(){return[this.x,this.y]}},{key:"fromArray",value:function(e){return this.x=e[0],this.y=e[1],this}},{key:"toString",value:function(){return"("+this.x+","+this.y+")"}}],[{key:"getDistance",value:function(e,t){return Math.sqrt(Math.pow(t.getVector().x-e.getVector().x,2)+Math.pow(t.getVector().y-e.getVector().y,2))}},{key:"getAngle",value:function(e,t){return Math.atan2(t.getVector().y-e.getVector().y,t.getVector().x-e.getVector().x)*(180/Math.PI)}}]),e}();t.default=o,e.exports=t.default}),function(e,t){if("function"==typeof define&&define.amd)define("utils/MathUtil",["module","exports"],t);else if("undefined"!=typeof exports)t(module,exports);else{var n={exports:{}};t(n,n.exports),e.j2d=e.j2d||{},e.j2d.utils=e.j2d.utils||{},e.j2d.utils.MathUtil=n.exports}}(this,function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=function(){function e(){n(this,e)}return i(e,null,[{key:"number2Integer",value:function(e){return e>>0}},{key:"isInteger",value:function(e){return"number"==typeof e&&isFinite(e)&&e>-9007199254740992&&e<9007199254740992&&Math.floor(e)===e}},{key:"randomColor",value:function(t,n,i){return"rgba("+e.random(t,n)+", "+e.random(t,n)+", "+e.random(t,n)+", "+i+")"}},{key:"random",value:function t(n,i,o){var t=Math.floor(Math.random()*(i-n+1)+n);return o&&0==t?e.random(n,i,o):t}},{key:"degree2Radian",value:function(e){return e*(Math.PI/180)}},{key:"radian2Degree",value:function(e){return e*(180/Math.PI)}}]),e}();t.default=o,e.exports=t.default}),function(e,t){if("function"==typeof define&&define.amd)define("transitions/Tween",["module","exports","utils/ObjectUtil","utils/Events","transitions/utils/Easing"],t);else if("undefined"!=typeof exports)t(module,exports,require("utils/ObjectUtil"),require("utils/Events"),require("transitions/utils/Easing"));else{var n={exports:{}};t(n,n.exports,e.j2d.utils.ObjectUtil,e.j2d.utils.Events,e.j2d.transitions.utils.Easing),e.j2d=e.j2d||{},e.j2d.transitions=e.j2d.transitions||{},e.j2d.transitions.Tween=n.exports}}(this,function(e,t,n,i,o){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var u=r(n),s=r(i),l=r(o),d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),f=[],p=function(){function e(t,n){a(this,e),this.data=u.default.extend(!0,{},e.defaults,n),this.node=t,this.events=new s.default,this.state={}}return c(e,[{key:"_tweenStateData",value:function(t){return void 0!==t&&"object"===("undefined"==typeof t?"undefined":d(t))?u.default.extend(!0,{},e.stateDefaults,t):e.stateDefaults}},{key:"to",value:function(e,t){var n=this;if(!n.data.isStarted){"number"==typeof t&&(t={data:t});var i="number"!=typeof t?this._tweenStateData(t):t;return void 0!==t&&"number"==typeof t&&(i.duration=t),n.data.tweenStateStack.push([e,i]),n}}},{key:"update",value:function(t){var n=this,i=n.data.tweenStateStack[n.data.currentStateAnimation+1];if(t<n.data.startTime||void 0===i)return!0;n.data.isStarted||(n.events.trigger("start",[n.node]),n.data.isStarted=!0);var o=n.data.tweenStateStack[n.data.currentStateAnimation],r=n.getStateTimeDuration(n.data.currentStateAnimation,!0),a=(t-(n.data.startTime+r))/i[1].duration;if(a=a>1?1:a,n.node.import(e.util.animateTween(o[0],i[0],l.default.get(i[1].easing)(a))),n.events.trigger("update",[n.node]),1===a){if(!(n.data.currentStateAnimation<n.data.tweenStateStack.length)){n.events.trigger("complete",[n.node]);for(var u=0;u<n.data.chainedTweensStack.length;u++)n.data.chainedTweensStack[u].start(n.data.startTime+n.getStateTimeDuration(n.data.currentStateAnimation-1,!0));return!1}n.data.currentStateAnimation++}return!0}},{key:"_calculateStackStateTimings",value:function(e){var t=[];return e.forEach(function(e){t.push(e[1].duration)}),t}},{key:"getStateTimeDuration",value:function(e,t){if(void 0!==e&&null!==e||(e=this.data.currentStateAnimation),void 0===t&&(t=!1),void 0===this.data.tweenStateTimings[e])return 0;if(t){for(var n=0,i=1;i<=e;i++)n+=this.data.tweenStateTimings[i];return n}return this.data.tweenStateTimings[e]}},{key:"_calculateStackState",value:function(t,n){var i=[t],o=1,r=[t],a=0,s=0;return n.forEach(function(t){if("object"!==d(t[0])||t[0]instanceof Array){if("string"==typeof t[0]){var n=0;switch(t[0]){case"delay":a=t[1].data;break;case"delayAll":s=t[1].data;break;case"repeat":for(n=0;n<t[1].data;n++)r.push(r[o]),o++;break;case"repeatAll":for(n=0;n<t[1].data;n++)r.concat(r),o++;break;case"yoyo":case"reverse":for(n=0;n<t[1].data;n++)void 0!==r[o-1]&&(r.push([e.util.reverseProperties(r[o-1][0]),r[o-1][1]]),o++);break;case"yoyoAll":case"reverseAll":for(n=0;n<t[1].data;n++)for(var i=r.slice(0),u=i.length,l=0;l<u;l++){var c=u-l-1;void 0!==i[c]&&(r.push([e.util.reverseProperties(i[c][0]),i[c][1]]),o++)}}}}else 0!==a?(t[1].delay=a,a=0):0!==s&&(t[1].delay=s),r.push([t[0],t[1]]),o++}),o=0,r.shift(),r.forEach(function(t){"object"!==d(t[0])||t[0]instanceof Array||(i.push([e.util.calculateProperties(i[o][0],u.default.extend(!0,{},i[o][0],t[0])),t[1]]),o++)}),i}},{key:"start",value:function(t){var n=this;return void 0===t&&(t=global.performance.now()),n.data.isAnimated=!0,n.data.isStarted||(n.data.isStarted=!0,n.state=[e.util.cleanProperties(n.node.data),e.stateDefaults],n.data.tweenStateStack=this._calculateStackState(n.state,n.data.tweenStateStack),n.data.tweenStateTimings=this._calculateStackStateTimings(n.data.tweenStateStack)),n.data.startTime=t+n.data.delayTime,e.add(n)}},{key:"stop",value:function(){var t=this;return t.data.isAnimated?(t.data.isAnimated=!1,t.events.trigger("stop",[t.node]),t.stopChainedTweens(),e.remove(t)):this}},{key:"stopChainedTweens",value:function(){for(var e=this,t=0;t<e.data.chainedTweensStack.length;t++)e.data.chainedTweensStack[t].stop();return e}},{key:"delay",value:function(e){return void 0===e&&(e=1e3),this.to("delay",e),this}},{key:"delayAll",value:function(e){return void 0===e&&(e=1e3),this.to("delayAll",e),this}},{key:"repeat",value:function(e){return void 0===e&&(e=1),this.to("repeat",e),this}},{key:"repeatAll",value:function(e){return void 0===e&&(e=1),this.to("repeatAll",e),this}},{key:"yoyo",value:function(e){return void 0===e&&(e=1),this.to("yoyo",e),this}},{key:"reverse",value:function(e){return void 0===e&&(e=1),this.to("reverse",e),this}},{key:"yoyoAll",value:function(e){return void 0===e&&(e=1),this.to("yoyoAll",e),this}},{key:"reverseAll",value:function(e){return void 0===e&&(e=1),this.to("reverseAll",e),this}},{key:"on",value:function(e,t){return this.events.on(e,t)}},{key:"off",value:function(e,t){return this.events.off(e,t)}},{key:"once",value:function(e,t){return this.events.once(e,t)}},{key:"flush",value:function(e){return this.events.flush(e)}},{key:"trigger",value:function(e,t){return this.events.trigger(e,t)}}],[{key:"get",value:function(e){return void 0===e?f:f[e]}},{key:"add",value:function(e){return f.push(e),e}},{key:"remove",value:function(e){var t=f.indexOf(e);return t!==-1&&f.splice(t,1),e}},{key:"flush",value:function(){f=[]}},{key:"update",value:function(e){if(0===f.length)return!1;for(var t=0;t<f.length;)f[t].update(e)?t++:f.splice(t,1);return!0}}]),e}();Object.defineProperty(p,"defaults",{enumerable:!0,writable:!0,value:{currentStateAnimation:0,tweenStateStack:[],tweenStateTimings:[],chainedTweensStack:[],isAnimated:!1,isStarted:!1,startTime:null,delayTime:0,defaultDuration:1e3}}),Object.defineProperty(p,"stateDefaults",{enumerable:!0,writable:!0,value:{data:null,duration:1e3,delay:0,easing:"linear",interpolation:"linear"}}),Object.defineProperty(p,"Easing",{enumerable:!0,writable:!0,value:l.default}),Object.defineProperty(p,"util",{enumerable:!0,writable:!0,value:{animateTween:function(e,t,n){var i,o,r={};for(i in t)t.hasOwnProperty(i)&&e.hasOwnProperty(i)&&(o=null,"number"==typeof t[i]?o=e[i]===t[i]?e[i]:e[i]+(t[i]-e[i])*n:"object"===d(t[i])&&(o=this.animateTween(e[i],t[i],n)),null!==o&&(r[i]=o));return Object.keys(r).length>0?r:null},cleanProperties:function(e){var t,n,i={};for(t in e)e.hasOwnProperty(t)&&"id"!==t&&(n=null,"string"==typeof e[t]&&!isNaN(e[t])||"number"==typeof e[t]?n=e[t]:"object"===d(e[t])&&(n=this.cleanProperties(e[t])),null!==n&&(i[t]=n));return Object.keys(i).length>0?i:null},reverseProperties:function(e){var t,n,i={};for(t in e)e.hasOwnProperty(t)&&"id"!==t&&(n=null,"string"!=typeof e[t]||isNaN(e[t])?"number"==typeof e[t]?n=e[t]:"object"===d(e[t])&&(n=this.reverseProperties(e[t])):n=Number(parseFloat(e[t])*-1).toString(),null!==n&&(i[t]=n));return Object.keys(i).length>0?i:null},calculateProperties:function(e,t){var n,i,o={};for(n in t)t.hasOwnProperty(n)&&e.hasOwnProperty(n)&&"id"!==n&&(i=null,"string"!=typeof t[n]||isNaN(t[n])||"number"!=typeof e[n]?"number"!=typeof t[n]||"string"!=typeof e[n]||isNaN(e[n])?"number"==typeof t[n]&&"number"==typeof e[n]?i=t[n]:"object"===d(t[n])&&(i=this.calculateProperties(e[n],t[n])):i=t[n]-parseFloat(e[n]):i=e[n]+parseFloat(t[n]),null!==i&&(o[n]=i));return Object.keys(o).length>0?o:null}}}),t.default=p,e.exports=t.default}),function(e,t){if("function"==typeof define&&define.amd)define("states/DefaultGameState",["module","exports","states/BaseGameState"],t);else if("undefined"!=typeof exports)t(module,exports,require("states/BaseGameState"));else{var n={exports:{}};t(n,n.exports,e.j2d.states.BaseGameState),e.j2d=e.j2d||{},e.j2d.states=e.j2d.states||{},e.j2d.states.DefaultGameState=n.exports}}(this,function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=i(n),s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),l=function(e){function t(e,n){return o(this,t),void 0===n&&(n={}),n.id="init_j2d",r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n))}return a(t,e),s(t,[{key:"update",value:function(e,t){return setTimeout(function(){this.gsm.setNextState()}.bind(this),1e3),!0}}]),t}(u.default);t.default=l,e.exports=t.default}),function(e,t){if("function"==typeof define&&define.amd)define("states/BaseGameState",["module","exports","utils/ObjectUtil","utils/UUID","utils/Events"],t);else if("undefined"!=typeof exports)t(module,exports,require("utils/ObjectUtil"),require("utils/UUID"),require("utils/Events"));else{var n={exports:{}};t(n,n.exports,e.j2d.utils.ObjectUtil,e.j2d.utils.UUID,e.j2d.utils.Events),e.j2d=e.j2d||{},e.j2d.states=e.j2d.states||{},e.j2d.states.BaseGameState=n.exports}}(this,function(e,t,n,i,o){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var u=r(n),s=r(i),l=r(o),d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),f=function(){function e(t,n){a(this,e),void 0===n&&(n={}),void 0===n&&(n={}),n.currentState=0,void 0!==n.id&&null!==n.id||(n.id=s.default.generate()),this.data=u.default.extend(!0,{},e.defaults,n),this.gsm=t,this.loader=null,this.events=new l.default}return c(e,[{key:"init",value:function(e){return"object"===("undefined"==typeof e?"undefined":d(e))&&void 0!==e.callback&&e.callback(),!0}},{key:"load",value:function(e){return"object"===("undefined"==typeof e?"undefined":d(e))&&void 0!==e.callback&&e.callback(),!0}},{key:"update",value:function(e,t){return!0}},{key:"render",value:function(e,t){return!0}},{key:"unload",value:function(e){return"object"===("undefined"==typeof e?"undefined":d(e))&&void 0!==e.callback&&e.callback(),!0}},{key:"on",value:function(e,t){return this.events.on(e,t)}},{key:"off",value:function(e,t){return this.events.off(e,t)}},{key:"once",value:function(e,t){return this.events.once(e,t)}},{key:"flush",value:function(e){return this.events.flush(e)}},{key:"trigger",value:function(e,t){return this.events.trigger(e,t)}},{key:"id",get:function(){return this.data.id},set:function(e){this.data.id=e}}]),e}();Object.defineProperty(f,"defaults",{enumerable:!0,writable:!0,value:{id:"BaseState",currentState:0}}),Object.defineProperty(f,"STATE",{enumerable:!0,writable:!0,value:{STATE_NOT_LOADED:0,STATE_INIT:1,STATE_LOAD:2,STATE_UPDATE:3,STATE_RENDER:4,STATE_UNLOAD:5}}),t.default=f,e.exports=t.default}),function(e,t){if("function"==typeof define&&define.amd)define("nodes/RectNode",["module","exports","utils/ObjectUtil","nodes/AnimatedNode","utils/MathUtil"],t);else if("undefined"!=typeof exports)t(module,exports,require("utils/ObjectUtil"),require("nodes/AnimatedNode"),require("utils/MathUtil"));else{var n={exports:{}};t(n,n.exports,e.j2d.utils.ObjectUtil,e.j2d.nodes.AnimatedNode,e.j2d.utils.MathUtil),e.j2d=e.j2d||{},e.j2d.nodes=e.j2d.nodes||{},e.j2d.nodes.RectNode=n.exports}}(this,function(e,t,n,i,o){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=r(n),d=r(i),c=r(o),f=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),p=function(e){function t(e){return a(this,t),u(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,l.default.extend(!0,{},t.defaults,e)))}return s(t,e),f(t,[{key:"getColor",value:function(){return this.data.color}},{key:"setColor",value:function(e){return this.data.color=e,this}},{key:"draw",value:function(e,t,n,i){if(this.data.visible&&this.inViewport(t)){if(1!==this.data.opacity){var o=e.globalAlpha;e.globalAlpha=this.data.opacity}(this.data.angle||0!==t.angle)&&(e.save(),e.translate(this.getPosition().x-t.offset.x,this.getPosition().y-t.offset.y),e.rotate(c.default.degree2Radian(this.data.angle+t.angle)),e.translate(-(this.getPosition().x-t.offset.x),-(this.getPosition().y-t.offset.y))),e.fillStyle=this.data.color,e.lineWidth=0,e.fillRect(this.data.position.x-t.offset.x,this.data.position.y-t.offset.y,this.data.size.x*this.data.scale*t.scale,this.data.size.y*this.data.scale*t.scale),(this.data.angle||0!==t.angle)&&e.restore(),1!==this.data.opacity&&(e.globalAlpha=o)}return null}},{key:"render",value:function(e,t,n,i){return this.draw(e,t,n,i),this}}]),t}(d.default);Object.defineProperty(p,"defaults",{enumerable:!0,writable:!0,value:{type:"RectNode",color:"#000000"}}),t.default=p,e.exports=t.default}),function(e,t){if("function"==typeof define&&define.amd)define("nodes/CollectionNode",["module","exports","utils/ObjectUtil","nodes/AnimatedNode","utils/ArrayMap","nodes/BaseNode"],t);else if("undefined"!=typeof exports)t(module,exports,require("utils/ObjectUtil"),require("nodes/AnimatedNode"),require("utils/ArrayMap"),require("nodes/BaseNode"));else{var n={exports:{}};t(n,n.exports,e.j2d.utils.ObjectUtil,e.j2d.nodes.AnimatedNode,e.j2d.utils.ArrayMap,e.j2d.nodes.BaseNode),e.j2d=e.j2d||{},e.j2d.nodes=e.j2d.nodes||{},e.j2d.nodes.CollectionNode=n.exports}}(this,function(e,t,n,i,o,r){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var d=a(n),c=a(i),f=a(o),p=a(r),y=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),h=function(e){function t(e){u(this,t);var n=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,d.default.extend(!0,{},t.defaults,e)));return null===n.data.collection&&(n.data.collection=new f.default),n}return l(t,e),y(t,[{key:"add",value:function(e,t){return e instanceof p.default&&(t=t||e.data.id,this.data.collection.add(t,e)),this}},{key:"remove",value:function(e,t){return e instanceof p.default&&this.data.collection.remove(this.data.collection[e.data.id]),"string"==typeof t&&null===e&&this.data.collection.remove(t),this}},{key:"has",value:function(e){return void 0!==this.data.collection[e]}},{key:"get",value:function(e){return void 0!==this.data.collection[e]&&this.data.collection[e]}},{key:"flush",value:function(){return this.data.collection.length=0,this}},{key:"render",value:function(e,t,n,i){var o=this;return 0!==this.data.collection.length&&this.data.collection.each(function(r){o.data.collection.hasOwnProperty(r)&&o.data.collection[r]instanceof p.default&&o.data.collection[r].render(e,t,n,i)}),this}},{key:"zIndex",get:function(){return 1e3-this.data.zIndex},set:function(e){this.data.zIndex=1e3+e}}]),t}(c.default);Object.defineProperty(h,"defaults",{enumerable:!0,writable:!0,value:{type:"CollectionNode",collection:null,zIndex:1e3}}),t.default=h,e.exports=t.default}),function(e,t){if("function"==typeof define&&define.amd)define("nodes/CameraNode",["module","exports","utils/ObjectUtil","nodes/AnimatedNode"],t);else if("undefined"!=typeof exports)t(module,exports,require("utils/ObjectUtil"),require("nodes/AnimatedNode"));else{
var n={exports:{}};t(n,n.exports,e.j2d.utils.ObjectUtil,e.j2d.nodes.AnimatedNode),e.j2d=e.j2d||{},e.j2d.nodes=e.j2d.nodes||{},e.j2d.nodes.CameraNode=n.exports}}(this,function(e,t,n,i){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=o(n),l=o(i),d=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),c=function(e){function t(e){return r(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,s.default.extend(!0,{},t.defaults,e)))}return u(t,e),d(t,[{key:"getCameraViewport",value:function(e,t){return t(e,{offset:this.data.position,size:this.data.size,angle:this.data.angle,scale:this.data.scale})}},{key:"render",value:function(e,t,n,i){return this}}]),t}(l.default);Object.defineProperty(c,"defaults",{enumerable:!0,writable:!0,value:{type:"CameraNode"}}),t.default=c,e.exports=t.default}),function(e,t){if("function"==typeof define&&define.amd)define("nodes/BaseNode",["module","exports","utils/ObjectUtil","utils/UUID","utils/Vector2d"],t);else if("undefined"!=typeof exports)t(module,exports,require("utils/ObjectUtil"),require("utils/UUID"),require("utils/Vector2d"));else{var n={exports:{}};t(n,n.exports,e.j2d.utils.ObjectUtil,e.j2d.utils.UUID,e.j2d.utils.Vector2d),e.j2d=e.j2d||{},e.j2d.nodes=e.j2d.nodes||{},e.j2d.nodes.BaseNode=n.exports}}(this,function(e,t,n,i,o){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var u=r(n),s=r(i),l=r(o),d=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),c=function(){function e(t){a(this,e),this.data=u.default.extend(!0,{},e.defaults,t),null===this.data.id&&(this.data.id=s.default.generate())}return d(e,[{key:"load",value:function(e){this.data=u.default.extend(!0,{},this.data,e)}},{key:"save",value:function(){return this.data}},{key:"getPosition",value:function(){return new l.default(this.data.position.x,this.data.position.y)}},{key:"setPosition",value:function(t){return void 0!==t&&(t instanceof l.default?this.data.position=t.getVector():t instanceof e&&(this.data.position=t.getPosition().getVector())),this}},{key:"getSize",value:function(){return new l.default(this.data.size.x,this.data.size.y)}},{key:"setSize",value:function(t){return void 0!==t&&(t instanceof l.default?this.data.size=t.getVector():t instanceof e&&(this.data.size=t.getSize().getVector())),this}},{key:"getOffset",value:function(){return new l.default(this.data.offset.x,this.data.offset.y)}},{key:"setOffset",value:function(t){return void 0!==t&&(t instanceof l.default?this.data.offset=t.getVector():t instanceof e&&(this.data.offset=t.getOffset().getVector())),this}},{key:"render",value:function(e,t,n,i){return this}},{key:"inViewport",value:function(e){return!(this.data.position.x>e.offset.x+e.size.x||this.data.position.x+e.size.x<e.offset.x||this.data.position.y>e.offset.y+e.size.y||this.data.position.y+e.size.y<e.offset.y)}},{key:"opacity",get:function(){return this.data.opacity},set:function(e){this.data.opacity=e}},{key:"visible",get:function(){return this.data.visible},set:function(e){this.data.visible=!!e}},{key:"angle",get:function(){return this.data.angle},set:function(e){this.data.angle=e%360}},{key:"scale",get:function(){return this.data.scale},set:function(e){this.data.scale=e}},{key:"cache",get:function(){return this.data.enabledCache},set:function(e){this.data.enabledCache=!!e}}]),e}();Object.defineProperty(c,"defaults",{enumerable:!0,writable:!0,value:{id:null,type:"BaseNode",position:{x:0,y:0},size:{x:0,y:0},offset:{x:0,y:0},visible:!0,angle:0,scale:1,opacity:1,cache:null,enabledCache:!1}}),t.default=c,e.exports=t.default}),function(e,t){if("function"==typeof define&&define.amd)define("nodes/AnimatedNode",["module","exports","utils/ObjectUtil","nodes/BaseNode","utils/Vector2d","transitions/Tween"],t);else if("undefined"!=typeof exports)t(module,exports,require("utils/ObjectUtil"),require("nodes/BaseNode"),require("utils/Vector2d"),require("transitions/Tween"));else{var n={exports:{}};t(n,n.exports,e.j2d.utils.ObjectUtil,e.j2d.nodes.BaseNode,e.j2d.utils.Vector2d,e.j2d.transitions.Tween),e.j2d=e.j2d||{},e.j2d.nodes=e.j2d.nodes||{},e.j2d.nodes.AnimatedNode=n.exports}}(this,function(e,t,n,i,o,r){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var d=a(n),c=a(i),f=a(o),p=a(r),y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},h=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),v=function(e){function t(e){return u(this,t),s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,d.default.extend(!0,{},t.defaults,e)))}return l(t,e),h(t,[{key:"moveTo",value:function(e,t,n){if(void 0!==t&&"number"==typeof t||(t=1e3),"object"===("undefined"==typeof e?"undefined":y(e))){var i=new p.default(this);e instanceof f.default?(n&&(t=f.default.getDistance(this.getPosition(),e)/t),i.to({position:{x:e.getVector().x,y:e.getVector().y}},t)):e instanceof c.default&&(n&&(t=f.default.getDistance(this.getPosition(),e.getPosition())/t),i.to({position:{x:e.getPosition().getVector().x,y:e.getPosition().getVector().y}},t)),i.start()}}},{key:"resizeTo",value:function(e,t,n){if(void 0!==t&&"number"==typeof t||(t=1e3),"object"===("undefined"==typeof position?"undefined":y(position))){var i=new p.default(this);e instanceof f.default?(n&&(t=f.default.getDistance(this.getSize(),e)/t),i.to({size:{x:e.getVector().x,y:e.getVector().y}},t)):e instanceof c.default&&(n&&(t=f.default.getDistance(this.getSize(),e.getSize())/t),i.to({size:{x:e.getSize().getVector().x,y:e.getSize().getVector().y}},t)),i.start()}}},{key:"rotateTo",value:function(e,t){void 0!==t&&"number"==typeof t||(t=1e3);var n=new p.default(this);"number"==typeof e?n.to({angle:e%360},t):"object"===("undefined"==typeof e?"undefined":y(e))&&e instanceof c.default&&n.to({angle:f.default.getAngle(e.getPosition(),this.getPosition())},t),n.start()}},{key:"turn",value:function(e){void 0!==e&&"number"==typeof e||(e=1),this.angle+=e}}]),t}(c.default);Object.defineProperty(v,"defaults",{enumerable:!0,writable:!0,value:{type:"AnimatedNode"}}),t.default=v,e.exports=t.default}),function(e,t){if("function"==typeof define&&define.amd)define("media/Video",["module","exports"],t);else if("undefined"!=typeof exports)t(module,exports);else{var n={exports:{}};t(n,n.exports),e.j2d=e.j2d||{},e.j2d.media=e.j2d.media||{},e.j2d.media.Video=n.exports}}(this,function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function e(){n(this,e)};t.default=i,e.exports=t.default}),function(e,t){if("function"==typeof define&&define.amd)define("media/Sound",["module","exports","utils/ObjectUtil","utils/UUID","utils/Events","media/Audio"],t);else if("undefined"!=typeof exports)t(module,exports,require("utils/ObjectUtil"),require("utils/UUID"),require("utils/Events"),require("media/Audio"));else{var n={exports:{}};t(n,n.exports,e.j2d.utils.ObjectUtil,e.j2d.utils.UUID,e.j2d.utils.Events,e.j2d.media.Audio),e.j2d=e.j2d||{},e.j2d.media=e.j2d.media||{},e.j2d.media.Sound=n.exports}}(this,function(e,t,n,i,o,r){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function d(){return c?(f=void 0===c.createGain?c.createGainNode():c.createGain(),f.gain.value=1,f.connect(c.destination),f):null}Object.defineProperty(t,"__esModule",{value:!0});var c,f,p=a(n),y=a(i),h=a(o),v=a(r),b=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),m={},g=function(e){function t(e,n){u(this,t);var i=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return i.manager=n,i.events=i.manager?i.manager.events:new h.default,i.data=p.default.extend(!0,{},t.defaults,e),i.audioNode=[],c=n?n.getAudioContext():new(window.AudioContext||window.webkitAudioContext),f=n?n.getMasterGain():d(),null===i.data.id&&(i.data.id=y.default.generate()),c&&i.data.buffer&&i._setupAudioNode(i),i.manager&&c&&i.manager.data.iOSAutoEnable&&(i.manager.iOSEnable=!0),i.manager&&i.manager.media.get("sounds").add(i.data.id,i),i.load(),i}return l(t,e),b(t,[{key:"_load",value:function(e){return _(e,e.data.src),e}},{key:"_unload",value:function(e){e.disconnect(0)}},{key:"play",value:function(e,t){var n=this;return"function"==typeof e&&(t=e),e&&"function"!=typeof e||(e="default"),n.data.loaded?n.data.sprite[e]?(n._inactiveNode(n,function(i){i.sprite=e;var o=i.pos>0?i.pos:n.data.sprite[e][0]/1e3,r=n.data.sprite[e][1]/1e3-i.pos;i.pos>0&&(o=n.data.sprite[e][0]/1e3+o);var a,u=!(!n.data.loop&&!n.data.sprite[e][2]),s="string"==typeof t?t:Math.round(Date.now()*Math.random())+"";!function(){var t={id:s,sprite:e,loop:u};a=setTimeout(function(){c&&!u&&(n._nodeById(n,t.id).paused=!0,n._nodeById(n,t.id).pos=0,n._clearEndTimer(n,t.id)),n.events.trigger("unload",s)},r/n.data.rate*1e3),n.data.onEndTimer.push({timer:a,id:t.id})}();var l=n.data.sprite[e][0]/1e3,d=n.data.sprite[e][1]/1e3;return i.id=s,i.paused=!1,j(n,[u,l,d],s),n.data.playStart=c.currentTime,i.gain.value=n.data.volume,"undefined"==typeof i.bufferSource.start?u?i.bufferSource.noteGrainOn(0,o,86400):i.bufferSource.noteGrainOn(0,o,r):u?i.bufferSource.start(0,o,86400):i.bufferSource.start(0,o,r),n.events.trigger("play"),"function"==typeof t&&t(s),n}),n):("function"==typeof t&&t(),n):(n.events.on("load",function(){n.play(e,t)}),n)}},{key:"_pause",value:function(e){return!(e.bufferSource&&!e.paused)||(e.paused=!0,void 0==e.bufferSource.stop?e.bufferSource.noteOff(0):e.bufferSource.stop(0),!1)}},{key:"_stop",value:function(e){return!(e.bufferSource&&!e.paused)||(e.paused=!0,"undefined"==typeof e.bufferSource.stop?e.bufferSource.noteOff(0):e.bufferSource.stop(0),!1)}},{key:"_mute",value:function(e){e.gain.value=0}},{key:"_unMute",value:function(e){e.gain.value=this.data.volume}},{key:"_volume",value:function(e,t){e.gain.value=t}},{key:"_position",value:function(e,t){return void 0!==t&&1==t?e.pos:e.pos+(c.currentTime-this.data.playStart)}},{key:"_pos3d",value:function(e,t,n,i){e&&(this.data.pos3d=[t,n,i],e.panner.setPosition(t,n,i),e.panner.panningModel=this.data.model||"HRTF")}},{key:"_setupAudioNode",value:function(){var e=this,t=e.audioNode,n=e.audioNode.length;return t[n]=void 0===c.createGain?c.createGainNode():c.createGain(),t[n].gain.value=e.data.volume,t[n].paused=!0,t[n].pos=0,t[n].readyState=4,t[n].connect(f),t[n].panner=c.createPanner(),t[n].panner.panningModel=e.data.model||"equalpower",t[n].panner.setPosition(e.data.pos3d[0],e.data.pos3d[1],e.data.pos3d[2]),t[n].panner.connect(t[n]),t[n]}},{key:"_inactiveNode",value:function(e,t){for(var n=null,i=0;i<e.audioNode.length;i++)if(e.audioNode[i].paused&&4===e.audioNode[i].readyState){t(e.audioNode[i]),n=!0;break}if(e._drainPool(e),!n){var o=e._setupAudioNode();t(o)}}},{key:"_drainPool",value:function(e){for(var t=0,n=0;n<e.audioNode.length;n++)e.audioNode[n].paused&&t++;for(n=e.audioNode.length-1;n>=0&&!(t<=5);n--)e.audioNode[n].paused&&(c&&e.audioNode[n].disconnect(0),e.audioNode.splice(n,1),t--)}}]),t}(v.default);Object.defineProperty(g,"defaults",{enumerable:!0,writable:!0,value:{id:null,src:[],format:null,autoPlay:!1,duration:0,loop:!1,sprite:{},volume:1,muted:!1,pos3d:[0,0,-.5],rate:1,loaded:!1,buffer:!1,model:null,onEndTimer:[]}}),t.default=g;var _=function(e,t){if(t in m)return e.data.duration=m[t].duration,void E(e);if(/^data:[^;]+;base64,/.test(t)){for(var n=atob(t.split(",")[1]),i=new Uint8Array(n.length),o=0;o<n.length;++o)i[o]=n.charCodeAt(o);w(i.buffer,e,t)}else{var r=new XMLHttpRequest;r.open("GET",t,!0),r.responseType="arraybuffer",r.onload=function(){w(r.response,e,t)},r.onerror=function(){c&&(e.data.buffer=!0,e.audioNode=[],delete e.gainNode,delete m[t],e.load())};try{r.send()}catch(e){r.onerror()}}},w=function(e,t,n){c.decodeAudioData(e,function(e){e&&(m[n]=e,E(t,e))},function(e){t.events.trigger("loaderror",e)})},E=function(e,t){e.data.duration=t?t.duration:e.data.duration,0===Object.getOwnPropertyNames(e.data.sprite).length&&(e.data.sprite={default:[0,1e3*e.data.duration]}),e.data.loaded||(e.data.loaded=!0,e.events.trigger("load")),e.data.autoPlay&&e.play()},j=function(e,t,n){var i=e._nodeById(e,n);i.bufferSource=c.createBufferSource(),i.bufferSource.buffer=m[e.data.src],i.bufferSource.connect(i.panner),i.bufferSource.loop=t[0],t[0]&&(i.bufferSource.loopStart=t[1],i.bufferSource.loopEnd=t[1]+t[2]),i.bufferSource.playbackRate.value=e.data.rate};e.exports=t.default}),function(e,t){if("function"==typeof define&&define.amd)define("media/Audio",["module","exports","utils/ObjectUtil","utils/UUID","utils/Events"],t);else if("undefined"!=typeof exports)t(module,exports,require("utils/ObjectUtil"),require("utils/UUID"),require("utils/Events"));else{var n={exports:{}};t(n,n.exports,e.j2d.utils.ObjectUtil,e.j2d.utils.UUID,e.j2d.utils.Events),e.j2d=e.j2d||{},e.j2d.media=e.j2d.media||{},e.j2d.media.Audio=n.exports}}(this,function(e,t,n,i,o){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var u=r(n),s=r(i),l=r(o),d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),f={},p=window.Audio,y=function(){function e(t,n){a(this,e);var i=this;i.manager=void 0!==n?n:null,i.events=i.manager?i.manager.events:new l.default,i.data=u.default.extend(!0,{},e.defaults,t),i.audioNode=[],null===i.data.id&&(i.data.id=s.default.generate()),i.manager&&i.manager.media.get("audios").add(i.data.id,i),i.load()}return c(e,[{key:"_load",value:function(e){var t=new p;t.addEventListener("error",function(){console.error({type:t.error?t.error.code:0})},!1),e.audioNode.push(t),t.src=e.data.src,t.pos=0,t.preload="auto",t.volume=e.manager?e.manager.muted?0:e.data.volume*(e.manager.volume/100):e.data.muted?0:e.data.volume;var n=function n(){e.data.duration=Math.ceil(10*t.duration)/10,0===Object.getOwnPropertyNames(e.data.sprite).length&&(e.data.sprite={default:[0,1e3*e.data.duration]}),e.data.loaded||(e.data.loaded=!0,e.events.trigger("load")),e.data.autoPlay&&e.play(),t.removeEventListener("canplaythrough",n,!1)};return t.addEventListener("canplaythrough",n,!1),t.load(),e}},{key:"load",value:function(){var e=this,t="",n="";if(e.manager&&e.manager.isSupportAudio)return console.warn("No audio support."),!1;var i=function(e,t){if(t)return t;var n=/^data:audio\/([^;,]+);/i.exec(e);return n||(n=/\.([^.]+)$/.exec(e.split("?",1)[0])),n?n[1].toLowerCase():(console.warn("Could not extract format from passed URLs, please add format"),null)};if(e.data.src instanceof Array){for(var o=0;o<e.data.src.length&&(t=e.data.src[o],n=i(e.data.src[o],e.data.format),null===n);o++);e.data.src=t}else{if("string"!=typeof e.data.src)return console.warn("Unknown audio source"),!1;n=i(e.data.src,e.data.format)}return e.manager&&e.manager.isSupportCodec[n]?(console.warn("Codec not support"),!1):e._load(e)}},{key:"_unload",value:function(e){e.src=""}},{key:"unload",value:function(){for(var e=this,t=e.audioNode,n=0;n<e.audioNode.length;n++)t[n].paused||(e.stop(t[n].id),e.events.trigger("unload",t[n].id)),e._unload(t[n]);for(n=0;n<e.data.onEndTimer.length;n++)clearTimeout(e.data.onEndTimer[n].timer);if(e.manager){var i=this.manager.get("audios"),o=i.indexOf(e);null!==o&&o>=0&&i.splice(o,1)}delete f[e.data.src],e=null}},{key:"src",value:function(e){var t=this;return e&&(t.stop(),t.data.src=e,t.data.loaded=!1,t.load()),null}},{key:"play",value:function(e,t){var n=this;return"function"==typeof e&&(t=e),e&&"function"!=typeof e||(e="default"),n.data.loaded?n.data.sprite[e]?(n._inactiveNode(n,function(i){i.sprite=e;var o,r=i.pos>0?i.pos:n.data.sprite[e][0]/1e3,a=n.data.sprite[e][1]/1e3-(r-n.data.sprite[e][0]/1e3),u=!(!n.data.loop&&!n.data.sprite[e][2]),s="string"==typeof t?t:Math.round(Date.now()*Math.random())+"";return function(){var t={id:s,sprite:e,loop:u};o=setTimeout(function(){u?n.stop(t.id).play(e,t.id):n.stop(t.id),n.events.trigger("unload",s)},a/n.data.rate*1e3),n.data.onEndTimer.push({timer:o,id:t.id})}(),4===i.readyState||!i.readyState&&navigator.isCocoonJS?(i.id=s,i.currentTime=r,i.muted=n.manager?n.manager.muted||i.muted:n.data.muted||i.muted,i.volume=n.manager?n.data.volume*(n.manager.volume/100):n.data.volume,setTimeout(function(){i.play()},0),n.events.trigger("play"),"function"==typeof t&&t(s),n):(n._clearEndTimer(s),function(){var n=n,o=e,r=t,a=i,u=function e(){n.play(o,r),a.removeEventListener("canplaythrough",e,!1)};a.addEventListener("canplaythrough",u,!1)}(),n)}),n):("function"==typeof t&&t(),n):(n.events.on("load",function(){n.play(e,t)}),n)}},{key:"_pause",value:function(e){return e.pause(),!1}},{key:"pause",value:function(e){var t=this;if(!t.data.loaded)return t.events.on("play",function(){t.pause(e)}),t;t._clearEndTimer(t,e);var n=e?t._nodeById(e):t._activeNode(t);if(n){n.pos=t.pos(null,e);var i=t._pause(n);if(i)return t}return t.events.trigger("pause"),t}},{key:"_stop",value:function(e){return isNaN(e.duration)||(e.pause(),e.currentTime=0),!1}},{key:"stop",value:function(e){var t=this;if(!t.data.loaded)return t.events.on("play",function(){t.stop(e)}),t;t._clearEndTimer(t,e);var n=e?t._nodeById(t,e):t._activeNode(t);if(n){n.pos=0;var i=t._stop(n);if(i)return t}return t}},{key:"_mute",value:function(e){e.muted=!0}},{key:"mute",value:function(e){var t=this;if(!t.data.loaded)return t.events.on("play",function(){t.mute(e)}),t;var n=e?t._nodeById(e):t._activeNode(t);return n&&t._mute(),t}},{key:"_unMute",value:function(e){e.muted=!1}},{key:"unMute",value:function(e){var t=this;if(!t.data.loaded)return t.events.on("play",function(){t.unMute(e)}),t;var n=e?t._nodeById(e):t._activeNode(t);return n&&t._unMute(),t}},{key:"_volume",value:function(e,t){e.volume=t}},{key:"volume",value:function(e,t){var n=this;if(e=parseFloat(e),e>=0&&e<=1){if(n.data.volume=e,!n.data.loaded)return n.events.on("play",function(){n.volume(e,t)}),n;var i=t?n._nodeById(t):n._activeNode(n);return i&&(e=n.manager?e*(n.manager.volume/100):n.data.volume,n._volume(e)),n}return n.data.volume}},{key:"loop",value:function(e){var t=this;return"boolean"==typeof e?(t.data.loop=e,t):t.data.loop}},{key:"sprite",value:function(e){var t=this;return"object"===("undefined"==typeof e?"undefined":d(e))?(t.data.sprite=e,t):t.data.sprite}},{key:"_position",value:function(e,t){return e.currentTime}},{key:"pos",value:function(e,t){var n=this;if(!n.data.loaded)return n.events.on("load",function(){n.pos(e)}),"number"==typeof e?n:n.data.pos||0;e=parseFloat(e);var i=t?n._nodeById(t):n._activeNode(n);if(i)return e>=0?(n.pause(t),i.pos=e,n.play(i.sprite,t),n):n._position(i,!1);if(e>=0)return n;for(var o=0;o<n.audioNode.length;o++)if(n.audioNode[o].paused&&4===n.audioNode[o].readyState)return n._position(n.audioNode[o],!0)}},{key:"_pos3d",value:function(e,t,n,i){return null}},{key:"pos3d",value:function(e,t,n,i){var o=this;if(t="undefined"!=typeof t&&t?t:0,n="undefined"!=typeof n&&n?n:-.5,!o.data.loaded)return o.events.on("play",function(){o.pos3d(e,t,n,i)}),o;if(!(e>=0||e<0))return o.data.pos3d;var r=i?o._nodeById(i):o._activeNode(o);return o._pos3d(r,e,t,n),o}},{key:"_nodeById",value:function(e,t){for(var n=e.audioNode[0],i=0;i<e.audioNode.length;i++)if(e.audioNode[i].id===t){n=e.audioNode[i];break}return n}},{key:"_clearEndTimer",value:function(e,t){for(var n=-1,i=0;i<e.data.onEndTimer.length;i++)if(e.data.onEndTimer[i].id===t){n=i;break}var o=e.data.onEndTimer[n];o&&(clearTimeout(o.timer),e.data.onEndTimer.splice(n,1))}},{key:"_activeNode",value:function(e){for(var t=null,n=0;n<e.audioNode.length;n++)if(!e.audioNode[n].paused){t=e.audioNode[n];break}return e._drainPool(e),t}},{key:"_inactiveNode",value:function(e,t){for(var n=null,i=0;i<e.audioNode.length;i++)if(e.audioNode[i].paused&&4===e.audioNode[i].readyState){t(e.audioNode[i]),n=!0;break}if(e._drainPool(e),!n){e.load();var o=e.audioNode[e.audioNode.length-1],r=navigator.isCocoonJS?"canplaythrough":"loadedmetadata",a=function e(){o.removeEventListener(r,e,!1),t(o)};o.addEventListener(r,a,!1)}}},{key:"_drainPool",value:function(e){for(var t=0,n=0;n<e.audioNode.length;n++)e.audioNode[n].paused&&t++;for(n=e.audioNode.length-1;n>=0&&!(t<=5);n--)e.audioNode[n].paused&&(e.audioNode.splice(n,1),t--)}}]),e}();Object.defineProperty(y,"defaults",{enumerable:!0,writable:!0,value:{id:null,src:[],format:null,autoPlay:!1,duration:0,loop:!1,sprite:{},volume:1,muted:!1,pos3d:[0,0,-.5],loaded:!1,onEndTimer:[]}}),t.default=y,e.exports=t.default}),function(e,t){if("function"==typeof define&&define.amd)define("loaders/AssetsLoader",["module","exports"],t);else if("undefined"!=typeof exports)t(module,exports);else{var n={exports:{}};t(n,n.exports),e.loadersAssetsLoader=n.exports}}(this,function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=function(){function e(){n(this,e),Object.defineProperty(this,"progress",{enumerable:!0,writable:!0,value:0})}return i(e,[{key:"getProgress",value:function(){return this.progress}},{key:"load",value:function(){}},{key:"isLoaded",value:function(e){}},{key:"dispose",value:function(e){}}]),e}();t.default=o,e.exports=t.default}),function(e,t){if("function"==typeof define&&define.amd)define("exceptions/UnexpectedValueException",["module","exports","exceptions/Exception"],t);else if("undefined"!=typeof exports)t(module,exports,require("exceptions/Exception"));else{var n={exports:{}};t(n,n.exports,e.exceptionsException),e.exceptionsUnexpectedValueException=n.exports}}(this,function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=i(n),s=function(e){function t(e){o(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return Object.defineProperty(n,"toString",{enumerable:!0,writable:!0,value:function(){return this.message}}),n}return a(t,e),t}(u.default);t.default=s,e.exports=t.default}),function(e,t){if("function"==typeof define&&define.amd)define("exceptions/RuntimeException",["module","exports","exceptions/Exception"],t);else if("undefined"!=typeof exports)t(module,exports,require("exceptions/Exception"));else{var n={exports:{}};t(n,n.exports,e.exceptionsException),e.exceptionsRuntimeException=n.exports}}(this,function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=i(n),s=function(e){function t(e){o(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return Object.defineProperty(n,"toString",{enumerable:!0,writable:!0,value:function(){return this.message}}),n}return a(t,e),t}(u.default);t.default=s,e.exports=t.default}),function(e,t){if("function"==typeof define&&define.amd)define("exceptions/RangeException",["module","exports","exceptions/Exception"],t);else if("undefined"!=typeof exports)t(module,exports,require("exceptions/Exception"));else{var n={exports:{}};t(n,n.exports,e.exceptionsException),e.exceptionsRangeException=n.exports}}(this,function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=i(n),s=function(e){function t(e){o(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return Object.defineProperty(n,"toString",{enumerable:!0,writable:!0,value:function(){return this.message}}),n}return a(t,e),t}(u.default);t.default=s,e.exports=t.default}),function(e,t){if("function"==typeof define&&define.amd)define("exceptions/OutOfRangeException",["module","exports","exceptions/Exception"],t);else if("undefined"!=typeof exports)t(module,exports,require("exceptions/Exception"));else{var n={exports:{}};t(n,n.exports,e.exceptionsException),e.exceptionsOutOfRangeException=n.exports}}(this,function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=i(n),s=function(e){function t(e){o(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return Object.defineProperty(n,"toString",{enumerable:!0,writable:!0,value:function(){return this.message}}),n}return a(t,e),t}(u.default);t.default=s,e.exports=t.default}),function(e,t){if("function"==typeof define&&define.amd)define("exceptions/OutOfBoundsException",["module","exports","exceptions/Exception"],t);else if("undefined"!=typeof exports)t(module,exports,require("exceptions/Exception"));else{var n={exports:{}};t(n,n.exports,e.exceptionsException),e.exceptionsOutOfBoundsException=n.exports}}(this,function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=i(n),s=function(e){function t(e){o(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return Object.defineProperty(n,"toString",{enumerable:!0,writable:!0,value:function(){return this.message}}),n}return a(t,e),t}(u.default);t.default=s,e.exports=t.default}),function(e,t){if("function"==typeof define&&define.amd)define("exceptions/LogicException",["module","exports","exceptions/Exception"],t);else if("undefined"!=typeof exports)t(module,exports,require("exceptions/Exception"));else{var n={exports:{}};t(n,n.exports,e.exceptionsException),e.exceptionsLogicException=n.exports}}(this,function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,
enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=i(n),s=function(e){function t(e){o(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return Object.defineProperty(n,"toString",{enumerable:!0,writable:!0,value:function(){return this.message}}),n}return a(t,e),t}(u.default);t.default=s,e.exports=t.default}),function(e,t){if("function"==typeof define&&define.amd)define("exceptions/LengthException",["module","exports","exceptions/Exception"],t);else if("undefined"!=typeof exports)t(module,exports,require("exceptions/Exception"));else{var n={exports:{}};t(n,n.exports,e.exceptionsException),e.exceptionsLengthException=n.exports}}(this,function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=i(n),s=function(e){function t(e){o(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return Object.defineProperty(n,"toString",{enumerable:!0,writable:!0,value:function(){return this.message}}),n}return a(t,e),t}(u.default);t.default=s,e.exports=t.default}),function(e,t){if("function"==typeof define&&define.amd)define("exceptions/Exception",["module","exports"],t);else if("undefined"!=typeof exports)t(module,exports);else{var n={exports:{}};t(n,n.exports),e.exceptionsException=n.exports}}(this,function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function r(e){function t(){var t=Reflect.construct(e,Array.from(arguments));return Object.setPrototypeOf(t,Object.getPrototypeOf(this)),t}return t.prototype=Object.create(e.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e,t}Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){function t(e){n(this,t);var o=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return o.message=e,o.toString=function(){return this.message},o}return o(t,e),t}(r(Error));t.default=a,e.exports=t.default}),function(e,t){if("function"==typeof define&&define.amd)define("exceptions/BadMethodCallException",["module","exports","exceptions/Exception"],t);else if("undefined"!=typeof exports)t(module,exports,require("exceptions/Exception"));else{var n={exports:{}};t(n,n.exports,e.exceptionsException),e.exceptionsBadMethodCallException=n.exports}}(this,function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=i(n),s=function(e){function t(e){o(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return Object.defineProperty(n,"toString",{enumerable:!0,writable:!0,value:function(){return this.message}}),n}return a(t,e),t}(u.default);t.default=s,e.exports=t.default}),function(e,t){if("function"==typeof define&&define.amd)define("exceptions/BadFunctionCallException",["module","exports","exceptions/Exception"],t);else if("undefined"!=typeof exports)t(module,exports,require("exceptions/Exception"));else{var n={exports:{}};t(n,n.exports,e.exceptionsException),e.exceptionsBadFunctionCallException=n.exports}}(this,function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=i(n),s=function(e){function t(e){o(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return Object.defineProperty(n,"toString",{enumerable:!0,writable:!0,value:function(){return this.message}}),n}return a(t,e),t}(u.default);t.default=s,e.exports=t.default}),function(e,t){if("function"==typeof define&&define.amd)define("utils/Events",["module","exports"],t);else if("undefined"!=typeof exports)t(module,exports);else{var n={exports:{}};t(n,n.exports),e.j2d=e.j2d||{},e.j2d.utils=e.j2d.utils||{},e.j2d.utils.Events=n.exports}}(this,function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=function(){function e(){n(this,e),Object.defineProperty(this,"events",{enumerable:!0,writable:!0,value:[]}),Object.defineProperty(this,"onces",{enumerable:!0,writable:!0,value:[]}),this.flush()}return i(e,[{key:"flush",value:function(e){void 0!==e?(void 0!==this.events[e]&&(this.events[e]=[]),void 0!==this.onces[e]&&(this.onces[e]=[])):(this.onces=[],this.events=[])}},{key:"on",value:function(e,t){if(void 0!==this.events[e]){var n=this.events[e];n.indexOf(t)===-1&&n.push(t)}else this.events[e]=[],this.events[e].push(t)}},{key:"once",value:function(e,t){if(void 0!==this.onces[e]){var n=this.onces[e];n.indexOf(t)===-1&&n.push(t)}else this.onces[e]=[],this.onces[e].push(t)}},{key:"off",value:function(e,t){if(void 0!==this.onces[e]){var n=this.events[e];n.indexOf(t)!==-1&&n.splice(n.indexOf(t))}}},{key:"trigger",value:function(e,t){var n,i;if(void 0!==this.events[e])for(n=this.events[e],i=0;i<n.length;i++)n[i].call(n[i],t);if(void 0!==this.onces[e]){for(n=this.onces[e],i=0;i<n.length;i++)n[i].call(n[i],t);this.flush(e)}}}]),e}();t.default=o,e.exports=t.default}),function(e,t){if("function"==typeof define&&define.amd)define("utils/ArrayMap",["module","exports"],t);else if("undefined"!=typeof exports)t(module,exports);else{var n={exports:{}};t(n,n.exports),e.j2d=e.j2d||{},e.j2d.utils=e.j2d.utils||{},e.j2d.utils.ArrayMap=n.exports}}(this,function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function r(e){function t(){var t=Reflect.construct(e,Array.from(arguments));return Object.setPrototypeOf(t,Object.getPrototypeOf(this)),t}return t.prototype=Object.create(e.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e,t}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),u=function(e){function t(e){n(this,t);var o=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return Object.defineProperty(o,"last",{enumerable:!0,writable:!0,value:function(){return o[o.length-1]}}),o}return o(t,e),a(t,[{key:"equals",value:function(e){if(!e)return!1;if(this.length!=e.length)return!1;for(var t=0,n=this.length;t<n;t++)if(this[t]instanceof Array&&e[t]instanceof Array){if(!this[t].equals(e[t]))return!1}else if(this[t]!=e[t])return!1;return!0}},{key:"contains",value:function(e){for(var t=this.length;t--;)if(this[t]===e)return!0;return!1}},{key:"each",value:function(e){if(!e)return!1;for(var t=!1,n=0;n<this.length;n++)if(0==(t=e(this[n],n)))return t;return t}},{key:"add",value:function(e,t){return this.contains(e)?this[e]=t:(this.push(e),this[e]=t),this}},{key:"get",value:function(e){return this.contains(e)?this[e]:null}},{key:"remove",value:function(e){for(var t=0;t<this.length;++t)if(this[t]==e)return this.splice(t,1),delete this[e],this;return this}}]),t}(r(Array));t.default=u,e.exports=t.default}),function(e,t){if("function"==typeof define&&define.amd)define("utils/ObjectUtil",["module","exports"],t);else if("undefined"!=typeof exports)t(module,exports);else{var n={exports:{}};t(n,n.exports),e.j2d=e.j2d||{},e.j2d.utils=e.j2d.utils||{},e.j2d.utils.ObjectUtil=n.exports}}(this,function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=function(){function e(){n(this,e)}return o(e,null,[{key:"extend",value:function(){var t=Array.prototype.slice.call(arguments),n=!1;"boolean"==typeof t[0]&&(n=t[0],t.splice(0,1));for(var o=t[0]||function(){return void 0!==t[1]&&null!==t[1]&&"object"===i(t[1])?Object.create(t[1]):{}}(),r=1;r<t.length;r++){var a=t[r];if(a)for(var u in a)a.hasOwnProperty(u)&&("object"===i(a[u])&&null!==a[u]?o[u]=n?e.extend(n,o[u],a[u]):a[u]:o[u]=a[u])}return o}}]),e}();t.default=r,e.exports=t.default}),function(e,t){if("function"==typeof define&&define.amd)define("io/MediaManager",["module","exports","../utils/ObjectUtil","../utils/Events","../utils/ArrayMap"],t);else if("undefined"!=typeof exports)t(module,exports,require("../utils/ObjectUtil"),require("../utils/Events"),require("../utils/ArrayMap"));else{var n={exports:{}};t(n,n.exports,e.utilsObjectUtil,e.utilsEvents,e.utilsArrayMap),e.j2d=e.j2d||{},e.j2d.io=e.j2d.io||{},e.j2d.io.MediaManager=n.exports}}(this,function(e,t,n,i,o){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var u=r(n),s=r(i),l=r(o),d=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),c=window.Audio,f=!1,p=!1;try{var y=window.AudioContext||window.webkitAudioContext;f=new y}catch(e){console.warn("Web Audio API is not supported in your browser")}try{p=!!new c}catch(e){console.warn("HTML5 Audio is not supported in your browser")}if(f){var h=void 0===f.createGain?f.createGainNode():f.createGain();h.gain.value=1,h.connect(f.destination)}var v=function(){function e(t,n){if(a(this,e),void 0===n&&(n={}),this.j2d=t,this.data=u.default.extend(!0,{},e.defaults,n),this.events=new s.default,this.media=new l.default,this.media.add("sounds",new l.default),this.media.add("audios",new l.default),this.media.add("videos",new l.default),this.volume=100*this.data.volume,this.iOSEnabled=!1,f||p){var i=new c;this.data.codecs={mp3:!!i.canPlayType("audio/mpeg;").replace(/^no$/,""),opus:!!i.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!i.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!i.canPlayType('audio/wav; codecs="1"').replace(/^no$/,""),aac:!!i.canPlayType("audio/aac;").replace(/^no$/,""),m4a:!!(i.canPlayType("audio/x-m4a;")||i.canPlayType("audio/m4a;")||i.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(i.canPlayType("audio/x-mp4;")||i.canPlayType("audio/mp4;")||i.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!i.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")},i=null}}return d(e,[{key:"getAudioContext",value:function(){return f}},{key:"getMasterGain",value:function(){return h}},{key:"mute",value:function(){return this.muted=!0,this}},{key:"unMute",value:function(){return this.muted=!1,this}},{key:"isSupportCodec",value:function(e){return!!this.data.codecs[e]}},{key:"addSound",value:function(e){return new Sound(e,this),this}},{key:"addAudio",value:function(e){return new Audio(e,this),this}},{key:"addVideo",value:function(e){return this}},{key:"sound",value:function(e){return this.media.get("sounds").get(e)}},{key:"audio",value:function(e){return this.media.get("audios").get(e)}},{key:"video",value:function(e){return this.media.get("videos").get(e)}},{key:"removeSound",value:function(e){return this.media.get("sounds").contains(e)&&(this.media.get("sounds").get(e).stop(),this.media.get("sounds").remove(e)),this}},{key:"removeAudio",value:function(e){return this.media.get("audios").contains(e)&&(this.media.get("audios").get(e).stop(),this.media.get("audios").remove(e)),this}},{key:"removeVideo",value:function(e){return this.media.get("videos").contains(e)&&(this.media.get("videos").get(e).stop(),this.media.get("videos").remove(e)),this}},{key:"volume",get:function(){return 100*this.data.volume},set:function(e){if(this.data.volume=parseFloat(e/100),e>=0&&e<=1)if(f)h.gain.value=this.data.volume;else{var t=this.media.get("sounds");for(var n in t)if(t.hasOwnProperty(n)&&!t[n].webAudio)for(var i=0;i<t[n].audioNode.length;i++)t[n].audioNode[i].volume=t[n].volume*this.data.volume;t=null}}},{key:"muted",get:function(){return!!this.data.muted},set:function(e){if(this.data.muted=!!e,f)h.gain.value=this.data.muted?0:this.data.volume;else{var t=this.media.get("sounds");for(var n in t)if(t.hasOwnProperty(n)&&t[n].webAudio===!1)for(var i=0;i<t[n].audioNode.length;i++)t[n].audioNode[i].muted=this.data.muted;t=null}}},{key:"iOSEnable",get:function(){return!!this.data.iOSAutoEnable},set:function(e){if(f&&(this.iOSEnabled||!/iPhone|iPad|iPod/i.test(navigator.userAgent)))return e;this.iOSEnabled=!1;var t=function e(){var t=f.createBuffer(1,1,22050),n=f.createBufferSource();n.buffer=t,n.connect(f.destination),void 0===n.start?n.noteOn(0):n.start(0),setTimeout(function(){n.playbackState!==n.PLAYING_STATE&&n.playbackState!==n.FINISHED_STATE||(this.iOSEnabled=!0,this.data.iOSAutoEnable=!1,window.removeEventListener("touchend",e,!1))},0)};window.addEventListener("touchend",t,!1)}},{key:"isSupportAudio",get:function(){return!f&&!p}}]),e}();Object.defineProperty(v,"defaults",{enumerable:!0,writable:!0,value:{volume:1,muted:!1,codecs:{},iOSAutoEnable:!0}}),t.default=v,e.exports=t.default}),function(e,t){if("function"==typeof define&&define.amd)define("io/InputManager",["module","exports","utils/ArrayMap","utils/Vector2d"],t);else if("undefined"!=typeof exports)t(module,exports,require("utils/ArrayMap"),require("utils/Vector2d"));else{var n={exports:{}};t(n,n.exports,e.j2d.utils.ArrayMap,e.j2d.utils.Vector2d),e.ioInputManager=n.exports}}(this,function(module,exports,_ArrayMap,_Vector2d){"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function getKey(e,t){return Object.keys(e).filter(function(n){return e[n]===t})[0]}Object.defineProperty(exports,"__esModule",{value:!0});var _ArrayMap2=_interopRequireDefault(_ArrayMap),_Vector2d2=_interopRequireDefault(_Vector2d),_createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),checkKeyMap=function checkKeyMap(e,enableCallback){void 0===enableCallback&&(enableCallback=!0);var j2d=e.data.manager.j2d,manager=e.data.manager,keyCode=e.which,keyMap=e.data.manager.keyMap;for(var index in keyMap)if(keyMap.hasOwnProperty(index)){var value=keyMap[index];if(!$.isArray(value[0])&&value[0]===keyCode&&value[1])return"string"==typeof value[1]&&(value[1]=eval("("+value[1]+")")),"function"==typeof value[1]&&enableCallback&&value[1](j2d,value[2]),!0;if($.isArray(value[0])&&manager.data.keysPressed.equals(value[0])&&value[1])return"string"==typeof value[1]&&(value[1]=eval("("+value[1]+")")),"function"==typeof value[1]&&enableCallback&&value[1](j2d,value[2]),!0}return!1},events={onMouseClick:function(e){var t=e.data.manager;if(!t.data.enabled||!t.j2d.isPlay||!t.j2d.element.hasClass("active"))return!0;var n=t.data.keysPressed,i=getKey(DEPRECATED_InputManager.key,e.which)||"KEY_UNKNOWN_"+e.which,o=t.data.mouse;2!==e.data.event?(0===e.data.event?(-1===$.inArray(DEPRECATED_InputManager.key[i],n)&&(n.push(DEPRECATED_InputManager.key[i]),t.data.enableAdditionalData&&(o.startPosition.x=e.pageX,o.startPosition.y=e.pageY,o.distance=0,t.data.timePressed=e.timeStamp)),(checkKeyMap(e,!1)||t.data.preventAll)&&e.preventDefault()):((checkKeyMap(e)||t.data.preventAll)&&e.preventDefault(),t.data.enableAdditionalData&&(o.previousDistance=o.distance,o.startPosition.x=0,o.startPosition.y=0),n.splice(n.indexOf(DEPRECATED_InputManager.key[i]),1)),t.element.trigger(0===e.data.event?"mouseKeyDown":"mouseKeyUp",{keyCode:i})):checkKeyMap(e,!1)&&e.preventDefault()},onMouseWheel:function(e){var t=e.data.manager;if(!t.data.enabled||!t.j2d.isPlay||!t.j2d.element.hasClass("active"))return!0;var n=t.data.keysPressed,i=e.originalEvent.wheelDelta/120>0?getKey(DEPRECATED_InputManager.key,4):getKey(DEPRECATED_InputManager.key,5);e.which=e.originalEvent.wheelDelta/120>0?4:5,-1===$.inArray(DEPRECATED_InputManager.key[i],n)&&n.push(DEPRECATED_InputManager.key[i]),(checkKeyMap(e)||t.data.preventAll)&&(e.preventDefault(),t.fixMouseWheel()),t.element.trigger("mouseWheel",{keyCode:i})},mouseWheelCancel:function(e,t){e.splice(e.indexOf(DEPRECATED_InputManager.key[t]),1)},onMouseMove:function(e){var t=e.data.manager,n=e.data.manager.data.mouse;t.data.mouse.currentPosition.x=e.pageX,t.data.mouse.currentPosition.y=e.pageY,e.data.manager.data.enableAdditionalData&&(n.distance=Math.sqrt(Math.pow(n.currentPosition.x-n.startPosition.x,2)+Math.pow(n.currentPosition.y-n.startPosition.y,2)).toFixed(1))},onKeyboardPress:function(e){var t=e.data.manager;if(!t.data.enabled||!t.j2d.isPlay||!t.element.hasClass("active"))return!0;var n=t.data.keysPressed,i=getKey(DEPRECATED_InputManager.key,e.which)||"KEY_UNKNOWN_"+e.which;if(2===e.data.event&&!0===t.data.writeMode){var o=String.fromCharCode(e.which||e.keyCode);e.preventDefault(),t.element.focus().trigger("keyboardCharPress",{key:e.which||e.keyCode,keyCode:i,char:o})}2!==e.data.event&&!1===t.data.writeMode&&(0===e.data.event?(-1===$.inArray(DEPRECATED_InputManager.key[i],n)&&(n.push(DEPRECATED_InputManager.key[i]),t.data.enableAdditionalData&&(t.data.timePressed=e.timeStamp)),(checkKeyMap(e,!1)||t.data.preventAll)&&e.preventDefault()):((checkKeyMap(e)||t.data.preventAll)&&e.preventDefault(),n.splice(n.indexOf(DEPRECATED_InputManager.key[i]),1)),t.element.trigger(0===e.data.event?"keyboardKeyDown":"keyboardKeyUp",{keyCode:i,key:e.which||e.keyCode})),2!==e.data.event&&!0===t.data.writeMode&&t.element.trigger(0===e.data.event?"keyboardKeyDown":"keyboardKeyUp",{keyCode:i,key:e.which||e.keyCode})},onTouchTap:function(e){var t=e.data.manager;if(!t.data.enabled||!t.j2d.isPlay||!t.j2d.element.hasClass("active"))return!0;var n=t.data.keysPressed,i=getKey(DEPRECATED_InputManager.key,e.which+1)||"KEY_UNKNOWN_"+e.which,o=e.originalEvent.touches[0]||e.originalEvent.changedTouches[0],r=t.data.mouse;0===e.data.event?(-1===$.inArray(DEPRECATED_InputManager.key[i],n)&&(n.push(DEPRECATED_InputManager.key[i]),t.data.enableAdditionalData&&(r.startPosition.x=o.pageX,r.startPosition.y=o.pageY,r.distance=0,t.data.timePressed=e.timeStamp)),(checkKeyMap(e,!1)||t.data.preventAll)&&e.preventDefault()):((checkKeyMap(e)||t.data.preventAll)&&e.preventDefault(),t.data.enableAdditionalData&&(r.previousDistance=r.distance,r.startPosition.x=0,r.startPosition.y=0),n.splice(n.indexOf(DEPRECATED_InputManager.key[i]),1)),t.element.trigger(0===e.data.event?"mouseKeyDown":"mouseKeyUp",{keyCode:i})},onTouchMove:function(e){var t=e.originalEvent.touches[0]||e.originalEvent.changedTouches[0],n=e.data.manager.data.mouse;n.currentPosition.x=t.pageX.toFixed(0),n.currentPosition.y=t.pageY.toFixed(0),e.data.manager.data.enableAdditionalData&&(n.distance=Math.sqrt(Math.pow(n.currentPosition.x-n.startPosition.x,2)+Math.pow(n.currentPosition.y-n.startPosition.y,2)).toFixed(1))}},bindEvents=function(e){var t="[guid="+e.id+"]";$(document).on("contextmenu",t,{manager:e,event:2},events.onMouseClick),$(document).on("mousedown",t,{manager:e,event:0},events.onMouseClick),$(document).on("mouseup",t,{manager:e,event:1},events.onMouseClick),$(document).on("mousewheel",t,{manager:e},events.onMouseWheel),$(document).on("mousemove",t,{manager:e},events.onMouseMove),$(document).on("keydown",null,{manager:e,event:0},events.onKeyboardPress),$(document).on("keyup",null,{manager:e,event:1},events.onKeyboardPress),$(document).on("keypress",null,{manager:e,event:2},events.onKeyboardPress),$(document).on("touchstart",t,{manager:e,event:0},events.onTouchTap),$(document).on("touchend",t,{manager:e,event:1},events.onTouchTap),$(document).on("touchmove ",t,{manager:e},events.onTouchMove)},unbindEvents=function(e){var t="[guid="+e.id+"]";$(document).off("contextmenu",t,{manager:e,event:1},events.onMouseClick),$(document).off("mousedown",t,{manager:e,event:0},events.onMouseClick),$(document).off("mouseup",t,{manager:e,event:1},events.onMouseClick),$(document).off("mousewheel",t,{manager:e},events.onMouseWheel),$(document).off("mousemove",t,{manager:e},events.onMouseMove),$(document).off("keydown",null,{manager:e,event:0},events.onKeyboardPress),$(document).off("keyup",null,{manager:e,event:1},events.onKeyboardPress),$(document).off("keypress",null,{manager:e,event:2},events.onKeyboardPress),$(document).off("touchstart",t,{manager:e,event:0},events.onTouchTap),$(document).off("touchend",t,{manager:e,event:1},events.onTouchTap),$(document).off("touchmove ",t,{manager:e},events.onTouchMove)},getPressData=function(e,t){return!e.data.enableAdditionalData||{keyList:t,time:Date.now()-e.data.timePressed}},DEPRECATED_InputManager=function(){function e(t){_classCallCheck(this,e),this.j2d=t,this.id=t.data.id,this.element=t.element,this.data={mouse:{startPosition:{x:0,y:0},currentPosition:{x:0,y:0},previousDistance:0,distance:0},viewport:{position:{x:0,y:0}},enabled:!1,enableAdditionalData:!1,keysPressed:new _ArrayMap2.default,writeMode:!1,timePressed:0,preventAll:!1,cursor:{enabled:!1,image:"auto"}},this.keyMap={FULLSCREEN:[[e.key.KEY_CTRL,e.key.KEY_F11],"j2d.scene.toggleFullScreen",{}]}}return _createClass(e,[{key:"init",value:function(){return!this.data.enabled&&window.j2dPlugin.pluginInit&&(bindEvents(this),this.data.enabled=!0),this}},{key:"update",value:function(){if(!this.data.enabled)return!1;var e=this.j2d.scene.canvas.offsetWidth/this.j2d.scene.data.width,t=this.j2d.scene.canvas.offsetHeight/this.j2d.scene.data.height,n=this.data.mouse.currentPosition.x/e,i=this.data.mouse.currentPosition.y/t,o=this.element.offset();return this.data.viewport.x=this.j2d.scene.viewport.x+n-o.left,this.data.viewport.y=this.j2d.scene.viewport.y+i-o.top,!0}},{key:"flush",value:function(){return this.data.keysPressed.length=0,this}},{key:"clear",value:function(){return this}},{key:"fixMouseWheel",value:function(){var t=this.data.keysPressed;return-1!==$.inArray(e.key.SCROLL_MOUSE_UP,t)?events.mouseWheelCancel(t,e.key.SCROLL_MOUSE_UP):-1!==$.inArray(e.key.SCROLL_MOUSE_DOWN,t)&&events.mouseWheelCancel(t,e.key.SCROLL_MOUSE_DOWN),this}},{key:"enable",value:function(){return this.data.enabled||(this.data.enabled=!1),this}},{key:"disable",value:function(){return this.data.enabled&&(this.data.enabled=!1),this}},{key:"load",value:function(e){var t=JSON.stringify(this.keyMap);return this.keyMap=JSON.parse(e),t}},{key:"save",value:function(){return JSON.stringify(this.keyMap)}},{key:"setKeys",value:function(e){return this.keyMap=$.extend(!0,{},this.keyMap,e),this}},{key:"getMouseMoveDistance",value:function(){return this.data.enableAdditionalData?{current:this.data.mouse.distance,previous:this.data.mouse.previousDistance}:0}},{key:"checkPressedKeyList",value:function(e){return $.isArray(e)?e.length===this.data.keysPressed.length&&(this.data.keysPressed.equals(e)?(this.fixMouseWheel(),getPressData(this,e)):(this.fixMouseWheel(),!1)):!isNaN(e)&&(-1!==this.data.keysPressed.indexOf(e)?(this.fixMouseWheel(),getPressData(this,e)):(this.fixMouseWheel(),!1))}},{key:"checkPressedKeyMap",value:function(e){if(void 0===this.keyMap[e])return!1;var t=this.keyMap[e][0];return this.checkPressedKeyList(t)}},{key:"getPosition",value:function(){return new _Vector2d2.default(this.data.viewport.x+.5,this.data.viewport.y+.3)}},{key:"setWriteMode",value:function(e){return this.data.writeMode=!!e,this}},{key:"isWriteMode",value:function(){return!!this.data.writeMode}},{key:"setCursorImage",value:function(e){return this.data.cursor.image='url("'+e+'"), auto',$(this.element).css("cursor",this.data.cursor.image),this}},{key:"toggleCursor",value:function(e){return void 0!==e?this.data.cursor.enable=!!e:this.data.cursor.enable=!this.data.cursor.enable,this.data.cursor.enable?$(this.element).css("cursor",this.data.cursor.image):(this.data.cursor.image=$(this.j2d.element).css("cursor"),$(this.element).css("cursor","none")),this}},{key:"isCursorVisible",value:function(){return!!this.data.cursor.enable}}]),e}();Object.defineProperty(DEPRECATED_InputManager,"key",{enumerable:!0,writable:!0,value:{KEY_MOUSE_LEFT:1,KEY_MOUSE_MIDDLE:2,KEY_MOUSE_RIGHT:3,SCROLL_MOUSE_UP:4,SCROLL_MOUSE_DOWN:5,KEY_BACKSPACE:8,KEY_TAB:9,KEY_ENTER:13,KEY_SHIFT:16,KEY_CTRL:17,KEY_ALT:18,KEY_PAUSE:19,KEY_BREAK:19,KEY_CAPS_LOCK:20,KEY_ESCAPE:27,KEY_SPACE_BAR:32,KEY_PAGE_UP:33,KEY_PAGE_DOWN:34,KEY_END:35,KEY_HOME:36,KEY_LEFT_ARROW:37,KEY_UP_ARROW:38,KEY_RIGHT_ARROW:39,KEY_DOWN_ARROW:40,KEY_INSERT:45,KEY_DELETE:46,KEY_0:48,KEY_1:49,KEY_2:50,KEY_3:51,KEY_4:52,KEY_5:53,KEY_6:54,KEY_7:55,KEY_8:56,KEY_9:57,KEY_A:65,KEY_B:66,KEY_C:67,KEY_D:68,KEY_E:69,KEY_F:70,KEY_G:71,KEY_H:72,KEY_I:73,KEY_J:74,KEY_K:75,KEY_L:76,KEY_M:77,KEY_N:78,KEY_O:79,KEY_P:80,KEY_Q:81,KEY_R:82,KEY_S:83,KEY_T:84,KEY_U:85,KEY_V:86,KEY_W:87,KEY_X:88,KEY_Y:89,KEY_Z:90,KEY_LEFT_WINDOW_KEY:91,KEY_RIGHT_WINDOW_KEY:92,KEY_SELECT_KEY:93,KEY_NUMPAD_0:96,KEY_NUMPAD_1:97,KEY_NUMPAD_2:98,KEY_NUMPAD_3:99,KEY_NUMPAD_4:100,KEY_NUMPAD_5:101,KEY_NUMPAD_6:102,KEY_NUMPAD_7:103,KEY_NUMPAD_8:104,KEY_NUMPAD_9:105,KEY_MULTIPLY:106,KEY_ADD:107,KEY_SUBTRACT:109,KEY_DECIMAL_POINT:110,KEY_DIVIDE:111,KEY_F1:112,KEY_F2:113,KEY_F3:114,KEY_F4:115,KEY_F5:116,KEY_F6:117,KEY_F7:118,KEY_F8:119,KEY_F9:120,KEY_F10:121,KEY_F11:122,KEY_F12:123,KEY_NUM_LOCK:144,KEY_SCROLL_LOCK:145,KEY_SEMI_COLON:186,KEY_EQUAL_SIGN:187,KEY_COMMA:188,KEY_DASH:189,KEY_PERIOD:190,KEY_FORWARD_SLASH:191,KEY_GRAVE_ACCENT:192,KEY_OPEN_BRACKET:219,KEY_BACK_SLASH:220,KEY_CLOSE_BRACKET:221,KEY_SINGLE_QUOTE:222,KEY_LEFT_COMMAND:224,KEY_RIGHT_COMMAND:224}}),exports.default=DEPRECATED_InputManager,module.exports=exports.default}),function(e,t){if("function"==typeof define&&define.amd)define("io/InputHandlerCodes",["module","exports"],t);else if("undefined"!=typeof exports)t(module,exports);else{var n={exports:{}};t(n,n.exports),e.j2d=e.j2d||{},e.j2d.io=e.j2d.io||{},e.j2d.io.InputHandlerCodes=n.exports}}(this,function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={KEY_MOUSE_LEFT:1,KEY_MOUSE_MIDDLE:2,KEY_MOUSE_RIGHT:3,SCROLL_MOUSE_UP:4,SCROLL_MOUSE_DOWN:5,KEY_BACKSPACE:8,KEY_TAB:9,KEY_ENTER:13,KEY_SHIFT:16,KEY_CTRL:17,KEY_ALT:18,KEY_PAUSE:19,KEY_BREAK:19,KEY_CAPS_LOCK:20,KEY_ESCAPE:27,KEY_SPACE_BAR:32,KEY_PAGE_UP:33,KEY_PAGE_DOWN:34,KEY_END:35,KEY_HOME:36,KEY_LEFT_ARROW:37,KEY_UP_ARROW:38,KEY_RIGHT_ARROW:39,KEY_DOWN_ARROW:40,KEY_INSERT:45,KEY_DELETE:46,KEY_0:48,KEY_1:49,KEY_2:50,KEY_3:51,KEY_4:52,KEY_5:53,KEY_6:54,KEY_7:55,KEY_8:56,KEY_9:57,KEY_A:65,KEY_B:66,KEY_C:67,KEY_D:68,KEY_E:69,KEY_F:70,KEY_G:71,KEY_H:72,KEY_I:73,KEY_J:74,KEY_K:75,KEY_L:76,KEY_M:77,KEY_N:78,KEY_O:79,KEY_P:80,KEY_Q:81,KEY_R:82,KEY_S:83,KEY_T:84,KEY_U:85,KEY_V:86,KEY_W:87,KEY_X:88,KEY_Y:89,KEY_Z:90,KEY_LEFT_WINDOW_KEY:91,KEY_RIGHT_WINDOW_KEY:92,KEY_SELECT_KEY:93,KEY_NUMPAD_0:96,KEY_NUMPAD_1:97,KEY_NUMPAD_2:98,KEY_NUMPAD_3:99,KEY_NUMPAD_4:100,KEY_NUMPAD_5:101,KEY_NUMPAD_6:102,KEY_NUMPAD_7:103,KEY_NUMPAD_8:104,KEY_NUMPAD_9:105,KEY_MULTIPLY:106,KEY_ADD:107,KEY_SUBTRACT:109,KEY_DECIMAL_POINT:110,KEY_DIVIDE:111,KEY_F1:112,KEY_F2:113,KEY_F3:114,KEY_F4:115,KEY_F5:116,KEY_F6:117,KEY_F7:118,KEY_F8:119,KEY_F9:120,KEY_F10:121,KEY_F11:122,KEY_F12:123,KEY_NUM_LOCK:144,KEY_SCROLL_LOCK:145,KEY_SEMI_COLON:186,KEY_EQUAL_SIGN:187,KEY_COMMA:188,KEY_DASH:189,KEY_PERIOD:190,KEY_FORWARD_SLASH:191,KEY_GRAVE_ACCENT:192,KEY_OPEN_BRACKET:219,KEY_BACK_SLASH:220,KEY_CLOSE_BRACKET:221,KEY_SINGLE_QUOTE:222,KEY_LEFT_COMMAND:224,KEY_RIGHT_COMMAND:224,KEY_MOUSE_3:403,KEY_MOUSE_4:404,KEY_MOUSE_5:405,KEY_MOUSE_6:406,KEY_MOUSE_7:407,KEY_MOUSE_8:408,KEY_MOUSE_9:409,KEY_MOUSE_10:410},e.exports=t.default}),function(e,t){if("function"==typeof define&&define.amd)define("api/PrototypeObject",["module","exports","api/PrototypeInterface"],t);else if("undefined"!=typeof exports)t(module,exports,require("api/PrototypeInterface"));else{var n={exports:{}};t(n,n.exports,e.j2d.api.PrototypeInterface),e.j2d=e.j2d||{},e.j2d.api=e.j2d.api||{},e.j2d.api.PrototypeObject=n.exports}}(this,function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=i(n),a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),
Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=function(){function e(){o(this,e),void 0===this.constructor.interfaces&&(this.constructor.interfaces=[]);var t=[],n=function(e){if(!("Object"===e.__proto__.constructor.name||void 0===e.__proto__.constructor||e.__proto__.constructor.interfaces.length<1)){for(var i=0;i<e.__proto__.constructor.interfaces.length;i++)t.includes(e.__proto__.constructor.interfaces[i].name)||(t.push(e.__proto__.constructor.interfaces[i].name),this.constructor.interfaces.push(e.__proto__.constructor.interfaces[i]));n(e.__proto__)}}.bind(this);n(this.__proto__)}return u(e,[{key:"instanceOf",value:function(e){var t=0;if("object"===("undefined"==typeof e?"undefined":a(e))&&e instanceof Array)for(t=0;t<e.length;t++)if("function"==typeof e[t]&&new e[t]instanceof r.default){if(this.constructor.interfaces.includes(e[t])===!1)return!1}else{if("function"!=typeof e[t])throw new Error('Error. "'+e[t].constructor.name+'" is not interface!');if(!(this instanceof e[t]))return!1}else{if("function"==typeof e&&new e instanceof r.default)return this.constructor.interfaces.includes(e);if("function"!=typeof e)throw new Error('Error. "'+e.constructor.name+'" is not interface!');if(!(this instanceof e))return!1}return!0}},{key:"toString",value:function(){return this.__proto__.constructor.name}}]),e}();Object.defineProperty(s,"interfaces",{enumerable:!0,writable:!0,value:[]}),t.default=s,e.exports=t.default}),function(e,t){if("function"==typeof define&&define.amd)define("api/PrototypeInterface",["module","exports"],t);else if("undefined"!=typeof exports)t(module,exports);else{var n={exports:{}};t(n,n.exports),e.j2d=e.j2d||{},e.j2d.api=e.j2d.api||{},e.j2d.api.PrototypeInterface=n.exports}}(this,function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=function(){function e(){n(this,e)}return o(e,[{key:"instanceOf",value:function(t){var n=0,o=0;if("object"===("undefined"==typeof t?"undefined":i(t))&&t instanceof Array)for(n=0;n<t.length;n++){if(!("function"==typeof t[n]&&new t[n]instanceof e))throw new Error('Error. "'+t[n].constructor.name+'" is not interface!');for(o=0;o<this.constructor.interfaces.length;o++)if(!(new this.constructor.interfaces[o]instanceof t[n]))return!1}else{if(!("function"==typeof t&&new t instanceof e))throw new Error('Error. "'+t.constructor.name+'" is not interface!');for(n=0;n<this.constructor.interfaces.length;n++)if(!(new this.constructor.interfaces[n]instanceof t))return!1}return!0}}]),e}();Object.defineProperty(r,"interfaces",{enumerable:!0,writable:!0,value:[r]}),t.default=r,e.exports=t.default}),function(e,t){if("function"==typeof define&&define.amd)define("api/Handler",["module","exports","api/PrototypeObject","api/interfaces/IHandler"],t);else if("undefined"!=typeof exports)t(module,exports,require("api/PrototypeObject"),require("api/interfaces/IHandler"));else{var n={exports:{}};t(n,n.exports,e.j2d.api.PrototypeObject,e.j2d.api.interfaces.IHandler),e.j2d=e.j2d||{},e.j2d.api=e.j2d.api||{},e.j2d.api.Handler=n.exports}}(this,function(e,t,n,i){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=o(n),l=o(i),d=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),c=function(e){function t(){r(this,t);var e=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return Object.defineProperty(e,"_isEnabled",{enumerable:!0,writable:!0,value:!1}),e.events=null,e._isEnabled=!1,e}return u(t,e),d(t,[{key:"init",value:function(e){return void 0!==e&&(this.events=e),this}},{key:"enable",value:function(){return this._isEnabled=!0,this}},{key:"disable",value:function(){return this._isEnabled=!1,this}},{key:"toggle",value:function(e){return void 0===e&&(e=!this.isEnabled),e?this.enable():this.disable(),this}},{key:"isEnabled",get:function(){return this._isEnabled}}]),t}(s.default);Object.defineProperty(c,"interfaces",{enumerable:!0,writable:!0,value:[l.default]}),t.default=c,e.exports=t.default}),function(e,t){if("function"==typeof define&&define.amd)define("api/EngineComponent",["module","exports","api/Handler","api/interfaces/IEngineComponent"],t);else if("undefined"!=typeof exports)t(module,exports,require("api/Handler"),require("api/interfaces/IEngineComponent"));else{var n={exports:{}};t(n,n.exports,e.j2d.api.Handler,e.j2d.api.interfaces.IEngineComponent),e.j2d=e.j2d||{},e.j2d.api=e.j2d.api||{},e.j2d.api.EngineComponent=n.exports}}(this,function(e,t,n,i){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=o(n),l=o(i),d=function(e){function t(){return r(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this))}return u(t,e),t}(s.default);Object.defineProperty(d,"interfaces",{enumerable:!0,writable:!0,value:[l.default]}),t.default=d,e.exports=t.default}),function(e,t){if("function"==typeof define&&define.amd)define("api/Device",["module","exports"],t);else if("undefined"!=typeof exports)t(module,exports);else{var n={exports:{}};t(n,n.exports),e.j2d=e.j2d||{},e.j2d.api=e.j2d.api||{},e.j2d.api.Device=n.exports}}(this,function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=function(){function e(t){n(this,e),Object.defineProperty(this,"input",{enumerable:!0,writable:!0,value:void 0}),void 0!==t&&(this.input=t)}return i(e,[{key:"enable",value:function(){return!0}},{key:"disable",value:function(){return!0}},{key:"init",value:function(e){return void 0!==e&&void 0===this.input&&(this.input=e),!1}},{key:"update",value:function(){return!0}},{key:"clear",value:function(){return!0}},{key:"toString",value:function(){return function(e){return e[0].toLowerCase()+e.slice(1)}(this.constructor.DeviceName||this.constructor.name)}}]),e}();t.default=o,e.exports=t.default}),function(e,t){if("function"==typeof define&&define.amd)define("utils/UUID",["module","exports"],t);else if("undefined"!=typeof exports)t(module,exports);else{var n={exports:{}};t(n,n.exports),e.j2d=e.j2d||{},e.j2d.utils=e.j2d.utils||{},e.j2d.utils.UUID=n.exports}}(this,function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function e(){n(this,e)};Object.defineProperty(i,"generate",{enumerable:!0,writable:!0,value:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0,n="x"==e?t:3&t|8;return n.toString(16)})}}),t.default=i,e.exports=t.default}),function(e,t){if("function"==typeof define&&define.amd)define("utils/SystemConsole",["module","exports"],t);else if("undefined"!=typeof exports)t(module,exports);else{var n={exports:{}};t(n,n.exports),e.j2d=e.j2d||{},e.j2d.utils=e.j2d.utils||{},e.j2d.utils.SystemConsole=n.exports}}(this,function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=function(){function e(){n(this,e),Object.defineProperty(this,"css",{enumerable:!0,writable:!0,value:function(e){return"background: "+e+";background-repeat: no-repeat;color: #1df9a8;line-height: 16px;padding: 1px 0;margin: 0;user-select: none;-webkit-user-select: none;-moz-user-select: none;"}}),Object.defineProperty(this,"link",{enumerable:!0,writable:!0,value:function(e){return"background: "+e+";background-repeat: no-repeat;font-size: 12px;color: #446d96;line-height: 14px"}})}return i(e,[{key:"logSystem",value:function(e,t){return console.log("%c %c %c %s %c %c %c %c%s",this.css("#5C6166"),this.css("#4F5357"),this.css("#313335"),e,this.css("#4F5357"),this.css("#5C6166"),this.link("none"),this.link("none"),t)}},{key:"log",value:function(e,t){var n="";switch("string"==typeof t&&(t=t.toLowerCase()),t){case"info":t="INFO",n="background: #308AE4; color: #fff; padding: 1px 4px";break;case"warn":case"warning":t="WARNING",n="background: #f7a148; color: #fff; padding: 1px 4px";break;case"error":t="ERROR",n="background: #DB5252; color: #fff; padding: 1px 4px";break;case"network":t="NETWORK",n="background: #7D2998; color: #fff; padding: 1px 4px";break;case"debug":case void 0:default:t="DEBUG",n="background: #ADADAD; color: #fff; padding: 1px 4px"}return console.log("%c%s",n,t,e)}}]),e}();t.default=o,e.exports=t.default}),function(e,t){if("function"==typeof define&&define.amd)define("utils/Device",["module","exports","utils/Vector2dInteger"],t);else if("undefined"!=typeof exports)t(module,exports,require("utils/Vector2dInteger"));else{var n={exports:{}};t(n,n.exports,e.j2d.utils.Vector2dInteger),e.j2d=e.j2d||{},e.j2d.utils=e.j2d.utils||{},e.j2d.utils.Device=n.exports}}(this,function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=i(n),a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),u=function(){function e(){o(this,e);var t=parseInt(Math.max(document.documentElement.clientWidth,document.body.scrollWidth,document.documentElement.scrollWidth,document.body.offsetWidth,document.documentElement.offsetWidth)),n=parseInt(Math.max(document.documentElement.clientHeight,document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight));this.width=t<parseInt(screen.width)?t:parseInt(screen.width),this.height=n<parseInt(screen.height)?n:parseInt(screen.height)}return a(e,[{key:"onResize",value:function(){return this.width=window.innerWidth,this.height=window.innerHeight,this}},{key:"getWidth",value:function(){return this.width}},{key:"getHeight",value:function(){return this.height}},{key:"getSize",value:function(){return new r.default(this.width,this.height)}}]),e}();t.default=u,e.exports=t.default}),function(e,t){if("function"==typeof define&&define.amd)define("core/FrameHandler",["exports","api/Handler","api/EngineComponent"],t);else if("undefined"!=typeof exports)t(exports,require("api/Handler"),require("api/EngineComponent"));else{var n={exports:{}};t(n.exports,e.j2d.api.Handler,e.j2d.api.EngineComponent),e.j2d=e.j2d||{},e.j2d.core=e.j2d.core||{},e.j2d.core.FrameHandler=n.exports}}(this,function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(e,"__esModule",{value:!0}),e.CancelAnimationFrame=e.RequestAnimationFrame=void 0;var u=i(t),s=i(n),l=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),d=function(e){function t(){o(this,t);var e=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return Object.defineProperty(e,"_engineStack",{enumerable:!0,writable:!0,value:[]}),Object.defineProperty(e,"_data",{enumerable:!0,writable:!0,value:{start:!1,pause:!1}}),e}return a(t,e),l(t,[{key:"loop",value:function(e){var n=this;if(void 0===this._loop&&(this._loop=function(e){n.loop(e)}),this._engineStack.length<=0&&this._data.start||this._data.pause)return t._breakAnimationFrame=!0,this._data.start=!1,f(this._loop);this._data.start=!0,c(this._loop);for(var i=0;i<this._engineStack.length;i++)if(this._engineStack[i].isEnabled){var o=this._engineStack[i];o._data.pause||(o.io&&o.io.update(),o._state&&"function"==typeof o._state&&o.update(e),o.io&&o.io.clear())}}},{key:"start",value:function(e){return void 0===this._engineStack[e.guid]&&(this._engineStack[e.guid]=e,this._engineStack.push(e)),this._data.start||this.loop(Date.now()-t.timestamp),this}},{key:"stop",value:function(e){return void 0!==this._engineStack[e.guid]&&(delete this._engineStack[e.guid],this._engineStack.splice(this._engineStack.indexOf(e.guid),1)),this}},{key:"init",value:function(e){return u.default.prototype.init.call(this,e),this}},{key:"enable",value:function(){return u.default.prototype.enable.call(this),this._data.pause=!1,this}},{key:"disable",value:function(){return u.default.prototype.disable.call(this),this._data.pause=!0,this}},{key:"frameLimit",set:function(e){return e<=60&&e>0&&(t.frameLimit=e),t.frameLimit||e}},{key:"isStarted",get:function(){return this._data.start}},{key:"isPaused",get:function(){return this._data.pause}}],[{key:"init",value:function(){return t.instance||(t.instance=new t)}}]),t}(s.default);Object.defineProperty(d,"instance",{enumerable:!0,writable:!0,value:void 0}),Object.defineProperty(d,"timestamp",{enumerable:!0,writable:!0,value:0}),Object.defineProperty(d,"frameLimit",{enumerable:!0,writable:!0,value:60}),Object.defineProperty(d,"_breakAnimationFrame",{enumerable:!0,writable:!0,value:!1}),e.default=d;var c=e.RequestAnimationFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){d._breakAnimationFrame?d._breakAnimationFrame=!1:(d.timestamp>=Number.MAX_SAFE_INTEGER-1&&(d.timestamp=0),0===d.timestamp&&(d.timestamp=void 0===window.performance?Date.now():window.performance.now()),window.setTimeout(e.bind(void 0,void 0===window.performance?Date.now()-d.timestamp:window.performance.now()-d.timestamp),1e3/d.frameLimit))}}(),f=e.CancelAnimationFrame=function(){return d.timestamp=0,window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.oCancelAnimationFrame||window.msCancelAnimationFrame}()}),function(e,t){if("function"==typeof define&&define.amd)define("io/InputHandler",["module","exports","api/Handler","io/InputHandlerCodes","io/devices/Keyboard","io/devices/Joystick","io/devices/Mouse","io/devices/Touch","api/Device","api/EngineComponent"],t);else if("undefined"!=typeof exports)t(module,exports,require("api/Handler"),require("io/InputHandlerCodes"),require("io/devices/Keyboard"),require("io/devices/Joystick"),require("io/devices/Mouse"),require("io/devices/Touch"),require("api/Device"),require("api/EngineComponent"));else{var n={exports:{}};t(n,n.exports,e.j2d.api.Handler,e.j2d.io.InputHandlerCodes,e.j2d.io.devices.Keyboard,e.j2d.io.devices.Joystick,e.j2d.io.devices.Mouse,e.j2d.io.devices.Touch,e.j2d.api.Device,e.j2d.api.EngineComponent),e.j2d=e.j2d||{},e.j2d.io=e.j2d.io||{},e.j2d.io.InputHandler=n.exports}}(this,function(e,t,n,i,o,r,a,u,s,l){"use strict";function d(e){return e&&e.__esModule?e:{default:e}}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function p(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var y=d(n),h=d(i),v=d(o),b=d(r),m=d(a),g=d(u),_=d(s),w=d(l),E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},j=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),x=function(e){function t(){c(this,t);var e=f(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return Object.defineProperty(e,"defaultIO",{enumerable:!0,writable:!0,value:{KEYBOARD:v.default,JOYSTICK:b.default,MOUSE:m.default,TOUCH:g.default}}),Object.defineProperty(e,"KEY",{enumerable:!0,writable:!0,value:t.KEY}),e.preventDefault=!1,e.IO=[],e.options={cursor:"none"},e.store={},e.data={},e.keyCodeMap={FULLSCREEN:[[t.KEY.KEY_CTRL,t.KEY.KEY_F11],"j2d.scene.toggleFullScreen",{}]},e}return p(t,e),j(t,[{key:"bindListeners",value:function(){for(var e=0;e<this.IO.length;e++)if(this.IO[e].enable()===!1)return!1}},{key:"unBindListeners",value:function(){for(var e=0;e<this.IO.length;e++)if(this.IO[e].disable()===!1)return!1}},{key:"update",value:function(){if(!this.isEnabled)return!1;for(var e=0;e<this.IO.length;e++)if(this.IO[e].update()===!1)return!1;return!0}},{key:"clear",value:function(){if(!this.isEnabled)return!1;for(var e=0;e<this.IO.length;e++)if(this.IO[e].clear()===!1)return!1;return!0}},{key:"load",value:function(e){var t=JSON.stringify(this.keyCodeMap);return this.keyCodeMap=JSON.parse(e),t}},{key:"save",value:function(){return JSON.stringify(this.keyCodeMap)}},{key:"flush",value:function(){}},{key:"checkPressedKeyList",value:function(e){return"object"===("undefined"==typeof e?"undefined":E(e))&&e instanceof Array?(e.length!==this.data.keys.keysDown.length,!1):!isNaN(e)&&(-1!==this.data.keys.keysDown.indexOf(e)&&t._getPressData(this,e))}},{key:"checkPressedKeyMap",value:function(e){return void 0!==this.keyCodeMap[e]&&this.checkPressedKeyList(this.keyCodeMap[e][0])}},{key:"setKeys",value:function(e){return this}},{key:"init",value:function(e,n,i){return y.default.prototype.init.call(this,e),void 0!==i&&null!==i&&"object"===("undefined"==typeof i?"undefined":E(i))&&(this.options=i),void 0!==n&&null!==n&&"object"===("undefined"==typeof n?"undefined":E(n))&&n instanceof Array&&(this.IO=[],n.map(function(e){if("string"==typeof e&&void 0!==t.IO[e.toUpperCase()]){if(e=new(this.defaultIO[e.toUpperCase()]),this.IO[e.toString()]=e,this.IO.push(e),this.IO[e].init(this)===!1)throw new Error('Error. Device "'+e+'" not initialize.')}else{if(!("object"===("undefined"==typeof e?"undefined":E(e))&&e instanceof _.default))throw new Error('Error. Unknown IO device "'+e.toString()+'" is not supported yet.');if(this.IO[e.toString()]=e,this.IO.push(e),this.IO[e.toString()].init(this)===!1)throw new Error('Error. Device "'+e+'" not initialize.')}}.bind(this))),this}},{key:"enable",value:function(){return y.default.prototype.enable.call(this),this.bindListeners(),this}},{key:"disable",value:function(){return y.default.prototype.disable.call(this),this.unBindListeners(),this}},{key:"toggle",value:function(e){return y.default.prototype.toggle.call(this,e),this}}],[{key:"_getPressData",value:function(e,t){return{keyList:t,time:e.store.keys.pressedTime[t[0]]}}}]),t}(w.default);Object.defineProperty(x,"IO",{enumerable:!0,writable:!0,value:{KEYBOARD:"keyboard",JOYSTICK:"joystick",MOUSE:"mouse",TOUCH:"touch"}}),Object.defineProperty(x,"KEY",{enumerable:!0,writable:!0,value:h.default}),Object.defineProperty(x,"KEYS_HELPER",{enumerable:!0,writable:!0,value:x.prototype.KEYS_HELPER={getKeyById:function(e){return x.KEY[e]||"KEY_UNKNOWN_"+e},getKeyByCode:function(e){return x.KEY[e]||0}}}),t.default=x,e.exports=t.default}),function(e,t){if("function"==typeof define&&define.amd)define("events/EventHandler",["module","exports","api/Handler","../api/EngineComponent"],t);else if("undefined"!=typeof exports)t(module,exports,require("api/Handler"),require("../api/EngineComponent"));else{var n={exports:{}};t(n,n.exports,e.j2d.api.Handler,e.apiEngineComponent),e.j2d=e.j2d||{},e.j2d.events=e.j2d.events||{},e.j2d.events.EventHandler=n.exports}}(this,function(e,t,n,i){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=o(n),l=o(i),d=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),c=function(e){function t(){r(this,t);var e=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return Object.defineProperty(e,"events",{enumerable:!0,writable:!0,value:[]}),Object.defineProperty(e,"onces",{enumerable:!0,writable:!0,value:[]}),e.flush(),e}return u(t,e),d(t,[{key:"on",value:function(e,t){if(void 0!==this.events[e]){var n=this.events[e];n.indexOf(t)===-1&&n.push(t)}else this.events[e]=[],this.events[e].push(t);return this}},{key:"once",value:function(e,t){if(void 0!==this.onces[e]){var n=this.onces[e];n.indexOf(t)===-1&&n.push(t)}else this.onces[e]=[],this.onces[e].push(t);return this}},{key:"off",value:function(e,t){if(void 0!==this.onces[e]){var n=this.events[e];n.indexOf(t)!==-1&&n.splice(n.indexOf(t))}return this}},{key:"trigger",value:function(e,t){var n,i,o;if(void 0!==this.onces[e]){for(n=this.onces[e],i=0;i<n.length;i++)if(o=n[i].call(n[i],t),"boolean"==typeof o&&!o)return this;this.flush(e)}if(void 0!==this.events[e])for(n=this.events[e],i=0;i<n.length;i++)if(o=n[i].call(n[i],t),"boolean"==typeof o&&!o)return this;return this}},{key:"flush",value:function(e){return void 0!==e?(void 0!==this.events[e]&&(this.events[e]=[]),void 0!==this.onces[e]&&(this.onces[e]=[])):(this.onces=[],this.events=[]),this}},{key:"init",value:function(e){return s.default.prototype.init.call(this,e),this}},{key:"enable",value:function(){return s.default.prototype.enable.call(this),this}},{key:"disable",value:function(){return s.default.prototype.disable.call(this),this}},{key:"toggle",value:function(e){return s.default.prototype.toggle.call(this,e),this}}]),t}(l.default);t.default=c,e.exports=t.default}),function(e,t){if("function"==typeof define&&define.amd)define("exceptions/InvalidArgumentException",["module","exports","exceptions/Exception"],t);else if("undefined"!=typeof exports)t(module,exports,require("exceptions/Exception"));else{var n={exports:{}};t(n,n.exports,e.exceptionsException),e.exceptionsInvalidArgumentException=n.exports}}(this,function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=i(n),s=function(e){function t(e){o(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return Object.defineProperty(n,"toString",{enumerable:!0,writable:!0,value:function(){return this.message}}),n}return a(t,e),t}(u.default);t.default=s,e.exports=t.default}),function(e,t){if("function"==typeof define&&define.amd)define("api/interfaces/IEngineComponent",["module","exports","api/PrototypeInterface"],t);else if("undefined"!=typeof exports)t(module,exports,require("api/PrototypeInterface"));else{var n={exports:{}};t(n,n.exports,e.j2d.api.PrototypeInterface),e.j2d=e.j2d||{},e.j2d.api=e.j2d.api||{},e.j2d.api.interfaces=e.j2d.api.interfaces||{},e.j2d.api.interfaces.IEngineComponent=n.exports}}(this,function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=i(n),s=function(e){function t(){return o(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),t}(u.default);t.default=s,e.exports=t.default}),function(e,t){if("function"==typeof define&&define.amd)define("api/Engine",["module","exports","api/PrototypeObject","api/interfaces/IEngine","exceptions/RuntimeException"],t);else if("undefined"!=typeof exports)t(module,exports,require("api/PrototypeObject"),require("api/interfaces/IEngine"),require("exceptions/RuntimeException"));else{var n={exports:{}};t(n,n.exports,e.j2d.api.PrototypeObject,e.j2d.api.interfaces.IEngine,e.exceptionsRuntimeException),e.j2d=e.j2d||{},e.j2d.api=e.j2d.api||{},e.j2d.api.Engine=n.exports}}(this,function(e,t,n,i,o){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=r(n),d=r(i),c=r(o),f=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),p=function(e){function t(e){a(this,t);var n=u(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));if(Object.defineProperty(n,"_isEnabled",{enumerable:!0,writable:!0,value:!1}),!t._$classPreInitialize.includes(e))throw new c.default("The constructor is private. Please use static "+n.constructor.name+".init()");return t._$classPreInitialize.splice(t._$classPreInitialize.indexOf(e),1),n}return s(t,e),f(t,[{key:"enable",value:function(){return this._isEnabled=!0,this}},{key:"disable",value:function(){return this._isEnabled=!1,this}},{key:"toggle",value:function(e){return void 0===e&&(e=!this.isEnabled),e?this.enable():this.disable(),this}},{key:"isEnabled",get:function(){return this._isEnabled}}]),t}(l.default);Object.defineProperty(p,"interfaces",{enumerable:!0,writable:!0,value:[d.default]}),Object.defineProperty(p,"_$classPreInitialize",{enumerable:!0,writable:!0,value:[]}),t.default=p,e.exports=t.default}),function(e,t){if("function"==typeof define&&define.amd)define("j2d",["module","exports","api/Engine","api/interfaces/IEngineComponent","exceptions/InvalidArgumentException","events/EventHandler","io/InputHandler","core/FrameHandler","utils/ArrayMap","utils/Device","utils/ObjectUtil","utils/SystemConsole","utils/UUID"],t);else if("undefined"!=typeof exports)t(module,exports,require("api/Engine"),require("api/interfaces/IEngineComponent"),require("exceptions/InvalidArgumentException"),require("events/EventHandler"),require("io/InputHandler"),require("core/FrameHandler"),require("utils/ArrayMap"),require("utils/Device"),require("utils/ObjectUtil"),require("utils/SystemConsole"),require("utils/UUID"));else{var n={exports:{}};t(n,n.exports,e.j2d.api.Engine,e.j2d.api.interfaces.IEngineComponent,e.exceptionsInvalidArgumentException,e.j2d.events.EventHandler,e.j2d.io.InputHandler,e.j2d.core.FrameHandler,e.j2d.utils.ArrayMap,e.j2d.utils.Device,e.j2d.utils.ObjectUtil,e.j2d.utils.SystemConsole,e.j2d.utils.UUID),e.j2d=e.j2d||{},e.j2d.Engine=n.exports}}(this,function(e,t,n,i,o,r,a,u,s,l,d,c,f){"use strict";function p(e){return e&&e.__esModule?e:{default:e}}function y(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function v(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t);
}Object.defineProperty(t,"__esModule",{value:!0});var b=p(n),m=p(i),g=p(o),_=p(r),w=p(a),E=p(u),j=p(s),x=p(l),O=p(d),k=p(c),P=p(f),M="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},S=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),C=function(e){function t(e,n){y(this,t);var i=h(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,void 0!==n?n.id:null));return Object.defineProperty(i,"_initialized",{enumerable:!0,writable:!0,value:!1}),Object.defineProperty(i,"_element",{enumerable:!0,writable:!0,value:null}),Object.defineProperty(i,"_data",{enumerable:!0,writable:!0,value:{}}),Object.defineProperty(i,"_state",{enumerable:!0,writable:!0,value:null}),Object.defineProperty(i,"device",{enumerable:!0,writable:!0,value:new x.default}),Object.defineProperty(i,"logger",{enumerable:!0,writable:!0,value:new k.default}),i._element=e,i._data=n,i.log('Find scene with id "'+i.guid+'"',"info"),i.log(i._data.components),i}return v(t,e),S(t,[{key:"start",value:function(){this._initialized||this.tryLoadComponents(),this.enable(),this.frame.start(this),this.events.trigger("start")}},{key:"stop",value:function(){this._initialized||this.tryLoadComponents(),this.disable(),this.frame.stop(this),this.events.trigger("stop")}},{key:"pause",value:function(){this._initialized||this.tryLoadComponents(),this.io&&this.io.flush(),this._data.pause=!0,this._element.classList.add("pause"),this.events.trigger("pause")}},{key:"resume",value:function(){this._initialized||this.tryLoadComponents(),this._element.classList.remove("pause"),this._element.focus(),this._data.pause=!1,this.io&&this.io.flush(),this.events.trigger("resume")}},{key:"update",value:function(e){this._state&&this._state.bind(this,e)()}},{key:"log",value:function(e,t){this.logger.log(e,t)}},{key:"tryLoadComponents",value:function(){this._initialized||(null===this.EventHandler&&(this.EventHandler=new _.default),this.EventHandler.enable(),null===this.InputHandler&&(this.InputHandler=new w.default,this.InputHandler.init(this.EventHandler,[w.default.IO.KEYBOARD,w.default.IO.MOUSE],{cursor:"default"})),this.InputHandler.enable(),null===this.FrameHandler&&(this.FrameHandler=E.default.init(),this.FrameHandler.init(this.EventHandler)),this.FrameHandler.enable(),this._initialized=!0)}},{key:"guid",get:function(){return this._data.id}},{key:"state",set:function(e){return this._state=e}},{key:"events",get:function(){return this.EventHandler}},{key:"EventHandler",get:function(){return this._data.components.EventHandler},set:function(e){if(!e.instanceOf(m.default))throw new g.default("Handler not implements IEngineComponent");return this._data.components.EventHandler=e}},{key:"frame",get:function(){return this.FrameHandler}},{key:"FrameHandler",get:function(){return this._data.components.FrameHandler},set:function(e){if(!e.instanceOf(m.default))throw new g.default("Handler not implements IEngineComponent");return this._data.components.FrameHandler=e}},{key:"io",get:function(){return this.InputHandler}},{key:"InputHandler",get:function(){return this._data.components.InputHandler},set:function(e){if(!e.instanceOf(m.default))throw new g.default("Handler not implements IEngineComponent");return this._data.components.InputHandler=e}},{key:"media",get:function(){return this.MediaHandler}},{key:"MediaHandler",get:function(){return this._data.components.MediaHandler},set:function(e){if(!e.instanceOf(m.default))throw new g.default("Handler not implements IEngineComponent");return this._data.components.MediaHandler=e}},{key:"tweens",get:function(){return this.TweenHandler}},{key:"TweenHandler",get:function(){return this._data.components.TweenHandler},set:function(e){if(!e.instanceOf(m.default))throw new g.default("Handler not implements IEngineComponent");return this._data.components.TweenHandler=e}},{key:"scene",get:function(){return this.SceneHandler}},{key:"SceneHandler",get:function(){return this._data.components.SceneHandler},set:function(e){if(!e.instanceOf(m.default))throw new g.default("Handler not implements IEngineComponent");return this._data.components.SceneHandler=e}}],[{key:"init",value:function(e,n){function i(){var e=void 0;return this.classList.contains("pause")?(e=t.stack.get(this.getAttribute("guid")),e&&e.resume(),a(this)):!this.classList.contains("resume-by-click")&&this.classList.contains(":focus")&&(this.classList.add("active"),this.focus(),e=t.stack.get(this.getAttribute("guid")),e&&e.resume(),a(this)),!0}void 0===e&&(e=".j2d"),void 0===n&&(n={}),n=O.default.extend(!0,{},t.defaults,n);var o=[];if("string"==typeof e)o=window.document.querySelectorAll(e);else{if(!("object"===("undefined"==typeof e?"undefined":M(e))&&void 0!==window.jQuery&&e instanceof window.jQuery))return null;o=e.get()}var r=[];Array.prototype.forEach.call(o,function(e){e.hasAttribute("guid")||r.push(e)}),r.forEach(function(e){n.id=P.default.generate(),e.setAttribute("guid",n.id);var i=e.getAttribute("id");void 0!==i&&null!==i||e.setAttribute("guid",n.id);var o=e.getAttribute("tabindex");void 0!==o&&null!==o&&o!==!1||e.setAttribute("tabindex","-1"),e.classList.contains("j2d")||e.classList.add("j2d"),b.default._$classPreInitialize.push(n.id),t.stack.add(n.id,new t(e,n)),e.click(),e.focus()});var a=function(e){var n=void 0,i=void 0;n=window.document.querySelectorAll("div.canvas[guid]:not(.pause-disable):not(:focus)"),Array.prototype.forEach.call(n,function(n){e!==n&&(n.classList.remove("active"),i=t.stack.get(n.getAttribute("guid")),i&&i.pause())}),n=window.document.querySelectorAll("div.canvas[guid].active.pause-disable:not(:focus)"),Array.prototype.forEach.call(n,function(t){e!==t&&t.classList.remove("active")})},u=[];return o=window.document.querySelectorAll(".j2d[guid]"),Array.prototype.forEach.call(o,function(e){u.push(t.stack.get(e.getAttribute("guid"))),e.addEventListener("click",i),e.addEventListener("touch",i),e.addEventListener("mouseenter",i)}),1===u.length?u[0]:u}}]),t}(b.default);Object.defineProperty(C,"VERSION",{enumerable:!0,writable:!0,value:"1.0.0-dev (VeNoM iNjecTioN)"}),Object.defineProperty(C,"defaults",{enumerable:!0,writable:!0,value:{id:"",pause:!1,components:{EventHandler:null,FrameHandler:null,InputHandler:null,MediaHandler:null,TweenHandler:null,SceneHandler:null}}}),Object.defineProperty(C,"stack",{enumerable:!0,writable:!0,value:new j.default}),t.default=C,(C.initPlugin=function(){function e(){var e=i();if(!e){var t=void 0,n=void 0;t=window.document.querySelector(".j2d[guid].active"),t&&(n=C.stack.get(t.getAttribute("guid"))),n&&n.scene.resizeToFullPage(e),t=window.document.querySelector(".j2d[guid]:not(.active)"),t&&(n=C.stack.get(t.getAttribute("guid"))),n&&n.toggle(!e)}}if(void 0!==window.j2dPlugin)return null;window.j2dPlugin={pluginInit:!0,stack:new j.default},(new k.default).logSystem("j2D v."+C.VERSION,"https://github.com/fsggs/j2d"),void 0!==window.jQuery&&(window.jQuery.fn.j2d=function(e){return C.init(void 0,e)}),window.j2dPlugin.init=C.init;var t=window.navigator.userAgent.match(/Firefox\/([0-9]+)\./),n=!!t&&parseInt(t[2],10),i=function(){return!!(window.document.webkitFullscreenElement||window.document.webkitCurrentFullScreenElement||n&&n<47?window.document.mozFullScreenElement:window.document.fullscreenElement||window.document.msFullscreenElement)},o=window.document.querySelector("html");o.classList.contains("j2d-engine")||(window.document.addEventListener("fullscreenchange",e),window.document.addEventListener("webkitfullscreenchange",e),window.document.addEventListener("mozfullscreenchange",e),window.document.addEventListener("MSFullscreenChange",e),window.addEventListener("focus",function(){var e=void 0,t=void 0;e=window.document.querySelector(".j2d[guid].active:not(.resume-by-click)"),e&&(t=C.stack.get(e.getAttribute("guid"))),t&&t.resume()}),window.addEventListener("blur",function(){var e=void 0,t=void 0;e=window.document.querySelectorAll(".j2d[guid]:not(.pause-disable)"),Array.prototype.forEach.call(e,function(e){e&&(t=C.stack.get(e.getAttribute("guid"))),t&&t.pause()})}),window.addEventListener("resize",function(){C.stack.forEach(function(e){C.stack[e].device.onResize()});var e=i();if(e){var t=void 0,n=void 0;t=window.document.querySelector(".j2d[guid].active"),t&&(n=C.stack.get(t.getAttribute("guid"))),n&&n.scene.resizeToFullPage(e)}return!0}),o.classList.add("j2d-engine"))})(),e.exports=t.default});
//# sourceMappingURL=j2d.min.map
